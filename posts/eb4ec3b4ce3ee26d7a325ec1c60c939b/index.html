<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>å¤§æ•°æ®æ¯•ä¸šè®¾è®¡ï¼špythonæ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§ç³»ç»Ÿ äº¤é€šå¯è§†åŒ– ç‰©è”ç½‘ Flaskæ¡†æ¶ï¼ˆæºç ï¼‰âœ… - è€å¸…çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/eb4ec3b4ce3ee26d7a325ec1c60c939b/">
  <meta property="og:site_name" content="è€å¸…çš„åšå®¢">
  <meta property="og:title" content="å¤§æ•°æ®æ¯•ä¸šè®¾è®¡ï¼špythonæ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§ç³»ç»Ÿ äº¤é€šå¯è§†åŒ– ç‰©è”ç½‘ Flaskæ¡†æ¶ï¼ˆæºç ï¼‰âœ…">
  <meta property="og:description" content="æ¯•ä¸šè®¾è®¡ï¼š2023-2024å¹´è®¡ç®—æœºä¸“ä¸šæ¯•ä¸šè®¾è®¡é€‰é¢˜æ±‡æ€»ï¼ˆå»ºè®®æ”¶è—ï¼‰
æ¯•ä¸šè®¾è®¡ï¼š2023-2024å¹´æœ€æ–°æœ€å…¨è®¡ç®—æœºä¸“ä¸šæ¯•è®¾é€‰é¢˜æ¨èæ±‡æ€»
ğŸ…æ„Ÿå…´è¶£çš„å¯ä»¥å…ˆæ”¶è—èµ·æ¥ï¼Œç‚¹èµã€å…³æ³¨ä¸è¿·è·¯ï¼Œå¤§å®¶åœ¨æ¯•è®¾é€‰é¢˜ï¼Œé¡¹ç›®ä»¥åŠè®ºæ–‡ç¼–å†™ç­‰ç›¸å…³é—®é¢˜éƒ½å¯ä»¥ç»™æˆ‘ç•™è¨€å’¨è¯¢ï¼Œå¸Œæœ›å¸®åŠ©åŒå­¦ä»¬é¡ºåˆ©æ¯•ä¸šÂ ã€‚ğŸ…
1ã€é¡¹ç›®ä»‹ç» æŠ€æœ¯æ ˆï¼š
Pythonè¯­è¨€ã€Flaskæ¡†æ¶ã€Echartså¯è§†åŒ–ã€ç™¾åº¦åœ°å›¾ã€sqliteæ•°æ®åº“ã€HTML
æ™ºæ…§äº¤é€šç›‘æ§å¤§æ•°æ®ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºä»¥ä¸ŠæŠ€æœ¯æ ˆæ„å»ºçš„ç³»ç»Ÿï¼Œé€šè¿‡é‡‡é›†äº¤é€šç›‘æ§è®¾å¤‡äº§ç”Ÿçš„æ•°æ®ï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†å’Œåˆ†æï¼Œç„¶åä½¿ç”¨Echartså¯è§†åŒ–åº“å°†æ•°æ®ä»¥å›¾è¡¨çš„å½¢å¼å±•ç¤ºåœ¨Webé¡µé¢ä¸Šã€‚ç™¾åº¦åœ°å›¾å¯ä»¥ç”¨æ¥æ˜¾ç¤ºäº¤é€šçŠ¶å†µã€æ ‡æ³¨äº¤é€šäº‹ä»¶æˆ–çƒ­ç‚¹åŒºåŸŸã€‚SQLiteæ•°æ®åº“ç”¨äºå­˜å‚¨äº¤é€šç›‘æ§è®¾å¤‡é‡‡é›†çš„æ•°æ®ï¼Œæ”¯æŒæ•°æ®çš„æŸ¥è¯¢å’Œç®¡ç†ã€‚æ•´ä¸ªç³»ç»Ÿçš„å‰ç«¯ç•Œé¢åˆ™é€šè¿‡HTMLæ¥å‘ˆç°ç»™ç”¨æˆ·ã€‚
2ã€é¡¹ç›®ç•Œé¢ ï¼ˆ1ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§ç”»é¢
ï¼ˆ2ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§å¤§å±
ï¼ˆ3ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§åœ°å›¾
ï¼ˆ4ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§ç»Ÿè®¡åˆ†æ
ï¼ˆ5ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§ç³»ç»Ÿåå°æ•°æ®ç®¡ç†
ï¼ˆ6ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§æ•°æ®ç»Ÿè®¡åˆ†æ
ï¼ˆ7ï¼‰æ³¨å†Œç™»å½•ç•Œé¢
3ã€é¡¹ç›®è¯´æ˜ æŠ€æœ¯æ ˆæè¿°ï¼š
Pythonè¯­è¨€ï¼šä½œä¸ºä¸»è¦çš„å¼€å‘è¯­è¨€ï¼Œç”¨äºç¼–å†™åç«¯é€»è¾‘å’Œæ•°æ®å¤„ç†ã€‚
Flaskæ¡†æ¶ï¼šç”¨äºæ„å»ºWebåº”ç”¨ç¨‹åºï¼Œæä¾›è·¯ç”±ã€è¯·æ±‚å¤„ç†å’Œæ¨¡æ¿æ¸²æŸ“ç­‰åŠŸèƒ½ã€‚
Echartså¯è§†åŒ–ï¼šç”¨äºåœ¨Webé¡µé¢ä¸­ç”Ÿæˆäº¤äº’å¼å›¾è¡¨ï¼Œå®ç°æ•°æ®çš„å¯è§†åŒ–å±•ç¤ºã€‚
ç™¾åº¦åœ°å›¾ï¼šé€šè¿‡ç™¾åº¦åœ°å›¾APIè·å–åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œå®ç°åœ°å›¾æ˜¾ç¤ºå’Œä½ç½®æ ‡æ³¨ç­‰åŠŸèƒ½ã€‚
SQLiteæ•°æ®åº“ï¼šä½œä¸ºè½»é‡çº§çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå­˜å‚¨ç³»ç»Ÿä¸­çš„ç›‘æ§æ•°æ®ã€‚
HTMLï¼šç”¨äºæ„å»ºå‰ç«¯ç”¨æˆ·ç•Œé¢ï¼Œå®šä¹‰é¡µé¢ç»“æ„å’Œå†…å®¹å±•ç¤ºã€‚
æ™ºæ…§äº¤é€šç›‘æ§å¤§æ•°æ®ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºä»¥ä¸ŠæŠ€æœ¯æ ˆæ„å»ºçš„ç³»ç»Ÿï¼Œé€šè¿‡é‡‡é›†äº¤é€šç›‘æ§è®¾å¤‡äº§ç”Ÿçš„æ•°æ®ï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†å’Œåˆ†æï¼Œç„¶åä½¿ç”¨Echartså¯è§†åŒ–åº“å°†æ•°æ®ä»¥å›¾è¡¨çš„å½¢å¼å±•ç¤ºåœ¨Webé¡µé¢ä¸Šã€‚ç™¾åº¦åœ°å›¾å¯ä»¥ç”¨æ¥æ˜¾ç¤ºäº¤é€šçŠ¶å†µã€æ ‡æ³¨äº¤é€šäº‹ä»¶æˆ–çƒ­ç‚¹åŒºåŸŸã€‚SQLiteæ•°æ®åº“ç”¨äºå­˜å‚¨äº¤é€šç›‘æ§è®¾å¤‡é‡‡é›†çš„æ•°æ®ï¼Œæ”¯æŒæ•°æ®çš„æŸ¥è¯¢å’Œç®¡ç†ã€‚æ•´ä¸ªç³»ç»Ÿçš„å‰ç«¯ç•Œé¢åˆ™é€šè¿‡HTMLæ¥å‘ˆç°ç»™ç”¨æˆ·ã€‚
4ã€æ ¸å¿ƒä»£ç  from flask import session,redirect,request,render_template,url_for,Flask,jsonify from models import app import models from flask_security import Security, SQLAlchemySessionUserDatastore, \ UserMixin, RoleMixin, login_required, auth_token_required, http_auth_required,current_user from sqlalchemy import and_ user_datastore = SQLAlchemySessionUserDatastore(models.db.session, models.User, models.Role) security = Security(app, user_datastore) @app.route(&#39;/&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;]) @app.route(&#39;/index&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;]) def home(): stu_id = current_user.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-25T22:34:27+08:00">
    <meta property="article:modified_time" content="2024-02-25T22:34:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="è€å¸…çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">è€å¸…çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">å¤§æ•°æ®æ¯•ä¸šè®¾è®¡ï¼špythonæ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§ç³»ç»Ÿ äº¤é€šå¯è§†åŒ– ç‰©è”ç½‘ Flaskæ¡†æ¶ï¼ˆæºç ï¼‰âœ…</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <div class="blog-content-box"> 
 <div class="article-header-box"> 
 </div> 
</div> 
<p><a class="link-info" href="https://biyesheji0001.blog.csdn.net/article/details/134580993" rel="nofollow" title="æ¯•ä¸šè®¾è®¡ï¼š2023-2024å¹´è®¡ç®—æœºä¸“ä¸šæ¯•ä¸šè®¾è®¡é€‰é¢˜æ±‡æ€»ï¼ˆå»ºè®®æ”¶è—ï¼‰">æ¯•ä¸šè®¾è®¡ï¼š2023-2024å¹´è®¡ç®—æœºä¸“ä¸šæ¯•ä¸šè®¾è®¡é€‰é¢˜æ±‡æ€»ï¼ˆå»ºè®®æ”¶è—ï¼‰</a></p> 
<p><a class="link-info" href="https://blog.csdn.net/2201_75772776/article/details/133148685" title="[æ¯•ä¸šè®¾è®¡]2023-2024å¹´æœ€æ–°æœ€å…¨è®¡ç®—æœºä¸“ä¸šæ¯•è®¾é€‰é¢˜æ¨èæ±‡æ€»">æ¯•ä¸šè®¾è®¡ï¼š2023-2024å¹´æœ€æ–°æœ€å…¨è®¡ç®—æœºä¸“ä¸šæ¯•è®¾é€‰é¢˜æ¨èæ±‡æ€»</a></p> 
<p>ğŸ…<strong>æ„Ÿå…´è¶£çš„å¯ä»¥å…ˆæ”¶è—èµ·æ¥ï¼Œç‚¹èµã€å…³æ³¨ä¸è¿·è·¯ï¼Œå¤§å®¶åœ¨æ¯•è®¾é€‰é¢˜ï¼Œé¡¹ç›®ä»¥åŠè®ºæ–‡ç¼–å†™ç­‰ç›¸å…³é—®é¢˜éƒ½å¯ä»¥ç»™æˆ‘ç•™è¨€å’¨è¯¢ï¼Œå¸Œæœ›å¸®åŠ©åŒå­¦ä»¬é¡ºåˆ©æ¯•ä¸šÂ ã€‚</strong>ğŸ…</p> 
<h3><a id="1_23"></a>1ã€é¡¹ç›®ä»‹ç»</h3> 
<p>æŠ€æœ¯æ ˆï¼š<br> Pythonè¯­è¨€ã€Flaskæ¡†æ¶ã€Echartså¯è§†åŒ–ã€ç™¾åº¦åœ°å›¾ã€sqliteæ•°æ®åº“ã€HTML</p> 
<p>æ™ºæ…§äº¤é€šç›‘æ§å¤§æ•°æ®ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºä»¥ä¸ŠæŠ€æœ¯æ ˆæ„å»ºçš„ç³»ç»Ÿï¼Œé€šè¿‡é‡‡é›†äº¤é€šç›‘æ§è®¾å¤‡äº§ç”Ÿçš„æ•°æ®ï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†å’Œåˆ†æï¼Œç„¶åä½¿ç”¨Echartså¯è§†åŒ–åº“å°†æ•°æ®ä»¥å›¾è¡¨çš„å½¢å¼å±•ç¤ºåœ¨Webé¡µé¢ä¸Šã€‚ç™¾åº¦åœ°å›¾å¯ä»¥ç”¨æ¥æ˜¾ç¤ºäº¤é€šçŠ¶å†µã€æ ‡æ³¨äº¤é€šäº‹ä»¶æˆ–çƒ­ç‚¹åŒºåŸŸã€‚SQLiteæ•°æ®åº“ç”¨äºå­˜å‚¨äº¤é€šç›‘æ§è®¾å¤‡é‡‡é›†çš„æ•°æ®ï¼Œæ”¯æŒæ•°æ®çš„æŸ¥è¯¢å’Œç®¡ç†ã€‚æ•´ä¸ªç³»ç»Ÿçš„å‰ç«¯ç•Œé¢åˆ™é€šè¿‡HTMLæ¥å‘ˆç°ç»™ç”¨æˆ·ã€‚</p> 
<h3><a id="2_32"></a>2ã€é¡¹ç›®ç•Œé¢</h3> 
<p>ï¼ˆ1ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§ç”»é¢</p> 
<p><img src="https://images2.imgbox.com/3c/a8/Lj4oIv4m_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ï¼ˆ2ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§å¤§å±</p> 
<p><img src="https://images2.imgbox.com/ea/ab/XgXr7X0f_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ï¼ˆ3ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§åœ°å›¾<br> <img src="https://images2.imgbox.com/02/93/NOB9QJfq_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ï¼ˆ4ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§ç»Ÿè®¡åˆ†æ</p> 
<p><img src="https://images2.imgbox.com/9d/a6/uj5mjzto_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ï¼ˆ5ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§ç³»ç»Ÿåå°æ•°æ®ç®¡ç†</p> 
<p><img src="https://images2.imgbox.com/61/c5/HUI3hHa5_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ï¼ˆ6ï¼‰æ™ºæ…§äº¤é€šå¤§æ•°æ®ç›‘æ§æ•°æ®ç»Ÿè®¡åˆ†æ</p> 
<p><img src="https://images2.imgbox.com/bb/37/X9glaFKJ_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ï¼ˆ7ï¼‰æ³¨å†Œç™»å½•ç•Œé¢</p> 
<p><img src="https://images2.imgbox.com/ac/1d/McKxYOez_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="3_80"></a>3ã€é¡¹ç›®è¯´æ˜</h3> 
<p>æŠ€æœ¯æ ˆæè¿°ï¼š</p> 
<p>Pythonè¯­è¨€ï¼šä½œä¸ºä¸»è¦çš„å¼€å‘è¯­è¨€ï¼Œç”¨äºç¼–å†™åç«¯é€»è¾‘å’Œæ•°æ®å¤„ç†ã€‚<br> Flaskæ¡†æ¶ï¼šç”¨äºæ„å»ºWebåº”ç”¨ç¨‹åºï¼Œæä¾›è·¯ç”±ã€è¯·æ±‚å¤„ç†å’Œæ¨¡æ¿æ¸²æŸ“ç­‰åŠŸèƒ½ã€‚<br> Echartså¯è§†åŒ–ï¼šç”¨äºåœ¨Webé¡µé¢ä¸­ç”Ÿæˆäº¤äº’å¼å›¾è¡¨ï¼Œå®ç°æ•°æ®çš„å¯è§†åŒ–å±•ç¤ºã€‚<br> ç™¾åº¦åœ°å›¾ï¼šé€šè¿‡ç™¾åº¦åœ°å›¾APIè·å–åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œå®ç°åœ°å›¾æ˜¾ç¤ºå’Œä½ç½®æ ‡æ³¨ç­‰åŠŸèƒ½ã€‚<br> SQLiteæ•°æ®åº“ï¼šä½œä¸ºè½»é‡çº§çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå­˜å‚¨ç³»ç»Ÿä¸­çš„ç›‘æ§æ•°æ®ã€‚<br> HTMLï¼šç”¨äºæ„å»ºå‰ç«¯ç”¨æˆ·ç•Œé¢ï¼Œå®šä¹‰é¡µé¢ç»“æ„å’Œå†…å®¹å±•ç¤ºã€‚<br> æ™ºæ…§äº¤é€šç›‘æ§å¤§æ•°æ®ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºä»¥ä¸ŠæŠ€æœ¯æ ˆæ„å»ºçš„ç³»ç»Ÿï¼Œé€šè¿‡é‡‡é›†äº¤é€šç›‘æ§è®¾å¤‡äº§ç”Ÿçš„æ•°æ®ï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†å’Œåˆ†æï¼Œç„¶åä½¿ç”¨Echartså¯è§†åŒ–åº“å°†æ•°æ®ä»¥å›¾è¡¨çš„å½¢å¼å±•ç¤ºåœ¨Webé¡µé¢ä¸Šã€‚ç™¾åº¦åœ°å›¾å¯ä»¥ç”¨æ¥æ˜¾ç¤ºäº¤é€šçŠ¶å†µã€æ ‡æ³¨äº¤é€šäº‹ä»¶æˆ–çƒ­ç‚¹åŒºåŸŸã€‚SQLiteæ•°æ®åº“ç”¨äºå­˜å‚¨äº¤é€šç›‘æ§è®¾å¤‡é‡‡é›†çš„æ•°æ®ï¼Œæ”¯æŒæ•°æ®çš„æŸ¥è¯¢å’Œç®¡ç†ã€‚æ•´ä¸ªç³»ç»Ÿçš„å‰ç«¯ç•Œé¢åˆ™é€šè¿‡HTMLæ¥å‘ˆç°ç»™ç”¨æˆ·ã€‚</p> 
<h3><a id="4_96"></a>4ã€æ ¸å¿ƒä»£ç </h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> session<span class="token punctuation">,</span>redirect<span class="token punctuation">,</span>request<span class="token punctuation">,</span>render_template<span class="token punctuation">,</span>url_for<span class="token punctuation">,</span>Flask<span class="token punctuation">,</span>jsonify
<span class="token keyword">from</span> models <span class="token keyword">import</span> app
<span class="token keyword">import</span> models
<span class="token keyword">from</span> flask_security <span class="token keyword">import</span> Security<span class="token punctuation">,</span> SQLAlchemySessionUserDatastore<span class="token punctuation">,</span> \
    UserMixin<span class="token punctuation">,</span> RoleMixin<span class="token punctuation">,</span> login_required<span class="token punctuation">,</span> auth_token_required<span class="token punctuation">,</span> http_auth_required<span class="token punctuation">,</span>current_user
<span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> and_

user_datastore <span class="token operator">=</span> SQLAlchemySessionUserDatastore<span class="token punctuation">(</span>models<span class="token punctuation">.</span>db<span class="token punctuation">.</span>session<span class="token punctuation">,</span> models<span class="token punctuation">.</span>User<span class="token punctuation">,</span> models<span class="token punctuation">.</span>Role<span class="token punctuation">)</span>
security <span class="token operator">=</span> Security<span class="token punctuation">(</span>app<span class="token punctuation">,</span> user_datastore<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">home</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    stu_id <span class="token operator">=</span> current_user<span class="token punctuation">.</span>is_anonymous
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/carContrl'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">carContrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    stu_id <span class="token operator">=</span> current_user<span class="token punctuation">.</span>is_anonymous
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'carContrl.html'</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/map'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    stu_id <span class="token operator">=</span> current_user<span class="token punctuation">.</span>is_anonymous
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'map.html'</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/static1'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">static1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    stu_id <span class="token operator">=</span> current_user<span class="token punctuation">.</span>is_anonymous
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'static.html'</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">import</span> os
<span class="token keyword">from</span> werkzeug<span class="token punctuation">.</span>utils <span class="token keyword">import</span> secure_filename
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/message'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    stu_id <span class="token operator">=</span> current_user<span class="token punctuation">.</span>is_anonymous
    <span class="token keyword">if</span> stu_id<span class="token punctuation">:</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'logins'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'message.html'</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        title <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span>
        type1 <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span>
        ref <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'ref'</span><span class="token punctuation">)</span>
        <span class="token builtin">file</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>files<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
        user_input <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>

        basepath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span>  <span class="token comment"># å½“å‰æ–‡ä»¶æ‰€åœ¨è·¯å¾„</span>

        upload_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>basepath<span class="token punctuation">,</span> <span class="token string">'static/file'</span><span class="token punctuation">,</span> secure_filename<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># æ³¨æ„ï¼šæ²¡æœ‰çš„æ–‡ä»¶å¤¹ä¸€å®šè¦å…ˆåˆ›å»ºï¼Œä¸ç„¶ä¼šæç¤ºæ²¡æœ‰è¯¥è·¯å¾„</span>
        <span class="token comment"># upload_path = os.path.join(basepath, 'static/images','test.jpg')  #æ³¨æ„ï¼šæ²¡æœ‰çš„æ–‡ä»¶å¤¹ä¸€å®šè¦å…ˆåˆ›å»ºï¼Œä¸ç„¶ä¼šæç¤ºæ²¡æœ‰è¯¥è·¯å¾„</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span>upload_path<span class="token punctuation">)</span>

        content <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">)</span>

        models<span class="token punctuation">.</span>db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
            models<span class="token punctuation">.</span>Case_item<span class="token punctuation">(</span>
                title <span class="token operator">=</span> title<span class="token punctuation">,</span>
                <span class="token builtin">type</span> <span class="token operator">=</span> type1<span class="token punctuation">,</span>
                examine <span class="token operator">=</span> ref<span class="token punctuation">,</span>
                files <span class="token operator">=</span> upload_path<span class="token punctuation">,</span>
                conten <span class="token operator">=</span> content
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        models<span class="token punctuation">.</span>db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">)</span>



<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/table1'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">table1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    stu_id <span class="token operator">=</span> current_user<span class="token punctuation">.</span>is_anonymous
    <span class="token keyword">if</span> stu_id<span class="token punctuation">:</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'logins'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        results <span class="token operator">=</span> models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>query<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'table1.html'</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/add_project'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">add_project</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'add_project.html'</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        name <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
        nameid <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'nameid'</span><span class="token punctuation">)</span>
        types <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'types'</span><span class="token punctuation">)</span>
        gjc <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'gjc'</span><span class="token punctuation">)</span>
        fanshi <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'fanshi'</span><span class="token punctuation">)</span>
        chetype <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'chetype'</span><span class="token punctuation">)</span>
        driversnumber <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'driversnumber'</span><span class="token punctuation">)</span>
        platenumber <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'platenumber'</span><span class="token punctuation">)</span>
        Truckpass <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Truckpass'</span><span class="token punctuation">)</span>
        models<span class="token punctuation">.</span>db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
            models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">(</span>
                name <span class="token operator">=</span> name<span class="token punctuation">,</span>
                nameid <span class="token operator">=</span> nameid<span class="token punctuation">,</span>
                types <span class="token operator">=</span> types<span class="token punctuation">,</span>
                gjc <span class="token operator">=</span> gjc<span class="token punctuation">,</span>
                fanshi <span class="token operator">=</span> fanshi<span class="token punctuation">,</span>
                chetype <span class="token operator">=</span> chetype<span class="token punctuation">,</span>
                driversnumber <span class="token operator">=</span> driversnumber<span class="token punctuation">,</span>
                platenumber <span class="token operator">=</span> platenumber<span class="token punctuation">,</span>
                Truckpass <span class="token operator">=</span> Truckpass
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        models<span class="token punctuation">.</span>db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">u'æ–°å¢æˆåŠŸ'</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/up_project'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">up_project</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>query<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'update_project.html'</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>form<span class="token punctuation">)</span>
        name <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
        nameid <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'nameid'</span><span class="token punctuation">)</span>
        types <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'types'</span><span class="token punctuation">)</span>
        gjc <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'gjc'</span><span class="token punctuation">)</span>
        fanshi <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'fanshi'</span><span class="token punctuation">)</span>
        chetype <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'chetype'</span><span class="token punctuation">)</span>
        driversnumber <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'driversnumber'</span><span class="token punctuation">)</span>
        platenumber <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'platenumber'</span><span class="token punctuation">)</span>
        Truckpass <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Truckpass'</span><span class="token punctuation">)</span>

        data <span class="token operator">=</span> models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>query<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        data<span class="token punctuation">.</span>nameid <span class="token operator">=</span> nameid
        data<span class="token punctuation">.</span>types <span class="token operator">=</span> types
        data<span class="token punctuation">.</span>gjc <span class="token operator">=</span> gjc
        data<span class="token punctuation">.</span>fanshi <span class="token operator">=</span> fanshi
        data<span class="token punctuation">.</span>chetype <span class="token operator">=</span> chetype
        data<span class="token punctuation">.</span>driversnumber <span class="token operator">=</span> driversnumber
        data<span class="token punctuation">.</span>platenumber <span class="token operator">=</span> platenumber
        data<span class="token punctuation">.</span>Truckpass <span class="token operator">=</span> Truckpass
        models<span class="token punctuation">.</span>db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">u'æ›´æ–°æˆåŠŸ'</span>



<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/tail_more'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">tail_more</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        results <span class="token operator">=</span> models<span class="token punctuation">.</span>Case_item<span class="token punctuation">.</span>query<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'tail_more.html'</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/delete_project'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">delete_project</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>query<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>
        models<span class="token punctuation">.</span>db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>delete<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        models<span class="token punctuation">.</span>db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/table1'</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/get_table_admin'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_table_admin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        name <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
        nameid <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'nameid'</span><span class="token punctuation">)</span>
        type1 <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'type1'</span><span class="token punctuation">)</span>
        chetype <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'chetype'</span><span class="token punctuation">)</span>
        driversnumber <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'driversnumber'</span><span class="token punctuation">)</span>
        platenumber <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'platenumber'</span><span class="token punctuation">)</span>
        results <span class="token operator">=</span> models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>query
        <span class="token keyword">if</span> name<span class="token punctuation">:</span>
            results <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>name<span class="token punctuation">.</span>like<span class="token punctuation">(</span><span class="token string">'%{}%'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> nameid<span class="token punctuation">:</span>
            results <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>nameid<span class="token operator">==</span>nameid<span class="token punctuation">)</span>
        <span class="token keyword">if</span> type1<span class="token punctuation">:</span>
            results <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>types <span class="token operator">==</span> type1<span class="token punctuation">)</span>
        <span class="token keyword">if</span> chetype<span class="token punctuation">:</span>
            results <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>chetype <span class="token operator">==</span> chetype<span class="token punctuation">)</span>
        <span class="token keyword">if</span> driversnumber<span class="token punctuation">:</span>
            results <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>driversnumber <span class="token operator">==</span> driversnumber<span class="token punctuation">)</span>
        <span class="token keyword">if</span> platenumber<span class="token punctuation">:</span>
            results <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>ShuJu<span class="token punctuation">.</span>platenumber <span class="token operator">==</span> platenumber<span class="token punctuation">)</span>

        results <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        info_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> results<span class="token punctuation">:</span>
            info_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"id"</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token string">"type1"</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span>types<span class="token punctuation">,</span>
                              <span class="token string">"chetype"</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span>chetype<span class="token punctuation">,</span><span class="token string">"driversnumber"</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span>driversnumber<span class="token punctuation">,</span>
                              <span class="token string">"platenumber"</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span>platenumber

                              <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>info_list<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/signups'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">signup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    uuid <span class="token operator">=</span> current_user<span class="token punctuation">.</span>is_anonymous
    <span class="token keyword">print</span><span class="token punctuation">(</span>uuid<span class="token punctuation">)</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'account/register.html'</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        user <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span>
        email <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>query<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>username <span class="token operator">==</span> user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'account/register.html'</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">'è´¦å·åå·²è¢«æ³¨å†Œ'</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> user <span class="token operator">==</span> <span class="token string">''</span> <span class="token keyword">or</span> password <span class="token operator">==</span> <span class="token string">''</span> <span class="token keyword">or</span> email <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'account/register.html'</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">'è¾“å…¥ä¸èƒ½ä¸ºç©º'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            new_user <span class="token operator">=</span> user_datastore<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span>username<span class="token operator">=</span>user<span class="token punctuation">,</span>email<span class="token operator">=</span>email<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span>
            normal_role <span class="token operator">=</span> user_datastore<span class="token punctuation">.</span>find_role<span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">)</span>
            models<span class="token punctuation">.</span>db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>add<span class="token punctuation">(</span>new_user<span class="token punctuation">)</span>
            user_datastore<span class="token punctuation">.</span>add_role_to_user<span class="token punctuation">(</span>new_user<span class="token punctuation">,</span> normal_role<span class="token punctuation">)</span>
            models<span class="token punctuation">.</span>db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
            login_user<span class="token punctuation">(</span>new_user<span class="token punctuation">,</span> remember<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">from</span> flask_security<span class="token punctuation">.</span>utils <span class="token keyword">import</span> login_user<span class="token punctuation">,</span> logout_user
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/logins'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">logins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    uuid <span class="token operator">=</span> current_user<span class="token punctuation">.</span>is_anonymous
    <span class="token keyword">if</span> <span class="token keyword">not</span> uuid<span class="token punctuation">:</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method<span class="token operator">==</span><span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'account/index.html'</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> request<span class="token punctuation">.</span>method<span class="token operator">==</span><span class="token string">'POST'</span><span class="token punctuation">:</span>
        user <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>query<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>and_<span class="token punctuation">(</span>models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>username<span class="token operator">==</span>user<span class="token punctuation">,</span>models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>password<span class="token operator">==</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> data<span class="token punctuation">:</span>
            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'account/index.html'</span><span class="token punctuation">,</span>error<span class="token operator">=</span><span class="token string">'è´¦å·å¯†ç é”™è¯¯'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            login_user<span class="token punctuation">(</span>data<span class="token punctuation">,</span> remember<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> data<span class="token punctuation">.</span>is_authenticated<span class="token punctuation">:</span>
                <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>



<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/loginsout'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">loginsout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method<span class="token operator">==</span><span class="token string">'GET'</span><span class="token punctuation">:</span>
        logout_user<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'logins'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="5_371"></a>5ã€æºç è·å–æ–¹å¼</h3> 
<blockquote> 
 <p>ğŸ…<strong>ç”±äºç¯‡å¹…é™åˆ¶ï¼Œè·å–å®Œæ•´æ–‡ç« æˆ–æºç ã€ä»£åšé¡¹ç›®çš„ï¼ŒæŸ¥çœ‹æˆ‘çš„ã€ç”¨æˆ·åã€‘ã€ã€ä¸“æ åç§°ã€‘ã€ã€é¡¶éƒ¨é€‰é¢˜é“¾æ¥ã€‘å°±å¯ä»¥æ‰¾åˆ°æˆ‘å•¦</strong>ğŸ…</p> 
 <p>æ„Ÿå…´è¶£çš„å¯ä»¥å…ˆæ”¶è—èµ·æ¥ï¼Œç‚¹èµã€å…³æ³¨ä¸è¿·è·¯ï¼Œ<strong>ä¸‹æ–¹æŸ¥çœ‹</strong>ğŸ‘‡ğŸ»<strong>è·å–è”ç³»æ–¹å¼</strong>ğŸ‘‡ğŸ»</p> 
</blockquote> 
<div> 
 <div></div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7f18efed4be5f76771dba5cae39d59f2/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ã€è´¢ä¼šã€‘ä¼ä¸šè´¢ç¨æ ¸ç®—</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3a1ede7b63aa656903584d275381dc46/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">æ™ºæ…§æ ¡å›­|æ™ºæ…§æ ¡å›­ç®¡ç†å°ç¨‹åº|åŸºäºå¾®ä¿¡å°ç¨‹åºçš„æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿè®¾è®¡ä¸å®ç°(æºç &#43;æ•°æ®åº“&#43;æ–‡æ¡£)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 è€å¸…çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>