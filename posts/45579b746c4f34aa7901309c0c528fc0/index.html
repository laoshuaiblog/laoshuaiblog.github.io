<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Iris框架学习 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/45579b746c4f34aa7901309c0c528fc0/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="Iris框架学习">
  <meta property="og:description" content="Iris框架介绍 学习网址 Iris官网：https://www.iris-go.com/
Iris github地址：https://github.com/kataras/iris
Iris官方学习文档（英文）：https://docs.iris-go.com/iris/
Iris中文文档1：https://learnku.com/docs/iris-go/10/why/3759
Iris中文文档2：https://www.topgoer.com/Iris/
Iris框架的特点 Iris是一款通过go语言编写的快速、简单、功能齐全、效率高、免费、开源的Web框架Iris支持MVC架构模式Iris可以被用来作为gRPC的web端口，为gRPC提供APIIris官网中被称作速度最快的Go后端开发框架 Iris入门 安装 安装的唯一要求是Go编程语言，版本在1.15及以上
安装Iris
go get github.com/kataras/iris/v12@master 确保gomod文件中正常导入如下包
require ( github.com/BurntSushi/toml v1.2.1 // indirect github.com/CloudyKit/fastprinter v0.0.0-20200109182630-33d98a066a53 // indirect github.com/CloudyKit/jet/v3 v3.0.0 // indirect github.com/CloudyKit/jet/v6 v6.1.0 // indirect github.com/Joker/jade v1.1.3 // indirect github.com/Shopify/goreferrer v0.0.0-20220729165902-8cddb4f5de06 // indirect github.com/andybalholm/brotli v1.0.4 // indirect github.com/aymerick/douceur v0.2.0 // indirect github.com/aymerick/raymond v2.0.3-0.20180322193309-b565731e1464&#43;incompatible // indirect github.com/eknkc/amber v0.0.0-20171010120322-cdade1c07385 // indirect github.com/fatih/structs v1.1.0 // indirect github.com/flosch/pongo2/v4 v4.0.2 // indirect github.com/golang/snappy v0.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-02-26T14:07:25+08:00">
    <meta property="article:modified_time" content="2023-02-26T14:07:25+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Iris框架学习</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Iris_0"></a>Iris框架介绍</h2> 
<h3><a id="_2"></a>学习网址</h3> 
<p>Iris官网：https://www.iris-go.com/</p> 
<p>Iris github地址：https://github.com/kataras/iris</p> 
<p>Iris官方学习文档（英文）：https://docs.iris-go.com/iris/</p> 
<p>Iris中文文档1：https://learnku.com/docs/iris-go/10/why/3759</p> 
<p>Iris中文文档2：https://www.topgoer.com/Iris/</p> 
<h3><a id="Iris_14"></a>Iris框架的特点</h3> 
<ul><li>Iris是一款通过go语言编写的快速、简单、功能齐全、效率高、免费、开源的Web框架</li><li>Iris支持MVC架构模式</li><li>Iris可以被用来作为gRPC的web端口，为gRPC提供API</li><li>Iris官网中被称作速度最快的Go后端开发框架</li></ul> 
<h2><a id="Iris_23"></a>Iris入门</h2> 
<h3><a id="_25"></a>安装</h3> 
<p><strong>安装的唯一要求是Go编程语言，版本在1.15及以上</strong></p> 
<blockquote> 
 <p>安装Iris</p> 
</blockquote> 
<pre><code class="prism language-shell">go get github.com/kataras/iris/v12@master
</code></pre> 
<p>确保gomod文件中正常导入如下包</p> 
<pre><code class="prism language-go">require <span class="token punctuation">(</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>BurntSushi<span class="token operator">/</span>toml v1<span class="token punctuation">.</span><span class="token number">2.1</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>CloudyKit<span class="token operator">/</span>fastprinter v0<span class="token punctuation">.</span><span class="token number">0.0</span><span class="token operator">-</span><span class="token number">20200109182630</span><span class="token operator">-</span>33d98a066a53 <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>CloudyKit<span class="token operator">/</span>jet<span class="token operator">/</span>v3 v3<span class="token punctuation">.</span><span class="token number">0.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>CloudyKit<span class="token operator">/</span>jet<span class="token operator">/</span>v6 v6<span class="token punctuation">.</span><span class="token number">1.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>Joker<span class="token operator">/</span>jade v1<span class="token punctuation">.</span><span class="token number">1.3</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>Shopify<span class="token operator">/</span>goreferrer v0<span class="token punctuation">.</span><span class="token number">0.0</span><span class="token operator">-</span><span class="token number">20220729165902</span><span class="token operator">-</span>8cddb4f5de06 <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>andybalholm<span class="token operator">/</span>brotli v1<span class="token punctuation">.</span><span class="token number">0.4</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>aymerick<span class="token operator">/</span>douceur v0<span class="token punctuation">.</span><span class="token number">2.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>aymerick<span class="token operator">/</span>raymond v2<span class="token punctuation">.</span><span class="token number">0.3</span><span class="token operator">-</span><span class="token number">0.20180322193309</span><span class="token operator">-</span>b565731e1464<span class="token operator">+</span>incompatible <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>eknkc<span class="token operator">/</span>amber v0<span class="token punctuation">.</span><span class="token number">0.0</span><span class="token operator">-</span><span class="token number">20171010120322</span><span class="token operator">-</span>cdade1c07385 <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>fatih<span class="token operator">/</span>structs v1<span class="token punctuation">.</span><span class="token number">1.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>flosch<span class="token operator">/</span>pongo2<span class="token operator">/</span>v4 v4<span class="token punctuation">.</span><span class="token number">0.2</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>golang<span class="token operator">/</span>snappy v0<span class="token punctuation">.</span><span class="token number">0.4</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>google<span class="token operator">/</span>uuid v1<span class="token punctuation">.</span><span class="token number">3.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>gorilla<span class="token operator">/</span>css v1<span class="token punctuation">.</span><span class="token number">0.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>iris<span class="token operator">-</span>contrib<span class="token operator">/</span>blackfriday v2<span class="token punctuation">.</span><span class="token number">0.0</span><span class="token operator">+</span>incompatible <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>iris<span class="token operator">-</span>contrib<span class="token operator">/</span>jade v1<span class="token punctuation">.</span><span class="token number">1.3</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>iris<span class="token operator">-</span>contrib<span class="token operator">/</span>pongo2 v0<span class="token punctuation">.</span><span class="token number">0.1</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>iris<span class="token operator">-</span>contrib<span class="token operator">/</span>schema v0<span class="token punctuation">.</span><span class="token number">0.6</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>josharian<span class="token operator">/</span>intern v1<span class="token punctuation">.</span><span class="token number">0.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>json<span class="token operator">-</span>iterator<span class="token operator">/</span><span class="token keyword">go</span> v1<span class="token punctuation">.</span><span class="token number">1.12</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>kataras<span class="token operator">/</span>blocks v0<span class="token punctuation">.</span><span class="token number">0.7</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>kataras<span class="token operator">/</span>golog v0<span class="token punctuation">.</span><span class="token number">1.8</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>kataras<span class="token operator">/</span>iris<span class="token operator">/</span>v12 v12<span class="token punctuation">.</span><span class="token number">2.0</span><span class="token operator">-</span>beta6<span class="token punctuation">.</span><span class="token number">0.20221125222511</span><span class="token operator">-</span>29c29e79e5da <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>kataras<span class="token operator">/</span>pio v0<span class="token punctuation">.</span><span class="token number">0.11</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>kataras<span class="token operator">/</span>sitemap v0<span class="token punctuation">.</span><span class="token number">0.6</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>kataras<span class="token operator">/</span>tunnel v0<span class="token punctuation">.</span><span class="token number">0.4</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>klauspost<span class="token operator">/</span>compress v1<span class="token punctuation">.</span><span class="token number">15.12</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>mailgun<span class="token operator">/</span>raymond<span class="token operator">/</span>v2 v2<span class="token punctuation">.</span><span class="token number">0.48</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>mailru<span class="token operator">/</span>easyjson v0<span class="token punctuation">.</span><span class="token number">7.7</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>microcosm<span class="token operator">-</span>cc<span class="token operator">/</span>bluemonday v1<span class="token punctuation">.</span><span class="token number">0.21</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>modern<span class="token operator">-</span><span class="token keyword">go</span><span class="token operator">/</span>concurrent v0<span class="token punctuation">.</span><span class="token number">0.0</span><span class="token operator">-</span><span class="token number">20180228061459</span><span class="token operator">-</span>e0a39a4cb421 <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>modern<span class="token operator">-</span><span class="token keyword">go</span><span class="token operator">/</span>reflect2 v1<span class="token punctuation">.</span><span class="token number">0.2</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>russross<span class="token operator">/</span>blackfriday<span class="token operator">/</span>v2 v2<span class="token punctuation">.</span><span class="token number">1.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>ryanuber<span class="token operator">/</span>columnize v2<span class="token punctuation">.</span><span class="token number">1.0</span><span class="token operator">+</span>incompatible <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>schollz<span class="token operator">/</span>closestmatch v2<span class="token punctuation">.</span><span class="token number">1.0</span><span class="token operator">+</span>incompatible <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>shurcooL<span class="token operator">/</span>sanitized_anchor_name v1<span class="token punctuation">.</span><span class="token number">0.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>sirupsen<span class="token operator">/</span>logrus v1<span class="token punctuation">.</span><span class="token number">8.1</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>tdewolff<span class="token operator">/</span>minify<span class="token operator">/</span>v2 v2<span class="token punctuation">.</span><span class="token number">12.4</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>tdewolff<span class="token operator">/</span>parse<span class="token operator">/</span>v2 v2<span class="token punctuation">.</span><span class="token number">6.4</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>valyala<span class="token operator">/</span>bytebufferpool v1<span class="token punctuation">.</span><span class="token number">0.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>vmihailenco<span class="token operator">/</span>msgpack<span class="token operator">/</span>v5 v5<span class="token punctuation">.</span><span class="token number">3.5</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>vmihailenco<span class="token operator">/</span>tagparser<span class="token operator">/</span>v2 v2<span class="token punctuation">.</span><span class="token number">0.0</span> <span class="token comment">// indirect</span>
	github<span class="token punctuation">.</span>com<span class="token operator">/</span>yosssi<span class="token operator">/</span>ace v0<span class="token punctuation">.</span><span class="token number">0.5</span> <span class="token comment">// indirect</span>
	golang<span class="token punctuation">.</span>org<span class="token operator">/</span>x<span class="token operator">/</span>crypto v0<span class="token punctuation">.</span><span class="token number">3.0</span> <span class="token comment">// indirect</span>
	golang<span class="token punctuation">.</span>org<span class="token operator">/</span>x<span class="token operator">/</span>net v0<span class="token punctuation">.</span><span class="token number">2.0</span> <span class="token comment">// indirect</span>
	golang<span class="token punctuation">.</span>org<span class="token operator">/</span>x<span class="token operator">/</span>sys v0<span class="token punctuation">.</span><span class="token number">2.0</span> <span class="token comment">// indirect</span>
	golang<span class="token punctuation">.</span>org<span class="token operator">/</span>x<span class="token operator">/</span>text v0<span class="token punctuation">.</span><span class="token number">4.0</span> <span class="token comment">// indirect</span>
	golang<span class="token punctuation">.</span>org<span class="token operator">/</span>x<span class="token operator">/</span>time v0<span class="token punctuation">.</span><span class="token number">2.0</span> <span class="token comment">// indirect</span>
	google<span class="token punctuation">.</span>golang<span class="token punctuation">.</span>org<span class="token operator">/</span>protobuf v1<span class="token punctuation">.</span><span class="token number">28.1</span> <span class="token comment">// indirect</span>
	gopkg<span class="token punctuation">.</span>in<span class="token operator">/</span>ini<span class="token punctuation">.</span>v1 v1<span class="token punctuation">.</span><span class="token number">67.0</span> <span class="token comment">// indirect</span>
	gopkg<span class="token punctuation">.</span>in<span class="token operator">/</span>yaml<span class="token punctuation">.</span>v3 v3<span class="token punctuation">.</span><span class="token number">0.1</span> <span class="token comment">// indirect</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>如果包导入不成功，查看是否配置了有效的GOPROXY环境变量</p> 
<p><img src="https://images2.imgbox.com/60/eb/k0Xv7FY0_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_101"></a>快速使用</h3> 
<p>新建一个go的文件，输入如下代码</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"github.com/kataras/iris/v12"</span>
	<span class="token string">"github.com/kataras/iris/v12/context"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	app <span class="token operator">:=</span> iris<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span>Compression<span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		ctx<span class="token punctuation">.</span><span class="token function">HTML</span><span class="token punctuation">(</span><span class="token string">"hello &lt;strong&gt;%s&lt;/strong&gt;"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>运行成功后，在网址中输入http://localhost:8080/hello</p> 
<p>如果出现hello world，恭喜您，第一个Iris程序运行成功</p> 
<h3><a id="_130"></a>代码简单介绍</h3> 
<p><code>iris.New()</code>创建并返回一个空的<code>iris *Application</code>实例</p> 
<p><code>app.Use()</code>用于在请求执行前进行某种处理，参数为一个或者多个<code>iris.Handler</code>（处理请求）</p> 
<p><code>app.Done()</code>用于在请求执行后进行某种处理</p> 
<p><code>iris.Compression</code>是一种Iris框架对IO数据进行压缩的函数，用于提高数据的传输效率</p> 
<p><code>app.Get()</code>创建一个get请求，第一个参数为请求路径，第二个可变参数为一个或者多个iris.Handler`</p> 
<p><code>ctx</code>为上下文context</p> 
<p><code>Listen()</code>设置端口</p> 
<h2><a id="_146"></a>请求处理与响应</h2> 
<h3><a id="API_148"></a>处理请求的API</h3> 
<p>支持所有的 HTTP 方法，开发者也可以在相同路劲的不同的方法注册处理器(比如 <code>/user</code> 的 GET 和 POST)。</p> 
<p>第一个参数是 HTTP 方法，第二个参数是请求的路径，第三个可变参数应该包含一个或多个<code>iris.Handler</code>，当客户端请求到特定的资源路径时，这些处理器将会按照注册的顺序依次执行。</p> 
<pre><code class="prism language-go">app <span class="token operator">:=</span> iris<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"/contact"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    ctx<span class="token punctuation">.</span><span class="token function">HTML</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt; Hello from /contact &lt;/h1&gt;"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>同时，Iris框架为我们方便使用，利用restful风格的API封装了所有的HTTP方法，去掉了原始的第一个参数。</p> 
<pre><code class="prism language-go">app <span class="token operator">:=</span> iris<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Method: "GET"</span>
app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token comment">// Method: "POST"</span>
app<span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token comment">// Method: "PUT"</span>
app<span class="token punctuation">.</span><span class="token function">Put</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token comment">// Method: "DELETE"</span>
app<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token comment">// Method: "OPTIONS"</span>
app<span class="token punctuation">.</span><span class="token function">Options</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token comment">// Method: "TRACE"</span>
app<span class="token punctuation">.</span><span class="token function">Trace</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token comment">// Method: "CONNECT"</span>
app<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token comment">// Method: "HEAD"</span>
app<span class="token punctuation">.</span><span class="token function">Head</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token comment">// Method: "PATCH"</span>
app<span class="token punctuation">.</span><span class="token function">Patch</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token comment">// register the route for all HTTP Methods</span>
app<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">handler</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ctx<span class="token punctuation">.</span><span class="token function">Writef</span><span class="token punctuation">(</span><span class="token string">"Hello from method: %s and path: %s\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">Path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_202"></a>请求参数的获取</h3> 
<blockquote> 
 <p>对于GET请求参数的获取</p> 
</blockquote> 
<pre><code class="prism language-go">app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    username <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">URLParam</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>
    password <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">URLParam</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span>username <span class="token operator">+</span> <span class="token string">"--"</span> <span class="token operator">+</span> password<span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>username <span class="token operator">+</span> <span class="token string">"--"</span> <span class="token operator">+</span> password<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>使用<code>ctx.URLParam()</code>来获取GET请求路径上的参数</p> 
<p>访问<a href="" rel="nofollow">localhost:8080/user?username=zhangsan&amp;password=123456</a></p> 
<blockquote> 
 <p>对于POST请求参数的获取</p> 
</blockquote> 
<pre><code class="prism language-go">app<span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">"/user/login"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    username <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">PostValue</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>
    password <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">PostValue</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span>username <span class="token operator">+</span> <span class="token string">"--"</span> <span class="token operator">+</span> password<span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>username <span class="token operator">+</span> <span class="token string">"--"</span> <span class="token operator">+</span> password<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>使用<code>ctx.PostValue()</code>来获取POST请求的参数</p> 
<p>使用postman进行测试</p> 
<p><img src="https://images2.imgbox.com/be/e9/rskWhH7n_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>获取json数据</p> 
</blockquote> 
<p>用户传递的数据为json格式或对象时，使用结构体接收</p> 
<pre><code class="prism language-go">app<span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">"/user/json"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
        Username <span class="token builtin">string</span> <span class="token string">`json:"username"`</span>
        Password <span class="token builtin">string</span> <span class="token string">`json:"password"`</span>
    <span class="token punctuation">}</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    err <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">ReadJSON</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    app<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span>Map<span class="token punctuation">{<!-- --></span><span class="token string">"user"</span><span class="token punctuation">:</span> user<span class="token punctuation">,</span> <span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>使用<code>ctx.ReadJSON</code>来获取数据</p> 
<blockquote> 
 <p>获取具有Restful风格的请求的参数（key-value格式）</p> 
</blockquote> 
<pre><code class="prism language-go">app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/user/{userid:int64}/{username:string}"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    userid <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">Params</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"userid"</span><span class="token punctuation">)</span>
    username <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">Params</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span>userid <span class="token operator">+</span> <span class="token string">"--"</span> <span class="token operator">+</span> username<span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>userid <span class="token operator">+</span> <span class="token string">"--"</span> <span class="token operator">+</span> username<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>使用<code>ctx.Params().Ger()</code>方法通过key值来获取value</p> 
<h2><a id="Party_279"></a>Party路由组</h2> 
<p>随着项目的越来越大，请求也变得越来越多，管理起来越发困难</p> 
<p>根据企业中的规范，我们通常将一类请求使用相同的前缀归为一类，例如有关用户信息的请求是<code>/user/***</code>，有关订单的请求是<code>/order/***</code></p> 
<p>这种情况下，我们使用<code>app.Party()</code>将前缀提取出来，方便后续代码的编写和维护</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/kataras/iris/v12"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	app <span class="token operator">:=</span> iris<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span>Compression<span class="token punctuation">)</span>

	user <span class="token operator">:=</span> app<span class="token punctuation">.</span><span class="token function">Party</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"这是user请求路由组"</span><span class="token punctuation">)</span>
		ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	user<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/add"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	user<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/update"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	user<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/delete"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	user<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>

	order <span class="token operator">:=</span> app<span class="token punctuation">.</span><span class="token function">Party</span><span class="token punctuation">(</span><span class="token string">"/order"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"这是order请求路由组"</span><span class="token punctuation">)</span>
		ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	order<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/add"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	order<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/update"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	order<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/delete"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	order<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_322"></a>页面处理</h2> 
<p>Iris 通过它的视图引擎提供了 6 种开箱即用的模板解析器。当然开发者仍然可以使用各种go模板解析器作为 <code>Context.ResponseWriter()</code>， 只要实现了 <code>http.ResponseWriter</code> 和 <code>io.Writer</code>。</p> 
<p>Iris提出了一些默认的解析器不支持的通用规则和功能。例如，我们已经支持 <code>yield</code>，<code>render</code>，<code>render_r</code>，<code>current</code>，<code>urlpath</code> 模板函数， 并通过中间件和嵌入式模板文件为所有的引擎布局和绑定。</p> 
<p>为了使用一个模板引擎独特的功能，你需要通过阅读文档来学习模板引擎的特征和语法(点击下面)。选择最适合你app需要的。</p> 
<p>内置的视图引擎：</p> 
<ul><li>标准 template/html：<code>iris.HTML(...)</code></li><li>django：<code>iris.Django(...)</code></li><li>handlebars：<code>iris.Handlebars(...)</code></li><li>amber：<code>iris.Amber(...)</code></li><li>pug(jade)：<code>iris.Pug(...)</code></li><li>jet：<code>iris.Jet(...)</code></li></ul> 
<p>一个或者多个视图引擎可以注册到相同的应用中，使用 <code>RegisterView(ViewEngine)</code> 方法注册。</p> 
<p>如果需要加载静态资源，使用<code>app.HandleDir()</code>方法注册</p> 
<p>从 <code>./views</code> 目录中加载所有后缀为 <code>.html</code> 的模板，然后使用标准库 <code>html/template</code> 包来解析它们。</p> 
<p>使用<code>ctx.ViewData()</code>向前端传递数据</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/kataras/iris/v12"</span>
	<span class="token string">"github.com/kataras/iris/v12/context"</span>
	<span class="token string">"net/http"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	app <span class="token operator">:=</span> iris<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span>Compression<span class="token punctuation">)</span>

    <span class="token comment">// 加载资源</span>
	app<span class="token punctuation">.</span><span class="token function">RegisterView</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span><span class="token function">HTML</span><span class="token punctuation">(</span><span class="token string">"./views"</span><span class="token punctuation">,</span> <span class="token string">".html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Reload</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">HandleDir</span><span class="token punctuation">(</span><span class="token string">"static"</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">Dir</span><span class="token punctuation">(</span><span class="token string">"./static"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        ctx<span class="token punctuation">.</span><span class="token function">ViewData</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span><span class="token string">"hello world"</span><span class="token punctuation">)</span>
		ctx<span class="token punctuation">.</span><span class="token function">View</span><span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
    
	app<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>index.html</p> 
<pre><code class="prism language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/css/style.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/js/index.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    首页
    {<!-- -->{.msg}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h2><a id="_392"></a>错误处理</h2> 
<blockquote> 
 <p>Iris框架封装的常用状态码</p> 
</blockquote> 
<p>200（请求成功）：<code>iris.StatusOK</code></p> 
<p>301（请求成功，但是资源被转移）：<code>iris.StatusMovedPermanently</code></p> 
<p>302（临时重定向）：<code>iris.StatusFound</code></p> 
<p>404（请求内容不存在）：<code>iris.StatusNotFound</code></p> 
<p>500（服务器错误）：<code>iris.StatusInternalServerError</code></p> 
<p>使用<code>app.OnErrorCode()</code>根据状态码处理请求</p> 
<pre><code class="prism language-go">app<span class="token punctuation">.</span><span class="token function">OnErrorCode</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span>StatusNotFound<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    c<span class="token punctuation">.</span><span class="token function">View</span><span class="token punctuation">(</span><span class="token string">"404.html"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">OnErrorCode</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span>StatusInternalServerError<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    c<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span><span class="token string">"500"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>设置重定向</p> 
<pre><code class="prism language-go">app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>context <span class="token operator">*</span>context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    context<span class="token punctuation">.</span><span class="token function">StatusCode</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span>StatusFound<span class="token punctuation">)</span>
    context<span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">"Location"</span><span class="token punctuation">,</span> <span class="token string">"/login"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_426"></a>中间件</h2> 
<p>当我们谈论 Iris 中的中间件时，我们谈论的是一个 HTTP 请求的生命周期中主处理器代码运行前/后运行的代码。例如，日志中间件可能记录一个传入请求的详情到日志中，然后调用处理器代码，然后再编写有关响应的详细信息到日志中。关于中间件的一件很酷的事情是，这些单元非常灵活且可重复使用。</p> 
<p>中间件仅是一个 <code>Handler</code> 格式的函数 <code>func(ctx iris.Context)</code>，当前一个中间件调用 <code>ctx.Next()</code> 方法时，此中间件被执行，这可以用作身份验证，即如果请求验证通过，就调用 <code>ctx.Next()</code> 来执行该请求剩下链上的处理器，否则触发一个错误响应。</p> 
<p><code>app.Use()</code>在主处理器运行前处理请求，必须有<code>ctx.Next()</code></p> 
<p><code>app.Done()</code>在主处理器运行后处理请求，当有多个时必须有<code>ctx.Next()</code></p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/kataras/iris/v12"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

	app <span class="token operator">:=</span> iris<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span>Compression<span class="token punctuation">,</span> before<span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>before<span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span>after<span class="token punctuation">)</span>

	<span class="token comment">//app.Get("/index", before, index, after)</span>
	app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">index</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	msg <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">Values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"index==&gt;"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">before</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	ctx<span class="token punctuation">.</span><span class="token function">Values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span> <span class="token string">"index"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"before"</span><span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">after</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"after"</span><span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="session_473"></a>session会话</h2> 
<p>当你使用一个应用程序，你打开它，做了一些改变，然后关闭它。这就像一个会话。计算机知道你是谁。它知道你什么时候开始这个程序，什么什么时候关闭。但是在互联网上，这是一个问题：web服务器不知道你是谁，也不知道你做什么，因为HTTP不能保持状态。</p> 
<p><code>Session</code> 变量通过存储要在多个页面上使用的用户信息（例如用户名，喜欢的颜色等）来解决此问题。默认情况下，<code>Session</code> 变量会一直存在，直到浏览器关闭。</p> 
<p>因此，<code>Session</code> 变量保存有关一个用户的信息，并且可用于一个应用程序中的所有页面。</p> 
<blockquote> 
 <p>Tip：如果你想要持久化存储，你可以存储数据到数据库中。</p> 
</blockquote> 
<p>Iris 在 <code>iris/sessions</code> 子包中有自己的会话实现和会话管理。你只需导入这个包就能使用了。</p> 
<p>一个会话通过 <code>Session</code> 对象的 <code>Start</code> 函数开始，<code>Session</code> 对象是通过 <code>New</code> 函数创建的，这个函数会返回一个 <code>Sessoin</code>。</p> 
<p><code>Session</code> 变量通过 <code>Session.Set</code> 方法设置，通过 <code>Session.Get</code> 方法取回。使用 <code>Session.Delete</code> 删除一个变量。要删除整个会话并使之无效，请使用 <code>Session.Destroy</code> 方法。</p> 
<p>session 管理器通过 <code>New</code> 方法创建的。</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"github.com/kataras/iris/v12"</span>
	<span class="token string">"github.com/kataras/iris/v12/sessions"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> <span class="token punctuation">(</span>
	cookie  <span class="token operator">=</span> <span class="token string">"sessionid"</span>
	session <span class="token operator">=</span> sessions<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>sessions<span class="token punctuation">.</span>Config<span class="token punctuation">{<!-- --></span>Cookie<span class="token punctuation">:</span> cookie<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	app <span class="token operator">:=</span> iris<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span>Compression<span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">,</span> index5<span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> login<span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/logout"</span><span class="token punctuation">,</span> logout<span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"/destory"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		session<span class="token punctuation">.</span><span class="token function">Destroy</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">index5</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	auth<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> session<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetBoolean</span><span class="token punctuation">(</span><span class="token string">"auth"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>auth <span class="token punctuation">{<!-- --></span>
		ctx<span class="token punctuation">.</span><span class="token function">StatusCode</span><span class="token punctuation">(</span>iris<span class="token punctuation">.</span>StatusForbidden<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	ctx<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span><span class="token string">"用户已经登录了"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">login</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	session <span class="token operator">:=</span> session<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
	session<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"auth"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">logout</span><span class="token punctuation">(</span>ctx iris<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	session <span class="token operator">:=</span> session<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
	session<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"auth"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cfa07d5b41d7024fbf7573f8d9a78e57/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">从Clickhouse读取大量数据写入本地文件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8fb8281f8eb430b3e4f89a3bcaae30f6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">== 和 ===的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>