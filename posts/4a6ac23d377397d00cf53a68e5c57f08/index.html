<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>R进阶绘图--散点箱线图&#43;显著性 / 组间差异比较 / ggpubr包 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/4a6ac23d377397d00cf53a68e5c57f08/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="R进阶绘图--散点箱线图&#43;显著性 / 组间差异比较 / ggpubr包">
  <meta property="og:description" content="R进阶绘图系列主要是带领大家绘制一些科研中常用到的组合图形，力争在表达更多信息的同时而又不失美观，该系列会持续更新，有需要的小伙伴赶紧关注起来吧。
预备知识 今天的内容是连续型变量的组间差异比较，首先来说独立样本。
两组独立样本：如果数据同时满足正态性和方差齐性，可以采用独立样本t检验或者Wilcoxon秩和检验，如果不满足可采用Wilcoxon秩和检验。
两组以上独立样本：如果数据同时满足正态性和方差齐性，可以采用方差分析（ANOVA）或者Kruskal检验，如果不满足可采用Kruskal检验。
独立样本t检验检验和方差分析（ANOVA）都是参数检验，对数据分布具有一定的假设，在符合检验假设的情况下，建议采用参数检验。
Wilcoxon秩和检验和Kruskal检验都是非参数检验，可用于呈偏态分布或者组间不满足方差齐性的数据，对数据分布无要求。
接下来说非独立样本。
两组非独立样本：如果数据满足正态性，可以采用配对t检验或者Wilcoxon符号秩检验，如果不满足可采用Wilcoxon符号秩检验。
两组以上非独立样本：如果数据同时满足正态性和方差齐性，可以采用重复测量方差分析（Repeated Measures ANOVA）或者Friedman M检验，如果不满足可采用Friedman M检验。
配对t检验和重复测量方差分析（Repeated Measures ANOVA）都是参数检验，Wilcoxon符号秩检验和Friedman M检验都是非参数检验。
大家在绘图前要首先为自己的数据选择合适的检验方法，不要只求出图哦。
写上面一段话，我都快把自己给绕晕了，个人能力有限，如果大家发现任何问题，欢迎后台留言指正，我会在公众号底部做一个纠错专栏，所有出现错误然后纠正后的内容会放在那里（ps：因为基本上改不了原文）。
绘图 加载包和数据 # 加载包、导入数据 library(ggpubr) # 继承ggplot语法 library(patchwork) # 拼图包 library(ggsci) #配色包 data(&#34;ToothGrowth&#34;) ToothGrowth$dose=factor(ToothGrowth$dose) 数据介绍 ToothGrowth数据集结构如图所示，这是一项评估维生素C对豚鼠牙齿生长的影响的研究数据，len是牙齿长度；supp是两种给药方式，一种是橙汁OJ，另一种是抗坏血酸VC；dose是三种给药水平。对于该数据集我们后续均采用非参数检验方法。
散点箱线图 # 绘制散点箱线图----------------------------------------- p &amp;lt;- ggplot(ToothGrowth, aes(x=dose, y=len,color=dose)) &#43; # 绘制箱线图 geom_boxplot(aes(fill=dose), alpha=0.1)&#43; # 设置透明度 # 绘制散点 geom_jitter()&#43; # 设置颜色 scale_color_manual(values = pal_npg(&#39;nrc&#39;)(9))&#43; scale_fill_manual(values = pal_npg(&#39;nrc&#39;)(9))&#43; # 设置主题 theme_bw()&#43; # 去除网格线 theme(panel.grid = element_blank()) p stat_compare_means( )参数解读 method（方法）：指定要执行的统计检验。对于非配对检验： &#34;">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-05T20:29:23+08:00">
    <meta property="article:modified_time" content="2024-01-05T20:29:23+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">R进阶绘图--散点箱线图&#43;显著性 / 组间差异比较 / ggpubr包</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/e7/0f/Pyq8IjT9_o.png" alt="20231225散点箱线图+显著性检验"></p> 
<p><strong>R进阶绘图</strong>系列主要是带领大家绘制一些科研中常用到的组合图形，力争在表达更多信息的同时而又不失美观，该系列会持续更新，有需要的小伙伴赶紧关注起来吧。</p> 
<h3><a id="_4"></a>预备知识</h3> 
<p>今天的内容是连续型变量的组间差异比较，首先来说独立样本。</p> 
<p><strong>两组独立样本</strong>：如果数据同时满足正态性和方差齐性，可以采用独立样本t检验或者Wilcoxon秩和检验，如果不满足可采用Wilcoxon秩和检验。</p> 
<p><strong>两组以上独立样本</strong>：如果数据同时满足正态性和方差齐性，可以采用方差分析（ANOVA）或者Kruskal检验，如果不满足可采用Kruskal检验。</p> 
<p>独立样本t检验检验和方差分析（ANOVA）都是参数检验，对数据分布具有一定的假设，在符合检验假设的情况下，建议采用参数检验。</p> 
<p>Wilcoxon秩和检验和Kruskal检验都是非参数检验，可用于呈偏态分布或者组间不满足方差齐性的数据，对数据分布无要求。</p> 
<p>接下来说非独立样本。</p> 
<p><strong>两组非独立样本</strong>：如果数据满足正态性，可以采用配对t检验或者Wilcoxon符号秩检验，如果不满足可采用Wilcoxon符号秩检验。</p> 
<p><strong>两组以上非独立样本</strong>：如果数据同时满足正态性和方差齐性，可以采用重复测量方差分析（Repeated Measures ANOVA）或者Friedman M检验，如果不满足可采用Friedman M检验。</p> 
<p>配对t检验和重复测量方差分析（Repeated Measures ANOVA）都是参数检验，Wilcoxon符号秩检验和Friedman M检验都是非参数检验。</p> 
<p>大家在绘图前要首先为自己的数据选择合适的检验方法，不要只求出图哦。</p> 
<blockquote> 
 <p>写上面一段话，我都快把自己给绕晕了，个人能力有限，如果大家发现任何问题，欢迎后台留言指正，我会在公众号底部做一个纠错专栏，所有出现错误然后纠正后的内容会放在那里（ps：因为基本上改不了原文）。</p> 
</blockquote> 
<h3><a id="_28"></a>绘图</h3> 
<h4><a id="_30"></a>加载包和数据</h4> 
<pre><code class="prism language-R"># 加载包、导入数据
library(ggpubr) # 继承ggplot语法
library(patchwork) # 拼图包
library(ggsci) #配色包
data("ToothGrowth")
ToothGrowth$dose=factor(ToothGrowth$dose)
</code></pre> 
<h4><a id="_41"></a>数据介绍</h4> 
<p><img src="https://images2.imgbox.com/50/14/DHN95Bdl_o.png" alt="示例数据"></p> 
<p>ToothGrowth数据集结构如图所示，这是一项评估维生素C对豚鼠牙齿生长的影响的研究数据，len是牙齿长度；supp是两种给药方式，一种是橙汁OJ，另一种是抗坏血酸VC；dose是三种给药水平。对于该数据集我们后续均采用非参数检验方法。</p> 
<h4><a id="_47"></a>散点箱线图</h4> 
<pre><code class="prism language-R"># 绘制散点箱线图-----------------------------------------
p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len,color=dose)) +
  # 绘制箱线图
  geom_boxplot(aes(fill=dose),
               alpha=0.1)+ # 设置透明度
  # 绘制散点
  geom_jitter()+
  # 设置颜色
  scale_color_manual(values = pal_npg('nrc')(9))+
  scale_fill_manual(values = pal_npg('nrc')(9))+
  # 设置主题
  theme_bw()+
  # 去除网格线
  theme(panel.grid = element_blank())
p
</code></pre> 
<p><img src="https://images2.imgbox.com/c2/cb/jtThMphM_o.png" alt="plot0"></p> 
<h4><a id="stat_compare_means__69"></a>stat_compare_means( )参数解读</h4> 
<ol><li><strong>method（方法）</strong>：指定要执行的统计检验。对于非配对检验： 
  <ul><li><code>"t.test"</code>：数据需满足双独立样本，正态性，方差齐性。</li><li><code>"wilcox.test"</code>：数据需满足双独立样本。（两组数据的默认方法）</li><li><code>"kruskal.test"</code>：数据需满足三组或更多组独立样本。（&gt;=3组数据的默认方法）</li><li><code>"anova"</code>：数据需满足三组或更多组独立样本，正态性，方差齐性。</li></ul> </li><li><strong>label（标签）</strong>：默认显示检验方法和p值，<code>p.format</code>只显示p值不显示检验方法，<code>p.signif</code>显示显著性水平符号，<code>ns</code>: p &gt; 0.05、<code>*</code>: p &lt;= 0.05、<code>**</code>: p &lt;= 0.01、<code>***</code>: p &lt;= 0.001、<code>****</code>: p &lt;= 0.0001。</li><li><strong>label.x与label.y</strong>：标签的坐标位置。</li><li><strong>comparisons（比较）</strong>：一个列表，用于指定要进行比较的组。</li><li><strong>order（顺序）</strong>：一个可选的参数，用于指定应显示比较的顺序。</li><li><strong>paired（配对）</strong>：逻辑值。如果为 <code>TRUE</code>，表示进行比较的组是配对的。</li><li><strong>show.legend</strong> ：逻辑值，是否在图例中显示，建议False。</li></ol> 
<h4><a id="_83"></a>单因素两水平/多水平比较</h4> 
<pre><code class="prism language-R"># 单因素：两水平/多水平比较----------------------------------------

p1 &lt;- p+stat_compare_means(method = "kruskal.test",
                     label = "p.format",
                     label.x = 0.8, 
                     label.y = 33,
                     show.legend = F)
  
p2 &lt;- p+stat_compare_means(method = "kruskal.test",
                           label = "p.signif",
                           label.x = 0.8, 
                           label.y = 33,
                           show.legend = F)
p1+p2
ggsave('plot1.pdf',width = 7,height = 4.5)
</code></pre> 
<p><img src="https://images2.imgbox.com/3b/6e/hurPkhJk_o.png" alt="plot1"></p> 
<h4><a id="_105"></a>单因素多水平两两比较</h4> 
<pre><code class="prism language-R"># 单因素：多水平两两比较-------------------------------------------
# 设置要比较的分组
my_comparisons &lt;- list(c("0.5", "1"), c("0.5", "2"),c("1", "2"))
p3 &lt;- p + stat_compare_means(comparisons=my_comparisons,
                       label.y = c(28, 32, 36),
                       method="wilcox.test"
)
p4 &lt;- p + stat_compare_means(comparisons=my_comparisons,
                       label.y = c(28, 32, 36),
                       method="wilcox.test",
                       label="p.signif"
)
p3+p4
ggsave('plot2.pdf',width = 7,height = 4.5)
</code></pre> 
<p><img src="https://images2.imgbox.com/3e/a0/5e0IGYDj_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_125"></a>双因素</h4> 
<pre><code class="prism language-R"># 双因素----------------------------------------------------------
p5&lt;-ggplot(ToothGrowth,aes(x=dose,y=len,color=supp))+
  geom_boxplot(aes(fill=supp),
               alpha=0.1)+
  geom_jitter(position = position_jitterdodge(jitter.height=0.75, # 散点抖动高度
                                              jitter.width = 0.5, # 散点抖动宽度
                                              dodge.width = 0.75))+ # x轴方向上的闪避量
  scale_color_manual(values = pal_npg('nrc')(9)[c(1,3)])+
  scale_fill_manual(values = pal_npg('nrc')(9)[c(1,3)])+
  theme_bw()+
  theme(panel.grid = element_blank())

p5 &lt;- p5 + stat_compare_means(aes(group = supp),
                        label="p.signif",
                       show.legend = F)
p5
ggsave('plot3.pdf',width = 6,height = 4)
</code></pre> 
<p><img src="https://images2.imgbox.com/6f/7a/4aS1U0X5_o.png" alt="在这里插入图片描述"><br> <a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTg4NzQxMQ==&amp;mid=2247484690&amp;idx=1&amp;sn=1af9de6affba76d35892ef21d7d8643e&amp;chksm=cf5e54cef829ddd87add1a59c9878d85122638aa283fa3cfecc808c35b93170862230598e264#rd" rel="nofollow">R进阶绘图–散点箱线图+显著性 / 组间差异比较 / ggpubr包</a></p> 
<p><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTg4NzQxMQ==&amp;mid=2247484691&amp;idx=1&amp;sn=46188442f597eac681b8eba61f176b3f&amp;chksm=cf5e54cff829ddd9ac1c8d4ef5df657fc921df7fc04a7f0baf657e4504fa36358682cc109bdc#rd" rel="nofollow">R进阶绘图–散点图+统计分布图/ggpubr包/aplot包/gridExtra包</a></p> 
<h3><a id="_150"></a>合集文章</h3> 
<p>本期的内容就到这里了，喜欢的小伙伴，欢迎点赞、转发、收藏、在看哦！</p> 
<p>关注<strong>数据之帆</strong>，成为一帆的原始粉丝，和一帆一起进步吧！</p> 
<h4><a id="_160"></a>参考资料</h4> 
<p>https://rpkgs.datanovia.com/ggpubr/</p> 
<p>https://mp.weixin.qq.com/s/LV2W5aen9QSRcs4wB7MgDA</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d8422cfa7e1b7508b5018d601d5da8dc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python 柱状图的实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dd12617fc5ed5b88a5cf0514c97fb9eb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【数学理论】随机矩阵理论-20240104</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>