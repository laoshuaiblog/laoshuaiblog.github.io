<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#后台弹出窗口 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/e400be061b35d33c85835c304d9fe733/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="C#后台弹出窗口">
  <meta property="og:description" content="&amp;lt;SCRIPT LANGUAGE=&#34;javascript&#34;&amp;gt; &amp;lt;!-- window.open (&#39;page.html&#39;, &#39;newwindow&#39;, &#39;height=100, width=400, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=n o, status=no&#39;) ; --&amp;gt; &amp;lt;/SCRIPT&amp;gt; 参数解释：
js脚本结束
利用Response.Write将JavaScript写出
//关闭,父窗口弹出对话框,子窗口直接关闭
Response.Write(&#34;&amp;lt;script language=javascript&amp;gt;window.close();&amp;lt;/script&amp;gt;&#34;); //关闭,父窗口和子窗口都不弹出对话框,直接关闭
Response.Write(&#34;&amp;lt;script&amp;gt;{top.opener =null;top.close();}&amp;lt;/script&amp;gt;&#34;); //弹出窗口刷新当前页面width=200 height=200菜单。菜单栏,工具条,地址栏,状态栏全没有
Response.Write(&#34;&amp;lt;script language=javascript&amp;gt;window.open(&#39;rows.aspx&#39;,&#39;newwindow&#39;,&#39;width=200,height=200&#39;)&amp;lt;/script&amp;gt;&#34;); //弹出窗口刷新当前页面
Response.Write(&#34;&amp;lt;script language=javascript&amp;gt;window.open(&#39;rows.aspx&#39;)&amp;lt;/script&amp;gt;&#34;); Response.Write(&#34;&amp;lt;script&amp;gt;window.open(&#39;WebForm2.aspx&#39;,&#39;_blank&#39;);&amp;lt;/script&amp;gt;&#34;); //弹出提示窗口跳到webform2.aspx页(在一个IE窗口中)
Response.Write(&#34; &amp;lt;script language=javascript&amp;gt;alert(&#39;注册成功&#39;); window.window.location.href=&#39;WebForm2.aspx&#39;;&amp;lt;/script&amp;gt; &#34;); //关闭当前子窗口,刷新父窗口
Response.Write(&#34;&amp;lt;script&amp;gt;window.opener.location.href=window.opener.location.href;window.close();&amp;lt;/script&amp;gt;&#34;); Response.Write(&#34;&amp;lt;script&amp;gt;window.opener.location.replace(window.opener.document.referrer);window.close();&amp;lt;/script&amp;gt;&#34;); //子窗口刷新父窗口
Response.Write(&#34;&amp;lt;script&amp;gt;window.opener.location.href=window.opener.location.href;&amp;lt;/script&amp;gt;&#34;); Response.Write(&#34;&amp;lt;script&amp;gt;window.opener.location.href=&#39;WebForm1.aspx&#39;;&amp;lt;/script&amp;gt;&#34;); //弹出提示窗口.确定后弹出子窗口(WebForm2.aspx)
Response.Write(&#34;&amp;lt;script language=&#39;javascript&#39;&amp;gt;alert(&#39;发表成功！&#39;);window.open(&#39;WebForm2.aspx&#39;)&amp;lt;/script&amp;gt;&#34;); //弹出提示窗口,确定后,刷新父窗口
Response.Write(&#34;&amp;lt;script&amp;gt;alert(&#39;发表成功！&#39;);window.opener.location.href=window.opener.location.href;&amp;lt;/script&amp;gt;&#34;); //弹出相同的一页
&amp;lt;INPUT type=&#34;button&#34; value=&#34;Button&#34; onclick=&#34;javascript:window.open(window.location.href)&#34;&amp;gt; Response.Write(&#34;parent.mainFrameBottom.location.href=&#39;yourwebform.aspx?temp=&#34; &#43;str&#43;&#34;&#39;;&#34;); 例:
window.open(&#39;detail.aspx?ID=&#34;&#43;e.Item.Cells[1].Text&#43;&#34;&#39;,&#39;newwin&#39;,&#39;width=750,height=600,scrollbars=yes,top=50,left=50&#39;);&#34;); Response.Write(&#34;&amp;lt;Script&amp;gt;window.open(&#39;WebForm2.aspx&#39;,&#39;&#39;,&#39;toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=750,height=470,left=80,top=40&#39;);&amp;lt;/script&amp;gt;&#34;); 例:
Response.Write(&#34;&amp;lt;script&amp;gt;alert(&#39;发表成功！&#39;);window.opener.location.href=window.opener.location.href;&amp;lt;/script&amp;gt;&#34;); Response.Write(&#34;&amp;lt;script&amp;gt;&#34;); Response.Write(&#34;{top.opener =null;top.close();}&#34;); Response.Write(&#34;&amp;lt;/script&amp;gt;&#34;); 例:">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-03-19T10:33:01+08:00">
    <meta property="article:modified_time" content="2020-03-19T10:33:01+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#后台弹出窗口</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code class="prism language-csharp"><span class="token operator">&lt;</span><span class="token class-name">SCRIPT</span> LANGUAGE<span class="token operator">=</span><span class="token string">"javascript"</span><span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 
window<span class="token punctuation">.</span>open <span class="token punctuation">(</span><span class="token string">'page.html'</span><span class="token punctuation">,</span> <span class="token string">'newwindow'</span><span class="token punctuation">,</span> <span class="token string">'height=100, width=400, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=n o, status=no'</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span><span class="token operator">/</span>SCRIPT<span class="token operator">&gt;</span>
</code></pre> 
<p>参数解释：</p> 
<p> js脚本结束</p> 
<p>利用Response.Write将JavaScript写出</p> 
<p>//关闭,父窗口弹出对话框,子窗口直接关闭</p> 
<pre><code class="prism language-csharp">Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script language=javascript&gt;window.close();&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>//关闭,父窗口和子窗口都不弹出对话框,直接关闭</p> 
<pre><code class="prism language-csharp">Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;{top.opener =null;top.close();}&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>//弹出窗口刷新当前页面width=200 height=200菜单。菜单栏,工具条,地址栏,状态栏全没有</p> 
<pre><code class="prism language-csharp">Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script language=javascript&gt;window.open('rows.aspx','newwindow','width=200,height=200')&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>//弹出窗口刷新当前页面</p> 
<pre><code class="prism language-csharp">Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script language=javascript&gt;window.open('rows.aspx')&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;window.open('WebForm2.aspx','_blank');&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>//弹出提示窗口跳到webform2.aspx页(在一个IE窗口中)</p> 
<pre><code class="prism language-csharp">Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">" &lt;script language=javascript&gt;alert('注册成功'); window.window.location.href='WebForm2.aspx';&lt;/script&gt; "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>//关闭当前子窗口,刷新父窗口</p> 
<pre><code class="prism language-csharp">Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;window.opener.location.href=window.opener.location.href;window.close();&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;window.opener.location.replace(window.opener.document.referrer);window.close();&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>//子窗口刷新父窗口</p> 
<pre><code class="prism language-csharp">Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;window.opener.location.href=window.opener.location.href;&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;window.opener.location.href='WebForm1.aspx';&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>//弹出提示窗口.确定后弹出子窗口(WebForm2.aspx)</p> 
<pre><code class="prism language-csharp">Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script language='javascript'&gt;alert('发表成功！');window.open('WebForm2.aspx')&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>//弹出提示窗口,确定后,刷新父窗口</p> 
<pre><code class="prism language-csharp">Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;alert('发表成功！');window.opener.location.href=window.opener.location.href;&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>//弹出相同的一页</p> 
<pre><code class="prism language-csharp"><span class="token operator">&lt;</span><span class="token class-name">INPUT</span> type<span class="token operator">=</span><span class="token string">"button"</span> <span class="token keyword">value</span><span class="token operator">=</span><span class="token string">"Button"</span> onclick<span class="token operator">=</span><span class="token string">"javascript:window.open(window.location.href)"</span><span class="token operator">&gt;</span> 
Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"parent.mainFrameBottom.location.href='yourwebform.aspx?temp="</span> <span class="token operator">+</span>str<span class="token operator">+</span><span class="token string">"';"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>例:</p> 
<pre><code class="prism language-csharp">window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'detail.aspx?ID="+e.Item.Cells[1].Text+"'</span><span class="token punctuation">,</span><span class="token string">'newwin'</span><span class="token punctuation">,</span><span class="token string">'width=750,height=600,scrollbars=yes,top=50,left=50'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>"<span class="token punctuation">)</span><span class="token punctuation">;</span> 
Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;Script&gt;window.open('WebForm2.aspx','','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=750,height=470,left=80,top=40');&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>例:</p> 
<pre><code class="prism language-csharp">Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;alert('发表成功！');window.opener.location.href=window.opener.location.href;&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"{top.opener =null;top.close();}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;/script&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>例:</p> 
<pre><code class="prism language-csharp">linkcolumn1<span class="token punctuation">.</span>DataNavigateUrlFormatString<span class="token operator">=</span><span class="token string">"javascript:varwin=window.open('edit_usr.aspx?actid={0}','newwin','width=750,height=600,scrollbars=yes,top=50,left=50');window.close()"</span>

<span class="token comment">//服务器端传值弹出窗口,将B页面值传到A页面文本框上</span>
<span class="token comment">//A页面的跳转 txtTBIN是asp:text控件</span>
<span class="token keyword">string</span> url <span class="token operator">=</span> <span class="token string">"B.aspx?TBIN="</span> <span class="token operator">+</span> txtTBIN<span class="token punctuation">.</span>ClientID <span class="token punctuation">;</span>
        imgBIN<span class="token punctuation">.</span>Attributes<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"onclick"</span><span class="token punctuation">,</span> <span class="token string">"window.open('"</span> <span class="token operator">+</span> url <span class="token operator">+</span> <span class="token string">"','xWindow','width=640,height=400,status=no,toolbar=no,menubar=no,location=no,scrollbars=yes,resizable=no,top=250,left=430')"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//B页面</span>
<span class="token comment">//js</span>
function <span class="token function">ReturnDetail</span><span class="token punctuation">(</span>BIN<span class="token punctuation">)</span> 
<span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> _TBIN<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">"txtTBIN"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">value</span><span class="token punctuation">;</span>  
                <span class="token keyword">var</span> obj_TBIN<span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"window.opener.document.all('"</span><span class="token operator">+</span>_TBIN<span class="token operator">+</span><span class="token string">"')"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
                obj_TBIN<span class="token punctuation">.</span><span class="token keyword">value</span><span class="token operator">=</span> BIN<span class="token punctuation">;</span>
                window<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//&lt;%--隐藏的目标 --%&gt;</span>
<span class="token operator">&lt;</span>input id<span class="token operator">=</span><span class="token string">"txtTBIN"</span> runat<span class="token operator">=</span><span class="token string">"server"</span> name<span class="token operator">=</span><span class="token string">"txtFldFocus"</span> type<span class="token operator">=</span><span class="token string">"hidden"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token comment">//调用</span>
<span class="token operator">&lt;</span>asp<span class="token punctuation">:</span><span class="token class-name">Button</span> ID<span class="token operator">=</span><span class="token string">"Button1"</span>  runat<span class="token operator">=</span><span class="token string">"server"</span> Text<span class="token operator">=</span><span class="token string">"将文本框值传到A页面文本框"</span> OnClientClick<span class="token operator">=</span><span class="token string">"javascript: ReturnDetail(document.all('txtBIN').value);"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token comment">//page_load 声明</span>
<span class="token comment">//重要</span>
<span class="token keyword">string</span> tbin <span class="token operator">=</span> Request<span class="token punctuation">.</span>Params<span class="token punctuation">[</span><span class="token string">"TBIN"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token punctuation">:</span> Request<span class="token punctuation">.</span>Params<span class="token punctuation">[</span><span class="token string">"TBIN"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
txtTBIN<span class="token punctuation">.</span>Value <span class="token operator">=</span> tbin<span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ff168b4f44e05d15700514754cc35e20/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">以管理员权限打开命令提示符窗口的3种方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1fba6826b23a8978396e480d72982cd6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">adb命令查看设备内存</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>