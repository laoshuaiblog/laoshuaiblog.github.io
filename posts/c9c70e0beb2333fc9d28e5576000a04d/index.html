<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Polars ï¼Œæœ€å¼ºPandaså¹³æ›¿ï¼Ÿ - è€å¸…çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/c9c70e0beb2333fc9d28e5576000a04d/">
  <meta property="og:site_name" content="è€å¸…çš„åšå®¢">
  <meta property="og:title" content="Polars ï¼Œæœ€å¼ºPandaså¹³æ›¿ï¼Ÿ">
  <meta property="og:description" content="è½¬è‡ªï¼šæ•°æ®studio
å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é˜¿ç²¥ï½
ä»Šå¤©ç»™å¤§å®¶åˆ†äº«å…³äºPolarsåº“çš„å†…å®¹ï¼Œå‰æ’æç¤ºï¼Œæ–‡æœ«é€ä¸¤æœ¬å¥½ä¹¦ï½
Polarsæ˜¯ä¸€ä¸ªç”¨äºæ“ä½œç»“æ„åŒ–æ•°æ®çš„é«˜æ€§èƒ½DataFrameåº“ï¼Œå¯ä»¥è¯´æ˜¯å¹³æ›¿pandasæœ€æœ‰æ½œè´¨çš„åŒ…ã€‚Polarså…¶æ ¸å¿ƒéƒ¨åˆ†æ˜¯ç”¨Rustç¼–å†™çš„ï¼Œä½†è¯¥åº“ä¹Ÿæä¾›äº†Pythonæ¥å£ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š
å¿«é€Ÿ: Polarsæ˜¯ä»é›¶å¼€å§‹ç¼–å†™çš„ï¼Œç´§å¯†ä¸æœºå™¨ç»“åˆï¼Œæ²¡æœ‰å¤–éƒ¨ä¾èµ–ã€‚
I/O: å¯¹æ‰€æœ‰å¸¸è§æ•°æ®å­˜å‚¨å±‚æä¾›ä¸€æµæ”¯æŒï¼šæœ¬åœ°ã€äº‘å­˜å‚¨å’Œæ•°æ®åº“ã€‚
æ˜“äºä½¿ç”¨: ä»¥åŸå§‹æ„å›¾ç¼–å†™æŸ¥è¯¢ã€‚Polars åœ¨å†…éƒ¨ä¼šä½¿ç”¨å…¶æŸ¥è¯¢ä¼˜åŒ–å™¨ç¡®å®šæ‰§è¡Œæœ€æœ‰æ•ˆçš„æ–¹å¼ã€‚
ç¦»çº¿å¤„ç†: Polarsæ”¯æŒé€šè¿‡å…¶æµå¼APIè¿›è¡Œç¦»çº¿æ•°æ®è½¬æ¢ã€‚è¿™ä½¿æ‚¨èƒ½å¤Ÿå¤„ç†ç»“æœï¼Œè€Œæ— éœ€åŒæ—¶å°†æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚
å¹¶è¡Œå¤„ç†: Polarsé€šè¿‡åœ¨å¯ç”¨çš„CPUæ ¸å¿ƒä¹‹é—´åˆ†é…å·¥ä½œè´Ÿè½½ï¼Œå……åˆ†åˆ©ç”¨è®¡ç®—æœºæ€§èƒ½ï¼Œè€Œæ— éœ€é¢å¤–é…ç½®ã€‚
çŸ¢é‡åŒ–æŸ¥è¯¢å¼•æ“: Polarsä½¿ç”¨ Apache Arrowï¼Œä¸€ç§åˆ—å¼æ•°æ®æ ¼å¼ï¼Œä»¥çŸ¢é‡åŒ–æ–¹å¼å¤„ç†æŸ¥è¯¢ã€‚å®ƒä½¿ç”¨ SIMD æ¥ä¼˜åŒ–CPUä½¿ç”¨ã€‚
User guide: https://pola-rs.github.io/polars/user-guide/
API reference: https://pola-rs.github.io/polars/py-polars/html/reference/io.html
ä»‹ç»
Polars çš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªé—ªç”µèˆ¬å¿«é€Ÿçš„ DataFrame åº“ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
åˆ©ç”¨è®¡ç®—æœºä¸Šæ‰€æœ‰å¯ç”¨çš„æ ¸å¿ƒã€‚
é€šè¿‡ä¼˜åŒ–æŸ¥è¯¢æ¥å‡å°‘ä¸å¿…è¦çš„å·¥ä½œ/å†…å­˜åˆ†é…ã€‚
å¤„ç†æ¯”å¯ç”¨ RAM æ›´å¤§å¾—å¤šçš„æ•°æ®é›†ã€‚
å…·æœ‰ä¸€è‡´ä¸”å¯é¢„æµ‹çš„ APIã€‚
å…·æœ‰ä¸¥æ ¼çš„æ¨¡å¼ï¼ˆåœ¨è¿è¡ŒæŸ¥è¯¢ä¹‹å‰åº”è¯¥çŸ¥é“æ•°æ®ç±»å‹ï¼‰ã€‚
Polars æ˜¯ç”¨ Rust ç¼–å†™çš„ï¼Œè¿™ä½¿å¾—å®ƒå…·æœ‰ C/C&#43;&#43; æ€§èƒ½ï¼Œå¹¶å…è®¸å®ƒå®Œå…¨æ§åˆ¶æŸ¥è¯¢å¼•æ“ä¸­çš„æ€§èƒ½å…³é”®éƒ¨åˆ†ã€‚å› æ­¤ï¼ŒPolars ä¸ºæ­¤ä»˜å‡ºäº†å¾ˆå¤§çš„åŠªåŠ›ï¼š
å‡å°‘å†—ä½™çš„å¤åˆ¶ã€‚
é«˜æ•ˆåœ°éå†å†…å­˜ç¼“å­˜ã€‚
åœ¨å¹¶è¡Œæ€§ä¸­æœ€å°åŒ–äº‰ç”¨ã€‚
ä»¥å—å¤„ç†æ•°æ®ã€‚
é‡ç”¨å†…å­˜åˆ†é…ã€‚
åŸºç¡€ Series &amp;amp; DataFrames Series æ˜¯ä¸€ä¸ªä¸€ç»´æ•°æ®ç»“æ„ã€‚åœ¨ä¸€ä¸ª Series ä¸­ï¼Œæ‰€æœ‰å…ƒç´ éƒ½å…·æœ‰ç›¸åŒçš„æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œæ•´æ•°ã€å­—ç¬¦ä¸²ï¼‰ã€‚ä¸‹é¢çš„ç‰‡æ®µå±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªç®€å•çš„å¸¦æœ‰åç§°çš„ Series å¯¹è±¡ã€‚
importÂ polarsÂ asÂ pl importÂ numpyÂ asÂ np sÂ =Â pl.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-05T22:03:52+08:00">
    <meta property="article:modified_time" content="2024-03-05T22:03:52+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="è€å¸…çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">è€å¸…çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Polars ï¼Œæœ€å¼ºPandaså¹³æ›¿ï¼Ÿ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align:center;">è½¬è‡ªï¼šæ•°æ®studio</p> 
 <p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é˜¿ç²¥ï½</p> 
 <p>ä»Šå¤©ç»™å¤§å®¶åˆ†äº«å…³äºPolarsåº“çš„å†…å®¹ï¼Œ<strong>å‰æ’æç¤ºï¼Œæ–‡æœ«é€ä¸¤æœ¬å¥½ä¹¦ï½</strong></p> 
 <p>Polarsæ˜¯ä¸€ä¸ªç”¨äºæ“ä½œç»“æ„åŒ–æ•°æ®çš„é«˜æ€§èƒ½DataFrameåº“ï¼Œå¯ä»¥è¯´æ˜¯å¹³æ›¿pandasæœ€æœ‰æ½œè´¨çš„åŒ…ã€‚Polarså…¶æ ¸å¿ƒéƒ¨åˆ†æ˜¯ç”¨Rustç¼–å†™çš„ï¼Œä½†è¯¥åº“ä¹Ÿæä¾›äº†Pythonæ¥å£ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p> 
 <ul><li><p><strong>å¿«é€Ÿ</strong>: Polarsæ˜¯ä»é›¶å¼€å§‹ç¼–å†™çš„ï¼Œç´§å¯†ä¸æœºå™¨ç»“åˆï¼Œæ²¡æœ‰å¤–éƒ¨ä¾èµ–ã€‚</p></li><li><p><strong>I/O</strong>: å¯¹æ‰€æœ‰å¸¸è§æ•°æ®å­˜å‚¨å±‚æä¾›ä¸€æµæ”¯æŒï¼šæœ¬åœ°ã€äº‘å­˜å‚¨å’Œæ•°æ®åº“ã€‚</p></li><li><p><strong>æ˜“äºä½¿ç”¨</strong>: ä»¥åŸå§‹æ„å›¾ç¼–å†™æŸ¥è¯¢ã€‚Polars åœ¨å†…éƒ¨ä¼šä½¿ç”¨å…¶æŸ¥è¯¢ä¼˜åŒ–å™¨ç¡®å®šæ‰§è¡Œæœ€æœ‰æ•ˆçš„æ–¹å¼ã€‚</p></li><li><p><strong>ç¦»çº¿å¤„ç†</strong>: Polarsæ”¯æŒé€šè¿‡å…¶æµå¼APIè¿›è¡Œç¦»çº¿æ•°æ®è½¬æ¢ã€‚è¿™ä½¿æ‚¨èƒ½å¤Ÿå¤„ç†ç»“æœï¼Œè€Œæ— éœ€åŒæ—¶å°†æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚</p></li><li><p><strong>å¹¶è¡Œå¤„ç†</strong>: Polarsé€šè¿‡åœ¨å¯ç”¨çš„CPUæ ¸å¿ƒä¹‹é—´åˆ†é…å·¥ä½œè´Ÿè½½ï¼Œå……åˆ†åˆ©ç”¨è®¡ç®—æœºæ€§èƒ½ï¼Œè€Œæ— éœ€é¢å¤–é…ç½®ã€‚</p></li><li><p><strong>çŸ¢é‡åŒ–æŸ¥è¯¢å¼•æ“</strong>: Polarsä½¿ç”¨ Apache Arrowï¼Œä¸€ç§åˆ—å¼æ•°æ®æ ¼å¼ï¼Œä»¥çŸ¢é‡åŒ–æ–¹å¼å¤„ç†æŸ¥è¯¢ã€‚å®ƒä½¿ç”¨ SIMD æ¥ä¼˜åŒ–CPUä½¿ç”¨ã€‚</p></li></ul> 
 <p style="text-align:left;">User guide: https://pola-rs.github.io/polars/user-guide/<br>API reference: https://pola-rs.github.io/polars/py-polars/html/reference/io.html</p> 
 <p style="text-align:center;"><strong>ä»‹ç»</strong></p> 
 <p>Polars çš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªé—ªç”µèˆ¬å¿«é€Ÿçš„ <code>DataFrame</code> åº“ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p> 
 <ul><li><p>åˆ©ç”¨è®¡ç®—æœºä¸Šæ‰€æœ‰å¯ç”¨çš„æ ¸å¿ƒã€‚</p></li><li><p>é€šè¿‡ä¼˜åŒ–æŸ¥è¯¢æ¥å‡å°‘ä¸å¿…è¦çš„å·¥ä½œ/å†…å­˜åˆ†é…ã€‚</p></li><li><p>å¤„ç†æ¯”å¯ç”¨ RAM æ›´å¤§å¾—å¤šçš„æ•°æ®é›†ã€‚</p></li><li><p>å…·æœ‰ä¸€è‡´ä¸”å¯é¢„æµ‹çš„ APIã€‚</p></li><li><p>å…·æœ‰ä¸¥æ ¼çš„æ¨¡å¼ï¼ˆåœ¨è¿è¡ŒæŸ¥è¯¢ä¹‹å‰åº”è¯¥çŸ¥é“æ•°æ®ç±»å‹ï¼‰ã€‚</p></li></ul> 
 <p>Polars æ˜¯ç”¨ Rust ç¼–å†™çš„ï¼Œè¿™ä½¿å¾—å®ƒå…·æœ‰ C/C++ æ€§èƒ½ï¼Œå¹¶å…è®¸å®ƒå®Œå…¨æ§åˆ¶æŸ¥è¯¢å¼•æ“ä¸­çš„æ€§èƒ½å…³é”®éƒ¨åˆ†ã€‚å› æ­¤ï¼ŒPolars ä¸ºæ­¤ä»˜å‡ºäº†å¾ˆå¤§çš„åŠªåŠ›ï¼š</p> 
 <ul><li><p>å‡å°‘å†—ä½™çš„å¤åˆ¶ã€‚</p></li><li><p>é«˜æ•ˆåœ°éå†å†…å­˜ç¼“å­˜ã€‚</p></li><li><p>åœ¨å¹¶è¡Œæ€§ä¸­æœ€å°åŒ–äº‰ç”¨ã€‚</p></li><li><p>ä»¥å—å¤„ç†æ•°æ®ã€‚</p></li><li><p>é‡ç”¨å†…å­˜åˆ†é…ã€‚</p></li></ul> 
 <h3></h3> 
 <h3><strong>åŸºç¡€</strong></h3> 
 <h4>Series &amp; DataFrames</h4> 
 <p>Series æ˜¯ä¸€ä¸ªä¸€ç»´æ•°æ®ç»“æ„ã€‚åœ¨ä¸€ä¸ª Series ä¸­ï¼Œæ‰€æœ‰å…ƒç´ éƒ½å…·æœ‰ç›¸åŒçš„æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œæ•´æ•°ã€å­—ç¬¦ä¸²ï¼‰ã€‚ä¸‹é¢çš„ç‰‡æ®µå±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªç®€å•çš„å¸¦æœ‰åç§°çš„ Series å¯¹è±¡ã€‚</p> 
 <pre class="has"><code class="language-go">importÂ polarsÂ asÂ pl
importÂ numpyÂ asÂ np

sÂ =Â pl.Series("a",Â [1,Â 2,Â 3,Â 4,Â 5])
print(s)
sÂ =Â pl.Series("a",Â [1,Â 2,Â 3,Â 4,Â 5])
print(s.min())
print(s.max())
sÂ =Â pl.Series("a",Â ["polar",Â "bear",Â "arctic",Â "polarÂ fox",Â "polarÂ bear"])
s2Â =Â s.str.replace("polar",Â "pola")
print(s2)
fromÂ datetimeÂ importÂ date

startÂ =Â date(2001,Â 1,Â 1)
stopÂ =Â date(2001,Â 1,Â 9)
sÂ =Â pl.date_range(start,Â stop,Â interval="2d",Â eager=True)
print(s.dt.day())</code></pre> 
 <p>DataFrame æ˜¯ä¸€ä¸ªäºŒç»´æ•°æ®ç»“æ„ï¼Œç”±ä¸€ä¸ªæˆ–å¤šä¸ª Series æ”¯æŒï¼Œå¯ä»¥çœ‹ä½œæ˜¯å¯¹ä¸€ç³»åˆ—ï¼ˆä¾‹å¦‚åˆ—è¡¨ï¼‰Seriesçš„æŠ½è±¡ã€‚åœ¨ DataFrame ä¸Šå¯ä»¥æ‰§è¡Œçš„æ“ä½œä¸åœ¨ SQL æŸ¥è¯¢ä¸­æ‰§è¡Œçš„æ“ä½œéå¸¸ç›¸ä¼¼ã€‚æ‚¨å¯ä»¥è¿›è¡Œ GROUP BYã€JOINã€PIVOTï¼Œè¿˜å¯ä»¥å®šä¹‰è‡ªå®šä¹‰å‡½æ•°ã€‚</p> 
 <pre class="has"><code class="language-go">fromÂ datetimeÂ importÂ datetime

dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "integer":Â [1,Â 2,Â 3,Â 4,Â 5],
Â Â Â Â Â Â Â Â "date":Â [
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2022,Â 1,Â 1),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2022,Â 1,Â 2),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2022,Â 1,Â 3),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2022,Â 1,Â 4),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2022,Â 1,Â 5),
Â Â Â Â Â Â Â Â ],
Â Â Â Â Â Â Â Â "float":Â [4.0,Â 5.0,Â 6.0,Â 7.0,Â 8.0],
Â Â Â Â }
)

print(df)
print(df.head(3))
print(df.describe())</code></pre> 
 <h4>Reading &amp; writing</h4> 
 <pre class="has"><code class="language-go">importÂ polarsÂ asÂ pl
fromÂ datetimeÂ importÂ datetime

dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "integer":Â [1,Â 2,Â 3],
Â Â Â Â Â Â Â Â "date":Â [
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2022,Â 1,Â 1),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2022,Â 1,Â 2),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2022,Â 1,Â 3),
Â Â Â Â Â Â Â Â ],
Â Â Â Â Â Â Â Â "float":Â [4.0,Â 5.0,Â 6.0],
Â Â Â Â }
)

print(df)
df.write_csv("output.csv")
df_csvÂ =Â pl.read_csv("output.csv")
print(df_csv)
df_csvÂ =Â pl.read_csv("output.csv",Â try_parse_dates=True)
print(df_csv)</code></pre> 
 <h4>Expressions</h4> 
 <pre class="has"><code class="language-go">importÂ polarsÂ asÂ pl

#Â åˆ›å»ºä¸€ä¸ªç®€å•çš„Â DataFrame
dataÂ =Â {'column1':Â [1,Â 2,Â 3],
Â Â Â Â Â Â Â Â 'column2':Â ['a',Â 'b',Â 'c']}
dfÂ =Â pl.DataFrame(data)

#Â ä½¿ç”¨è¡¨è¾¾å¼è¿›è¡Œé€‰æ‹©
selected_dfÂ =Â df.select(['column1'])

#Â ä½¿ç”¨è¡¨è¾¾å¼è¿›è¡Œè¿‡æ»¤
filtered_dfÂ =Â df.filter(df['column1']Â &gt;Â 1)
selected_df
filtered_df</code></pre> 
 <h3><strong>æ‹¼æ¥</strong></h3> 
 <pre class="has"><code class="language-go">dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "a":Â np.arange(0,Â 8),
Â Â Â Â Â Â Â Â "b":Â np.random.rand(8),
Â Â Â Â Â Â Â Â "d":Â [1,Â 2.0,Â np.NaN,Â np.NaN,Â 0,Â -5,Â -42,Â None],
Â Â Â Â }
)

df2Â =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "x":Â np.arange(0,Â 8),
Â Â Â Â Â Â Â Â "y":Â ["A",Â "A",Â "A",Â "B",Â "B",Â "C",Â "X",Â "X"],
Â Â Â Â }
)
joinedÂ =Â df.join(df2,Â left_on="a",Â right_on="x")
print(joined)
stackedÂ =Â df.hstack(df2)
print(stacked)</code></pre> 
 <h3><strong>æ¦‚å¿µ</strong></h3> 
 <h4>Data types</h4> 
 <p>Polars å®Œå…¨åŸºäº Arrow æ•°æ®ç±»å‹ï¼Œå¹¶ç”± Arrow å†…å­˜æ•°ç»„æ”¯æŒã€‚è¿™ä½¿å¾—æ•°æ®å¤„ç†åœ¨ç¼“å­˜æ•ˆç‡å’Œè·¨è¿›ç¨‹é€šä¿¡æ–¹é¢å¾—åˆ°è‰¯å¥½æ”¯æŒã€‚å¤§å¤šæ•°æ•°æ®ç±»å‹éƒ½ä¸ Arrow çš„å®ç°å®Œå…¨ä¸€è‡´ï¼Œä½†æœ‰ä¸€äº›ä¾‹å¤–ï¼Œå¦‚ <code>Utf8</code>ï¼ˆå®é™…ä¸Šæ˜¯ <code>LargeUtf8</code>ï¼‰ã€<code>Categorical</code> å’Œ <code>Object</code>ï¼ˆæ”¯æŒæœ‰é™ï¼‰ç­‰ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æ•°æ®ç±»å‹ï¼š</p> 
 <table><thead><tr><th>åˆ†ç»„</th><th>ç±»å‹</th><th>è¯¦ç»†ä¿¡æ¯</th></tr></thead><tbody><tr><td>æ•°å€¼</td><td><code>Int8</code></td><td>8 ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</td></tr><tr><td><br></td><td><code>Int16</code></td><td>16 ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</td></tr><tr><td><br></td><td><code>Int32</code></td><td>32 ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</td></tr><tr><td><br></td><td><code>Int64</code></td><td>64 ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</td></tr><tr><td><br></td><td><code>UInt8</code></td><td>8 ä½æ— ç¬¦å·æ•´æ•°ã€‚</td></tr><tr><td><br></td><td><code>UInt16</code></td><td>16 ä½æ— ç¬¦å·æ•´æ•°ã€‚</td></tr><tr><td><br></td><td><code>UInt32</code></td><td>32 ä½æ— ç¬¦å·æ•´æ•°ã€‚</td></tr><tr><td><br></td><td><code>UInt64</code></td><td>64 ä½æ— ç¬¦å·æ•´æ•°ã€‚</td></tr><tr><td><br></td><td><code>Float32</code></td><td>32 ä½æµ®ç‚¹æ•°ã€‚</td></tr><tr><td><br></td><td><code>Float64</code></td><td>64 ä½æµ®ç‚¹æ•°ã€‚</td></tr><tr><td>åµŒå¥—</td><td><code>Struct</code></td><td>ç»“æ„æ•°ç»„è¡¨ç¤ºä¸º <code>Vec&lt;Series&gt;</code>ï¼Œç”¨äºåœ¨å•ä¸ªåˆ—ä¸­æ‰“åŒ…å¤šä¸ª/å¼‚æ„å€¼ã€‚</td></tr><tr><td><br></td><td><code>List</code></td><td>åˆ—è¡¨æ•°ç»„åŒ…å«åŒ…å«åˆ—è¡¨å€¼çš„å­æ•°ç»„å’Œä¸€ä¸ªåç§»æ•°ç»„ï¼ˆåœ¨å†…éƒ¨å®é™…ä¸Šæ˜¯ Arrow çš„ <code>LargeList</code>ï¼‰ã€‚</td></tr><tr><td>æ—¶é—´</td><td><code>Date</code></td><td>æ—¥æœŸè¡¨ç¤ºï¼Œå†…éƒ¨è¡¨ç¤ºä¸ºè·ç¦» UNIX çºªå…ƒçš„å¤©æ•°ï¼Œç”± 32 ä½æœ‰ç¬¦å·æ•´æ•°ç¼–ç ã€‚</td></tr><tr><td><br></td><td><code>Datetime</code></td><td>æ—¥æœŸæ—¶é—´è¡¨ç¤ºï¼Œå†…éƒ¨è¡¨ç¤ºä¸ºè·ç¦» UNIX çºªå…ƒçš„å¾®ç§’æ•°ï¼Œç”± 64 ä½æœ‰ç¬¦å·æ•´æ•°ç¼–ç ã€‚</td></tr><tr><td><br></td><td><code>Duration</code></td><td>è¡¨ç¤ºæ—¶é—´å·®çš„ç±»å‹ï¼Œå†…éƒ¨è¡¨ç¤ºä¸ºå¾®ç§’ã€‚é€šè¿‡å‡å» <code>Date/Datetime</code> åˆ›å»ºã€‚</td></tr><tr><td><br></td><td><code>Time</code></td><td>æ—¶é—´è¡¨ç¤ºï¼Œå†…éƒ¨è¡¨ç¤ºä¸ºè·åˆå¤œçš„çº³ç§’æ•°ã€‚</td></tr><tr><td>å…¶ä»–</td><td><code>Boolean</code></td><td>å¸ƒå°”ç±»å‹ï¼Œå®é™…ä¸Šæ˜¯æŒ‰ä½æ‰“åŒ…çš„ã€‚</td></tr><tr><td><br></td><td><code>Utf8</code></td><td>å­—ç¬¦ä¸²æ•°æ®ï¼ˆå®é™…ä¸Šåœ¨å†…éƒ¨æ˜¯ Arrow çš„ <code>LargeUtf8</code>ï¼‰ã€‚</td></tr><tr><td><br></td><td><code>Binary</code></td><td>ä»¥å­—èŠ‚å½¢å¼å­˜å‚¨æ•°æ®ã€‚</td></tr><tr><td><br></td><td><code>Object</code></td><td>æœ‰é™æ”¯æŒçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥æ˜¯ä»»ä½•å€¼ã€‚</td></tr><tr><td><br></td><td><code>Categorical</code></td><td>ä¸€ç»„å­—ç¬¦ä¸²çš„åˆ†ç±»ç¼–ç ã€‚</td></tr></tbody></table> 
 <h4>Contexts</h4> 
 <p>Polars å·²ç»å¼€å‘äº†è‡ªå·±çš„é¢†åŸŸç‰¹å®šè¯­è¨€ï¼ˆDSLï¼‰ç”¨äºæ•°æ®è½¬æ¢ã€‚è¯¥è¯­è¨€éå¸¸æ˜“äºä½¿ç”¨ï¼Œå…è®¸è¿›è¡Œå¤æ‚çš„æŸ¥è¯¢ï¼ŒåŒæ—¶ä¿æŒäººç±»å¯è¯»æ€§ã€‚è¯¥è¯­è¨€çš„ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶æ˜¯ä¸Šä¸‹æ–‡ï¼ˆContextsï¼‰å’Œè¡¨è¾¾å¼ï¼ˆExpressionsï¼‰ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€éƒ¨åˆ†ä»‹ç»è¡¨è¾¾å¼ã€‚</p> 
 <p>æ­£å¦‚åç§°æ‰€ç¤ºï¼Œä¸Šä¸‹æ–‡æŒ‡çš„æ˜¯éœ€è¦è¯„ä¼°è¡¨è¾¾å¼çš„ä¸Šä¸‹æ–‡ã€‚æœ‰ä¸‰ä¸ªä¸»è¦çš„ä¸Šä¸‹æ–‡ [^1^]ï¼š</p> 
 <ol><li><p>é€‰æ‹©ï¼ˆSelectionï¼‰: <code>df.select([..])</code>, <code>df.with_columns([..])</code></p></li><li><p>è¿‡æ»¤ï¼ˆFilteringï¼‰: <code>df.filter()</code></p></li><li><p>åˆ†ç»„/èšåˆï¼ˆGroup by / Aggregationï¼‰: <code>df.group_by(..).agg([..])</code></p></li></ol> 
 <pre class="has"><code class="language-go">dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "nrs":Â [1,Â 2,Â 3,Â None,Â 5],
Â Â Â Â Â Â Â Â "names":Â ["foo",Â "ham",Â "spam",Â "egg",Â None],
Â Â Â Â Â Â Â Â "random":Â np.random.rand(5),
Â Â Â Â Â Â Â Â "groups":Â ["A",Â "A",Â "B",Â "C",Â "B"],
Â Â Â Â }
)
print(df)
#Â åŸºäºdfÂ è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°æ–°çš„è¡¨æ ¼
outÂ =Â df.select(
Â Â Â Â pl.sum("nrs"),Â #Â nrsçš„å’Œ
Â Â Â Â pl.col("names").sort(),Â #Â namesæ’åºåçš„ç»“æœ
Â Â Â Â pl.col("names").first().alias("firstÂ name"),Â #Â namesç¬¬ä¸€ä¸ªå€¼
Â Â Â Â (pl.mean("nrs")Â *Â 10).alias("10xnrs"),Â #Â nrsçš„å‡å€¼Â *Â 10
)
print(out)
#Â åŸå§‹dfÂ æ–°å¢åˆ—
dfÂ =Â df.with_columns(
Â Â Â Â pl.sum("nrs").alias("nrs_sum"),
Â Â Â Â pl.col("random").count().alias("count"),
)
print(df)
outÂ =Â df.filter(pl.col("nrs")Â &gt;Â 2)
print(out)
outÂ =Â df.group_by("groups").agg(
Â Â Â Â pl.sum("nrs"),Â Â #Â sumÂ nrsÂ byÂ groups
Â Â Â Â pl.col("random").count().alias("count"),Â Â #Â countÂ groupÂ members
Â Â Â Â #Â sumÂ randomÂ whereÂ nameÂ !=Â null
Â Â Â Â pl.col("random").filter(pl.col("names").is_not_null()).sum().name.suffix("_sum"),
Â Â Â Â pl.col("names").reverse().alias("reversedÂ names"),
)
print(out)</code></pre> 
 <h4>Lazy / eager API</h4> 
 <p>Polarsæ”¯æŒä¸¤ç§æ“ä½œæ¨¡å¼ï¼šlazyï¼ˆå»¶è¿Ÿï¼‰å’Œeagerï¼ˆå³æ—¶ï¼‰ã€‚åœ¨eager APIä¸­ï¼ŒæŸ¥è¯¢ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œåœ¨lazy APIä¸­ï¼ŒæŸ¥è¯¢åªæœ‰åœ¨â€œéœ€è¦â€æ—¶æ‰ä¼šè¢«è¯„ä¼°ã€‚</p> 
 <pre class="has"><code class="language-go">!wgetÂ https://mirror.coggle.club/dataset/heart.csv
!headÂ heart.csv
dfÂ =Â pl.read_csv("heart.csv")
df_smallÂ =Â df.filter(pl.col("age")Â &gt;Â 5)
df_aggÂ =Â df_small.group_by("sex").agg(pl.col("chol").mean())
print(df_agg)
qÂ =Â (
Â Â Â Â pl.scan_csv("heart.csv")
Â Â Â Â .filter(pl.col("age")Â &gt;Â 5)
Â Â Â Â .group_by("sex")
Â Â Â Â .agg(pl.col("chol").mean())
)
#Â ç”Ÿæˆäº†è®¡ç®—é€»è¾‘

dfÂ =Â q.collect()Â #Â çœŸæ­£è®¡ç®—
print(df)</code></pre> 
 <h4>Streaming API</h4> 
 <p>https://pola-rs.github.io/polars/user-guide/concepts/streaming/</p> 
 <p>Lazy APIçš„å¦ä¸€ä¸ªé¢å¤–å¥½å¤„æ˜¯å®ƒå…è®¸ä»¥æµå¼æ–¹å¼æ‰§è¡ŒæŸ¥è¯¢ã€‚ä¸ä¸€æ¬¡æ€§å¤„ç†æ‰€æœ‰æ•°æ®ä¸åŒï¼ŒPolarså¯ä»¥æŒ‰æ‰¹æ‰§è¡ŒæŸ¥è¯¢ï¼Œä½¿æ‚¨èƒ½å¤Ÿå¤„ç†å¤§äºå†…å­˜çš„æ•°æ®é›†ã€‚</p> 
 <pre class="has"><code class="language-go">qÂ =Â (
Â Â Â Â pl.scan_csv("heart.csv")
Â Â Â Â .filter(pl.col("age")Â &gt;Â 5)
Â Â Â Â .group_by("sex")
Â Â Â Â .agg(pl.col("chol").mean())
)

dfÂ =Â q.collect(streaming=True)
print(df)</code></pre> 
 <h3><strong>è¡¨è¾¾å¼</strong></h3> 
 <h4>Basic operators</h4> 
 <pre class="has"><code class="language-go">dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "nrs":Â [1,Â 2,Â 3,Â None,Â 5],
Â Â Â Â Â Â Â Â "names":Â ["foo",Â "ham",Â "spam",Â "egg",Â None],
Â Â Â Â Â Â Â Â "random":Â np.random.rand(5),
Â Â Â Â Â Â Â Â "groups":Â ["A",Â "A",Â "B",Â "C",Â "B"],
Â Â Â Â }
)
print(df)
df_numericalÂ =Â df.select(
Â Â Â Â (pl.col("nrs")Â +Â 5).alias("nrsÂ +Â 5"),
Â Â Â Â (pl.col("nrs")Â -Â 5).alias("nrsÂ -Â 5"),
Â Â Â Â (pl.col("nrs")Â *Â pl.col("random")).alias("nrsÂ *Â random"),
Â Â Â Â (pl.col("nrs")Â /Â pl.col("random")).alias("nrsÂ /Â random"),
)
print(df_numerical)
df_logicalÂ =Â df.select(
Â Â Â Â (pl.col("nrs")Â &gt;Â 1).alias("nrsÂ &gt;Â 1"),
Â Â Â Â (pl.col("random")Â &lt;=Â 0.5).alias("randomÂ &lt;=Â .5"),
Â Â Â Â (pl.col("nrs")Â !=Â 1).alias("nrsÂ !=Â 1"),
Â Â Â Â (pl.col("nrs")Â ==Â 1).alias("nrsÂ ==Â 1"),
Â Â Â Â ((pl.col("random")Â &lt;=Â 0.5)Â &amp;Â (pl.col("nrs")Â &gt;Â 1)).alias("and_expr"),Â Â #Â and
Â Â Â Â ((pl.col("random")Â &lt;=Â 0.5)Â |Â (pl.col("nrs")Â &gt;Â 1)).alias("or_expr"),Â Â #Â or
)
print(df_logical)</code></pre> 
 <h4>Column selections</h4> 
 <pre class="has"><code class="language-go">fromÂ datetimeÂ importÂ date,Â datetime

dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "id":Â [9,Â 4,Â 2],
Â Â Â Â Â Â Â Â "place":Â ["Mars",Â "Earth",Â "Saturn"],
Â Â Â Â Â Â Â Â "date":Â pl.date_range(date(2022,Â 1,Â 1),Â date(2022,Â 1,Â 3),Â "1d",Â eager=True),
Â Â Â Â Â Â Â Â "sales":Â [33.4,Â 2142134.1,Â 44.7],
Â Â Â Â Â Â Â Â "has_people":Â [False,Â True,Â False],
Â Â Â Â Â Â Â Â "logged_at":Â pl.datetime_range(
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2022,Â 12,Â 1),Â datetime(2022,Â 12,Â 1,Â 0,Â 0,Â 2),Â "1s",Â eager=True
Â Â Â Â Â Â Â Â ),
Â Â Â Â }
).with_row_count("rn")
print(df)
outÂ =Â df.select(pl.col("*"))

#Â IsÂ equivalentÂ to
outÂ =Â df.select(pl.all())
print(out)
outÂ =Â df.select(pl.col("*").exclude("logged_at",Â "rn"))
print(out)
outÂ =Â df.select(pl.col("date",Â "logged_at").dt.to_string("%Y-%h-%d"))
print(out)
outÂ =Â df.select(pl.col("^.*(as|sa).*$"))
print(out)
outÂ =Â df.select(pl.col(pl.Int64,Â pl.UInt32,Â pl.Boolean).n_unique())
print(out)
importÂ polars.selectorsÂ asÂ cs
outÂ =Â df.select(cs.numeric()Â -Â cs.first())
print(out)
outÂ =Â df.select(cs.contains("rn"),Â cs.matches(".*_.*"))
print(out)</code></pre> 
 <h4>Functions</h4> 
 <pre class="has"><code class="language-go">dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "nrs":Â [1,Â 2,Â 3,Â None,Â 5],
Â Â Â Â Â Â Â Â "names":Â ["foo",Â "ham",Â "spam",Â "egg",Â "spam"],
Â Â Â Â Â Â Â Â "random":Â np.random.rand(5),
Â Â Â Â Â Â Â Â "groups":Â ["A",Â "A",Â "B",Â "C",Â "B"],
Â Â Â Â }
)
print(df)
df_samenameÂ =Â df.select(pl.col("nrs")Â +Â 5)
print(df_samename)
df_aliasÂ =Â df.select(
Â Â Â Â (pl.col("nrs")Â +Â 5).alias("nrsÂ +Â 5"),
Â Â Â Â (pl.col("nrs")Â -Â 5).alias("nrsÂ -Â 5"),
)
print(df_alias)
df_aliasÂ =Â df.select(
Â Â Â Â pl.col("names").n_unique().alias("unique"),
Â Â Â Â pl.approx_n_unique("names").alias("unique_approx"),
)
print(df_alias)
df_conditionalÂ =Â df.select(
Â Â Â Â pl.col("nrs"),
Â Â Â Â pl.when(pl.col("nrs")Â &gt;Â 2)
Â Â Â Â .then(pl.lit(True))
Â Â Â Â .otherwise(pl.lit(False))
Â Â Â Â .alias("conditional"),
)
print(df_conditional)</code></pre> 
 <h3><strong>è½¬æ¢</strong></h3> 
 <p>ç±»å‹è½¬æ¢ï¼ˆCastingï¼‰å°†åˆ—çš„åº•å±‚ <code>DataType</code> è½¬æ¢ä¸ºæ–°çš„æ•°æ®ç±»å‹ã€‚Polars ä½¿ç”¨ Arrow åœ¨å†…å­˜ä¸­ç®¡ç†æ•°æ®ï¼Œå¹¶ä¾èµ–äº Rust å®ç°ä¸­çš„è®¡ç®—æ ¸å¿ƒ æ¥æ‰§è¡Œè½¬æ¢ã€‚ç±»å‹è½¬æ¢é€šè¿‡ <code>cast()</code> æ–¹æ³•å®ç°ã€‚</p> 
 <p><code>cast</code> æ–¹æ³•åŒ…æ‹¬ä¸€ä¸ª <code>strict</code> å‚æ•°ï¼Œè¯¥å‚æ•°ç¡®å®šå½“ Polars é‡åˆ°æ— æ³•ä»æº <code>DataType</code> è½¬æ¢ä¸ºç›®æ ‡ <code>DataType</code> çš„å€¼æ—¶çš„è¡Œä¸ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>strict=True</code>ï¼Œè¿™æ„å‘³ç€ Polars å°†å¼•å‘é”™è¯¯ï¼Œé€šçŸ¥ç”¨æˆ·è½¬æ¢å¤±è´¥ï¼Œå¹¶æä¾›æ— æ³•è½¬æ¢çš„å€¼çš„è¯¦ç»†ä¿¡æ¯ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœ <code>strict=False</code>ï¼Œæ— æ³•è½¬æ¢ä¸ºç›®æ ‡ <code>DataType</code> çš„ä»»ä½•å€¼éƒ½å°†æ‚„æ‚„åœ°è½¬æ¢ä¸º <code>null</code>ã€‚</p> 
 <pre class="has"><code class="language-go">dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "integers":Â [1,Â 2,Â 3,Â 4,Â 5],
Â Â Â Â Â Â Â Â "big_integers":Â [1,Â 10000002,Â 3,Â 10000004,Â 10000005],
Â Â Â Â Â Â Â Â "floats":Â [4.0,Â 5.0,Â 6.0,Â 7.0,Â 8.0],
Â Â Â Â Â Â Â Â "floats_with_decimal":Â [4.532,Â 5.5,Â 6.5,Â 7.5,Â 8.5],
Â Â Â Â }
)

print(df)
outÂ =Â df.select(
Â Â Â Â pl.col("integers").cast(pl.Float32).alias("integers_as_floats"),
Â Â Â Â pl.col("floats").cast(pl.Int32).alias("floats_as_integers"),
Â Â Â Â pl.col("floats_with_decimal")
Â Â Â Â .cast(pl.Int32)
Â Â Â Â .alias("floats_with_decimal_as_integers"),
)
print(out)
outÂ =Â df.select(
Â Â Â Â pl.col("integers").cast(pl.Int16).alias("integers_smallfootprint"),
Â Â Â Â pl.col("floats").cast(pl.Float32).alias("floats_smallfootprint"),
)
print(out)
dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "integers":Â [1,Â 2,Â 3,Â 4,Â 5],
Â Â Â Â Â Â Â Â "float":Â [4.0,Â 5.03,Â 6.0,Â 7.0,Â 8.0],
Â Â Â Â Â Â Â Â "floats_as_string":Â ["4.0",Â "5.0",Â "6.0",Â "7.0",Â "8.0"],
Â Â Â Â }
)

outÂ =Â df.select(
Â Â Â Â pl.col("integers").cast(pl.Utf8),
Â Â Â Â pl.col("float").cast(pl.Utf8),
Â Â Â Â pl.col("floats_as_string").cast(pl.Float64),
)
print(out)
dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "integers":Â [-1,Â 0,Â 2,Â 3,Â 4],
Â Â Â Â Â Â Â Â "floats":Â [0.0,Â 1.0,Â 2.0,Â 3.0,Â 4.0],
Â Â Â Â Â Â Â Â "bools":Â [True,Â False,Â True,Â False,Â True],
Â Â Â Â }
)

outÂ =Â df.select(pl.col("integers").cast(pl.Boolean),Â pl.col("floats").cast(pl.Boolean))
print(out)
fromÂ datetimeÂ importÂ date,Â datetime

dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "date":Â pl.date_range(date(2022,Â 1,Â 1),Â date(2022,Â 1,Â 5),Â eager=True),
Â Â Â Â Â Â Â Â "datetime":Â pl.datetime_range(
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2022,Â 1,Â 1),Â datetime(2022,Â 1,Â 5),Â eager=True
Â Â Â Â Â Â Â Â ),
Â Â Â Â }
)

outÂ =Â df.select(pl.col("date").cast(pl.Int64),Â pl.col("datetime").cast(pl.Int64))
print(out)</code></pre> 
 <h4>Strings</h4> 
 <pre class="has"><code class="language-go">dfÂ =Â pl.DataFrame({"animal":Â ["Crab",Â "catÂ andÂ dog",Â "rab$bit",Â None]})

outÂ =Â df.select(
Â Â Â Â pl.col("animal").str.len_bytes().alias("byte_count"),
Â Â Â Â pl.col("animal").str.len_chars().alias("letter_count"),
)
print(out)
outÂ =Â df.select(
Â Â Â Â pl.col("animal"),
Â Â Â Â pl.col("animal").str.contains("cat|bit").alias("regex"),
Â Â Â Â pl.col("animal").str.contains("rab$",Â literal=True).alias("literal"),
Â Â Â Â pl.col("animal").str.starts_with("rab").alias("starts_with"),
Â Â Â Â pl.col("animal").str.ends_with("dog").alias("ends_with"),
)
print(out)</code></pre> 
 <h4>Aggregation</h4> 
 <p>https://pola-rs.github.io/polars/user-guide/expressions/aggregation/</p> 
 <pre class="has"><code class="language-go">dfÂ =Â pl.read_csv("heart.csv")
print(df)
qÂ =Â (
Â Â Â Â df.lazy()
Â Â Â Â .group_by("sex")
Â Â Â Â .agg(
Â Â Â Â Â Â Â Â pl.count(),
Â Â Â Â Â Â Â Â pl.col("cp"),
Â Â Â Â Â Â Â Â pl.first("caa"),
Â Â Â Â )
Â Â Â Â .sort("count",Â descending=True)
Â Â Â Â .limit(5)
)

dfÂ =Â q.collect()
print(df)
qÂ =Â (
Â Â Â Â df.lazy()
Â Â Â Â .group_by("sex")
Â Â Â Â .agg(
Â Â Â Â Â Â Â Â (pl.col("cp")Â ==Â 1).sum().alias("anti"),
Â Â Â Â Â Â Â Â (pl.col("cp")Â ==Â 2).sum().alias("pro"),
Â Â Â Â )
Â Â Â Â .sort("pro",Â descending=True)
Â Â Â Â .limit(5)
)

dfÂ =Â q.collect()
print(df)</code></pre> 
 <h3><strong>ç¼ºå¤±å€¼</strong></h3> 
 <pre class="has"><code class="language-go">dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "value":Â [1,Â None],
Â Â Â Â },
)
print(df)
null_count_dfÂ =Â df.null_count()
print(null_count_df)
dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "col1":Â [1,Â 2,Â 3],
Â Â Â Â Â Â Â Â "col2":Â [1,Â None,Â 3],
Â Â Â Â },
)
print(df)
fill_literal_dfÂ =Â df.with_columns(
Â Â Â Â pl.col("col2").fill_null(pl.lit(2)),
)
print(fill_literal_df)
fill_forward_dfÂ =Â df.with_columns(
Â Â Â Â pl.col("col2").fill_null(strategy="forward"),
)
print(fill_forward_df)
fill_median_dfÂ =Â df.with_columns(
Â Â Â Â pl.col("col2").fill_null(pl.median("col2")),
)
print(fill_median_df)
fill_interpolation_dfÂ =Â df.with_columns(
Â Â Â Â pl.col("col2").interpolate(),
)
print(fill_interpolation_df)</code></pre> 
 <h4>Window functions</h4> 
 <p style="text-align:left;">https://pola-rs.github.io/polars/user-guide/expressions/window/</p> 
 <pre class="has"><code class="language-go">!wgetÂ https://cdn.coggle.club/Pokemon.csv
!headÂ Pokemon.csv
#Â thenÂ let'sÂ loadÂ someÂ csvÂ dataÂ withÂ informationÂ aboutÂ pokemon
dfÂ =Â pl.read_csv("Pokemon.csv")
print(df.head())
outÂ =Â df.select(
Â Â Â Â "TypeÂ 1",
Â Â Â Â "TypeÂ 2",
Â Â Â Â pl.col("Attack").mean().over("TypeÂ 1").alias("avg_attack_by_type"),
Â Â Â Â pl.col("Defense")
Â Â Â Â .mean()
Â Â Â Â .over(["TypeÂ 1",Â "TypeÂ 2"])
Â Â Â Â .alias("avg_defense_by_type_combination"),
Â Â Â Â pl.col("Attack").mean().alias("avg_attack"),
)
print(out)
filteredÂ =Â df.filter(pl.col("TypeÂ 2")Â ==Â "Psychic").select(
Â Â Â Â "Name",
Â Â Â Â "TypeÂ 1",
Â Â Â Â "Speed",
)
print(filtered)
outÂ =Â filtered.with_columns(
Â Â Â Â pl.col(["Name",Â "Speed"]).sort_by("Speed",Â descending=True).over("TypeÂ 1"),
)
print(out)</code></pre> 
 <h4>Lists and Arrays</h4> 
 <pre class="has"><code class="language-go">weatherÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "station":Â ["StationÂ "Â +Â str(x)Â forÂ xÂ inÂ range(1,Â 6)],
Â Â Â Â Â Â Â Â "temperatures":Â [
Â Â Â Â Â Â Â Â Â Â Â Â "20Â 5Â 5Â E1Â 7Â 13Â 19Â 9Â 6Â 20",
Â Â Â Â Â Â Â Â Â Â Â Â "18Â 8Â 16Â 11Â 23Â E2Â 8Â E2Â E2Â E2Â 90Â 70Â 40",
Â Â Â Â Â Â Â Â Â Â Â Â "19Â 24Â E9Â 16Â 6Â 12Â 10Â 22",
Â Â Â Â Â Â Â Â Â Â Â Â "E2Â E0Â 15Â 7Â 8Â 10Â E1Â 24Â 17Â 13Â 6",
Â Â Â Â Â Â Â Â Â Â Â Â "14Â 8Â E0Â 16Â 22Â 24Â E1",
Â Â Â Â Â Â Â Â ],
Â Â Â Â }
)
print(weather)
outÂ =Â weather.with_columns(pl.col("temperatures").str.split("Â "))
print(out)
outÂ =Â weather.with_columns(pl.col("temperatures").str.split("Â ")).explode(
Â Â Â Â "temperatures"
)
print(out)
outÂ =Â weather.with_columns(pl.col("temperatures").str.split("Â ")).with_columns(
Â Â Â Â pl.col("temperatures").list.head(3).alias("top3"),
Â Â Â Â pl.col("temperatures").list.slice(-3,Â 3).alias("bottom_3"),
Â Â Â Â pl.col("temperatures").list.len().alias("obs"),
)
print(out)</code></pre> 
 <h3><strong>å˜å½¢</strong></h3> 
 <h4>Joins</h4> 
 <table><thead><tr><th>ç­–ç•¥</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>inner</code></td><td>è¿”å›ä¸¤ä¸ªæ•°æ®æ¡†ä¸­å…·æœ‰åŒ¹é…é”®çš„è¡Œã€‚å·¦æ¡†æˆ–å³æ¡†ä¸­çš„éåŒ¹é…è¡Œå°†è¢«ä¸¢å¼ƒã€‚</td></tr><tr><td><code>left</code></td><td>è¿”å›å·¦æ•°æ®æ¡†ä¸­çš„æ‰€æœ‰è¡Œï¼Œæ— è®ºæ˜¯å¦åœ¨å³æ•°æ®æ¡†ä¸­æ‰¾åˆ°åŒ¹é…é¡¹ã€‚éåŒ¹é…è¡Œçš„å³åˆ—å°†è¢«å¡«å……ä¸ºnullã€‚</td></tr><tr><td><code>outer</code></td><td>è¿”å›å·¦å³ä¸¤ä¸ªæ•°æ®æ¡†ä¸­çš„æ‰€æœ‰è¡Œã€‚å¦‚æœåœ¨ä¸€ä¸ªæ¡†ä¸­æ‰¾ä¸åˆ°åŒ¹é…é¡¹ï¼Œåˆ™ä»å¦ä¸€ä¸ªæ¡†ä¸­çš„åˆ—å°†è¢«å¡«å……ä¸ºnullã€‚</td></tr><tr><td><code>cross</code></td><td>è¿”å›å·¦æ¡†ä¸­çš„æ‰€æœ‰è¡Œä¸å³æ¡†ä¸­çš„æ‰€æœ‰è¡Œçš„ç¬›å¡å°”ç§¯ã€‚é‡å¤çš„è¡Œå°†è¢«ä¿ç•™ï¼›å·¦æ¡†ä¸å³æ¡†çš„äº¤å‰è¿æ¥çš„è¡¨é•¿åº¦å§‹ç»ˆä¸º<code>len(A) Ã— len(B)</code>ã€‚</td></tr><tr><td><code>asof</code></td><td>åœ¨æ­¤è¿æ¥ä¸­ï¼ŒåŒ¹é…æ˜¯æ ¹æ®<em>æœ€è¿‘</em>çš„é”®è€Œä¸æ˜¯ç›¸ç­‰çš„é”®æ‰§è¡Œçš„å·¦è¿æ¥ã€‚</td></tr><tr><td><code>semi</code></td><td>è¿”å›å·¦æ¡†ä¸­å…·æœ‰ä¸å³æ¡†ä¸­ç›¸åŒçš„è¿æ¥é”®çš„æ‰€æœ‰è¡Œã€‚</td></tr><tr><td><code>anti</code></td><td>è¿”å›å·¦æ¡†ä¸­è¿æ¥é”®<em>ä¸</em>åœ¨å³æ¡†ä¸­å‡ºç°çš„æ‰€æœ‰è¡Œã€‚</td></tr></tbody></table> 
 <pre class="has"><code class="language-go">df_customersÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "customer_id":Â [1,Â 2,Â 3],
Â Â Â Â Â Â Â Â "name":Â ["Alice",Â "Bob",Â "Charlie"],
Â Â Â Â }
)
print(df_customers)
df_ordersÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "order_id":Â ["a",Â "b",Â "c"],
Â Â Â Â Â Â Â Â "customer_id":Â [1,Â 2,Â 2],
Â Â Â Â Â Â Â Â "amount":Â [100,Â 200,Â 300],
Â Â Â Â }
)
print(df_orders)
dfÂ =Â df_customers.join(df_orders,Â on="customer_id",Â how="inner")
print(df)

dfÂ =Â df_customers.join(df_orders,Â on="customer_id",Â how="left")
print(df)

dfÂ =Â df_customers.join(df_orders,Â on="customer_id",Â how="outer")
print(df)

dfÂ =Â df_customers.join(df_orders,Â on="customer_id",Â how="cross")
print(df)
df_carsÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "id":Â ["a",Â "b",Â "c"],
Â Â Â Â Â Â Â Â "make":Â ["ford",Â "toyota",Â "bmw"],
Â Â Â Â }
)
print(df_cars)
df_repairsÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "id":Â ["c",Â "c"],
Â Â Â Â Â Â Â Â "cost":Â [100,Â 200],
Â Â Â Â }
)
print(df_repairs)
dfÂ =Â df_cars.join(df_repairs,Â on="id",Â how="inner")
print(df)

dfÂ =Â df_cars.join(df_repairs,Â on="id",Â how="semi")
print(df)

dfÂ =Â df_cars.join(df_repairs,Â on="id",Â how="anti")
print(df)
df_tradesÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "time":Â [
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2020,Â 1,Â 1,Â 9,Â 1,Â 0),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2020,Â 1,Â 1,Â 9,Â 1,Â 0),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2020,Â 1,Â 1,Â 9,Â 3,Â 0),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2020,Â 1,Â 1,Â 9,Â 6,Â 0),
Â Â Â Â Â Â Â Â ],
Â Â Â Â Â Â Â Â "stock":Â ["A",Â "B",Â "B",Â "C"],
Â Â Â Â Â Â Â Â "trade":Â [101,Â 299,Â 301,Â 500],
Â Â Â Â }
)
print(df_trades)

df_quotesÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "time":Â [
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2020,Â 1,Â 1,Â 9,Â 0,Â 0),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2020,Â 1,Â 1,Â 9,Â 2,Â 0),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2020,Â 1,Â 1,Â 9,Â 4,Â 0),
Â Â Â Â Â Â Â Â Â Â Â Â datetime(2020,Â 1,Â 1,Â 9,Â 6,Â 0),
Â Â Â Â Â Â Â Â ],
Â Â Â Â Â Â Â Â "stock":Â ["A",Â "B",Â "C",Â "A"],
Â Â Â Â Â Â Â Â "quote":Â [100,Â 300,Â 501,Â 102],
Â Â Â Â }
)

print(df_quotes)
df_asof_joinÂ =Â df_trades.join_asof(df_quotes,Â on="time",Â by="stock")
print(df_asof_join)
df_asof_tolerance_joinÂ =Â df_trades.join_asof(
Â Â Â Â df_quotes,Â on="time",Â by="stock",Â tolerance="1m"
)
print(df_asof_tolerance_join)</code></pre> 
 <h4>Concatenation</h4> 
 <pre class="has"><code class="language-go">df_v1Â =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "a":Â [1],
Â Â Â Â Â Â Â Â "b":Â [3],
Â Â Â Â }
)
df_v2Â =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "a":Â [2],
Â Â Â Â Â Â Â Â "b":Â [4],
Â Â Â Â }
)
df_vertical_concatÂ =Â pl.concat(
Â Â Â Â [
Â Â Â Â Â Â Â Â df_v1,
Â Â Â Â Â Â Â Â df_v2,
Â Â Â Â ],
Â Â Â Â how="vertical",
)
print(df_vertical_concat)
df_h1Â =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "l1":Â [1,Â 2],
Â Â Â Â Â Â Â Â "l2":Â [3,Â 4],
Â Â Â Â }
)
df_h2Â =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "r1":Â [5,Â 6],
Â Â Â Â Â Â Â Â "r2":Â [7,Â 8],
Â Â Â Â Â Â Â Â "r3":Â [9,Â 10],
Â Â Â Â }
)
df_horizontal_concatÂ =Â pl.concat(
Â Â Â Â [
Â Â Â Â Â Â Â Â df_h1,
Â Â Â Â Â Â Â Â df_h2,
Â Â Â Â ],
Â Â Â Â how="horizontal",
)
print(df_horizontal_concat)</code></pre> 
 <h4>Pivots</h4> 
 <pre class="has"><code class="language-go">dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "foo":Â ["A",Â "A",Â "B",Â "B",Â "C"],
Â Â Â Â Â Â Â Â "N":Â [1,Â 2,Â 2,Â 4,Â 2],
Â Â Â Â Â Â Â Â "bar":Â ["k",Â "l",Â "m",Â "n",Â "o"],
Â Â Â Â }
)
print(df)
outÂ =Â df.pivot(index="foo",Â columns="bar",Â values="N",Â aggregate_function="first")
print(out)
qÂ =Â (
Â Â Â Â df.lazy()
Â Â Â Â .collect()
Â Â Â Â .pivot(index="foo",Â columns="bar",Â values="N",Â aggregate_function="first")
Â Â Â Â .lazy()
)
outÂ =Â q.collect()
print(out)</code></pre> 
 <h4>Melts</h4> 
 <pre class="has"><code class="language-go">importÂ polarsÂ asÂ pl

dfÂ =Â pl.DataFrame(
Â Â Â Â {
Â Â Â Â Â Â Â Â "A":Â ["a",Â "b",Â "a"],
Â Â Â Â Â Â Â Â "B":Â [1,Â 3,Â 5],
Â Â Â Â Â Â Â Â "C":Â [10,Â 11,Â 12],
Â Â Â Â Â Â Â Â "D":Â [2,Â 4,Â 6],
Â Â Â Â }
)
print(df)
outÂ =Â df.melt(id_vars=["A",Â "B"],Â value_vars=["C",Â "D"])
print(out)</code></pre> 
 <p><strong>æœ€åçš„æœ€åï¼Œç²‰ä¸ç¦åˆ©ï¼Œé€ä¸¤æœ¬åŒ—äº¬å¤§å­¦å‡ºç‰ˆç¤¾çš„</strong><strong>ã€Šç ä¸Šè¡ŒåŠ¨ï¼šç”¨ChatGPTå­¦ä¼šP</strong><strong>ythonç¼–ç¨‹</strong><strong>ã€‹</strong>ã€‚è¿™æœ¬ä¹¦åˆ›æ–°åœ°ä»¥ChatGPTä½œä¸ºè¾…åŠ©å­¦ä¹ å·¥å…·ï¼Œç³»ç»Ÿå…¨é¢åœ°è®²è§£äº†é›¶åŸºç¡€è¯»è€…å¦‚ä½•å¿«é€Ÿæœ‰æ•ˆåœ°å­¦ä¹ Pythonç¼–ç¨‹æŠ€èƒ½ã€‚å†…å®¹æ¶µç›–Pythonå…¥é—¨é˜¶æ®µæ‰€æ¶‰åŠçš„åŸºæœ¬è¯­æ³•å’Œå¸¸è§ç”¨æ³•ï¼Œå­¦å®Œè¿™æœ¬ä¹¦ä¾¿å¯å…¥é—¨Pythonã€‚ç¤ºä¾‹ä¸°å¯Œï¼Œç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œè¯»è€…é€šè¿‡ç¤ºä¾‹ä»£ç æ›´å®¹æ˜“ç†è§£æ¦‚å¿µå¹¶è¿ç”¨åˆ°å®é™…å¼€å‘ä¸­ï¼Œå€¼å¾—ä¸€çœ‹ï¼</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/3f/4e/IlkRXJjF_o.jpg" alt="2944a5aad00d8178c350b204e5b6080e.jpeg"></p> 
 <p style="text-align:left;"><strong>è¿™æ¬¡æŠ½å¥–å½¢å¼ä¸°å¯Œç‚¹ï¼Œ</strong><strong>æœ¬æ–‡ä¸‰è¿ï¼ˆç‚¹èµã€åœ¨çœ‹æˆ–è€…è½¬å‘ä»»æ„éƒ½å¯ï¼‰åï¼š</strong></p> 
 <p style="text-align:left;"><strong>1ã€ç•™è¨€ç‚¹èµæ’åç¬¬ä¸€çš„é€ä¸€æœ¬ï¼ˆåˆ·èµå–æ¶ˆèµ„æ ¼ï¼‰</strong></p> 
 <p style="text-align:left;"><strong>2ã€åŠ æˆ‘å¾®ä¿¡å¥½å‹ï¼Œå›å¤â€œæŠ½å¥–â€ï¼ŒæŠ½å¥–é€1æœ¬</strong></p> 
 <pre class="has"><code class="language-go">ğŸ‘‡æ‰«ç åŠ æˆ‘å¥½å‹ğŸ‘‡</code></pre> 
 <p style="text-align:left;"><strong>3æœˆ8æ—¥22:00å¼€å¥–ï¼ˆä¸€ä¸ªäººæœ€å¤šåªèƒ½è·å¾—ä¸€æœ¬ï¼‰ï¼Œ<strong>ç¥å¤§å®¶å¥½è¿~</strong></strong></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3b2a243f939d496f4ec57a2b231e4d27/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">åµŒå…¥å¼ Linux ä¸‹çš„ LVGL ç§»æ¤</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2a065d9a08c616a0dae947b0a304f704/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">æ¸…é™¤æ³¨å†Œè¡¨çš„Uç›˜(USBç›˜)ä½¿ç”¨è®°å½•ï¼Œæˆ–è€…ç”µè„‘çš„Uç›˜è®°å½•</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 è€å¸…çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>