<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Cron表达式学习：每天十二点执行一次：0 0 12 * * ? - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/7400a601977ce7ebf73d1f021a6c7eb5/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="Cron表达式学习：每天十二点执行一次：0 0 12 * * ?">
  <meta property="og:description" content="首先推荐大家一个CRON表达式在线生成网站 http://cron.qqe2.com/
1.cron表达字符含义 cron表达式：* * * * * *，其实就是一个字符串，
字符串以5或6个空格隔开，分为6或7个域，每一个域代表一个含义，其中常用为六个域。
corn从左到右（用空格隔开）分别是：秒 分 小时 月份中的日期 月份 星期中的日期 年份
字段允许值允许的特殊字符秒（Seconds）0~59的整数, - * / 四个字符分（Minutes）0~59的整数, - * / 四个字符小时（Hours）0~23的整数, - * / 四个字符日期（DayofMonth）1~31的整数（但是你需要考虑你月的天数）,- * ? / L W C 八个字符月份（Month）1~12的整数或者 JAN-DEC, - * / 四个字符星期（DayofWeek）1~7的整数或者 SUN-SAT （1=SUN）, - * ? / L C # 八个字符年(可选，不常用)（Year）1970~2099, - * / 四个字符 2.corn各个字段的含义 （1）：表示匹配该域的任意值。假如在Minutes域使用, 即表示每分钟都会触发事件。
（2）?：只能用在DayofMonth和DayofWeek两个域。它也匹配域的任意值，但实际不会。因为DayofMonth和DayofWeek会相互影响。例如想在每月的20日触发调度，不管20日到底是星期几，则只能使用如下写法： 13 13 15 20 * ?, 其中最后一位只能用？，而不能使用*，如果使用*表示不管星期几都会触发，实际上并不是这样。
（3）-：表示范围。例如在Minutes域使用5-20，表示从5分到20分钟每分钟触发一次
（4）/：表示起始时间开始触发，然后每隔固定时间触发一次。例如在Minutes域使用5/20,则意味着5分钟触发一次，而25，45等分别触发一次.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-05-12T10:10:02+08:00">
    <meta property="article:modified_time" content="2022-05-12T10:10:02+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Cron表达式学习：每天十二点执行一次：0 0 12 * * ?</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="CRON_0"></a>首先推荐大家一个CRON表达式在线生成网站</h3> 
<p><a href="http://cron.qqe2.com/" rel="nofollow">http://cron.qqe2.com/</a></p> 
<h3><a id="1cron_2"></a>1.cron表达字符含义</h3> 
<p>cron表达式：* * * * * *，其实就是一个字符串，<br> 字符串以5或6个空格隔开，分为6或7个域，每一个域代表一个含义，其中常用为六个域。<br> corn从左到右（用空格隔开）分别是：秒 分 小时 月份中的日期 月份 星期中的日期 年份</p> 
<table><thead><tr><th>字段</th><th>允许值</th><th>允许的特殊字符</th></tr></thead><tbody><tr><td>秒（Seconds）</td><td>0~59的整数</td><td>, - * / 四个字符</td></tr><tr><td>分（Minutes）</td><td>0~59的整数</td><td>, - * / 四个字符</td></tr><tr><td>小时（Hours）</td><td>0~23的整数</td><td>, - * / 四个字符</td></tr><tr><td>日期（DayofMonth）</td><td>1~31的整数（但是你需要考虑你月的天数）</td><td>,- * ? / L W C 八个字符</td></tr><tr><td>月份（Month）</td><td>1~12的整数或者 JAN-DEC</td><td>, - * / 四个字符</td></tr><tr><td>星期（DayofWeek）</td><td>1~7的整数或者 SUN-SAT （1=SUN）</td><td>, - * ? / L C # 八个字符</td></tr><tr><td>年(可选，不常用)（Year）</td><td>1970~2099</td><td>, - * / 四个字符</td></tr></tbody></table> 
<h3><a id="2corn_16"></a>2.corn各个字段的含义</h3> 
<p>（1）<em>：表示匹配该域的任意值。假如在Minutes域使用</em>, 即表示每分钟都会触发事件。</p> 
<p>（2）?：只能用在DayofMonth和DayofWeek两个域。它也匹配域的任意值，但实际不会。因为DayofMonth和DayofWeek会相互影响。例如想在每月的20日触发调度，不管20日到底是星期几，则只能使用如下写法： 13 13 15 20 * ?, 其中最后一位只能用？，而不能使用*，如果使用*表示不管星期几都会触发，实际上并不是这样。</p> 
<p>（3）-：表示范围。例如在Minutes域使用5-20，表示从5分到20分钟每分钟触发一次</p> 
<p>（4）/：表示起始时间开始触发，然后每隔固定时间触发一次。例如在Minutes域使用5/20,则意味着5分钟触发一次，而25，45等分别触发一次.</p> 
<p>（5）,：表示列出枚举值。例如：在Minutes域使用5,20，则意味着在5和20分每分钟触发一次。</p> 
<p>（6）L：表示最后，只能出现在DayofWeek和DayofMonth域。如果在DayofWeek域使用5L,意味着在最后的一个星期四触发。</p> 
<p>（7）W:表示有效工作日(周一到周五),只能出现在DayofMonth域，系统将在离指定日期的最近的有效工作日触发事件。例如：在 DayofMonth使用5W，如果5日是星期六，则将在最近的工作日：星期五，即4日触发。如果5日是星期天，则在6日(周一)触发；如果5日在星期一到星期五中的一天，则就在5日触发。另外一点，W的最近寻找不会跨过月份 。</p> 
<p>（8）LW:这两个字符可以连用，表示在某个月最后一个工作日，即最后一个星期五。</p> 
<p>（9）#:用于确定每个月第几个星期几，只能出现在DayofMonth域。例如在4#2，表示某月的第二个星期三。</p> 
<h3><a id="3_35"></a>3.常用表达式示范</h3> 
<ul><li>每隔5秒执行一次：*/5 * * * * ?</li><li>每隔1分钟执行一次：0 */1 * * * ?</li><li>每小时的20分执行一次：0 20 * * * ?</li><li>每天的两点35分执行一次：0 35 2 * * ?</li><li>每月的1日的凌晨2点调整任务：0 0 2 1 * ? *</li><li>每天上午10点，下午2点，4点 执行一次：0 0 10,14,16 * * ?</li><li>每周星期天凌晨1点实行一次 ：0 0 1 ? * L</li></ul> 
<h3><a id="4cronspringboot_44"></a>4.cron表达式在springboot工程中的应用</h3> 
<p>在springboot的主类上，加上注解@EnableScheduling</p> 
<pre><code class="prism language-bash">@SpringBootApplication
@EnableScheduling
public class MybatisplusdemoApplication <span class="token punctuation">{<!-- --></span>

    public static void main<span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        SpringApplication.run<span class="token punctuation">(</span>MybatisplusdemoApplication.class, args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>编写测试类</p> 
<pre><code class="prism language-bash">package com.wyu.mybatisplusdemo.article.controller<span class="token punctuation">;</span>

<span class="token function">import</span> org.slf4j.Logger<span class="token punctuation">;</span>
<span class="token function">import</span> org.slf4j.LoggerFactory<span class="token punctuation">;</span>

<span class="token function">import</span> org.springframework.stereotype.Component<span class="token punctuation">;</span>
<span class="token function">import</span> org.springframework.scheduling.annotation.Scheduled<span class="token punctuation">;</span>

<span class="token function">import</span> java.text.SimpleDateFormat<span class="token punctuation">;</span>
<span class="token function">import</span> java.util.Date<span class="token punctuation">;</span>


@Component
public class Schedule <span class="token punctuation">{<!-- --></span>
    Logger log <span class="token operator">=</span> LoggerFactory.getLogger<span class="token punctuation">(</span>Schedule.class<span class="token punctuation">)</span><span class="token punctuation">;</span>

    //cron表达式：每隔5秒执行一次
    @Scheduled<span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"0/5 * * * * *"</span><span class="token punctuation">)</span>
    public void <span class="token function-name function">scheduled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        SimpleDateFormat simpleDateFormat <span class="token operator">=</span> new SimpleDateFormat<span class="token punctuation">(</span><span class="token string">"hh点mm分ss秒"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        // 将date日期解析为字符串
        String <span class="token function">date</span> <span class="token operator">=</span> simpleDateFormat.format<span class="token punctuation">(</span>new Date<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
        log.info<span class="token punctuation">(</span><span class="token string">"当前时间："</span> + <span class="token function">date</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<p>运行结果<br> <img src="https://images2.imgbox.com/bd/58/XYSW7Vy9_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5_cron_90"></a>5. 手写cron生成工具类</h3> 
<pre><code class="prism language-bash">@ApiModel<span class="token punctuation">(</span>description <span class="token operator">=</span> <span class="token string">"cron表达体"</span><span class="token punctuation">)</span>
@Data
@Accessors<span class="token punctuation">(</span>chain <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
@EqualsAndHashCode<span class="token punctuation">(</span><span class="token punctuation">)</span>
public class CronEntity extends Model<span class="token operator">&lt;</span>CronEntity<span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    /**
     * 周期: DAY：每天，WEEK：每周，MONTH：每月
     */
    String cycle<span class="token punctuation">;</span>

    /** 一周的哪几天 */
    String<span class="token punctuation">[</span><span class="token punctuation">]</span> dayOfWeeks<span class="token punctuation">;</span>

    /** 一个月的哪几天 */
    String<span class="token punctuation">[</span><span class="token punctuation">]</span> dayOfMonths<span class="token punctuation">;</span>

    /** 频次，一天执行多少次 */
    Integer frequency<span class="token punctuation">;</span>

    /** 时 */
    Integer hour<span class="token punctuation">;</span>

    /** 分 */
    Integer minute<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-bash">/**
 * 构建日周月的Cron表达式
 */
@Slf4j
public class CronUtil <span class="token punctuation">{<!-- --></span>

    public static String createCronExp<span class="token punctuation">(</span>CronEntity cronEntity<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        StringBuffer cronExp <span class="token operator">=</span> new StringBuffer<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cronEntity.getFrequency<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            cronEntity.setFrequency<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>null <span class="token operator">!=</span> cronEntity.getMinute<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> null <span class="token operator">!=</span> cronEntity.getHour<span class="token punctuation">(</span><span class="token punctuation">))</span> <span class="token punctuation">{<!-- --></span>
            cronExp.append<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>.append<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cronExp.append<span class="token punctuation">(</span>cronEntity.getMinute<span class="token punctuation">(</span><span class="token punctuation">))</span>.append<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cronExp.append<span class="token punctuation">(</span>cronEntity.getHour<span class="token punctuation">(</span><span class="token punctuation">))</span>.append<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            if<span class="token punctuation">(</span>cronEntity.getCycle<span class="token punctuation">(</span><span class="token punctuation">)</span>.equals<span class="token punctuation">(</span><span class="token string">"DAY"</span><span class="token punctuation">))</span><span class="token punctuation">{<!-- --></span>
                cronExp.append<span class="token punctuation">(</span><span class="token string">"*/"</span><span class="token punctuation">)</span>.append<span class="token punctuation">(</span>cronEntity.getFrequency<span class="token punctuation">(</span><span class="token punctuation">))</span>.append<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                cronExp.append<span class="token punctuation">(</span><span class="token string">"* "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                cronExp.append<span class="token punctuation">(</span><span class="token string">"?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> if<span class="token punctuation">(</span>cronEntity.getCycle<span class="token punctuation">(</span><span class="token punctuation">)</span>.equals<span class="token punctuation">(</span><span class="token string">"WEEK"</span><span class="token punctuation">))</span><span class="token punctuation">{<!-- --></span>
                cronExp.append<span class="token punctuation">(</span><span class="token string">"? "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                cronExp.append<span class="token punctuation">(</span><span class="token string">"* "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                String<span class="token punctuation">[</span><span class="token punctuation">]</span> weeks <span class="token operator">=</span> cronEntity.getDayOfWeeks<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                for<span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> weeks.length<span class="token punctuation">;</span> i++<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    if<span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        cronExp.append<span class="token punctuation">(</span>weeks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> else<span class="token punctuation">{<!-- --></span>
                        cronExp.append<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>.append<span class="token punctuation">(</span>weeks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> if<span class="token punctuation">(</span>cronEntity.getCycle<span class="token punctuation">(</span><span class="token punctuation">)</span>.equals<span class="token punctuation">(</span><span class="token string">"MONTH"</span><span class="token punctuation">))</span><span class="token punctuation">{<!-- --></span>
                String<span class="token punctuation">[</span><span class="token punctuation">]</span> days <span class="token operator">=</span> cronEntity.getDayOfMonths<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                for<span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> days.length<span class="token punctuation">;</span> i++<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    if<span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        cronExp.append<span class="token punctuation">(</span>days<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> else<span class="token punctuation">{<!-- --></span>
                        cronExp.append<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>.append<span class="token punctuation">(</span>days<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                cronExp.append<span class="token punctuation">(</span><span class="token string">" * "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                cronExp.append<span class="token punctuation">(</span><span class="token string">"?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>else <span class="token punctuation">{<!-- --></span>
            cronExp.append<span class="token punctuation">(</span><span class="token string">"Missing time parameter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            log.info<span class="token punctuation">(</span><span class="token string">"分钟小时参数未设置"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token builtin class-name">return</span> cronExp.toString<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    //测试
    public static void main<span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        CronEntity cronEntity <span class="token operator">=</span> new CronEntity<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cronEntity.setFrequency<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cronEntity.setCycle<span class="token punctuation">(</span><span class="token string">"WEEK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String<span class="token punctuation">[</span><span class="token punctuation">]</span> str <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"2"</span>,<span class="token string">"3"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        cronEntity.setDayOfWeeks<span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cronEntity.setMinute<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cronEntity.setHour<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String cronExp <span class="token operator">=</span> createCronExp<span class="token punctuation">(</span>cronEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log.info<span class="token punctuation">(</span>cronExp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_188"></a>参考文章</h3> 
<p><a href="https://www.cnblogs.com/yanghj010/p/10875151.html" rel="nofollow">cron表达式详解</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7358f9b939541ab74c2f8bee99164585/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Linux】程序的编译</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dfa85a3d764b2ba3773e86ac592c42dd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java保留小数点后两位方法（推荐使用NumberFormat）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>