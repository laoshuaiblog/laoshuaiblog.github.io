<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MATLAB 之 Simulink 子系统及其封装 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/8005807b027ec0f957b63ecdd6ffef11/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="MATLAB 之 Simulink 子系统及其封装">
  <meta property="og:description" content="这里写目录标题 一、子系统及其封装1. 子系统的创建1.1 通过 Subsystem 模块建立子系统1.2 通过已有的模块建立子系统 2. 子系统的条件执行2.1 使能子系统2.2 触发子系统2.3 使能加触发子系统 3. 子系统的封装3.1 lcon &amp;amp; Ports 选项卡的参数设置3.2 Parameters &amp;amp; Dialog 选项卡的参数设置3.3 Initialization 选项卡的参数设置3.4 Documentation 选项卡的参数设置 一、子系统及其封装 当模型的规模较大或较复杂时，用户可以把几个模块组合成一个新的模块，这样的模块称为子系统。子系统把功能上有关的一些模块集中到一起保存，能够完成几个模块的功能。建立子系统的优点是，减少系统中的模块数目，使系统易于调试，而且可以将一些常用的子系统封装成一些模块，这些模块可以在其他模型中直接作为标准的 Simulink 模块使用。 1. 子系统的创建 建立子系统有两种方法：通过 Subsystem 模块建立子系统和将已有的模块转换为子系统。两者的区别是，前者先建立子系统，再为其添加功能模块；后者先选择模块，再建立子系统。 1.1 通过 Subsystem 模块建立子系统 新建一个仿真模型，打开 Simulink 模块库中的 Ports &amp;amp; Subsystems 模块库，将 Subsystem 模块添加到模型编辑窗口中。双击 Subsystem 模块打开子系统编辑窗口，窗口中已经自动添加了相互连接的一个输入模块和输出模块（表示子系统的输入端口和输出端口）。将要组合的模块插入到输入模块和输出模块中间并重新连接，一个子系统就建好了。若双击已建立的子系统，则打开子系统内部结构窗口。 1.2 通过已有的模块建立子系统 先选择要建立子系统的模块，然后执行创建子系统的命令，原来的模块变为子系统。例如，PID 控制器是在自动控制中经常使用的模块，PID 控制器由比例单元（P）、积分单元（I）和微分单元（D）组成，PID 控制器的传递函数为 G ( S ) = K P &#43; K i S &#43; K d S G(S)=K_{P}&#43;\frac{K_{i}}{S}&#43;K_{d}S G(S)=KP​&#43;SKi​​&#43;Kd​S 我们建立 PID 控制器的模型并建立子系统。我们先建立 PID 控制器的模型，该模型具体如下图所示。 需要注意的是，模型中含有 3 个变量 K p K_{p} Kp​、 K i K_{i} Ki​ 和 K d K_{d} Kd​，仿真时这些变量应该在 MATLAB 工作空间中赋值。选中模型中所有模块，在模型编辑窗口选择 Diagram ⟶ \longrightarrow ⟶Subsystem &amp;amp; Model Deference ⟶ \longrightarrow ⟶Create Subsystem from Selection 命令，或按 Ctrl&#43;G 键建立子系统，所选模块将被一个 Subsystem 模块取代，具体如下图所示。 2.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-06-29T11:20:03+08:00">
    <meta property="article:modified_time" content="2023-06-29T11:20:03+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MATLAB 之 Simulink 子系统及其封装</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>这里写目录标题</h4> 
 <ul><li><a href="#_2" rel="nofollow">一、子系统及其封装</a></li><li><ul><li><a href="#1__5" rel="nofollow">1. 子系统的创建</a></li><li><ul><li><a href="#11__Subsystem__8" rel="nofollow">1.1 通过 Subsystem 模块建立子系统</a></li><li><a href="#12__12" rel="nofollow">1.2 通过已有的模块建立子系统</a></li></ul> 
   </li><li><a href="#2__22" rel="nofollow">2. 子系统的条件执行</a></li><li><ul><li><a href="#21__25" rel="nofollow">2.1 使能子系统</a></li><li><a href="#22__44" rel="nofollow">2.2 触发子系统</a></li><li><a href="#23__65" rel="nofollow">2.3 使能加触发子系统</a></li></ul> 
   </li><li><a href="#3__67" rel="nofollow">3. 子系统的封装</a></li><li><ul><li><a href="#31_lcon__Ports__74" rel="nofollow">3.1 lcon &amp; Ports 选项卡的参数设置</a></li><li><a href="#32_Parameters__Dialog__118" rel="nofollow">3.2 Parameters &amp; Dialog 选项卡的参数设置</a></li><li><a href="#33_Initialization__126" rel="nofollow">3.3 Initialization 选项卡的参数设置</a></li><li><a href="#34_Documentation__132" rel="nofollow">3.4 Documentation 选项卡的参数设置</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>一、子系统及其封装</h2> 
<ul><li>当模型的规模较大或较复杂时，用户可以把几个模块组合成一个新的模块，这样的模块称为子系统。</li><li>子系统把功能上有关的一些模块集中到一起保存，能够完成几个模块的功能。建立子系统的优点是，减少系统中的模块数目，使系统易于调试，而且可以将一些常用的子系统封装成一些模块，这些模块可以在其他模型中直接作为标准的 Simulink 模块使用。</li></ul> 
<h3><a id="1__5"></a>1. 子系统的创建</h3> 
<ul><li>建立子系统有两种方法：通过 Subsystem 模块建立子系统和将已有的模块转换为子系统。</li><li>两者的区别是，前者先建立子系统，再为其添加功能模块；后者先选择模块，再建立子系统。</li></ul> 
<h4><a id="11__Subsystem__8"></a>1.1 通过 Subsystem 模块建立子系统</h4> 
<ul><li>新建一个仿真模型，打开 Simulink 模块库中的 Ports &amp; Subsystems 模块库，将 Subsystem 模块添加到模型编辑窗口中。</li><li>双击 Subsystem 模块打开子系统编辑窗口，窗口中已经自动添加了相互连接的一个输入模块和输出模块（表示子系统的输入端口和输出端口）。</li><li>将要组合的模块插入到输入模块和输出模块中间并重新连接，一个子系统就建好了。若双击已建立的子系统，则打开子系统内部结构窗口。</li></ul> 
<h4><a id="12__12"></a>1.2 通过已有的模块建立子系统</h4> 
<ul><li>先选择要建立子系统的模块，然后执行创建子系统的命令，原来的模块变为子系统。</li><li><font color="red"><strong>例如，PID 控制器是在自动控制中经常使用的模块，PID 控制器由比例单元（P）、积分单元（I）和微分单元（D）组成，PID 控制器的传递函数为 <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             G 
            
           
             ( 
            
           
             S 
            
           
             ) 
            
           
             = 
            
            
            
              K 
             
            
              P 
             
            
           
             + 
            
            
             
             
               K 
              
             
               i 
              
             
            
              S 
             
            
           
             + 
            
            
            
              K 
             
            
              d 
             
            
           
             S 
            
           
          
            G(S)=K_{P}+\frac{K_{i}}{S}+K_{d}S 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0576em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.0463em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">S</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.0576em;">S</span></span></span></span></span></span> 我们建立 PID 控制器的模型并建立子系统。</strong></font></li><li>我们先建立 PID 控制器的模型，该模型具体如下图所示。</li></ul> 
<p><img src="https://images2.imgbox.com/20/16/xN4D85KI_o.png" alt="在这里插入图片描述"></p> 
<ul><li>需要注意的是，模型中含有 3 个变量 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           K 
          
         
           p 
          
         
        
       
         K_{p} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span>、<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           K 
          
         
           i 
          
         
        
       
         K_{i} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           K 
          
         
           d 
          
         
        
       
         K_{d} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，仿真时这些变量应该在 MATLAB 工作空间中赋值。</li><li>选中模型中所有模块，在模型编辑窗口选择 Diagram<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ⟶ 
         
        
       
         \longrightarrow 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.522em; vertical-align: -0.011em;"></span><span class="mrel">⟶</span></span></span></span></span>Subsystem &amp; Model Deference<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ⟶ 
         
        
       
         \longrightarrow 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.522em; vertical-align: -0.011em;"></span><span class="mrel">⟶</span></span></span></span></span>Create Subsystem from Selection 命令，或按 Ctrl+G 键建立子系统，所选模块将被一个 Subsystem 模块取代，具体如下图所示。</li></ul> 
<p><img src="https://images2.imgbox.com/a9/e4/lxTFEc52_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2__22"></a>2. 子系统的条件执行</h3> 
<ul><li>子系统的执行可以由输入信号来控制，用于控制子系统执行的信号称为控制信号，而由控制信号控制的子系统称为条件执行子系统。</li><li>在一个复杂模型中，有的模型的执行依赖于其他模块，这种情况下，条件执行子系统是很有用的。条件执行子系统分为使能子系统、触发子系统和使能加触发子系统。</li></ul> 
<h4><a id="21__25"></a>2.1 使能子系统</h4> 
<ul><li>使能子系统表示子系统在由控制信号控制时，控制信号由负变正时子系统开始执行，直到控制信号再次变为负时结束。控制信号可以是标量也可以是向量。</li><li>如果控制信号是标量，则当标量的值大于 0 时子系统开始执行。如果控制信号是向量，则向量中任何一个元素大于 0 ，子系统将执行。</li><li>使能子系统外观上有一个 “使能” 控制信号输入口。“使能” 是指当且仅当 “使能” 输入信号为正时，该模块才接收输入端的信号。可直接选择 Enabled Subsystem 模块来建立使能子系统，双击 Enabled Subsystem 模块，打开其内部结构窗口，具体如下图所示。</li></ul> 
<p><img src="https://images2.imgbox.com/b7/a4/Ot8HZZEF_o.png" alt="在这里插入图片描述"></p> 
<ul><li>也可以展开已有子系统，添加 Ports &amp; Subsystems 模块库中的 Enable 模块，将该子系统转换为使能子系统。</li><li><font color="red"><strong>例如，我们利用使能子系统构成一个正弦半波整流器。</strong></font></li><li>对此，我们新建一个仿真模型，将 Sine Wave、Enabled Subsystem 和 Scope 这 3 个模块拖至新打开的模型编辑窗口，连接各模块，设置参数并存盘，创建如下图所示的使能子系统。其中使能信号端接 Sine Wave 模块。</li></ul> 
<p><img src="https://images2.imgbox.com/53/84/o9hZRsKz_o.png" alt="在这里插入图片描述"></p> 
<ul><li>为了便于比较，除显示半波整流波形外，还显示正弦波，故在示波器窗口选择 View<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ⟶ 
         
        
       
         \longrightarrow 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.522em; vertical-align: -0.011em;"></span><span class="mrel">⟶</span></span></span></span></span>Configuration Properties 命令，在出现的对话框中将 Number of input ports 设置为 2 并设置输出布局（Layout）。</li><li>使能子系统建立好后，可对 Enable 模块进行参数设置。先双击 Enabled Subsystem 模块，打开其内部结构窗口，再双击其中的 Enable 模块打开其参数对话框，如下图所示。</li></ul> 
<p><img src="https://images2.imgbox.com/08/fd/u7FNeIof_o.png" alt="在这里插入图片描述"></p> 
<ul><li>在 Main 选项卡中勾选 Show output port 复选框，可以为 Enable 模块添加一个输出端，用以输出控制信号。在 States when enabling 下拉列表框中有两个选项：held 表示当使能子系统停止输出后，输出端口的值保持最近的输出值；reset 表示当使能子系统停止输出后，输出端口重新设为初始值。这里选择 reset 选项。设置完成后，单击 OK 按钮。</li><li>在模型编辑窗口单击工具栏 Run 命令按钮，就可以看到如下图所示的半波整流波形和正弦波形。</li></ul> 
<p><img src="https://images2.imgbox.com/8a/30/bC4VTGoM_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="22__44"></a>2.2 触发子系统</h4> 
<ul><li>触发子系统是指当触发事件发生时开始执行子系统。与使能子系统相类似，触发子系统的建立可直接选择 Triggered Subsystem 模块，或者展开已有子系统，添加 Ports &amp; Subsystems 模块库中的 Trigger 模块，将该子系统转换为触发子系统。</li><li>触发子系统在每次触发结束到下次触发之前总是保持上一次的输出值，而不会重新设置初始输出值。</li><li>触发形式在 Trigger 模块参数对话框中从 Main 选项卡的 Trigger type 下拉列表框中选择，如下图所示。</li></ul> 
<p><img src="https://images2.imgbox.com/65/81/gYW2f3og_o.png" alt="在这里插入图片描述"></p> 
<ul><li>（1） rising（上跳沿触发）：控制信号从负值或 0 上升到正值时子系统开始执行。</li><li>（2） falling（下跳沿触发）：控制信号从正值或 0 下降到负值时子系统开始执行。</li><li>（3） either（上跳沿或下跳沿触发）：当控制信号满足上跳沿或下跳沿触发条件时，子系统开始执行。</li><li>（4） function-call（函数调用触发）：表示子系统的触发由 S 函数的内部逻辑决定，这种触发方式必须与 S 函数配合使用。</li><li>Trigger 模块参数对话框中，还有一个 Show output port 复选框，表示是否为 Trigger 模块添加一个输出端，勾选后还可以选择输出信号的类型。</li><li><font color="red"><strong>例如，我们利用触发子系统将一锯齿波转换成方波。</strong></font></li><li>用 Signal Generator、Triggered Subsystem 和 Scope 模块构成如下图所示的子系统。</li></ul> 
<p><img src="https://images2.imgbox.com/5e/64/pKOMTHnD_o.png" alt="在这里插入图片描述"></p> 
<ul><li>双击 Signal Generator 模块图标，在 Wave form 下拉列表框中选择 sawtooth 选项，即锯齿波，幅值（Amplitude）设为 4，频率（Frequency）设为 1Hz。</li><li>打开 Triggered Subsystem 模块结构窗口，再双击 Trigger 模块，在其参数对话框中设置 Trigger type 触发事件形式为 either，即上跳沿或下跳沿触发。触发信号端接锯齿波模块。</li><li>为了便于比较，除显示方波外，还显示锯齿波，故在示波器属性窗口将 Number of input ports 设置为 2 并设置输出布局（Layout）。</li><li>把仿真的终止时间设置为 10，单击模型编辑窗口工具栏中的 Run 按钮，就可在示波器窗口看到如下图所示的波形。</li></ul> 
<p><img src="https://images2.imgbox.com/a2/aa/SOnEQP07_o.png" alt=""></p> 
<h4><a id="23__65"></a>2.3 使能加触发子系统</h4> 
<ul><li>所谓使能加触发子系统就是当使能控制信号和触发控制信号共同作用时执行子系统。该系统的行为方式与触发子系统相似，但只有当使能信号为正时，触发事件才起作用。</li></ul> 
<h3><a id="3__67"></a>3. 子系统的封装</h3> 
<ul><li>在对子系统进行参数设置时，需要打开其中的每个模块，然后分别进行参数设置，子系统本身没有基于整体的独立操作界面，从而使子系统的应用受到很大的限制，为解决这些问题，Simulink 提供了子系统封装技术。</li><li>所谓子系统的封装，就是为子系统定制对话框和图标，使子系统本身有一个独立的操作界面，把子系统中的各模块的参数设置合成在一个参数设置对话框内，在使用时不必打开每个模块进行参数设置，这样使子系统的使用更加方便。</li><li>子系统的封装过程很简单，先选中所要封装的子系统，再在模型编辑窗口选择 Diagram<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ⟶ 
         
        
       
         \longrightarrow 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.522em; vertical-align: -0.011em;"></span><span class="mrel">⟶</span></span></span></span></span>Mask<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ⟶ 
         
        
       
         \longrightarrow 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.522em; vertical-align: -0.011em;"></span><span class="mrel">⟶</span></span></span></span></span>Create Mask 命令，或按 Ctrl+M 键，这时将出现 “封装编辑器”（Mask Editor）窗口，如下图所示。</li></ul> 
<p><img src="https://images2.imgbox.com/ee/7f/BzL7jAZR_o.png" alt="在这里插入图片描述"></p> 
<ul><li>Mask Editor 窗口中共包括 4 个选项卡：Icon &amp; Ports、Parameters &amp; Dialog、Initialization 和 Documentation。子系统的封装主要就是对这 4 个选项卡的参数进行设置。</li></ul> 
<h4><a id="31_lcon__Ports__74"></a>3.1 lcon &amp; Ports 选项卡的参数设置</h4> 
<ul><li>Icon &amp; Ports 选项卡主要用于设置封装模块的图标，图标包括描述文字、状态方程、图像和图形，如上图所示。</li><li>（1） lcon drawing commands 编辑框。该编辑框用于输入命令以建立封装图标，常用绘图命令如下。</li><li>① 显示文本。在封装图标中显示文本的函数有 4 个：<code>disp</code>、<code>text</code>、<code>fprintf</code> 和 <code>port_lable</code>。</li><li>下面我们介绍 <code>port_lable</code> 函数的用法。<code>port_label</code> 函数根据端口类型和端口号为端口添加标记，其调用格式如下：</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">port_label</span><span class="token punctuation">(</span><span class="token char">'port_type'</span><span class="token punctuation">,</span>port_num<span class="token punctuation">,</span><span class="token char">'label'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>下面以使能子系统为例，在 Icon drawing commands 编辑框中输入如下命令：</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">disp</span><span class="token punctuation">(</span><span class="token char">'Enable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">port_label</span><span class="token punctuation">(</span><span class="token char">'input'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token char">'IN'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">port_label</span><span class="token punctuation">(</span><span class="token char">'output'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token char">'OUT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>则新生成的子系统图标如下图所示。</li></ul> 
<p><img src="https://images2.imgbox.com/ec/b7/Y3nhLpUK_o.png" alt="在这里插入图片描述"></p> 
<ul><li>如果命令输入不正确时，Simulink 将在子系统图标方框内显示 3 个问号。</li><li>② 显示图形图像。在图标中显示图形可以用 <code>plot</code> 函数、<code>patch</code> 函数和 <code>image</code> 函数。例如，想在图标上画出一个圆，则可在编辑框中使用下列命令：</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0.1</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0.1</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>又如，将当前文件夹的图形文件 flower.jpg 显示在子系统图标上，可使用下列命令：</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">image</span><span class="token punctuation">(</span><span class="token function">imread</span><span class="token punctuation">(</span><span class="token char">'flower.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>显示传递函数。在图标中显示传递函数使用 <code>dpoly</code> 函数，显示零极点模型的传递函数使用 <code>droots</code> 函数，其调用格式如下：</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">dpoly</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span>den<span class="token punctuation">)</span>
<span class="token function">dpoly</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span>den<span class="token punctuation">,</span><span class="token char">'character'</span><span class="token punctuation">)</span>
<span class="token function">droots</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span>p<span class="token punctuation">,</span>k<span class="token punctuation">)</span>
<span class="token function">droots</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span>p<span class="token punctuation">,</span>k<span class="token punctuation">,</span><span class="token char">'character'</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>其中，<code>num</code> 和 <code>den</code> 是传递函数的分子和分母的系数行向量，z 和 p 是传递函数的零点向量和极点向量，k 是传递函数的增益。</li><li>传递函数的默认变量是 s，也可以用 character 参数指定。character 的取值为 x 时，按 x 的降幂排列。取 x- 时，按 1/x 升幂排列。</li><li>（2） 设置封装图标特性。选择 Icon &amp; Ports 选项卡，左侧的 Options 区用于指定封装图标的属性，包括是否显示块框架、图标的透明度等。</li><li>① Block frame：设置图标的边框，在其下拉列表框中有两个选项：Invisible 和 Visible，分别表示隐藏和显示边框。</li><li>② Icon transparency：设置图标的透明度，在其下拉列表框中有两个选项：Transparent 表示透明，显示图标中的内容；Opaque 表示不透明，不显示图标中的内容。</li><li>③ Icon units：设置在 Icon drawing commands 编辑框中使用命令 plot 和 text 时的坐标系。在下拉列表框中有 3 个选项。</li><li>Autoscale 表示规定图标的左下角的坐标为 (0,0)，右上角的坐标为 (1,1)，要显示的文本等必须把坐标设在 [0,1] 之间才能显示，当模块大小改变时，图标也随之改变。</li><li>Pixels 表示图标以像素为单位，当模块大小改变时，图标不随之改变。</li><li>Normalized 表示根据设定的坐标点自动选取坐标系，使设置中的最小坐标位于图标左下角，最大坐标位于图标右上角。当模块大小改变时，图标也随之改变。</li><li>④ lcon rotation：设置图标是否跟模块一起旋转，在其下拉列表框中有两个选项：Fixed 表示不旋转，Rotates 表示旋转。</li><li>⑤ Port rotation：设置端口旋转方式，在其下拉列表框中有两个选项：Default 表示图形旋转时，端口信号流向从由上至下变为由左至右；Physical 表示信号流向相对位置不作变化。</li></ul> 
<h4><a id="32_Parameters__Dialog__118"></a>3.2 Parameters &amp; Dialog 选项卡的参数设置</h4> 
<ul><li>Parameters &amp; Dialog 选项卡主要用来设置参数和对话框，此选项卡由 3 部分组成：左侧为控件工具箱（Controls），中间的 Dialog box 区域显示对话框中的控件，右侧的 Property editor 区域用于显示和修改控件的属性。</li><li>下面，我们以 PID 控制器子系统为例，说明子系统参数和对话框的设置方法。</li><li>在 Parameters &amp; Dialog 选项卡的左侧控件工具箱中，连续 3 次单击 Edit 按钮，为 PID 控制器的 3 个变量准备输入位置。</li><li>双击 Dialog box 区域的列表中的 #1，在 Prompt 栏中输入该控件的提示信息，如 Proportional Kp，在 Name 栏中输入控件名 Kp，同样的方法设置 Ki 和 Kd，如下图所示，最后单击 OK 按钮确认设置。</li></ul> 
<p><img src="https://images2.imgbox.com/a1/eb/KUdfADSX_o.png" alt="在这里插入图片描述"></p> 
<ul><li>子系统参数和对话框设置完成后，双击子系统图标将出现其参数对话框。</li></ul> 
<h4><a id="33_Initialization__126"></a>3.3 Initialization 选项卡的参数设置</h4> 
<ul><li>Initialization 选项卡用于设置初始化命令。</li><li>初始化命令的设置在对话框的 Initialization commands编辑框中进行，在此输入初始化命令，而这些初始化命令将在仿真开始，载入模型、更换模块图标和重设封装子系统的图标时被调用。</li><li>初始化命令主要用来定义封装子系统的变量，这些变量可以被所有封装定义的初始化命令、封装子系统中的模块和绘制图标的命令所使用。</li><li>初始化的命令由 MATLAB 中的表达式组成，其中包括 MATLAB 函数、操作符和封装子系统工作区中定义的变量，但这些变量不包括基本工作区中的变量。</li><li>对于封装子系统工作区中定义的变量，通过初始化命令和模块的参数相联系，也就是说模块的参数在获取数据时，先读取封装子系统工作区的变量值，再通过初始化命令来取值。</li></ul> 
<h4><a id="34_Documentation__132"></a>3.4 Documentation 选项卡的参数设置</h4> 
<ul><li>Documentation 选项卡用于定义封装模块的类型、描述和帮助文本。</li><li>Type 编辑框中输入的字符串（如 PIDController）作为封装模块的名称将显示在封装模块参数对话框的顶部。</li><li>Description 编辑框中输入的字符串作为封装模块的注释将显示在封装模块参数对话框的上部（封装模块的名称下面）。</li><li>Help 编辑框中输入的字符串作为封装模块的帮助信息，当单击模块参数对话框的 Help 按钮时，将在 MATLAB 浏览器中显示。</li><li>封装信息设置完成后，单击 OK 按钮，这样就可以在其他系统模型中直接使用该模块了。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b3b83992419f0bc24d7a5fc9e69b58ef/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何让Windows应用程序在后台全速运行？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dca931a99d09ad7453fe95d36c1d3276/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java高级编程——Java9&amp;Java10&amp;Java11新特性</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>