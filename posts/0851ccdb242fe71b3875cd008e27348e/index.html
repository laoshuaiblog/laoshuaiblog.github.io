<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>主机访问服务器上虚拟机ttl超时,手动配置网关，解决VMWare虚拟机内可以访问主机但无法访问互联网的问题... - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/0851ccdb242fe71b3875cd008e27348e/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="主机访问服务器上虚拟机ttl超时,手动配置网关，解决VMWare虚拟机内可以访问主机但无法访问互联网的问题...">
  <meta property="og:description" content="常常都被虚拟机的网络折腾得颠三倒四，做点笔记吧。
问题：选择NAT后并配置好IP和NetMask之后，可以ping通主机，但连不通Internet。
解决：手动配置默认网关。
步骤：
在虚拟网络编辑器里，找到网关配置，这里是192.168.171.2 。
在虚拟机设置里，确认选择NAT。
IP和NetMask已经配置：
[root@localhost ~]# ifconfig ens33
ens33: flags=4163 mtu 1500
inet 192.168.171.128 netmask 255.255.255.0 broadcast 192.168.171.255
inet6 fe80::20c:29ff:feba:ba7c prefixlen 64 scopeid 0x20
ether 00:0c:29:ba:ba:7c txqueuelen 1000 (Ethernet)
RX packets 281023 bytes 361357640 (344.6 MiB)
RX errors 0 dropped 0 overruns 0 frame 0
TX packets 68897 bytes 14016800 (13.3 MiB)
TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0
可以Ping通主机，但无法连接Internet：
[root@localhost ~]# ping 192.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-08-12T02:55:58+08:00">
    <meta property="article:modified_time" content="2021-08-12T02:55:58+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">主机访问服务器上虚拟机ttl超时,手动配置网关，解决VMWare虚拟机内可以访问主机但无法访问互联网的问题...</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>常常都被虚拟机的网络折腾得颠三倒四，做点笔记吧。</p> 
 <p>问题：选择NAT后并配置好IP和NetMask之后，可以ping通主机，但连不通Internet。</p> 
 <p>解决：手动配置默认网关。</p> 
 <p>步骤：</p> 
 <p>在虚拟网络编辑器里，找到网关配置，这里是192.168.171.2 。</p> 
 <p>在虚拟机设置里，确认选择NAT。</p> 
 <p>IP和NetMask已经配置：</p> 
 <p>[root@localhost ~]# ifconfig ens33</p> 
 <p>ens33: flags=4163 mtu 1500</p> 
 <p>inet 192.168.171.128 netmask 255.255.255.0 broadcast 192.168.171.255</p> 
 <p>inet6 fe80::20c:29ff:feba:ba7c prefixlen 64 scopeid 0x20</p> 
 <p>ether 00:0c:29:ba:ba:7c txqueuelen 1000 (Ethernet)</p> 
 <p>RX packets 281023 bytes 361357640 (344.6 MiB)</p> 
 <p>RX errors 0 dropped 0 overruns 0 frame 0</p> 
 <p>TX packets 68897 bytes 14016800 (13.3 MiB)</p> 
 <p>TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0</p> 
 <p>可以Ping通主机，但无法连接Internet：</p> 
 <p>[root@localhost ~]# ping 192.168.171.1</p> 
 <p>PING 192.168.171.1 (192.168.171.1) 56(84) bytes of data.</p> 
 <p>64 bytes from 192.168.171.1: icmp_seq=1 ttl=128 time=0.416 ms</p> 
 <p>64 bytes from 192.168.171.1: icmp_seq=2 ttl=128 time=0.318 ms</p> 
 <p>64 bytes from 192.168.171.1: icmp_seq=3 ttl=128 time=0.348 ms</p> 
 <p>64 bytes from 192.168.171.1: icmp_seq=4 ttl=128 time=0.262 ms</p> 
 <p>^C</p> 
 <p>— 192.168.171.1 ping statistics —</p> 
 <p>4 packets transmitted, 4 received, 0% packet loss, time 3001ms</p> 
 <p>rtt min/avg/max/mdev = 0.262/0.336/0.416/0.055 ms</p> 
 <p>[root@localhost ~]# ping 8.8.8.8</p> 
 <p>connect: Network is unreachable</p> 
 <p>检查路由表：</p> 
 <p>[root@localhost ~]# netstat -nr</p> 
 <p>Kernel IP routing table</p> 
 <p>Destination Gateway Genmask Flags MSS Window irtt Iface</p> 
 <p>192.168.122.0 0.0.0.0 255.255.255.0 U 0 0 0 virbr0</p> 
 <p>192.168.171.0 0.0.0.0 255.255.255.0 U 0 0 0 ens33</p> 
 <p>手动添加网关：</p> 
 <p>[root@localhost ~]# route add default gw 192.168.171.2</p> 
 <p>[root@localhost ~]# netstat -nr</p> 
 <p>Kernel IP routing table</p> 
 <p>Destination Gateway Genmask Flags MSS Window irtt Iface</p> 
 <p>0.0.0.0 192.168.171.2 0.0.0.0 UG 0 0 0 ens33</p> 
 <p>192.168.122.0 0.0.0.0 255.255.255.0 U 0 0 0 virbr0</p> 
 <p>192.168.171.0 0.0.0.0 255.255.255.0 U 0 0 0 ens33</p> 
 <p>再次尝试：</p> 
 <p>[root@localhost ~]# ping 8.8.8.8</p> 
 <p>PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.</p> 
 <p>64 bytes from 8.8.8.8: icmp_seq=1 ttl=128 time=23.4 ms</p> 
 <p>64 bytes from 8.8.8.8: icmp_seq=2 ttl=128 time=26.5 ms</p> 
 <p>64 bytes from 8.8.8.8: icmp_seq=3 ttl=128 time=22.5 ms</p> 
 <p>64 bytes from 8.8.8.8: icmp_seq=4 ttl=128 time=29.2 ms</p> 
 <p>^C</p> 
 <p>— 8.8.8.8 ping statistics —</p> 
 <p>4 packets transmitted, 4 received, 0% packet loss, time 3007ms</p> 
 <p>rtt min/avg/max/mdev = 22.524/25.448/29.255/2.666 ms</p> 
 <p>删除刚刚添加的网关，重现之前的错误：</p> 
 <p>[root@localhost ~]# route del default gw 192.168.171.2</p> 
 <p>[root@localhost ~]# netstat -nr</p> 
 <p>Kernel IP routing table</p> 
 <p>Destination Gateway Genmask Flags MSS Window irtt Iface</p> 
 <p>192.168.122.0 0.0.0.0 255.255.255.0 U 0 0 0 virbr0</p> 
 <p>192.168.171.0 0.0.0.0 255.255.255.0 U 0 0 0 ens33</p> 
 <p>[root@localhost ~]# ping 8.8.8.8</p> 
 <p>connect: Network is unreachable</p> 
 <p>参考链接：</p> 
 <p>https://www.freebsd.org/doc/h… https://unix.stackexchange.co…</p> 
 <p>本文由乐趣区整理发布，转载请注明出处，谢谢。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b7998c423d3250e6bf78302e0e7b3f08/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">逆水寒服务器维护7月5号,逆水寒7月5日更新了什么内容_更新优化后最低配置要求...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/18bc44767d1dfdfdf38922824d1a7329/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">小米电视显示无服务器,小米电视摇控器没反应有什么解决办法？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>