<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>netty http3功能从零开始 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/a5df0be0cad062faab064d86167cb57c/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="netty http3功能从零开始">
  <meta property="og:description" content="1、windows安装jdk和mvn、gradle、gloovy 配置环境变量JAVA_HOME CLASSPATH MVN_HOME GRADLE_HOME GLOOVY_HOME mvn和gradle都是用来管理和编译java项目的，mvn比较老，现在一般用gradle 2、vscode环境 vscode安装extension：Extension Pack for java 设置-&amp;gt;extension-&amp;gt;java 修改setting.json { &#34;java.jdt.ls.java.home&#34;: &#34;D:\\Program Files\\Java\\jdk-20&#34;, &#34;java.semanticHighlighting.enabled&#34;: true, &#34;editor.suggestSelection&#34;: &#34;first&#34;, &#34;vsintellicode.modify.editor.suggestSelection&#34;: &#34;automaticallyOverrodeDefaultValue&#34;, &#34;java.configuration.checkProjectSettingsExclusions&#34;: false, &#34;git.ignoreWindowsGit27Warning&#34;: true, &#34;java.requirements.JDK11Warning&#34;: false, &#34;java.eclipse.downloadSources&#34;: true, &#34;java.maven.downloadSources&#34;: true, &#34;java.configuration.maven.globalSettings&#34;: &#34;D:\\Program Files\\apache-maven-3.9.2\\conf\\settings.xml&#34;, &#34;java.debug.settings.exceptionBreakpoint.skipClasses&#34;: [ ], } 修改环境变量（JAVA_home）：
3、创建新项目 idea可以直接创建，但我用的vscode，不知道怎么创建
在cmd内使用gradle命令创建（gradle init --type java-application）：
执行完毕后可以看到生成了一些文件：
修改build.gradle文件：
plugins { id &#39;java&#39; //配合shadowJar将依赖的jar打在一个包里 id &#39;com.github.johnrengelman.shadow&#39; version &#39;2.0.4&#39; } group &#39;hyper.http.server&#39; version &#39;1.0-SNAPSHOT&#39; //很多镜像被墙或者速度很慢，需要设置代理 repositories { maven { url &#39;https://maven.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-02T15:48:06+08:00">
    <meta property="article:modified_time" content="2024-01-02T15:48:06+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">netty http3功能从零开始</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1windowsjdkmvngradlegloovy_0"></a>1、windows安装jdk和mvn、gradle、gloovy</h2> 
<pre><code> 配置环境变量JAVA_HOME  CLASSPATH   MVN_HOME GRADLE_HOME GLOOVY_HOME
 mvn和gradle都是用来管理和编译java项目的，mvn比较老，现在一般用gradle
</code></pre> 
<h2><a id="2vscode_4"></a>2、vscode环境</h2> 
<pre><code> vscode安装extension：Extension Pack for java
 设置-&gt;extension-&gt;java 修改setting.json
</code></pre> 
<pre><code class="prism language-go"><span class="token punctuation">{<!-- --></span>
    <span class="token string">"java.jdt.ls.java.home"</span><span class="token punctuation">:</span> <span class="token string">"D:\\Program Files\\Java\\jdk-20"</span><span class="token punctuation">,</span>
    <span class="token string">"java.semanticHighlighting.enabled"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string">"editor.suggestSelection"</span><span class="token punctuation">:</span> <span class="token string">"first"</span><span class="token punctuation">,</span>
    <span class="token string">"vsintellicode.modify.editor.suggestSelection"</span><span class="token punctuation">:</span> <span class="token string">"automaticallyOverrodeDefaultValue"</span><span class="token punctuation">,</span>
    <span class="token string">"java.configuration.checkProjectSettingsExclusions"</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string">"git.ignoreWindowsGit27Warning"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string">"java.requirements.JDK11Warning"</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string">"java.eclipse.downloadSources"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string">"java.maven.downloadSources"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string">"java.configuration.maven.globalSettings"</span><span class="token punctuation">:</span> <span class="token string">"D:\\Program Files\\apache-maven-3.9.2\\conf\\settings.xml"</span><span class="token punctuation">,</span>
    <span class="token string">"java.debug.settings.exceptionBreakpoint.skipClasses"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>

    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre> 
<p>修改环境变量（JAVA_home）：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/d6/18/OhaJKE0G_o.png"></p> 
<h2><a id="3_29"></a>3、创建新项目</h2> 
<p>idea可以直接创建，但我用的vscode，不知道怎么创建<br> 在cmd内使用gradle命令创建（gradle init --type java-application）：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/a3/eb/k72zNwwI_o.png"><br> 执行完毕后可以看到生成了一些文件：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/ca/be/gF48XpEZ_o.png"><br> 修改build.gradle文件：</p> 
<pre><code class="prism language-c">
plugins <span class="token punctuation">{<!-- --></span>
   id <span class="token char">'java'</span>
   <span class="token comment">//配合shadowJar将依赖的jar打在一个包里</span>
   id <span class="token char">'com.github.johnrengelman.shadow'</span> version <span class="token char">'2.0.4'</span>
<span class="token punctuation">}</span>

group <span class="token char">'hyper.http.server'</span>
version <span class="token char">'1.0-SNAPSHOT'</span>

<span class="token comment">//很多镜像被墙或者速度很慢，需要设置代理</span>
repositories <span class="token punctuation">{<!-- --></span>
    maven <span class="token punctuation">{<!-- --></span>
      url 'https<span class="token operator">:</span><span class="token comment">//maven.aliyun.com/repository/central/'</span>
    <span class="token punctuation">}</span>
    maven <span class="token punctuation">{<!-- --></span>
      url 'https<span class="token operator">:</span><span class="token comment">//maven.aliyun.com/repository/public/'</span>
    <span class="token punctuation">}</span>
    maven <span class="token punctuation">{<!-- --></span>
      url 'https<span class="token operator">:</span><span class="token comment">//maven.aliyun.com/repository/spring/'</span>
    <span class="token punctuation">}</span>    
    maven <span class="token punctuation">{<!-- --></span>
      url 'https<span class="token operator">:</span><span class="token comment">//maven.aliyun.com/repository/google/'</span>
    <span class="token punctuation">}</span>
    maven <span class="token punctuation">{<!-- --></span>
      url 'https<span class="token operator">:</span><span class="token comment">//maven.aliyun.com/repository/gradle-plugin/'</span>
    <span class="token punctuation">}</span>
    maven <span class="token punctuation">{<!-- --></span>
      url 'https<span class="token operator">:</span><span class="token comment">//maven.aliyun.com/repository/spring-plugin/'</span>
    <span class="token punctuation">}</span>
	maven <span class="token punctuation">{<!-- --></span> url <span class="token char">'https://www.jitpack.io'</span> <span class="token punctuation">}</span>
    <span class="token function">mavenLocal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

dependencies <span class="token punctuation">{<!-- --></span>
    implementation <span class="token string">"io.netty:netty-all:4.1.78.Final"</span>
    implementation <span class="token string">"io.netty:netty-codec-http:4.1.78.Final"</span>
	implementation <span class="token string">"io.netty.incubator:netty-incubator-codec-http3:0.0.12.Final"</span>
    implementation 'io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token operator">:</span>netty<span class="token operator">-</span>incubator<span class="token operator">-</span>codec<span class="token operator">-</span>quic<span class="token operator">:</span><span class="token number">0.0</span><span class="token number">.12</span><span class="token punctuation">.</span>Final'
    implementation 'io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token operator">:</span>netty<span class="token operator">-</span>incubator<span class="token operator">-</span>codec<span class="token operator">-</span>native<span class="token operator">-</span>quic<span class="token operator">:</span><span class="token number">0.0</span><span class="token number">.28</span><span class="token punctuation">.</span>Final'
<span class="token punctuation">}</span>

java <span class="token punctuation">{<!-- --></span>
    toolchain <span class="token punctuation">{<!-- --></span>
        languageVersion <span class="token operator">=</span> JavaLanguageVersion<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

shadowJar <span class="token punctuation">{<!-- --></span>
    baseName <span class="token operator">=</span> <span class="token char">'hyperhttp'</span>
    version <span class="token operator">=</span> <span class="token char">'1.0-SNAPSHOT'</span>
    classifier <span class="token operator">=</span> null
    manifest <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//attributes 'Main-Class': 'com.example.Main'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="4netty_98"></a>4、netty环境</h3> 
<h4><a id="41__99"></a>4.1 代码下载</h4> 
<p>首先根据jdk环境和netty分支，选择jdk版本对应的分支，jdk换版本会有很多莫名其妙的问题。<br> 源码路径：https://github.com/netty/netty<br> netty的pom.xml总指定了jdk版本：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/40/36/Ab4mfADC_o.png"><br> 还要下载netty-incubator-codec-quic用来编译netty-quiche-xxx.so,libquiche.so等<br> （建议用linux环境，windows用dll但更麻烦一些，工具安装麻烦，问题也多）<br> https://github.com/netty/netty-incubator-codec-quic</p> 
<p>可以使用IntellJ的右键Dependency analazy选择正确的版本，到没有版本冲突为止</p> 
<h4><a id="42_nettyincubatorcodecquic_109"></a>4.2 编译netty-incubator-codec-quic</h4> 
<p>需要安装c、c++、rust和go相关的软件，包括rust（curl --proto ‘=https’ --tlsv1.2 -sSf https://sh.rustup.rs | sh）、c++（sudo apt install build-essential）、cmake（https://cmake.org/download/，apt install cmake）、Ninja（https://github.com/ninja-build/ninja/releases，apt install ninja-build）、go（apt install golang）、nasm（https://www.nasm.us/pub/nasm/releasebuilds/），autoreconf（sudo apt install -y autoconf automake libtool），还有其他工具，按照错误提示安装。<br> 先执行（不然编译过程中下载代码会失败）：</p> 
<pre><code class="prism language-c">git config <span class="token operator">--</span>global url<span class="token punctuation">.</span><span class="token string">"https://github.com/google/boringssl.git"</span><span class="token punctuation">.</span>insteadOf <span class="token string">"https://boringssl.googlesource.com/boringssl"</span></code></pre> 
<p>在代码目录下执行：mvn compile -X（X是为了看到错误细节）<br> 执行完会生成libquiche.so<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/8d/15/UpHgNUEn_o.png"></p> 
<p>继续执行mvn install -Dmaven.test.skip=true<br> 执行完会生成libnetty_quiche_xxx.so，install过程中会自动将生成的库设置好动态链接：</p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> libtool<span class="token operator">:</span> install<span class="token operator">:</span> <span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>install <span class="token operator">-</span>c <span class="token punctuation">.</span>libs<span class="token operator">/</span>libnetty_quiche_linux_x86_64<span class="token operator">-</span><span class="token number">0.0</span><span class="token number">.46</span><span class="token punctuation">.</span>Final<span class="token punctuation">.</span>so <span class="token operator">/</span>home<span class="token operator">/</span>http3<span class="token operator">/</span>netty<span class="token operator">-</span>incubator<span class="token operator">-</span>codec<span class="token operator">-</span>quic<span class="token operator">-</span><span class="token number">46</span><span class="token operator">/</span>codec<span class="token operator">-</span>native<span class="token operator">-</span>quic<span class="token operator">/</span>target<span class="token operator">/</span>native<span class="token operator">-</span>build<span class="token operator">/</span>target<span class="token operator">/</span>lib<span class="token operator">/</span>libnetty_quiche_linux_x86_64<span class="token operator">-</span><span class="token number">0.0</span><span class="token number">.46</span><span class="token punctuation">.</span>Final<span class="token punctuation">.</span>so
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> libtool<span class="token operator">:</span> install<span class="token operator">:</span> <span class="token punctuation">(</span>cd <span class="token operator">/</span>home<span class="token operator">/</span>http3<span class="token operator">/</span>netty<span class="token operator">-</span>incubator<span class="token operator">-</span>codec<span class="token operator">-</span>quic<span class="token operator">-</span><span class="token number">46</span><span class="token operator">/</span>codec<span class="token operator">-</span>native<span class="token operator">-</span>quic<span class="token operator">/</span>target<span class="token operator">/</span>native<span class="token operator">-</span>build<span class="token operator">/</span>target<span class="token operator">/</span>lib <span class="token operator">&amp;&amp;</span> <span class="token punctuation">{<!-- --></span> ln <span class="token operator">-</span>s <span class="token operator">-</span>f libnetty_quiche_linux_x86_64<span class="token operator">-</span><span class="token number">0.0</span><span class="token number">.46</span><span class="token punctuation">.</span>Final<span class="token punctuation">.</span>so libnetty_quiche_linux_x86_64<span class="token punctuation">.</span>so <span class="token operator">||</span> <span class="token punctuation">{<!-- --></span> rm <span class="token operator">-</span>f libnetty_quiche_linux_x86_64<span class="token punctuation">.</span>so <span class="token operator">&amp;&amp;</span> ln <span class="token operator">-</span>s libnetty_quiche_linux_x86_64<span class="token operator">-</span><span class="token number">0.0</span><span class="token number">.46</span><span class="token punctuation">.</span>Final<span class="token punctuation">.</span>so libnetty_quiche_linux_x86_64<span class="token punctuation">.</span>so<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> libtool<span class="token operator">:</span> install<span class="token operator">:</span> <span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>install <span class="token operator">-</span>c <span class="token punctuation">.</span>libs<span class="token operator">/</span>libnetty_quiche_linux_x86_64<span class="token punctuation">.</span>lai <span class="token operator">/</span>home<span class="token operator">/</span>http3<span class="token operator">/</span>netty<span class="token operator">-</span>incubator<span class="token operator">-</span>codec<span class="token operator">-</span>quic<span class="token operator">-</span><span class="token number">46</span><span class="token operator">/</span>codec<span class="token operator">-</span>native<span class="token operator">-</span>quic<span class="token operator">/</span>target<span class="token operator">/</span>native<span class="token operator">-</span>build<span class="token operator">/</span>target<span class="token operator">/</span>lib<span class="token operator">/</span>libnetty_quiche_linux_x86_64<span class="token punctuation">.</span>la
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> libtool<span class="token operator">:</span> finish<span class="token operator">:</span> PATH<span class="token operator">=</span><span class="token string">"/root/.cargo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/http3/jdk-20.0.1/bin:/sbin"</span> ldconfig <span class="token operator">-</span>n <span class="token operator">/</span>home<span class="token operator">/</span>http3<span class="token operator">/</span>netty<span class="token operator">-</span>incubator<span class="token operator">-</span>codec<span class="token operator">-</span>quic<span class="token operator">-</span><span class="token number">46</span><span class="token operator">/</span>codec<span class="token operator">-</span>native<span class="token operator">-</span>quic<span class="token operator">/</span>target<span class="token operator">/</span>native<span class="token operator">-</span>build<span class="token operator">/</span>target<span class="token operator">/</span>lib
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> Libraries have been installed in<span class="token operator">:</span>
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span>    <span class="token operator">/</span>home<span class="token operator">/</span>http3<span class="token operator">/</span>netty<span class="token operator">-</span>incubator<span class="token operator">-</span>codec<span class="token operator">-</span>quic<span class="token operator">-</span><span class="token number">46</span><span class="token operator">/</span>codec<span class="token operator">-</span>native<span class="token operator">-</span>quic<span class="token operator">/</span>target<span class="token operator">/</span>native<span class="token operator">-</span>build<span class="token operator">/</span>target<span class="token operator">/</span>lib</code></pre> 
<p>也可以将这两个so拷贝到/usr/lib/下面<br> <em>（用老版本很可能编不过，因为老版本需要每个git先下载再切分支，很慢很慢，很多次成功一次，很可能切分支失败你不知道，最后就版本不对应，你也不知道，github的访问有多愁人你懂的。<br> 很老的版本，比如我用的12，commit点都找不到了，根本不可能编的过）</em><br> 在/etc/profile中添加：</p> 
<pre><code class="prism language-c">export LD_LIBRARY_PATH<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>lib</code></pre> 
<p>然后source /etc/profile</p> 
<h4><a id="43__144"></a>4.3 编译运行自己的项目</h4> 
<p>./gradlew build后打包，可以看到打包的jar包：</p> 
<pre><code class="prism language-c"><span class="token punctuation">.</span><span class="token operator">/</span>build<span class="token operator">/</span>libs<span class="token operator">/</span>hyper<span class="token punctuation">.</span>jar</code></pre> 
<p>将hyperhttp.jar和依赖的jar都拷贝到build/libs/运行：</p> 
<pre><code class="prism language-c"><span class="token operator">/</span>mnt<span class="token operator">/</span>d<span class="token operator">/</span>codeC<span class="token operator">/</span>hyperhttp# cp <span class="token operator">-</span>f build<span class="token operator">/</span>libs<span class="token operator">/</span>hyperhttp<span class="token punctuation">.</span>jar bin<span class="token operator">/</span>test<span class="token operator">/</span>hyperhttp<span class="token operator">/</span>
<span class="token comment">//-cp后面是依赖的jar包</span>
<span class="token operator">/</span>mnt<span class="token operator">/</span>d<span class="token operator">/</span>codeC<span class="token operator">/</span>hyperhttp<span class="token operator">/</span>bin<span class="token operator">/</span>test#  java <span class="token operator">-</span>verbose<span class="token operator">:</span>class <span class="token operator">-</span>cp <span class="token string">"hyperhttp/*:"</span> hyperhttp<span class="token punctuation">.</span>AppServerExample</code></pre> 
<h4><a id="44_jar_157"></a>4.4 将所有依赖包打包到一个jar</h4> 
<p>按照上文中的配置，并执行./gradlew shadowJar可以生成build/libs/hyperhttp-1.0-SNAPSHOT.jar<br> 但是需要注意在build.gradle中配置正确的依赖包打包文件：</p> 
<pre><code class="prism language-c">dependencies <span class="token punctuation">{<!-- --></span>
    implementation <span class="token string">"io.netty:netty-all:4.1.94.Final"</span>
    implementation <span class="token string">"io.netty:netty-codec-http:4.1.94.Final"</span>
    implementation <span class="token string">"io.netty.incubator:netty-incubator-codec-http3:0.0.19.Final"</span>
    implementation 'io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token operator">:</span>netty<span class="token operator">-</span>incubator<span class="token operator">-</span>codec<span class="token operator">-</span>classes<span class="token operator">-</span>quic<span class="token operator">:</span><span class="token number">0.0</span><span class="token number">.46</span><span class="token punctuation">.</span>Final'
    <span class="token comment">//implementation 'io.netty.incubator:netty-incubator-codec-quic:0.0.19.Final'</span>
    implementation 'io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token operator">:</span>netty<span class="token operator">-</span>incubator<span class="token operator">-</span>codec<span class="token operator">-</span>native<span class="token operator">-</span>quic<span class="token operator">:</span><span class="token number">0.0</span><span class="token number">.46</span><span class="token punctuation">.</span>Final'
    implementation 'org<span class="token punctuation">.</span>bouncycastle<span class="token operator">:</span>bcpkix<span class="token operator">-</span>jdk15on<span class="token operator">:</span><span class="token number">1.69</span>'
    implementation 'org<span class="token punctuation">.</span>bouncycastle<span class="token operator">:</span>bcprov<span class="token operator">-</span>jdk15on<span class="token operator">:</span><span class="token number">1.69</span>'
    implementation 'org<span class="token punctuation">.</span>bouncycastle<span class="token operator">:</span>bctls<span class="token operator">-</span>jdk15on<span class="token operator">:</span><span class="token number">1.69</span>'
    implementation 'org<span class="token punctuation">.</span>bouncycastle<span class="token operator">:</span>bcutil<span class="token operator">-</span>jdk15on<span class="token operator">:</span><span class="token number">1.69</span>'
    <span class="token comment">// Use JUnit test framework.</span>
    <span class="token comment">//testImplementation 'junit:junit:4.13.2'</span>
<span class="token punctuation">}</span></code></pre> 
<p>不然可能会缺失jar或者jar中class冲突。</p> 
<h3><a id="5_179"></a>5、问题总结</h3> 
<h4><a id="mainjavalangNoClassDefFoundErrororgbouncycastlejceproviderBouncyCastleProvider_180"></a>运行main后提示java.lang.NoClassDefFoundError:org/bouncycastle/jce/provider/BouncyCastleProvider</h4> 
<p>解决方法：<br> 在pom.xml增加：</p> 
<pre><code class="prism language-c">    <span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>org<span class="token punctuation">.</span>bouncycastle<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>bcpkix<span class="token operator">-</span>jdk15on<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>version<span class="token operator">&gt;</span><span class="token number">1.69</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>scope<span class="token operator">&gt;</span>compile<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>optional<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>optional<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span></code></pre> 
<h4><a id="mvn_compilenew_linespace_195"></a>mvn compile提示new line什么space</h4> 
<p>使用mvn compile -Dcheckstyle.skip=true 编译</p> 
<h4><a id="gradlegradlew_buildCould_not_open_settings_generic_class_cache_for_settings_file_DcodeCs2UserAgentuseragentappsettingsgradle_CUsersxxxgradlecaches751scriptse4b9g30f2zgl5hoyt6gigkukl_198"></a>下载gradle管理的代码，使用./gradlew build编译提示：Could not open settings generic class cache for settings file ‘D:\codeC\s2\UserAgent\user-agent-app\settings.gradle’ (C:\Users\xxx.gradle\caches\7.5.1\scripts\e4b9g30f2zgl5hoyt6gigkukl).</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/94/4f/PavNhkWC_o.png"><br> 解决方法：修改D:\codeC\s2\UserAgent\user-agent-app\gradle\wrapper\gradle-wrapper.Properties中的distributionUrl为当前安装的版本</p> 
<h4><a id="An_exception_occurred_applying_plugin_request_id_comgithubjohnrengelmanshadow_version_204_202"></a>编译提示错误：An exception occurred applying plugin request [id: ‘com.github.johnrengelman.shadow’, version: ‘2.0.4’]</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/d7/b4/8AS0iHGR_o.png"><br> 解决方法：将build.gradle中id ‘com.github.johnrengelman.shadow’ version '2.0.4’删了，用不着</p> 
<h4><a id="_206"></a>编译的时候依赖下载慢</h4> 
<p>依赖库在setting.gradle中配置，执行gradle build（或者./gradlew build）后依赖库会下载到目录：<br> C:\Users(用户名).gradle\caches\modules-2\files-2.1<br> 如果使用默认配置下载会很慢，有的依赖库下不来，需要配置国内镜像，比如阿里云：</p> 
<pre><code class="prism language-go">repositories <span class="token punctuation">{<!-- --></span>    
    maven <span class="token punctuation">{<!-- --></span> url 'https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>maven<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>repository<span class="token operator">/</span>public<span class="token operator">/</span>' <span class="token punctuation">}</span>    
    maven <span class="token punctuation">{<!-- --></span> url 'https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>maven<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>repository<span class="token operator">/</span>spring<span class="token operator">/</span>' <span class="token punctuation">}</span>
    <span class="token function">mavenLocal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span></code></pre> 
<h4><a id="javagradle_buildjavaexejava_home_219"></a>java降级后gradle build提示找不到java.exe(java home是卸载版本的)</h4> 
<pre><code> 删除C:\Users\xxx\.gradle文件夹后重新执行
</code></pre> 
<h4><a id="test_222"></a>编译时test报错</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/a0/73/0jMMgozJ_o.png"><br> 解决方法：跳过test–gradlew.bat build -x test</p> 
<h4><a id="pomxml_226"></a>生成pom.xml（依赖包本地编译、查找的时候要）</h4> 
<p>D:\tool\quickio-main&gt;gradlew.bat publishToMavenLocal<br> 生成结果在D:\tool\quickio-main\build\publications\maven</p> 
<h4><a id="_230"></a>依赖库找不到</h4> 
<p>首先要明确找不到的库应该在哪里，是否在阿里云镜像上（在https://maven.aliyun.com/上查找）<br> 阿里云镜像没有的话在不在别的位置，也要加入setting<br> 比如quickio在https://www.jitpack.io（很多github的项目可能都在这个网站上发布包），就要把这个加入：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/1e/bb/A5pDMkPw_o.png"><br> 也可以本地编译后放入C盘下的缓存中</p> 
<h4><a id="vscodeSystemout_cannot_be_resolved_to_a_type_237"></a>vscode提示System.out cannot be resolved to a type</h4> 
<p>在Setting-&gt;Extension找到java相关的setting.json，里边配置了maven配置文件的路径，<br> 将对应路径下的setting中jdk设置上。<br> 在java的setting.json中增加"java.import.generatesMetadataFilesAtProjectRoot": true,<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/bf/5e/BNGZRkrN_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/d9/d9/BvLYPO7e_o.png"></p> 
<h4><a id="netty_quiche_dll_243"></a>找不到netty quiche dll</h4> 
<p>Caused by: java.lang.LinkageError: Possible multiple incompatible native libraries on the classpath for ‘C:\Users\llll\AppData\Local\Temp\netty_quiche_windows_x86_643357633935921649459.dll’?<br> Caused by: java.lang.NoSuchMethodError: Method io.netty.incubator.codec.quic.QuicheNativeStaticallyReferencedJniMethods.quicheRecvInfoOffsetofTo()I not found<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/85/0d/rcqnWUl0_o.png"><br> 这实际上是找不到quiche的JNI层，该层实现在netty-incubator-codec-quic的codec-native-quic中。<br> gradle build只会下载jar包（下载到C:\Users\lll.gradle\caches\modules-2\files-2.1），并不会下载其中JNI层的dll文件（在linux上是so文件），<br> 可能需要手动编译。<br> 下载对应版本后执行mvn build，注意将被墙的git路径替换掉，执行：</p> 
<pre><code class="prism language-c">git config <span class="token operator">--</span>global url<span class="token punctuation">.</span><span class="token string">"https://github.com/google/boringssl.git"</span><span class="token punctuation">.</span>insteadOf <span class="token string">"https://boringssl.googlesource.com/boringssl"</span></code></pre> 
<p>或者手动修改pom.xml</p> 
<p>注意准备好rust环境、c++环境、cmake（https://cmake.org/download/）、Ninja（https://github.com/ninja-build/ninja/releases）、go、nasm（https://www.nasm.us/pub/nasm/releasebuilds/）</p> 
<p>代码会下载到netty-incubator-codec-quic/codec-native-quic/target下面</p> 
<h4><a id="_261"></a>引用库冲突</h4> 
<p>引用库的版本间可能有冲突，可以先通过工具解决（以下例子通过IntelliJ）<br> 在文件上右键Analyze Dependence<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/f7/55/FE0IdHhj_o.png"></p> 
<h4><a id="The_C_compiler_identification_is_unknown_265"></a>The C compiler identification is unknown</h4> 
<p>这是mvn compile -X才看得到的错误<br> linux上使用g++，windows上使用VisualStudio下的cl.exe等，如果已经安装了c++的VisualStudio，把对应exe目录加到path里。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/31/69/VM97dFLl_o.png"></p> 
<h4><a id="Compiling_the_C_compiler_identification_source_file_CMakeCCompilerIdc_failed_269"></a>Compiling the C compiler identification source file “CMakeCCompilerId.c” failed.</h4> 
<p>执行<br> “C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Auxiliary\Build\vcvarsall.bat” x86</p> 
<h4><a id="linuxjavalangIllegalStateException_Unable_to_load_cache_item_273"></a>【linux】java.lang.IllegalStateException: Unable to load cache item</h4> 
<p>这是由于java和maven版本不匹配，maven用的3.6.3，jdk是17，而maven3.6.x不支持jdk17<br> 更换版本3.8.8，但只能更改path和maven_home到新的连接，如果覆盖原maven文件则出错：<br> mvn -v<br> Error: Could not find or load main class org.codehaus.plexus.classwords.launcher.Launcher<br> 这可能是由于文件系统的问题，我把文件放在了windows D盘，linux使用可能有问题。</p> 
<h4><a id="linux_Exception_in_thread_main_javalangUnsatisfiedLinkError_failed_to_load_the_required_native_library_280"></a>【linux】运行失败 Exception in thread “main” java.lang.UnsatisfiedLinkError: failed to load the required native library</h4> 
<pre><code class="prism language-c">root@DESKTOP<span class="token operator">-</span>JJS9ODB<span class="token operator">:</span><span class="token operator">/</span>mnt<span class="token operator">/</span>d<span class="token operator">/</span>codeC<span class="token operator">/</span>hyperhttp<span class="token operator">/</span>bin<span class="token operator">/</span>test# java <span class="token operator">-</span>cp <span class="token string">"hyperhttp/*:"</span> hyperhttp<span class="token punctuation">.</span>AppServerExample
Exception in thread <span class="token string">"main"</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>UnsatisfiedLinkError<span class="token operator">:</span> failed to load the required native library
        at io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>quic<span class="token punctuation">.</span>Quic<span class="token punctuation">.</span><span class="token function">ensureAvailability</span><span class="token punctuation">(</span>Quic<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">78</span><span class="token punctuation">)</span>
        at io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>quic<span class="token punctuation">.</span>QuicCodecBuilder<span class="token punctuation">.</span><span class="token operator">&lt;</span>init<span class="token operator">&gt;</span><span class="token punctuation">(</span>QuicCodecBuilder<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">59</span><span class="token punctuation">)</span>
        at io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>quic<span class="token punctuation">.</span>QuicServerCodecBuilder<span class="token punctuation">.</span><span class="token operator">&lt;</span>init<span class="token operator">&gt;</span><span class="token punctuation">(</span>QuicServerCodecBuilder<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">48</span><span class="token punctuation">)</span>
        at io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>http3<span class="token punctuation">.</span>Http3<span class="token punctuation">.</span><span class="token function">newQuicServerCodecBuilder</span><span class="token punctuation">(</span>Http3<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">148</span><span class="token punctuation">)</span>
        at hyper<span class="token punctuation">.</span>http<span class="token punctuation">.</span>server<span class="token punctuation">.</span>hyperHttpServer<span class="token punctuation">.</span><span class="token operator">&lt;</span>init<span class="token operator">&gt;</span><span class="token punctuation">(</span>hyperHttpServer<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">29</span><span class="token punctuation">)</span>
        at hyperhttp<span class="token punctuation">.</span>AppServerExample<span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span>AppServerExample<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">17</span><span class="token punctuation">)</span>
Caused by<span class="token operator">:</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>LinkageError<span class="token operator">:</span> Possible multiple incompatible native libraries on the classpath <span class="token keyword">for</span> '<span class="token operator">/</span>tmp<span class="token operator">/</span>libnetty_quiche_linux_x86_649259403363156468475<span class="token punctuation">.</span>so'<span class="token operator">?</span>
        at io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>util<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>NativeLibraryLoader<span class="token punctuation">.</span><span class="token function">rethrowWithMoreDetailsIfPossible</span><span class="token punctuation">(</span>NativeLibraryLoader<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">414</span><span class="token punctuation">)</span>
        at io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>util<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>NativeLibraryLoader<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span>NativeLibraryLoader<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">402</span><span class="token punctuation">)</span>
        at io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>util<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>NativeLibraryLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>NativeLibraryLoader<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">218</span><span class="token punctuation">)</span>
        at io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>quic<span class="token punctuation">.</span>Quiche<span class="token punctuation">.</span><span class="token function">loadNativeLibrary</span><span class="token punctuation">(</span>Quiche<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">77</span><span class="token punctuation">)</span>
        at io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>quic<span class="token punctuation">.</span>Quiche<span class="token punctuation">.</span><span class="token operator">&lt;</span>clinit<span class="token operator">&gt;</span><span class="token punctuation">(</span>Quiche<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">57</span><span class="token punctuation">)</span>
        at io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>quic<span class="token punctuation">.</span>Quic<span class="token punctuation">.</span><span class="token operator">&lt;</span>clinit<span class="token operator">&gt;</span><span class="token punctuation">(</span>Quic<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">43</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">5</span> more
Caused by<span class="token operator">:</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>NoSuchMethodError<span class="token operator">:</span> Method io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>quic<span class="token punctuation">.</span>QuicheNativeStaticallyReferencedJniMethods<span class="token punctuation">.</span><span class="token function">quicheRecvInfoOffsetofTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>I not found
        at java<span class="token punctuation">.</span>base<span class="token operator">/</span>jdk<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>loader<span class="token punctuation">.</span>NativeLibraries<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>Native Method<span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>base<span class="token operator">/</span>jdk<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>loader<span class="token punctuation">.</span>NativeLibraries$NativeLibraryImpl<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>NativeLibraries<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">331</span><span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>base<span class="token operator">/</span>jdk<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>loader<span class="token punctuation">.</span>NativeLibraries<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span>NativeLibraries<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">197</span><span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>base<span class="token operator">/</span>jdk<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>loader<span class="token punctuation">.</span>NativeLibraries<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span>NativeLibraries<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">139</span><span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>base<span class="token operator">/</span>java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ClassLoader<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span>ClassLoader<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2404</span><span class="token punctuation">)</span>
        at java</code></pre> 
<p>linux运行java： java -verbose:class -cp “hyperhttp/*:” hyperhttp.AppClientExample<br> windows也是这里失败，实际上不是在找so，而是在找class相关的jar<br> 需要编译netty-incubator-codec-quic（maven compile -X）成功生成的codec-classes-quic/target/netty-incubator-codec-classes-quic-0.0.46.Final.jar</p> 
<p>但有的情况下这个jar没问题也会出现这个提示，可以查看过程是不是引用错了jar，正确的应该是：</p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>class<span class="token punctuation">,</span>load<span class="token punctuation">]</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>incubator<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>quic<span class="token punctuation">.</span>QuicheNativeStaticallyReferencedJniMethods source<span class="token operator">:</span> file<span class="token operator">:</span><span class="token operator">/</span>mnt<span class="token operator">/</span>d<span class="token operator">/</span>codeC<span class="token operator">/</span>hyperhttp<span class="token operator">/</span>bin<span class="token operator">/</span>test<span class="token operator">/</span>hyperhttp<span class="token operator">/</span>netty<span class="token operator">-</span>incubator<span class="token operator">-</span>codec<span class="token operator">-</span>classes<span class="token operator">-</span>quic<span class="token operator">-</span><span class="token number">0.0</span><span class="token number">.46</span><span class="token punctuation">.</span>Final<span class="token punctuation">.</span>jar</code></pre> 
<p>另外一个jar也包含了这个class，就是netty-incubator-codec-quic-0.0.19.Final.jar，java可能会优先加载错误的jar包，删除这个jar就好了。<br> jar包的内容使用命令：</p> 
<pre><code class="prism language-c">jar tf xxx<span class="token punctuation">.</span>jar</code></pre> 
<h4><a id="javalangUnsupportedOperationException_OpenJdkSelfSignedCertGenerator_not_supported_on_the_used_JDK_version_324"></a>java.lang.UnsupportedOperationException: OpenJdkSelfSignedCertGenerator not supported on the used JDK version</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/95/78/symv5AyP_o.png"><br> netty这个版本依赖于jdk20（pom.xml）</p> 
<h4><a id="fatal_unable_to_access_httpsgithubcomgoogleboringsslgit_Failed_to_connect_to_githubcom_port_443_Connection_refused_328"></a>fatal: unable to access ‘https://github.com/google/boringssl.git/’: Failed to connect to github.com port 443: Connection refused</h4> 
<p>还有fatal: unable to connect to github.com:<br> github.com[0: 20.205.243.166]: errno=Invalid argument</p> 
<p>这很可能不是错误，就是github太难连上了，在不同的时间多试几次吧。。</p> 
<h4><a id="javasecuritycertCertificateException_No_provider_succeeded_to_generate_a_selfsigned_certificate_334"></a>java.security.cert.CertificateException: No provider succeeded to generate a self-signed certificate.</h4> 
<p>java.security.cert.CertificateException: No provider succeeded to generate a self-signed certificate.<br> java.lang.UnsupportedOperationException: OpenJdkSelfSignedCertGenerator not supported on the used JDK version<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/f4/7d/yspRpBaZ_o.png"><br> 虽然提示了jdk版本不对（不知道为什么提示，但版本确实是对的，我特意换了指定版本）<br> 但实际上，看代码：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/f0/63/V1muFYoB_o.png"><br> 如果支持了BouncyCastle，就用不着走后面的流程了，<br> 所以依赖包位置上根据对应版本的netty pom.xml拷贝几个jar包<br> windows位置：C:\Users\lll.m2\repository\org\bouncycastle\bcutil-jdk15on\1.69<br> linux位置：/root/.m2/repository/org\bouncycastle\bcutil-jdk15on\1.69<br> netty的pom.xml指定的版本：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/db/f6/agnLgy8u_o.png"><br> pom里边指定了三个jar包，实际上拷贝完这三个jar包并不管用，还有一个bcutil-jdk15on-1.69才可以：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/1d/0e/DmkpBdwW_o.png"></p> 
<h4><a id="Could_not_set_unknown_property_baseName_for_task_shadowJar_of_type_comgithubjengelmangradlepluginsshadowtasksShadowJar_350"></a>Could not set unknown property ‘baseName’ for task ‘:shadowJar’ of type com.github.jengelman.gradle.plugins.shadow.tasks.ShadowJar</h4> 
<pre><code class="prism language-c">FAILURE<span class="token operator">:</span> Build failed with an exception<span class="token punctuation">.</span>

<span class="token operator">*</span> Where<span class="token operator">:</span>
Build file '<span class="token operator">/</span>mnt<span class="token operator">/</span>d<span class="token operator">/</span>codeC<span class="token operator">/</span>hyperhttp<span class="token operator">/</span>build<span class="token punctuation">.</span>gradle' line<span class="token operator">:</span> <span class="token number">69</span>

<span class="token operator">*</span> What went wrong<span class="token operator">:</span>
A problem occurred evaluating root project <span class="token char">'hyperhttp'</span><span class="token punctuation">.</span>
<span class="token operator">&gt;</span> Could not set unknown property <span class="token char">'baseName'</span> <span class="token keyword">for</span> task <span class="token char">':shadowJar'</span> of type com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>jengelman<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>tasks<span class="token punctuation">.</span>ShadowJar<span class="token punctuation">.</span>
</code></pre> 
<p>这可能是由于shadow比较新，<br> 旧的ShadowJar版本使用的是baseName，但新的版本更换了方式：</p> 
<pre><code class="prism language-c">plugins <span class="token punctuation">{<!-- --></span>
   id <span class="token char">'java'</span>
   id <span class="token char">'com.github.johnrengelman.shadow'</span> version <span class="token char">'8.1.1'</span>
<span class="token punctuation">}</span>
    shadowJar <span class="token punctuation">{<!-- --></span>
        archiveBaseName<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token char">'hyperhttp'</span><span class="token punctuation">)</span>
        archiveClassifier<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token char">'1.0-SNAPSHOT'</span><span class="token punctuation">)</span>
        archiveVersion<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token char">''</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span></code></pre> 
<h4><a id="General_error_during_conversion_Unsupported_class_file_major_version_64_377"></a>General error during conversion: Unsupported class file major version 64</h4> 
<pre><code class="prism language-c">root@DESKTOP<span class="token operator">-</span>JJS9ODB<span class="token operator">:</span><span class="token operator">/</span>mnt<span class="token operator">/</span>d<span class="token operator">/</span>codeC<span class="token operator">/</span>hyperhttp# <span class="token punctuation">.</span><span class="token operator">/</span>gradlew build <span class="token operator">-</span>X

FAILURE<span class="token operator">:</span> Build failed with an exception<span class="token punctuation">.</span>

<span class="token operator">*</span> Where<span class="token operator">:</span>
Build file '<span class="token operator">/</span>mnt<span class="token operator">/</span>d<span class="token operator">/</span>codeC<span class="token operator">/</span>hyperhttp<span class="token operator">/</span>build<span class="token punctuation">.</span>gradle'

<span class="token operator">*</span> What went wrong<span class="token operator">:</span>
Could not compile build file '<span class="token operator">/</span>mnt<span class="token operator">/</span>d<span class="token operator">/</span>codeC<span class="token operator">/</span>hyperhttp<span class="token operator">/</span>build<span class="token punctuation">.</span>gradle'<span class="token punctuation">.</span>
<span class="token operator">&gt;</span> startup failed<span class="token operator">:</span>
  General error during conversion<span class="token operator">:</span> Unsupported class file major version <span class="token number">64</span>

  java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>IllegalArgumentException<span class="token operator">:</span> Unsupported class file major version <span class="token number">64</span>
        at groovyjarjarasm<span class="token punctuation">.</span><span class="token keyword">asm</span><span class="token punctuation">.</span>ClassReader<span class="token punctuation">.</span><span class="token operator">&lt;</span>init<span class="token operator">&gt;</span><span class="token punctuation">(</span>ClassReader<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">199</span><span class="token punctuation">)</span>
        at groovyjarjarasm<span class="token punctuation">.</span><span class="token keyword">asm</span><span class="token punctuation">.</span>ClassReader<span class="token punctuation">.</span><span class="token operator">&lt;</span>init<span class="token operator">&gt;</span><span class="token punctuation">(</span>ClassReader<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">180</span><span class="token punctuation">)</span>
        at groovyjarjarasm<span class="token punctuation">.</span><span class="token keyword">asm</span><span class="token punctuation">.</span>ClassReader<span class="token punctuation">.</span><span class="token operator">&lt;</span>init<span class="token operator">&gt;</span><span class="token punctuation">(</span>ClassReader<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span>
        at groovyjarjarasm<span class="token punctuation">.</span><span class="token keyword">asm</span><span class="token punctuation">.</span>ClassReader<span class="token punctuation">.</span><span class="token operator">&lt;</span>init<span class="token operator">&gt;</span><span class="token punctuation">(</span>ClassReader<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">287</span><span class="token punctuation">)</span>
        at org<span class="token punctuation">.</span>codehaus<span class="token punctuation">.</span>groovy<span class="token punctuation">.</span>ast<span class="token punctuation">.</span>decompiled<span class="token punctuation">.</span>AsmDecompiler<span class="token punctuation">.</span><span class="token function">parseClass</span><span class="token punctuation">(</span>AsmDecompiler<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">81</span><span class="token punctuation">)</span>
        at org<span class="token punctuation">.</span>codehaus<span class="token punctuation">.</span>groovy<span class="token punctuation">.</span>control<span class="token punctuation">.</span>ClassNodeResolver<span class="token punctuation">.</span><span class="token function">findDecompiled</span><span class="token punctuation">(</span>ClassNodeResolver<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">251</span><span class="token punctuation">)</span>
        at org<span class="token punctuation">.</span>codehaus<span class="token punctuation">.</span>groovy<span class="token punctuation">.</span>control<span class="token punctuation">.</span>ClassNodeResolver<span class="token punctuation">.</span><span class="token function">tryAsLoaderClassOrScript</span><span class="token punctuation">(</span>ClassNodeResolver<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">189</span><span class="token punctuation">)</span>
        at org<span class="token punctuation">.</span>codehaus<span class="token punctuation">.</span>groovy<span class="token punctuation">.</span>control<span class="token punctuation">.</span>ClassNodeResolver<span class="token punctuation">.</span><span class="token function">findClassNode</span><span class="token punctuation">(</span>ClassNodeResolver<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">169</span><span class="token punctuation">)</span>
        at org<span class="token punctuation">.</span>codehaus<span class="token punctuation">.</span>groovy<span class="token punctuation">.</span>control<span class="token punctuation">.</span>ClassNodeResolver<span class="token punctuation">.</span><span class="token function">resolveName</span><span class="token punctuation">(</span>ClassNodeResolver<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">125</span><span class="token punctuation">)</span>
        at org<span class="token punctuation">.</span>codehaus<span class="token punctuation">.</span>groovy<span class="token punctuation">.</span>ast<span class="token punctuation">.</span>decompiled<span class="token punctuation">.</span>AsmReferenceResolver<span class="token punctuation">.</span><span class="token function">resolveClassNullable</span><span class="token punctuation">(</span>AsmReferenceResolver<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">57</span><span class="token punctuation">)</span>
        at org<span class="token punctuation">.</span>codehaus<span class="token punctuation">.</span>groovy<span class="token punctuation">.</span>ast<span class="token punctuation">.</span>decompiled<span class="token punctuation">.</span>AsmReferenceResolver<span class="token punctuation">.</span><span class="token function">resolveClass</span><span class="token punctuation">(</span>AsmReferenceResolver<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">44</span><span class="token punctuation">)</span></code></pre> 
<p>这是由于jdk版本与gradle版本不配套，可以修改gradle\wrapper下的配置文件到相应的版本，<br> build时就会自动下载响应的gradle版本（我是jdk20， gradle8.2， shadow8.1.1）：</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/e4/44/e8kVrSxX_o.png"><br> 这个路径可能会下载失败，提示Exception in thread “main” java.io.IOException: Downloading from https://services.gradle.org/distributions/gradle-7.5.1-bin.zip failed: timeout<br> 可以换成distributionUrl=https://mirrors.cloud.tencent.com/gradle/gradle-7.5.1-bin.zip</p> 
<h4><a id="You_cant_map_a_property_that_does_not_exist_propertyNameclassifier_411"></a>You can’t map a property that does not exist: propertyName=classifier</h4> 
<pre><code class="prism language-c">FAILURE<span class="token operator">:</span> Build failed with an exception<span class="token punctuation">.</span>

<span class="token operator">*</span> Where<span class="token operator">:</span>
Build file '<span class="token operator">/</span>mnt<span class="token operator">/</span>d<span class="token operator">/</span>codeC<span class="token operator">/</span>hyperhttp<span class="token operator">/</span>build<span class="token punctuation">.</span>gradle' line<span class="token operator">:</span> <span class="token number">12</span>

<span class="token operator">*</span> What went wrong<span class="token operator">:</span>
An exception occurred applying plugin request <span class="token punctuation">[</span>id<span class="token operator">:</span> <span class="token char">'com.github.johnrengelman.shadow'</span><span class="token punctuation">,</span> version<span class="token operator">:</span> <span class="token char">'2.0.4'</span><span class="token punctuation">]</span>
<span class="token operator">&gt;</span> Failed to apply plugin class 'com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>jengelman<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>ShadowJavaPlugin'<span class="token punctuation">.</span>
   <span class="token operator">&gt;</span> You can't map a property that does not exist<span class="token operator">:</span> propertyName<span class="token operator">=</span>classifier</code></pre> 
<p>可能是由于shadow版本和gradle不配套，如果gradle用8.x.x，那么shadow相应的一般也是8.x.x</p> 
<h4><a id="vscodeImplicit_super_constructor_XXXX_is_undefined_for_default_constructor_426"></a>vscode所有类都提示Implicit super constructor XXXX() is undefined for default constructor</h4> 
<p>一般是vscode中JAVA_HOME配置有问题，首先确认环境变量中java home配置是否正确，然后确认vscode中setting-&gt;java-&gt;setting.json中"java.jdt.ls.java.home"是否正确。<br> 如果都没有问题，那么看下项目里边是否指定了jdk版本，比如build.gradle中：</p> 
<pre><code class="prism language-c">java <span class="token punctuation">{<!-- --></span>
    toolchain <span class="token punctuation">{<!-- --></span>
        languageVersion <span class="token operator">=</span> JavaLanguageVersion<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/25e0d694e1771d205d582a7a33071f8f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用idea跑起十多年前的项目</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/313f9f53b56c30b70fd7614bebea648f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Sharding Sphere 教程 简介</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>