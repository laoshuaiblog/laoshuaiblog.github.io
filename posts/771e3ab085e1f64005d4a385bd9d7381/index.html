<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pandasè¡¨æ ¼æ ·å¼è®¾ç½®æŠ€å·§ï¼Œæ¼‚äº®ï¼ - è€å¸…çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/771e3ab085e1f64005d4a385bd9d7381/">
  <meta property="og:site_name" content="è€å¸…çš„åšå®¢">
  <meta property="og:title" content="Pandasè¡¨æ ¼æ ·å¼è®¾ç½®æŠ€å·§ï¼Œæ¼‚äº®ï¼">
  <meta property="og:description" content="å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é˜¿ç²¥
ä»Šå¤©ç»™å¤§å®¶åˆ†äº«å¦‚ä½•ç»™Pandas DataFrameæ·»åŠ é¢œè‰²å’Œæ ·å¼ã€‚
å‰æ’æç¤ºï¼Œæ–‡æœ«é€ä¸¤æœ¬å•†ä¸šåˆ†æçš„å¥½ä¹¦~
é€šè¿‡è¿™ä¸€æ–¹æ³•ï¼Œå¢å¼ºæ•°æ®çš„å‘ˆç°ï¼Œä½¿ä¿¡æ¯çš„æ¢ç´¢å’Œç†è§£ä¸ä»…å†…å®¹ä¸°å¯Œï¼Œè€Œä¸”å…·æœ‰è§†è§‰å¸å¼•åŠ›ã€‚
Pandas Styleræ˜¯Pandasåº“ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒæä¾›äº†åˆ›å»ºDataFrameçš„HTMLæ ·å¼è¡¨ç¤ºçš„æ–¹æ³•ã€‚
æ­¤åŠŸèƒ½å…è®¸åœ¨å¯è§†åŒ–æœŸé—´è‡ªå®šä¹‰DataFrameçš„è§†è§‰å¤–è§‚ã€‚Pandas Stylerçš„æ ¸å¿ƒåŠŸèƒ½åœ¨äºèƒ½å¤Ÿæ ¹æ®ç‰¹å®šæ¡ä»¶å¯¹å•å…ƒæ ¼è¿›è¡Œçªå‡ºæ˜¾ç¤ºã€ç€è‰²å’Œæ ¼å¼åŒ–ã€‚
å¢å¼ºäº†å¯è§†åŒ–ä½“éªŒï¼Œå¹¶èƒ½å¤Ÿæ›´ç›´è§‚åœ°è§£é‡Šæ•°æ®é›†ä¸­åŒ…å«çš„ä¿¡æ¯ã€‚
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ç»„æ•°æ®åˆ›å»ºä¸€ä¸ªæ•°æ®é€è§†è¡¨ï¼Œä¸ºå…¶æä¾›ä¸åŒçš„æ ·å¼å’Œæ¡ä»¶æ ¼å¼ï¼Œæœ€ç»ˆå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚
æ•°æ®é€è§†è¡¨æ˜¯ä¸€ç§è¡¨æ ¼æ•°æ®ç»“æ„ï¼Œå®ƒæä¾›æ¥è‡ªå¦ä¸€ä¸ªè¡¨çš„ä¿¡æ¯çš„æ±‡æ€»æ¦‚è¿°ï¼Œæ ¹æ®ä¸€ä¸ªå˜é‡ç»„ç»‡æ•°æ®å¹¶æ˜¾ç¤ºä¸å¦ä¸€ä¸ªå˜é‡å…³è”çš„å€¼ã€‚
åœ¨æœ¬æ¬¡åˆ†æä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Apple Storeåº”ç”¨ç¨‹åºæ•°æ®é›†æ¥æ¢ç´¢æ•°æ®é€è§†è¡¨çš„åˆ›å»ºå’Œè¡¨æ ¼æ ·å¼çš„è‡ªå®šä¹‰ã€‚
æ•°æ®é›†æ¶µç›–ä»åº”ç”¨ç¨‹åºåç§°åˆ°å¤§å°ã€ä»·æ ¼å’Œè¯„çº§ç­‰ç»†èŠ‚çš„å„ä¸ªæ–¹é¢ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ‰æ•ˆåœ°åˆ†è§£ä¿¡æ¯ï¼ŒåŒæ—¶åº”ç”¨æœ‰æ•ˆå¢å¼ºæ•°æ®å‘ˆç°å’Œç†è§£çš„é£æ ¼ã€‚Â æ•°æ®è¯´æ˜ã€‚
æŸ¥çœ‹ç¯å¢ƒåŸºç¡€ä¿¡æ¯ã€‚
importÂ pandasÂ asÂ pd importÂ numpyÂ asÂ np importÂ math importÂ matplotlib.pyplotÂ asÂ plt importÂ warnings #Â å…³é—­pandasÂ warning warnings.filterwarnings(&#39;ignore&#39;) print(&#34;PythonÂ LibrariesÂ version:&#34;) print(&#39;Â -Â &#39;*20) print(&#34;PandasÂ version:Â &#34;,Â pd.__version__) print(&#34;NumpyÂ version:Â &#34;,Â np.__version__) print(&#34;MatplotlibÂ version:Â &#34;,Â plt.matplotlib.__version__) ç»“æœå¦‚ä¸‹ã€‚
è¯»å–æ•°æ®ã€‚
#Â è¯»å–æ•°æ® path=&#39;data/AppleStore.csv&#39; dataÂ =pd.read_csv(path,sep=&#39;;&#39;) åˆ›å»ºæ•°æ®é€è§†è¡¨ã€‚
#Â è¿‡æ»¤æ•°æ®ï¼Œåªä¿ç•™å‰15ä¸ªç±»å‹ top_genreÂ =Â data.value_counts(&#39;prime_genre&#39;)[:15].index.tolist() tmpÂ =Â data.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-21T22:03:39+08:00">
    <meta property="article:modified_time" content="2024-03-21T22:03:39+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="è€å¸…çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">è€å¸…çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pandasè¡¨æ ¼æ ·å¼è®¾ç½®æŠ€å·§ï¼Œæ¼‚äº®ï¼</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align:left;">å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é˜¿ç²¥</p> 
 <p style="text-align:left;">ä»Šå¤©ç»™å¤§å®¶åˆ†äº«å¦‚ä½•ç»™Pandas DataFrameæ·»åŠ é¢œè‰²å’Œæ ·å¼ã€‚<br></p> 
 <p style="text-align:justify;"><strong>å‰æ’æç¤ºï¼Œæ–‡æœ«é€ä¸¤æœ¬å•†ä¸šåˆ†æçš„å¥½ä¹¦~</strong></p> 
 <p style="text-align:justify;">é€šè¿‡è¿™ä¸€æ–¹æ³•ï¼Œå¢å¼ºæ•°æ®çš„å‘ˆç°ï¼Œä½¿ä¿¡æ¯çš„æ¢ç´¢å’Œç†è§£ä¸ä»…å†…å®¹ä¸°å¯Œï¼Œè€Œä¸”å…·æœ‰è§†è§‰å¸å¼•åŠ›ã€‚</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/e8/0a/JPKIctJY_o.png" alt="2d3cadc6df28f6fa8f5ee2ee59ffd857.png"></p> 
 <p style="text-align:justify;">Pandas Styleræ˜¯Pandasåº“ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒæä¾›äº†åˆ›å»ºDataFrameçš„HTMLæ ·å¼è¡¨ç¤ºçš„æ–¹æ³•ã€‚</p> 
 <p style="text-align:justify;">æ­¤åŠŸèƒ½å…è®¸åœ¨å¯è§†åŒ–æœŸé—´è‡ªå®šä¹‰DataFrameçš„è§†è§‰å¤–è§‚ã€‚Pandas Stylerçš„æ ¸å¿ƒåŠŸèƒ½åœ¨äºèƒ½å¤Ÿæ ¹æ®ç‰¹å®šæ¡ä»¶å¯¹å•å…ƒæ ¼è¿›è¡Œçªå‡ºæ˜¾ç¤ºã€ç€è‰²å’Œæ ¼å¼åŒ–ã€‚</p> 
 <p style="text-align:justify;">å¢å¼ºäº†å¯è§†åŒ–ä½“éªŒï¼Œå¹¶èƒ½å¤Ÿæ›´ç›´è§‚åœ°è§£é‡Šæ•°æ®é›†ä¸­åŒ…å«çš„ä¿¡æ¯ã€‚</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/d0/85/SNlxSbDX_o.jpg" alt="3e1bbb935e794919c7ce3c5373bc410c.jpeg"></p> 
 <p style="text-align:justify;">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ç»„æ•°æ®åˆ›å»ºä¸€ä¸ªæ•°æ®é€è§†è¡¨ï¼Œä¸ºå…¶æä¾›ä¸åŒçš„æ ·å¼å’Œæ¡ä»¶æ ¼å¼ï¼Œæœ€ç»ˆå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚</p> 
 <p style="text-align:justify;">æ•°æ®é€è§†è¡¨æ˜¯ä¸€ç§è¡¨æ ¼æ•°æ®ç»“æ„ï¼Œå®ƒæä¾›æ¥è‡ªå¦ä¸€ä¸ªè¡¨çš„ä¿¡æ¯çš„æ±‡æ€»æ¦‚è¿°ï¼Œæ ¹æ®ä¸€ä¸ªå˜é‡ç»„ç»‡æ•°æ®å¹¶æ˜¾ç¤ºä¸å¦ä¸€ä¸ªå˜é‡å…³è”çš„å€¼ã€‚</p> 
 <p style="text-align:justify;">åœ¨æœ¬æ¬¡åˆ†æä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Apple Storeåº”ç”¨ç¨‹åºæ•°æ®é›†æ¥æ¢ç´¢æ•°æ®é€è§†è¡¨çš„åˆ›å»ºå’Œè¡¨æ ¼æ ·å¼çš„è‡ªå®šä¹‰ã€‚</p> 
 <p style="text-align:justify;">æ•°æ®é›†æ¶µç›–ä»åº”ç”¨ç¨‹åºåç§°åˆ°å¤§å°ã€ä»·æ ¼å’Œè¯„çº§ç­‰ç»†èŠ‚çš„å„ä¸ªæ–¹é¢ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ‰æ•ˆåœ°åˆ†è§£ä¿¡æ¯ï¼ŒåŒæ—¶åº”ç”¨æœ‰æ•ˆå¢å¼ºæ•°æ®å‘ˆç°å’Œç†è§£çš„é£æ ¼ã€‚Â </p> 
 <p style="text-align:justify;">æ•°æ®è¯´æ˜ã€‚</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/3d/bf/VbVqN23w_o.png" alt="4cc5793f18e82e404737863a3e79dcf6.png"></p> 
 <p style="text-align:justify;">æŸ¥çœ‹ç¯å¢ƒåŸºç¡€ä¿¡æ¯ã€‚</p> 
 <pre class="has"><code class="language-go">importÂ pandasÂ asÂ pd
importÂ numpyÂ asÂ np
importÂ math
importÂ matplotlib.pyplotÂ asÂ plt
importÂ warnings

#Â å…³é—­pandasÂ warning
warnings.filterwarnings('ignore')
print("PythonÂ LibrariesÂ version:")
print('Â -Â '*20)
print("PandasÂ version:Â ",Â pd.__version__)
print("NumpyÂ version:Â ",Â np.__version__)
print("MatplotlibÂ version:Â ",Â plt.matplotlib.__version__)</code></pre> 
 <p style="text-align:justify;">ç»“æœå¦‚ä¸‹ã€‚</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/c7/96/98jDT2Za_o.png" alt="909c9a2a2a551692b218808ac280c067.png"></p> 
 <p style="text-align:justify;">è¯»å–æ•°æ®ã€‚</p> 
 <pre class="has"><code class="language-go">#Â è¯»å–æ•°æ®
path='data/AppleStore.csv'
dataÂ =pd.read_csv(path,sep=';')</code></pre> 
 <p style="text-align:justify;">åˆ›å»ºæ•°æ®é€è§†è¡¨ã€‚</p> 
 <pre class="has"><code class="language-go">#Â è¿‡æ»¤æ•°æ®ï¼Œåªä¿ç•™å‰15ä¸ªç±»å‹
top_genreÂ =Â data.value_counts('prime_genre')[:15].index.tolist()
tmpÂ =Â data.loc[data['prime_genre'].isin(top_genre),['prime_genre','user_rating','price']]

#Â åˆ›å»ºä¸€ä¸ªæ–°åˆ—ï¼Œå°†è¯„çº§å››èˆäº”å…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°
tmp['user_rating']Â =Â [f'rating_{str(math.trunc(item))}'Â forÂ itemÂ inÂ tmp['user_rating']]

#Â åˆ›å»ºæ•°æ®é€è§†è¡¨
tmp_pivotÂ =Â (
Â pd.pivot_table(
Â dataÂ =Â tmp,
Â columns='user_rating',
Â index='prime_genre',
Â values='price',
Â aggfunc='mean',
Â fill_value=0
Â ).reset_index().round(2)
)

#Â é‡å‘½ååˆ—
tmp_pivot.columns.name=''
#Â æ‰“å°é€è§†è¡¨
tmp_pivot</code></pre> 
 <p style="text-align:justify;">ç»“æœå¦‚ä¸‹ã€‚</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/fc/8d/m6HnxNhn_o.png" alt="4c944a2fd179a886396526b657e26f8f.png"></p> 
 <p style="text-align:justify;">ç°åœ¨æˆ‘ä»¬å°†æ¢ç´¢Pandasä¸­çš„â€œstyleâ€æ¨¡å—ï¼Œå®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿå¢å¼ºDataFrameçš„è§†è§‰å‘ˆç°ã€‚â€œstyleâ€æ¨¡å—æä¾›äº†ä¸åŒçš„é€‰é¡¹æ¥ä¿®æ”¹æ•°æ®çš„å¤–è§‚ï¼Œå…è®¸æˆ‘ä»¬è‡ªå®šä¹‰ä»¥ä¸‹æ–¹é¢ï¼šÂ </p> 
 <p style="text-align:justify;">ç»™å•å…ƒæ ¼ç€è‰²ï¼šæ ¹æ®å•å…ƒæ ¼å€¼æˆ–æ¡ä»¶åº”ç”¨ä¸åŒçš„é¢œè‰²ã€‚Â </p> 
 <p style="text-align:justify;">çªå‡ºæ˜¾ç¤ºï¼šå¼ºè°ƒç‰¹å®šçš„è¡Œã€åˆ—æˆ–å€¼ã€‚Â </p> 
 <p style="text-align:justify;">æ ¼å¼ï¼šè°ƒæ•´æ˜¾ç¤ºå€¼çš„æ ¼å¼ï¼ŒåŒ…æ‹¬ç²¾åº¦å’Œå¯¹é½æ–¹å¼ã€‚Â </p> 
 <p style="text-align:justify;">æ¡å½¢å›¾ï¼šåœ¨å•å…ƒæ ¼å†…ç”¨æ°´å¹³æˆ–å‚ç›´æ¡å½¢å›¾è¡¨ç¤ºæ•°æ®ã€‚</p> 
 <p style="text-align:justify;"><strong>æ ·å¼ï¼šè®¾ç½®æ ‡é¢˜çš„èƒŒæ™¯é¢œè‰²</strong></p> 
 <p style="text-align:justify;">åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†åº”ç”¨æ ·å¼åˆ°æ ‡é¢˜å’Œè¡¨æ ¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨èƒŒæ™¯é¢œè‰²æ¥çªå‡ºæ˜¾ç¤ºæ ‡é¢˜å’Œè¡¨æ ¼çš„å…¶ä½™éƒ¨åˆ†ã€‚</p> 
 <pre class="has"><code class="language-go">#Â æ›´æ”¹åˆ—çš„èƒŒæ™¯é¢œè‰²
headersÂ =Â {
Â 'selector':Â 'th.col_heading',
Â 'props':Â 'background-color:Â #5E17EB;Â color:Â white;'
}
index_styleÂ =Â {
Â 'selector':Â 'th.index_name',
Â 'props':Â 'background-color:Â #5E17EB;Â color:Â white;'
}
tmp_pivot_styleÂ =Â (
Â tmp_pivot
Â .style
Â .set_table_styles([headers,index_style])
Â .set_properties(**{'background-color':Â '#ECE3FF','color':Â 'black'})
)
tmp_pivot_style</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/e7/72/nOT3hChO_o.png" alt="e32695067a6d94f5fc21f685b0a0f569.png"></p> 
 <p style="text-align:justify;"><strong>æ ·å¼ï¼šè®¾ç½®ç‰¹å®šå•å…ƒæ ¼çš„èƒŒæ™¯é¢œè‰²</strong></p> 
 <p style="text-align:justify;">ä¸‹é¢çš„ä»£ç ç‰‡æ®µè¯´æ˜äº†å¦‚ä½•ä½¿ç”¨pandasæ ·å¼ä¸ºDataFrameä¸­çš„ç‰¹å®šå•å…ƒæ ¼è®¾ç½®è‡ªå®šä¹‰èƒŒæ™¯é¢œè‰²ã€‚</p> 
 <pre class="has"><code class="language-go">(
Â Â Â tmp_pivot
Â Â Â .style
Â Â Â .set_table_styles([headers,Â index_style])
Â Â Â .set_properties(**{'background-color':Â '#ECE3FF',Â 'color':Â 'black'})
Â Â Â .set_properties(**{'background-color':Â '#FD636B',Â 'color':Â 'white'},subset=pd.IndexSlice[4,Â 'rating_5'])
)</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/04/82/4SQU3tyc_o.png" alt="2be74b0e4dd35e084bd3d808c6331934.png"></p> 
 <p style="text-align:justify;"><strong>æ ·å¼ï¼šè®¾ç½®æ•°æ®æ¡†ä¸­æœ€å¤§/æœ€å°å€¼çš„èƒŒæ™¯é¢œè‰²</strong></p> 
 <p style="text-align:justify;">ç°åœ¨ï¼Œæˆ‘ä»¬å°†é‡ç‚¹çªå‡ºæ˜¾ç¤ºDataFrameä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä¸ºè¿™äº›æå€¼åˆ†é…ç‹¬ç‰¹çš„èƒŒæ™¯é¢œè‰²ï¼Œä»¥ä¾¿äºæ›´å¿«ã€æ›´ç›´è§‚åœ°ç†è§£æ•°æ®é›†ã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ¼”ç¤ºäº†å¦‚ä½•å®ç°è¿™ç§é£æ ¼å¢å¼ºã€‚</p> 
 <pre class="has"><code class="language-go">#Â é€‰æ‹©'rating_'å¼€å¤´çš„åˆ—
columnsÂ =Â tmp_pivot.columns[tmp_pivot.columns.str.startswith('rating_')]

#Â è·å–æœ€å¤§ã€æœ€å°å€¼
max_valueÂ =Â tmp_pivot[columns].max().max()
min_valueÂ =Â tmp_pivot[columns].min().min()
#Â æœ€å¤§å€¼æ ·å¼
max_styleÂ =Â f'border:Â 4pxÂ solidÂ #3BE8B0Â !important;'
#Â æœ€å°å€¼æ ·å¼
min_styleÂ =Â f'background-color:Â #FF66C4;Â '
(
Â tmp_pivot
Â .style
Â .set_table_styles([headers,Â index_style])
Â .set_properties(**{'background-color':Â '#ECE3FF',Â 'color':Â 'black'})
Â .set_properties(**{'background-color':Â '#FD636B',Â 'color':Â 'white'},Â subset=pd.IndexSlice[4,Â 'rating_5'])
Â .applymap(lambdaÂ x:Â max_styleÂ ifÂ xÂ ==Â max_valueÂ elseÂ '')
Â .applymap(lambdaÂ x:Â min_styleÂ ifÂ xÂ ==Â min_valueÂ elseÂ '',Â subset=columns)
)</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/bc/42/BCZCHDcZ_o.png" alt="a5f5dc41d2ae7ee4d3a639bf69940744.png"></p> 
 <p style="text-align:justify;"><strong>é£æ ¼ï¼šé¢œè‰²èƒŒæ™¯æ¸å˜</strong></p> 
 <p style="text-align:justify;">åœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥ç ”ç©¶é¢œè‰²å›¾çš„æ¦‚å¿µï¼Œå®ƒè¡¨ç¤ºä»¥æ¸å˜æ–¹å¼æ’åˆ—çš„é¢œè‰²å…‰è°±ã€‚é¢œè‰²å›¾æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé¢œè‰²è°ƒè‰²æ¿ï¼Œç”±ç‹¬ç‰¹çš„åç§°ç»„æˆï¼Œæœ€æµè¡Œçš„åç§°æ˜¯['viridis'ã€'magma'ã€'Greens'ã€'Reds']ã€‚Â </p> 
 <p style="text-align:justify;">åˆ›å»ºè¿™äº›è‰²è°±çš„ä¸»è¦ç›®çš„æ˜¯å¢å¼ºæ•°æ®çš„è§†è§‰è¡¨ç¤ºã€‚æ¸å˜ä¸­çš„æ¯ç§é¢œè‰²éƒ½å…·æœ‰ç‰¹å®šçš„ç»†å¾®å·®åˆ«ï¼Œæœ‰åŠ©äºæä¾›æ›´ç»†è‡´çš„æ•°æ®å¯è§†åŒ–ä½“éªŒã€‚Â </p> 
 <p style="text-align:justify;">å¯¹äºå¹¿æ³›çš„é¢œè‰²é€‰é¡¹ï¼Œæ‚¨å¯ä»¥æµè§ˆmatplotlib colormapsé“¾æ¥ã€‚</p> 
 <p style="text-align:justify;">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</p> 
 <pre class="has"><code class="language-go">importÂ matplotlib.pyplotÂ asÂ plt
importÂ numpyÂ asÂ np

#Â å®šä¹‰é¢œè‰²æ˜ å°„
forÂ cmap_itemÂ inÂ ['viridis',Â 'magma','Greens','Reds']:
Â cmapÂ =Â plt.get_cmap(cmap_item)
Â #Â åˆ›å»ºé¢œè‰²æ¸å˜
Â gradientÂ =Â np.linspace(0,Â 1,Â 256).reshape(1,Â -1)
Â #Â æ˜¾ç¤ºè°ƒè‰²æ¿
Â plt.figure(figsize=(10,Â 0.2))
Â plt.imshow(gradient,Â aspect='auto',Â cmap=cmap)
Â plt.axis('off')
Â plt.title(f'{cmap_item.capitalize()}Â ColorÂ Palette',Â loc='left',Â fontsize=9)
Â plt.show()</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/19/de/hoB2KLAJ_o.png" alt="5bfd3bbe03121fd2576f3064fec4d52c.png"></p> 
 <p style="text-align:justify;">Viridisè°ƒè‰²æ¿ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†å‘æ•°æ®é€è§†è¡¨åº”ç”¨é¢œè‰²æ¸å˜ï¼Œä»¥ä¾¿å¯ä»¥ä½¿ç”¨Viridisè°ƒè‰²æ¿è§‚å¯Ÿå®ƒçš„ç€è‰²æ–¹å¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¾ƒæµ…çš„é¢œè‰²è¡¨ç¤ºåˆ†å¸ƒä¸­è¾ƒå¤§çš„å€¼ï¼Œè€Œè¾ƒæ·±çš„é˜´å½±å¯¹åº”äºåˆ†å¸ƒä¸­è¾ƒå°çš„å€¼ã€‚è¿™ç§æ–¹æ³•æä¾›äº†ä¸€ç§è§†è§‰è¡¨ç¤ºï¼Œå¯ä»¥ç›´è§‚åœ°ä¼ è¾¾æ•°æ®çš„å¤§å°ï¼Œä»è€Œæ›´å®¹æ˜“è¾¨åˆ«æ•°æ®é›†ä¸­çš„æ¨¡å¼å’Œå˜åŒ–ã€‚</p> 
 <pre class="has"><code class="language-go">plt.get_cmap(Â 'viridis'Â ,lut=Â 20Â )</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/c0/8b/Uavh9kzW_o.png" alt="3f12b654398ad976497f7aac92b8e69e.png"></p> 
 <pre class="has"><code class="language-go">(Â 
tmp_pivotÂ 
.styleÂ 
.set_table_styles([headers,Â index_style])Â 
.background_gradient(cmap=Â 'viridis'Â ,subset=columns)Â 
)</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/d8/6a/PWFzytDH_o.png" alt="e3abf35b7bad022acc467a439a7facba.png"></p> 
 <p style="text-align:justify;"><strong>é£æ ¼ï¼šåˆ—ä¸­çš„å½©è‰²èƒŒæ™¯</strong></p> 
 <p style="text-align:justify;">åœ¨ä¸‹ä¸€ä¸ªä»£ç å—ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡å‘ç‰¹å®šåˆ—å¼•å…¥ä¸åŒçš„é¢œè‰²èƒŒæ™¯æ¥å¢å¼ºæ•°æ®é€è§†è¡¨çš„è§†è§‰è¡¨ç¤ºã€‚æ­¤æŠ€æœ¯æœ‰åŠ©äºæ›´å¥½åœ°çªå‡ºæ˜¾ç¤ºæ•°æ®å¹¶å¯¹å…¶è¿›è¡Œåˆ†ç±»ï¼Œä»è€Œæ›´è½»æ¾åœ°ä»è¡¨æ ¼ä¸­è·å–è§è§£ã€‚</p> 
 <pre class="has"><code class="language-go">(
Â tmp_pivot
Â .style
Â .set_table_styles([headers,Â index_style])
Â .set_properties(**{'background-color':Â '#FFCFC9','color':'black'},subset=['rating_0','rating_1'])
Â .set_properties(**{'background-color':Â '#FFF1B0','color':'black'},subset=['rating_2','rating_3'])
Â .set_properties(**{'background-color':Â '#BEEAE5','color':'black'},subset=['rating_4','rating_5'])
)</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/63/8a/cmf5gHYx_o.png" alt="feb335e63409ed9e412ced0f3d759dea.png"></p> 
 <p style="text-align:justify;"><strong>é£æ ¼ï¼šå½©æ¡</strong></p> 
 <p style="text-align:justify;">åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å®ç°style.barå‡½æ•°ä»¥å°†åŠ¨æ€é¢œè‰²æ¡å¼•å…¥åˆ°æˆ‘ä»¬çš„DataFrameä¸­ã€‚é¢œè‰²æ¡æä¾›æ•°æ®å€¼çš„ç›´è§‚è¡¨ç¤ºï¼Œä¸ºä¸åŒçš„æ•°æ®èŒƒå›´åˆ†é…ä¸åŒçš„é¢œè‰²ã€‚</p> 
 <pre class="has"><code class="language-go">(
Â tmp_pivot
Â .style
Â .set_table_styles([headers,Â index_style])
Â .set_properties(**{'background-color':Â '#ECE3FF',Â 'color':Â 'black'})
Â .set_properties(**{'background-color':Â 'white','color':'black'},subset=columns)
Â .bar(color='#FFCFC9',subset=['rating_0','rating_1'])
Â .bar(color='#FFF1B0',subset=['rating_2','rating_3'])
Â .bar(color='#BEEAE5',subset=['rating_4','rating_5'])
)</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/06/3c/unvI6ppp_o.png" alt="e4d013f3cd2c86846bb9ce74550ffd56.png"></p> 
 <p style="text-align:justify;"><strong>é£æ ¼ï¼šåˆ†åˆ—å›¾åƒ</strong></p> 
 <p style="text-align:justify;">åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡å‘é™„åŠ åˆ—æ·»åŠ å›¾åƒæ¥æ¢ç´¢æ•°æ®è¡¨ç¤ºçš„å¢å¼ºã€‚è¿™ç§æ–¹æ³•æä¾›äº†ä¸€ç§æ›¿ä»£æ–¹æ³•æ¥æå‡æ‰€å‘ˆç°æ•°æ®çš„è§†è§‰æ•ˆæœã€‚è¿™äº›å›¾åƒå¯ä»¥ä½œä¸ºå›¾æ ‡ã€ä»£è¡¨å“ç‰Œæˆ–ä¼ è¾¾é¢å¤–çš„è§†è§‰å…ƒç´ æ¥å¸å¼•å’Œå¸å¼•è§‚ä¼—ã€‚</p> 
 <pre class="has"><code class="language-go">#Â åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œæ ¹æ®ç±»å‹å°†å›¾åƒæ·»åŠ åˆ°dataframe
defÂ add_image(image_name):
Â img_urlÂ =Â f"img/icons/img_{image_name}.png"
Â widthÂ =Â "width:Â 50px"
Â heightÂ =Â "height:Â 50px"
Â text_alignÂ ="center"
Â returnÂ f'{width};{height};Â content:Â url({img_url});Â text-align:{text_align}'

#Â å°†å‡½æ•°åº”ç”¨äºdataframe
styled_dfÂ =Â (
Â tmp_pivot
Â .head(5)
Â .reset_index()
Â .rename({'index':Â 'genre'},Â axis=1)
Â .style.applymap(add_image,Â subset=pd.IndexSlice[:,Â ['genre']])
Â .set_table_styles([headers,Â index_style])
Â .set_properties(**{'background-color':Â '#ECE3FF',Â 'color':Â 'black'})
)

#Â æ˜¾ç¤ºå¸¦æœ‰å›¾åƒçš„dataframe
display(styled_df)</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/be/ce/Ie7fqUYo_o.png" alt="d95dff0c6a8a8bc837c2e2dda70ca951.png"></p> 
 <p style="text-align:justify;"><strong>é£æ ¼ï¼šåŸºäºç™¾åˆ†ä½æ•°çš„è¡¨æƒ…ç¬¦å·è¡¨ç¤º</strong></p> 
 <p style="text-align:justify;">åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥ç ”ç©¶åŸºäºç™¾åˆ†ä½å€¼çš„è¡¨æƒ…ç¬¦å·çš„åˆ›é€ æ€§ä½¿ç”¨ï¼Œæä¾›ä¸€ç§ç‹¬ç‰¹çš„æ–¹æ³•æ¥æå‡æ•°æ®è¡¨ç¤ºã€‚é€šè¿‡æ•´åˆä¸åŒçš„è¡¨æƒ…ç¬¦å·ï¼Œæˆ‘ä»¬å¢å¼ºäº†æ•°æ®çš„è§†è§‰å†²å‡»åŠ›ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨åœ†åœˆå’Œå°é˜Ÿä½œä¸ºè¡¨æƒ…ç¬¦å·ï¼Œä¸ºæˆ‘ä»¬çš„æ•°æ®ç‚¹å¸¦æ¥å¾®å¦™çš„è¡¨è¾¾ã€‚</p> 
 <pre class="has"><code class="language-go">defÂ get_percentiles(row_data,Â bins=3,Â emoji='circle'):
Â Â Â Â emoji_labelsÂ =Â {
Â Â Â Â Â Â Â Â 'circle':Â {3:Â ['ğŸ”´',Â 'ğŸŸ¡',Â 'ğŸŸ¢'],Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 4:Â ['ğŸ”´',Â 'ğŸŸ ',Â 'ğŸŸ¡',Â 'ğŸŸ¢']},
Â Â Â Â Â Â Â Â 'squad':Â {3:Â ['ğŸŸ¥',Â 'ğŸŸ¨',Â 'ğŸŸ©'],Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 4:Â ['ğŸŸ¥',Â 'ğŸŸ¨',Â 'ğŸŸ§',Â 'ğŸŸ©']}
Â Â Â Â }

Â Â Â Â ifÂ emojiÂ inÂ ['max',Â 'min',Â 'min_max']:
Â Â Â Â Â Â Â Â returnÂ create_series(row_data,Â emoji)
Â Â Â Â elifÂ emojiÂ inÂ emoji_labelsÂ andÂ binsÂ inÂ emoji_labels[emoji]:
Â Â Â Â Â Â Â Â labelsÂ =Â emoji_labels[emoji][bins]
Â Â Â Â Â Â Â Â returnÂ pd.cut(row_data,Â bins=len(labels),Â labels=labels,Â ordered=False)
Â Â Â Â else:
Â Â Â Â Â Â Â Â returnÂ row_data

defÂ create_series(row_data,Â emoji):
Â Â Â Â ifÂ emojiÂ ==Â 'max':
Â Â Â Â Â Â Â Â returnÂ pd.Series(['ğŸŸ©'Â ifÂ itemÂ ==Â row_data.max()Â elseÂ 'â¬œ'Â forÂ itemÂ inÂ row_data])
Â Â Â Â elifÂ emojiÂ ==Â 'min':
Â Â Â Â Â Â Â Â returnÂ pd.Series(['ğŸŸ¥'Â ifÂ itemÂ ==Â row_data.min()Â elseÂ 'â¬œ'Â forÂ itemÂ inÂ row_data])
Â Â Â Â elifÂ emojiÂ ==Â 'min_max':
Â Â Â Â Â Â Â Â returnÂ pd.Series(['ğŸŸ¥'Â ifÂ itemÂ ==Â row_data.min()Â elseÂ 'ğŸŸ©'Â ifÂ itemÂ ==Â row_data.max()Â elseÂ 'â¬œ'Â forÂ itemÂ inÂ row_data])

defÂ get_conditional_table_column(data,Â bins=3,Â emoji='circle'):
Â Â Â Â tmpÂ =Â data.copy()
Â Â Â Â forÂ columnÂ inÂ data.columns:
Â Â Â Â Â Â Â Â ifÂ pd.api.types.is_numeric_dtype(data[column]):
Â Â Â Â Â Â Â Â Â Â Â Â row_data_emojiÂ =Â get_percentiles(data[column],Â bins,Â emoji).astype(str)
Â Â Â Â Â Â Â Â Â Â Â Â tmp[column]Â =Â data[column].astype(str)Â +Â 'Â 'Â +Â row_data_emoji
Â Â Â Â returnÂ tmp

defÂ get_conditional_table_row(data,Â bins=3,Â emoji='circle'):
Â Â Â Â response_valuesÂ =Â []
Â Â Â Â column_strÂ =Â [itemÂ forÂ itemÂ inÂ data.columnsÂ ifÂ data[item].dtypesÂ notÂ inÂ ['int64',Â 'float64']]
Â Â Â Â columns_numÂ =Â [itemÂ forÂ itemÂ inÂ data.columnsÂ ifÂ data[item].dtypesÂ inÂ ['int64',Â 'float64']]

Â Â Â Â forÂ rowÂ inÂ range(data.shape[0]):
Â Â Â Â Â Â Â Â row_dataÂ =Â data.loc[row,Â columns_num]
Â Â Â Â Â Â Â Â percentilÂ =Â get_percentiles(row_data,Â bins,Â emoji)
Â Â Â Â Â Â Â Â row_dataÂ =Â row_data.apply(lambdaÂ x:Â '{:.2f}'.format(x))
Â Â Â Â Â Â Â Â percentil_valuesÂ =Â [str(row_data[item])Â +Â 'Â 'Â +Â percentil[item]Â forÂ itemÂ inÂ range(percentil.shape[0])]
Â Â Â Â Â Â Â Â response_values.append(percentil_values)

Â Â Â Â result_dfÂ =Â pd.DataFrame(response_values).round(2)
Â Â Â Â result_df.columnsÂ =Â columns_num
Â Â Â Â result_dfÂ =Â pd.concat([data[column_str],Â result_df],Â axis=1)
Â Â Â Â returnÂ result_df


#Â æŒ‰åˆ—æ¡ä»¶ç­›é€‰
get_conditional_table_row(data=tmp_pivot,emoji='min_max')

#Â æœ€å°å€¼
get_conditional_table_column(data=tmp_pivot,emoji='min')

#Â æœ€å¤§å€¼
get_conditional_table_column(data=tmp_pivot,emoji='max')

#Â 4åˆ†ç±»
get_conditional_table_column(data=tmp_pivot,emoji='circle',bins=4)</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/35/06/MJye59aT_o.png" alt="57262149e3388da90a621ea694746063.png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/8f/0c/qIUUnqEX_o.png" alt="65f17688d76bac84442d9e2a87d37ac8.png"></p> 
 <p><strong>æœ€åçš„æœ€åï¼Œç²‰ä¸ç¦åˆ©ï¼Œé€ä¸¤æœ¬åŒ—äº¬å¤§å­¦å‡ºç‰ˆç¤¾çš„å¥½ä¹¦</strong><strong>ã€Šå•†ä¸šåˆ†ææ€ç»´ä¸å®è·µï¼šç”¨æ•°æ®åˆ†</strong><strong>æè§£å†³å•†ä¸šé—®é¢˜ã€‹</strong>ã€‚è¿™æœ¬ä¹¦ä»¥ä¸šåŠ¡ä¸ºå¯¼å‘ï¼Œè¯¦ç»†åœ°è®²è§£äº†å¦‚ä½•é€šè¿‡å¤§æ•°æ®åˆ†ææ¥è§£å†³å•†ä¸šé—®é¢˜ã€‚å…¶ç›®çš„åœ¨äºè¿ç”¨å¤§æ•°æ®åˆ†ææ€ç»´ï¼Œå¸®åŠ©è¯»è€…æŠŠå­¦æœ¯çŸ¥è¯†åº”ç”¨äºçœŸå®çš„ä¸šåŠ¡åœºæ™¯ï¼Œè§£å†³å®é™…çš„ä¸šåŠ¡é—®é¢˜ï¼Œæœ‰æ€è·¯ã€æœ‰ä½“ç³»ã€æœ‰å®æˆ˜ã€æœ‰è½åœ°ï¼Œæ¨èä¸€è¯»ï¼</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/2d/53/pFcT1Lf8_o.jpg" alt="8d9e41fcd32738d1746827d5c515024b.jpeg"></p> 
 <p style="text-align:left;"><strong>è¿™æ¬¡æŠ½å¥–å½¢å¼ä¸°å¯Œç‚¹ï¼Œ</strong><strong>æœ¬æ–‡ä¸‰è¿ï¼ˆç‚¹èµã€åœ¨çœ‹æˆ–è€…è½¬å‘ä»»æ„éƒ½å¯ï¼‰åï¼š</strong></p> 
 <p style="text-align:left;"><strong>1ã€ç•™è¨€ç‚¹èµæ’åç¬¬3çš„é€ä¸€æœ¬ï¼ˆå¢å¼ºéšæœºæ€§ï¼‰</strong></p> 
 <p style="text-align:left;"><strong>2ã€åŠ æˆ‘å¾®ä¿¡å¥½å‹ï¼Œå›å¤â€œæŠ½å¥–â€ï¼ŒæŠ½å¥–é€1æœ¬</strong></p> 
 <pre class="has"><code class="language-go">ğŸ‘‡æ‰«ç åŠ æˆ‘å¥½å‹ğŸ‘‡</code></pre> 
 <p style="text-align:left;"><strong>3æœˆ24æ—¥22:00å¼€å¥–ï¼ˆä¸€ä¸ªäººæœ€å¤šåªèƒ½è·å¾—ä¸€æœ¬ï¼‰ï¼Œ<strong>ç¥å¤§å®¶å¥½è¿~</strong></strong></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1f3a4d5ec2162ae2a35107583d598afa/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ShardingSphere&#43;JPA&#43;Druidå®ç°åˆ†è¡¨æ“ä½œ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fb2bfc328214ac0f6f2c69dae66a93e4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">JPAä½¿ç”¨CriteriaQueryå®ç°åŠ¨æ€åˆ†ç»„æŸ¥è¯¢</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 è€å¸…çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>