<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阿里云对象存储OSS简介和使用 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/3d02e566c48d261ca8d3548334f39420/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="阿里云对象存储OSS简介和使用">
  <meta property="og:description" content="文章目录 简介OSS是什么存储类型费用说明使用限制 快速使用1.开通服务2.创建Bucket3.测试上传、访问 开发接入1.pom依赖2.获取AccessKey3.代码示例 高级功能表单上传追加上传断点续传上传分片上传图片处理防盗链设置监控搭配CDN 常见问题1.OSS的数据是如何组织的？ 简介 OSS是什么 阿里云对象存储OSS（Object Storage Service）是一款海量、安全、低成本、高可靠的云存储服务，提供99.9999999999%(12个9)的数据持久性，99.995%的数据可用性。多种存储类型供选择，全面优化存储成本。非常适合存储非结构化数据，例如视频、图形、日志、文本文件以及各种App应用、多终端同步软件、网盘下载站的文件等，单个文件的大小从1字节到48.8TB，可以存储的个数无限制。
存储类型 非特殊场景直接选择标准类型就可以了。
费用说明 OSS的所有计费服务都是单独计费的，例如您存储文件会产生存储费用；通过外网访问OSS存储的文件，会产生外网流出流量费用；使用图片处理服务处理OSS的图片会产生图片处理费用等。
以常见的费用明细罗列如下（未考虑搭配CDN情况）：
存储费用：标准存储（本地冗余）容量
按量计费：0.12元/GB/月
包年包月：标准型(本地冗余LRS)存储包 100G年价99元 = 0.99元/GB/年 = = 0.08元/GB/月
一年内容量在100G之内的部分会通过存储包抵扣，超出部分自动按量计费
流量费用：外网流出流量
按量计费：00:00-08:00（闲时）：0.25元/GB、8:00-24:00（忙时）：0.50元/GB
包年包月：下行流量包 100G年价441 = 0.36元/GB
一年内每个月都有100G的外网下载流量抵扣额度，每月1号更新，超出部分自动按量计费
请求费用：Put类型请求次数、Get类型请求次数
按量计费： 0.01元/万次包年包月：不支持 图片处理费用：
图片处理：每月0-10TB：免费，大于10TB：0.025元/G图片高级压缩：低规格（800×600以下）：0.025元/千次、中规格（1600×1200以下）：0.1元/千次 以上所有费用相加即为总费用，可以看到主要还是流量费用贵，其他的很便宜可以忽略了。费用明细地址：请参见阿里云产品定价。
这里提一嘴，ECS那边的流量费是0.8元/GB，详情链接
计费周期
OSS以小时为周期统计OSS所有资源的使用量，并按照使用量结算产生的费用。
计费案例：详情地址
李先生在OSS内存储了505GB标准存储（本地冗余）类型文件，存储空间所在地域为华东1（杭州），每小时的请求数均值为1000次，每天的外网流出流量约为2GB 。李先生可以选择以下两种方案进行付费：
仅按量计费
存储费用=505 GB*0.12元/GB/月=60.6元
请求费用=1000*0.01元/10000次*24小时*30天=0.72元
流量费用=2 GB*30天*0.5元/GB=30元
说明 OSS计算流量费用时，分为忙时流量（8:0024:00，0.50元/GB）和闲时流量（00:0008:00，0.25元/GB），用户都是白天使用，此处按忙时流量计算。
总费用：一个月费用约91.32元
包年包月&#43;按量计费
存储费用=54元（500 GB标准（LRS）存储包）&#43;5 GB*0.12元/GB/月=54.6元
说明 超出存储包的5 GB数据按量计费。
请求费用=1000*0.01元/10000次*24小时*30天=0.72元
流量费用=9.96元（50 GB流量包）&#43;10 GB*0.5元/GB=14.96元
说明
流量以忙时流量计算。50 GB流量包只有半年包，平均每月需59.76元/6个月=9.96元。 总费用：一个月费用约70.28元">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-10-27T17:17:49+08:00">
    <meta property="article:modified_time" content="2021-10-27T17:17:49+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阿里云对象存储OSS简介和使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">简介</a></li><li><ul><li><a href="#OSS_3" rel="nofollow">OSS是什么</a></li><li><a href="#_7" rel="nofollow">存储类型</a></li><li><a href="#_13" rel="nofollow">费用说明</a></li><li><a href="#_86" rel="nofollow">使用限制</a></li></ul> 
   </li><li><a href="#_99" rel="nofollow">快速使用</a></li><li><ul><li><a href="#1_101" rel="nofollow">1.开通服务</a></li><li><a href="#2Bucket_107" rel="nofollow">2.创建Bucket</a></li><li><a href="#3_117" rel="nofollow">3.测试上传、访问</a></li></ul> 
   </li><li><a href="#_129" rel="nofollow">开发接入</a></li><li><ul><li><a href="#1pom_131" rel="nofollow">1.pom依赖</a></li><li><a href="#2AccessKey_143" rel="nofollow">2.获取AccessKey</a></li><li><a href="#3_153" rel="nofollow">3.代码示例</a></li></ul> 
   </li><li><a href="#_198" rel="nofollow">高级功能</a></li><li><ul><li><a href="#_200" rel="nofollow">表单上传</a></li><li><a href="#_202" rel="nofollow">追加上传</a></li><li><a href="#_204" rel="nofollow">断点续传上传</a></li><li><a href="#_206" rel="nofollow">分片上传</a></li><li><a href="#_208" rel="nofollow">图片处理</a></li><li><a href="#_241" rel="nofollow">防盗链设置</a></li><li><a href="#_245" rel="nofollow">监控</a></li><li><a href="#CDN_251" rel="nofollow">搭配CDN</a></li></ul> 
   </li><li><a href="#_253" rel="nofollow">常见问题</a></li><li><ul><li><a href="#1OSS_255" rel="nofollow">1.OSS的数据是如何组织的？</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>简介</h3> 
<h4><a id="OSS_3"></a>OSS是什么</h4> 
<p>阿里云对象存储OSS（Object Storage Service）是一款海量、安全、低成本、高可靠的云存储服务，提供99.9999999999%(12个9)的数据持久性，99.995%的数据可用性。多种存储类型供选择，全面优化存储成本。非常<strong>适合存储非结构化数据，例如视频、图形、日志、文本文件以及各种App应用、多终端同步软件、网盘下载站的文件等</strong>，<strong>单个文件的大小从1字节到48.8TB</strong>，可以<strong>存储的个数无限制</strong>。</p> 
<h4><a id="_7"></a>存储类型</h4> 
<p>非特殊场景<strong>直接选择标准类型</strong>就可以了。</p> 
<p><img src="https://images2.imgbox.com/2e/83/v8d5BYR9_o.png" alt=""></p> 
<h4><a id="_13"></a>费用说明</h4> 
<p>OSS的所有计费服务都是单独计费的，例如您存储文件会产生存储费用；通过外网访问OSS存储的文件，会产生外网流出流量费用；使用图片处理服务处理OSS的图片会产生图片处理费用等。</p> 
<p>以常见的费用明细罗列如下（未考虑搭配CDN情况）：</p> 
<ul><li> <p><strong>存储费用</strong>：标准存储（本地冗余）容量</p> 
  <ul><li> <p><strong>按量计费</strong>：<strong>0.12元/GB/月</strong></p> </li><li> <p><strong>包年包月</strong>：<strong>标准型(本地冗余LRS)存储包</strong> <strong>100G年价99元</strong> = <strong>0.99元/GB/年</strong> = = <strong>0.08元/GB/月</strong></p> 
    <blockquote> 
     <p><strong>一年内容量在100G之内</strong>的部分会通过存储包抵扣，超出部分自动按量计费</p> 
    </blockquote> </li></ul> </li><li> <p><strong>流量费用</strong>：外网流出流量</p> 
  <ul><li> <p><strong>按量计费</strong>：00:00-08:00（闲时）：<strong>0.25元</strong>/GB、8:00-24:00（忙时）：<strong>0.50</strong>元/GB</p> </li><li> <p><strong>包年包月</strong>：<strong>下行流量包</strong> <strong>100G年价441</strong> = <strong>0.36</strong>元/GB</p> 
    <blockquote> 
     <p>一年内<strong>每个月</strong>都有<strong>100G</strong>的外网下载流量抵扣额度，每月1号更新，超出部分自动按量计费</p> 
    </blockquote> </li></ul> </li><li> <p><strong>请求费用</strong>：Put类型请求次数、Get类型请求次数</p> 
  <ul><li><strong>按量计费</strong>： <strong>0.01元</strong>/万次</li><li><strong>包年包月</strong>：不支持</li></ul> </li><li> <p><strong>图片处理费用</strong>：</p> 
  <ul><li><strong>图片处理</strong>：每月0-10TB：免费，大于10TB：0.025元/G</li><li><strong>图片高级压缩</strong>：低规格（800×600以下）：0.025元/千次、中规格（1600×1200以下）：0.1元/千次</li></ul> </li></ul> 
<p>以上所有费用相加即为总费用，可以看到<strong>主要还是流量费用贵</strong>，其他的很便宜可以忽略了。<strong>费用明细地址</strong>：请参见<a href="https://www.aliyun.com/price/product?spm=5176.7933691.744462.price2.b7a36a56kldoxf#/oss/detail" rel="nofollow">阿里云产品定价</a>。</p> 
<p><strong>这里提一嘴，ECS那边的流量费是0.8元/GB</strong>，<a href="https://laker.blog.csdn.net/article/details/120909772" rel="nofollow">详情链接</a></p> 
<blockquote> 
 <p>计费周期</p> 
 <p>OSS以小时为周期统计OSS所有资源的使用量，并按照使用量结算产生的费用。</p> 
</blockquote> 
<p><strong>计费案例</strong>：<a href="https://help.aliyun.com/document_detail/109686.htm?spm=a2c4g.11186623.0.0.26443048PYCjd9#concept-znm-rss-zgb" rel="nofollow">详情地址</a></p> 
<p>李先生在OSS内存储了<strong>505GB</strong>标准存储（本地冗余）类型文件，存储空间所在地域为华东1（杭州），每小时的请求数均值为<strong>1000</strong>次，每天的外网流出流量约为<strong>2GB</strong> 。李先生可以选择以下两种方案进行付费：</p> 
<ul><li> <p><strong>仅按量计费</strong></p> 
  <ul><li> <p><strong>存储费用</strong>=<code>505 GB*0.12元/GB/月=60.6元</code></p> </li><li> <p><strong>请求费用</strong>=<code>1000*0.01元/10000次*24小时*30天=0.72元</code></p> </li><li> <p><strong>流量费用</strong>=<code>2 GB*30天*0.5元/GB=30元</code></p> 
    <blockquote> 
     <p><strong>说明</strong> OSS计算流量费用时，分为忙时流量（8:00<sub>24:00，0.50元/GB）和闲时流量（00:00</sub>08:00，0.25元/GB），用户都是白天使用，此处按忙时流量计算。</p> 
    </blockquote> </li><li> <p><strong>总费用</strong>：<strong>一个月费用</strong>约<strong>91.32</strong>元</p> </li></ul> </li><li> <p><strong>包年包月</strong>+<strong>按量计费</strong></p> 
  <ul><li> <p><strong>存储费用</strong>=<code>54元（500 GB标准（LRS）存储包）+5 GB*0.12元/GB/月=54.6元</code></p> 
    <blockquote> 
     <p><strong>说明</strong> 超出存储包的5 GB数据按量计费。</p> 
    </blockquote> </li><li> <p><strong>请求费用</strong>=<code>1000*0.01元/10000次*24小时*30天=0.72元</code></p> </li><li> <p><strong>流量费用</strong>=<code>9.96元（50 GB流量包）+10 GB*0.5元/GB=14.96元</code></p> 
    <blockquote> 
     <p><strong>说明</strong></p> 
     <ul><li>流量以忙时流量计算。</li><li>50 GB流量包只有半年包，平均每月需59.76元/6个月=9.96元。</li></ul> 
    </blockquote> </li><li> <p><strong>总费用</strong>：<strong>一个月费用</strong>约<strong>70.28</strong>元</p> </li></ul> </li></ul> 
<h4><a id="_86"></a>使用限制</h4> 
<p>仅列出核心限制</p> 
<table><thead><tr><th align="left">限制项</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left"><strong>带宽</strong></td><td align="left"><strong>中国内地各地域10 Gbit/s</strong>、其他地域5 Gbit/s。如达到该阈值，请求会被流控。<strong>说明</strong> 当请求被流控时，请求返回的Header中会携带<code>x-oss-qos-delay-time: number</code>。其中<code>number</code>为请求被流控的时长，单位为ms。 上传类请求会返回精确的被流控的时长；下载类请求会返回根据流控程度和文件大小估算出的被流控的时长。如果您的业务（如大数据离线处理等）有更大的带宽（10 Gbit/s~100 Gbit/s）需求，请联系<a href="https://selfservice.console.aliyun.com/ticket/createIndex" rel="nofollow">技术支持</a>。</td></tr><tr><td align="left"><strong>对象或文件</strong>（Object）</td><td align="left"><strong>上传文件的大小</strong><br> 通过<a href="https://help.aliyun.com/document_detail/31848.htm#concept-bws-3bb-5db" rel="nofollow">简单上传</a>、<a href="https://help.aliyun.com/document_detail/31849.htm#concept-uln-lcb-5db" rel="nofollow">表单上传</a>、<a href="https://help.aliyun.com/document_detail/31851.htm#concept-ls5-yhb-5db" rel="nofollow">追加上传</a>的方式上传单个文件，文件的大小不能超过5 GB。<br> 通过<a href="https://help.aliyun.com/document_detail/31850.htm#section-k5c-lgp-mgb" rel="nofollow">分片上传</a>的方式上传单个文件，文件的大小不能超过48.8 TB。<br><strong>同名文件被覆盖默认情况下</strong>，如果上传的文件与已有文件同名，则覆盖已有文件。为防止文件被意外覆盖，您可以通过为文件所在的Bucket开启版本控制，或者在上传请求的Header中携带参数<strong>x-oss-forbid-overwrite</strong>，并指定其值为true。</td></tr><tr><td align="left"><strong>域名绑定</strong></td><td align="left">中国内地各地域绑定的域名必须在工信部备案，其他地域的域名绑定不需要在工信部备案。一个域名只能绑定在一个存储空间上，一个存储空间最多可以绑定100个域名。一个账号可绑定的域名个数无限制。</td></tr><tr><td align="left"><strong>回源规则</strong></td><td align="left">一个存储空间最多可配置20条回源规则。对于镜像回源，<br>中国内地各地域和中国香港默认QPS为2,000、流量为2 Gbit/s；<br>海外各地域默认QPS为1,000、流量为1 Gbit/s。</td></tr><tr><td align="left"><strong>图片处理</strong></td><td align="left">图片限制原图图片格式只支持JPG、PNG、BMP、GIF、WebP、TIFF。原图大小不能超过20 MB。<br>样式限制每个存储空间下最多能创建50个样式</td></tr><tr><td align="left"><strong>资源包</strong></td><td align="left">地域资源包仅支持在归属地域使用；中国大陆通用资源包仅支持在中国内地（不含中国香港）使用。已购资源包不支持更换地域。资源包中的存储包不支持叠加购买，但您可以对已购存储包进行<a href="https://help.aliyun.com/document_detail/48272.htm#section-nnt-zug-lsv" rel="nofollow">升级</a>。资源包中的传输加速包和回源流量包支持叠加购买，但不支持升级和续费。资源包中的下行流量包支持叠加购买和续费，但不支持升级。<a href="https://help.aliyun.com/document_detail/173536.htm#concept-2558398" rel="nofollow">请求费用</a>、<a href="https://help.aliyun.com/document_detail/173537.htm#concept-2558464" rel="nofollow">数据处理费用</a>和<a href="https://help.aliyun.com/document_detail/173535.htm#concept-2558367" rel="nofollow">流量费用</a>中的跨区域复制流量费用暂时无对应的资源包，即不支持包年包月，仅支持按量计费。</td></tr></tbody></table> 
<h3><a id="_99"></a>快速使用</h3> 
<h4><a id="1_101"></a>1.开通服务</h4> 
<p>打开<a href="https://www.aliyun.com/product/oss" rel="nofollow">OSS产品详情页</a>，单击<strong>立即开通</strong>即可。开通OSS服务后，默认的计费方式是<a href="https://help.aliyun.com/document_detail/48266.htm#concept-emk-1nh-tdb" rel="nofollow">按量计费</a>。（傻瓜式直接干就完事了）</p> 
<blockquote> 
 <p>如果想进一步降低OSS费用，建议您购买<a href="https://common-buy.aliyun.com/?spm=5176.7933691.1309819..68b22a66FQKm7f&amp;commodityCode=ossbag&amp;request=%7B%22region%22%3A%22china-common%22%7D#/buy" rel="nofollow">OSS资源包</a>。</p> 
</blockquote> 
<h4><a id="2Bucket_107"></a>2.创建Bucket</h4> 
<p>存储空间（Bucket）是用于存储对象（Object）的容器。在上传任意类型的Object前，您需要先创建Bucket。</p> 
<p><img src="https://images2.imgbox.com/54/6f/Ra4EIaJ0_o.png" alt=""></p> 
<p><strong>Bucket名称</strong>：Bucket名称必须全局唯一</p> 
<p><strong>地域</strong>：Bucket的数据中心。Bucket一旦创建，则无法更改其所在地域。ECS内网访问OSS，请选择与ECS相同的地域</p> 
<h4><a id="3_117"></a>3.测试上传、访问</h4> 
<p><strong>测试上传文件</strong></p> 
<p>直接到对应的桶上传即可，不截图了</p> 
<p><strong>测试访问文件</strong></p> 
<p><img src="https://images2.imgbox.com/0c/b9/N47Yd6No_o.png" alt=""></p> 
<blockquote> 
 <p><strong>注意</strong> 通过文件URL访问图片时，<strong>默认是下载行为</strong>。如需确保通过文件URL访问图片时是预览行为，您需要绑定自定义域名并添加CNAME记录。具体操作，请参见<a href="https://help.aliyun.com/document_detail/31902.html#concept-ozw-m2r-5fb" rel="nofollow">绑定自定义域名</a>。</p> 
</blockquote> 
<h3><a id="_129"></a>开发接入</h3> 
<h4><a id="1pom_131"></a>1.pom依赖</h4> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun.oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aliyun-sdk-oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.10.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p>自己去官方maven仓库看最新的版本</p> 
</blockquote> 
<h4><a id="2AccessKey_143"></a>2.获取AccessKey</h4> 
<p>AccessKey简称AK，指的是访问身份验证中用到的AccessKeyId和AccessKeySecret。OSS通过使用AccessKeyId和AccessKeySecret对称加密的方法来验证某个请求的发送者身份。AccessKeyId用于标识用户；AccessKeySecret是用户用于加密签名字符串和OSS用来验证签名字符串的密钥，必须保密。</p> 
<p><img src="https://images2.imgbox.com/c7/7e/n542Vzg8_o.png" alt=""></p> 
<p><strong>创建秘钥</strong></p> 
<p><img src="https://images2.imgbox.com/82/58/y5VtPAbD_o.png" alt=""></p> 
<h4><a id="3_153"></a>3.代码示例</h4> 
<p><strong>1.初始化</strong></p> 
<pre><code class="prism language-java"><span class="token comment">// yourEndpoint填写Bucket所在地域对应的Endpoint。以华东1（杭州）为例，Endpoint填写为https://oss-cn-hangzhou.aliyuncs.com。</span>
<span class="token class-name">String</span> endpoint <span class="token operator">=</span> <span class="token string">"yourEndpoint"</span><span class="token punctuation">;</span>
<span class="token comment">// 阿里云账号AccessKey拥有所有API的访问权限，风险很高。强烈建议您创建并使用RAM用户进行API访问或日常运维，请登录RAM控制台创建RAM用户。</span>
<span class="token class-name">String</span> accessKeyId <span class="token operator">=</span> <span class="token string">"yourAccessKeyId"</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> accessKeySecret <span class="token operator">=</span> <span class="token string">"yourAccessKeySecret"</span><span class="token punctuation">;</span>

<span class="token comment">// 创建OSSClient实例。</span>
<span class="token class-name">OSS</span> ossClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OSSClientBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>endpoint<span class="token punctuation">,</span> accessKeyId<span class="token punctuation">,</span> accessKeySecret<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 关闭OSSClient。</span>
ossClient<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    
</code></pre> 
<p><strong>2.上传文件</strong></p> 
<pre><code class="prism language-java"><span class="token comment">// yourEndpoint填写Bucket所在地域对应的Endpoint。以华东1（杭州）为例，Endpoint填写为https://oss-cn-hangzhou.aliyuncs.com。</span>
<span class="token class-name">String</span> endpoint <span class="token operator">=</span> <span class="token string">"yourEndpoint"</span><span class="token punctuation">;</span>
<span class="token comment">// 阿里云账号AccessKey拥有所有API的访问权限，风险很高。强烈建议您创建并使用RAM用户进行API访问或日常运维，请登录RAM控制台创建RAM用户。</span>
<span class="token class-name">String</span> accessKeyId <span class="token operator">=</span> <span class="token string">"yourAccessKeyId"</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> accessKeySecret <span class="token operator">=</span> <span class="token string">"yourAccessKeySecret"</span><span class="token punctuation">;</span>

<span class="token comment">// 创建OSSClient实例。</span>
<span class="token class-name">OSS</span> ossClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OSSClientBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>endpoint<span class="token punctuation">,</span> accessKeyId<span class="token punctuation">,</span> accessKeySecret<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 填写本地文件的完整路径。如果未指定本地路径，则默认从示例程序所属项目对应本地路径中上传文件流。</span>
<span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"D:\\localpath\\examplefile.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 依次填写Bucket名称（例如examplebucket）和Object完整路径（例如exampledir/exampleobject.txt）。Object完整路径中不能包含Bucket名称。</span>
ossClient<span class="token punctuation">.</span><span class="token function">putObject</span><span class="token punctuation">(</span><span class="token string">"examplebucket"</span><span class="token punctuation">,</span> <span class="token string">"exampledir/exampleobject.txt"</span><span class="token punctuation">,</span> inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 关闭OSSClient。</span>
ossClient<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>3.获取上传后地址</strong></p> 
<pre><code class="prism language-java"><span class="token string">"https://"</span> <span class="token operator">+</span> ossSetting<span class="token punctuation">.</span><span class="token function">getBucketName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> ossSetting<span class="token punctuation">.</span><span class="token function">getEndPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> objectName<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_198"></a>高级功能</h3> 
<h4><a id="_200"></a>表单上传</h4> 
<h4><a id="_202"></a>追加上传</h4> 
<h4><a id="_204"></a>断点续传上传</h4> 
<h4><a id="_206"></a>分片上传</h4> 
<h4><a id="_208"></a>图片处理</h4> 
<p>对OSS中存储的图片执行不同的操作，例如格式转换、裁剪、缩放、旋转、水印和样式封装等。</p> 
<p>例如：</p> 
<ul><li><strong>原图</strong>：https://laker.oss-cn-hangzhou.aliyuncs.com/d1130961908d4c3681be7e878dc764a6.jpg</li><li><strong>想获取其400X400图</strong>：https://laker.oss-cn-hangzhou.aliyuncs.com/d1130961908d4c3681be7e878dc764a6.jpg?x-oss-process=style/400X400</li></ul> 
<blockquote> 
 <p>结尾处加?x-oss-process=style/400X400、?x-oss-process=style/200X200即可</p> 
</blockquote> 
<p>要预先在<strong>OSS控制台</strong>-<strong>数据处理</strong>-<strong>新建400X400样式</strong></p> 
<p><img src="https://images2.imgbox.com/0a/e5/6deAsmkP_o.png" alt=""></p> 
<p>使用图片处理服务时，会产生如下费用：</p> 
<ul><li> <p>图片处理费用</p> <p>未超出免费额度时，不产生费用；超出免费额度后，按处理的原图实际大小计费。</p> <p>图片处理服务每个账号每月有10 TB的免费额度，即每月处理的原图累计不超过10 TB时，不收取图片处理费用；超过10 TB时，仅计算超出部分的费用。</p> </li><li> <p>请求费用</p> <p>处理图片时会产生一次GetObject请求，按请求次数收费。</p> </li><li> <p>流量费用</p> <p>根据处理的原图大小收取外网流出流量费用。</p> </li></ul> 
<blockquote> 
 <p>这个计费有点难受啊</p> 
</blockquote> 
<h4><a id="_241"></a>防盗链设置</h4> 
<p>可以看下面的<strong>监控</strong>中，有哪些<strong>Refer</strong>偷用我们的图片流量，给他关小黑屋，直接在控制台设置即可。</p> 
<h4><a id="_245"></a>监控</h4> 
<p><img src="https://images2.imgbox.com/d2/8f/kFy2aAQi_o.png" alt=""></p> 
<p>这里面有很多统计项，可以看有没有人恶意刷咱们的流量，可以给他关小黑屋。</p> 
<h4><a id="CDN_251"></a>搭配CDN</h4> 
<h3><a id="_253"></a>常见问题</h3> 
<h4><a id="1OSS_255"></a>1.OSS的数据是如何组织的？</h4> 
<p>OSS是一个分布式的对象存储服务，提供的是一个Key-Value形式的对象存储服务。当您存储文件（Object）时，需要指定此Object的名称（Key），后续您将通过这个Key来获取该Object的内容。</p> 
<p>Key也可以用来模拟文件夹的一些属性。OSS中文件夹的概念仅是一个逻辑概念，在通过API或SDK的方式设置文件夹的时候可以指定Object对应的Key值包括前面的目录即可模拟文件夹功能。例如，定义Object的Key为<code>dir/example.jpg</code>，就会在当前Bucket下创建一个名为<code>dir</code>的文件夹，并在该文件夹下创建一个名为<code>example.jpg</code>的文件。如果用户删除了<code>dir/example.jpg</code>，将不会再存在<code>dir</code>这个文件夹。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a5d1f35f05e18f3a2861fdb7a0a55ec2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">利用python实现本地文件上传到sftp</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d5821723d2dd1a1581eebf2d213e307a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">matlab 产生已知功率的复高斯白噪声及信噪比计算</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>