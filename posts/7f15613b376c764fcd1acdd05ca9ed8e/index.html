<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用c#制作简单的留言板(1) - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/7f15613b376c764fcd1acdd05ca9ed8e/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="利用c#制作简单的留言板(1)">
  <meta property="og:description" content="留言板分三个模块：列出留言列表、显示详细内容、发表留言
notepage.cs
namespace notpage
{
using System;
using System.Data.SQL ;
using System.Data ;
using System.Collections ;
/// &amp;lt;summary&amp;gt;
/// Summary description for notepage.
/// &amp;lt;/summary&amp;gt;
public class notepage
{
//私有变量
private int n_intID ; //ID编号
private string n_strTitle ; //主题
private string n_strAuthor ; //留言人
private string n_strContent ; //留言内容
private DateTime n_dateTime ; //留言时间
//属性
public int ID
{
get
{
return n_intID ;
}
set {
n_intID = value;">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2005-05-29T23:28:00+08:00">
    <meta property="article:modified_time" content="2005-05-29T23:28:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用c#制作简单的留言板(1)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p>留言板分三个模块：列出留言列表、显示详细内容、发表留言<br>notepage.cs<br>namespace notpage<br>{<!-- --><br>using System;<br>using System.Data.SQL ;<br>using System.Data ;<br>using System.Collections ;<br><br></p> 
<p>/// &lt;summary&gt;<br>/// Summary description for notepage.<br>/// &lt;/summary&gt;<br><br><br>public class notepage<br>{<!-- --><br>//私有变量<br><br>private int n_intID ; //ID编号<br>private string n_strTitle ; //主题<br>private string n_strAuthor ; //留言人<br>private string n_strContent ; //留言内容<br>private DateTime n_dateTime ; //留言时间<br><br><br>//属性<br><br><br>public int ID<br>{<!-- --><br>get<br>{<!-- --><br>return n_intID ;<br>}<br>set <br>{<!-- --><br>n_intID = value;<br>}<br>}<br><br>public string Title <br>{<!-- --><br>get<br>{<!-- --><br>return n_strTitle ;<br>}<br>set<br>{<!-- --><br>n_strTitle = value;<br>}<br>}<br><br>public string Author<br>{<!-- --><br>get<br>{<!-- --><br>return n_strAuthor ;<br>}<br>set<br>{<!-- --><br>n_strAuthor = value ;<br>}<br>}<br>public string Content<br>{<!-- --><br>get<br>{<!-- --><br>return n_strContent ;<br>}<br>set<br>{<!-- --><br>n_strContent = value ;<br>}<br>}<br>public DateTime adddate<br>{<!-- --><br><br>get<br>{<!-- --><br>return n_dateTime;<br>}<br>set<br>{<!-- --><br>n_dateTime = value;<br>}<br>}<br>//构造函数<br>public notepage()<br>{<!-- --><br>//<br>// TODO: Add Constructor Logic here<br>//<br>this.n_intID = 0 ;<br>this.n_strTitle = "" ;<br>this.n_strAuthor = "" ;<br>this.n_strContent = "" ;<br>this.n_dateTime = System.DateTime.Now;<br><br>}<br><br>/// &lt;summary&gt;<br>/// <br>/// 取得留言的内容<br>/// <br>/// &lt;/summary&gt;<br>/// &lt;param name="a_intID"&gt; &lt;/param&gt;<br>public notepage GetTopic(int a_intID)<br>{<!-- --><br>//<br>// TODO: Add Constructor Logic here<br>//<br><br><br><br>//读取数据库<br>myconn myConn = new myconn();<br><br>SQLCommand myCommand = new SQLCommand() ;<br>myCommand.ActiveConnection = myConn ;<br>myCommand.CommandText = "n_GetTopicInfo" ; //调用存储过程<br>myCommand.CommandType = CommandType.StoredProcedure ;<br>myCommand.Parameters.Add(new SQLParameter("@a_intTopicID" , SQLDataType.Int)) ;<br>myCommand.Parameters["@a_intTopicID"].Value = a_intID ;<br><br>notepage objNp = new notepage();<br>try<br>{ <br><br>myConn.Open() ;<br>SQLDataReader myReader ;<br>myCommand.Execute(out myReader) ;<br>if (myReader.Read())<br>{<!-- --><br>objNp.ID = (int)myReader["ID"] ;<br>objNp.Title = (string)myReader["Title"] ;<br>objNp.Author = (string)myReader["Author"] ;<br>objNp.Content = (string)myReader["Content"];<br>objNp.adddate = (DateTime)myReader["adddate"];<br>}<br><br><br><br>//清场<br>myReader.Close();<br>myConn.Close() ;<br><br>}<br>catch(Exception e)<br>{<!-- --><br>throw(new Exception("取贴子失败:" + e.ToString())) ;<br>}<br>return objNp;<br><br>}<br><br>/// &lt;summary&gt;<br>/// <br>/// 目的：将留言的内容入库<br>/// <br>/// 利用构造函数来传递信息<br>/// <br>/// &lt;/summary&gt;<br>/// &lt;param name="n_Topic"&gt; &lt;/param&gt;<br>public bool AddTopic(notepage n_Topic)<br>{<!-- --><br>//<br>// TODO: Add Constructor Logic here<br>//<br><br>//读取数据库<br>myconn myConn = new myconn();<br><br>SQLCommand myCommand = new SQLCommand() ;<br>myCommand.ActiveConnection = myConn ;<br>myCommand.CommandText = "n_addTopic" ; //调用存储过程<br>myCommand.CommandType = CommandType.StoredProcedure ;<br>myCommand.Parameters.Add(new SQLParameter("@a_strTitle" , SQLDataType.VarChar,100)) ;<br>myCommand.Parameters["@a_strTitle"].Value = n_Topic.Title ;<br><br>myCommand.Parameters.Add(new SQLParameter("@a_strAuthor" , SQLDataType.VarChar,50)) ;<br>myCommand.Parameters["@a_strAuthor"].Value = n_Topic.Author ;<br><br>myCommand.Parameters.Add(new SQLParameter("@a_strContent" , SQLDataType.VarChar,2000)) ;<br>myCommand.Parameters["@a_strContent"].Value = n_Topic.Content ;<br><br>try<br>{ <br><br>myConn.Open() ;<br>myCommand.ExecuteNonQuery() ;<br><br>//清场<br><br>myConn.Close() ;<br><br>}<br>catch(Exception e)<br>{<!-- --><br>throw(new Exception("取贴子失败:" + e.ToString())) ;<br>}<br>return true;<br><br><br><br>}<br><br><br>/// &lt;summary&gt;<br>/// 取的贴子列表<br>/// &lt;/summary&gt;<br>/// &lt;remarks&gt;<br>/// 返回一个Topic数组<br>/// &lt;/remarks&gt;<br>public ArrayList GetTopicList()<br>{<!-- --><br>//定义一个forum数组做为返回值<br>ArrayList arrForumList =new ArrayList() ;<br><br>//从数据库中读取留言列表<br>myconn myConn = new myconn();<br>SQLCommand myCommand = new SQLCommand() ;<br>myCommand.ActiveConnection = myConn ;<br>myCommand.CommandText = "n_GetTopicList" ; //调用存储过程<br>myCommand.CommandType = CommandType.StoredProcedure ;<br><br>try<br>{<!-- --><br>myConn.Open() ;<br>SQLDataReader myReader ;<br>myCommand.Execute(out myReader) ;<br><br>for (int i = 0 ; myReader.Read() ; i++)<br>{<!-- --><br>notepage objItem = new notepage() ;<br>objItem.ID = myReader["ID"].ToString().ToInt32() ;<br>objItem.Title = myReader["Title"].ToString() ;<br>objItem.Author = myReader["Author"].ToString() ;<br>objItem.adddate = myReader["adddate"].ToString().ToDateTime(); <br>objItem.Content = myReader["Content"].ToString();<br><br>arrForumList.Add(objItem) ;<br>}<br><br><br>//清场<br>myReader.Close();<br>myConn.Close() ;<br><br>}<br>catch(SQLException e)<br>{<!-- --><br>throw(new Exception("数据库出错:" + e.ToString())) ;<br>//return null ;<br>}<br><br>return arrForumList ;<br>}<br><br>}<br>}<br><br><br></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0b8374b8460b0b42caea30fa4e84e50f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ASP.NET立即上手教程 7</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2dcf3117bf4a29bd9b0b80cb41f452e2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">EIA232 Standard(RSR232)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>