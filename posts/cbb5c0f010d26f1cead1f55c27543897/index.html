<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>大众点评Cat实时应用监控平台服务端部署 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/cbb5c0f010d26f1cead1f55c27543897/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="大众点评Cat实时应用监控平台服务端部署">
  <meta property="og:description" content="关于cat服务端部署的相关文档地址如下：
https://github.com/dianping/cat/wiki/readme_server
话不多说，接下来就按照官方文档流程走一遍，我这里是使用的Windows系统进行部署。
第一步确认环境：
我这边使用的是如下环境：
jdk: 1.8
mysql: 5.7 切记不要用8.x的mysql
tomcat: 7.0.35
环境也可以不一样，具体参考上面的文档
第二步编写相关配置文件：
因为我们是Windows上部署，所以可以直接跳过官方文档的第一步：
tomcat conf下的server.xml是否修改不影响，最好是不动任何配置（修改了好像还是乱码）
这一步很重要
因为是在Windows上部署，所以你要确定你的tomcat打算放在哪个盘进行运行，比如你的tomcat解压放在D盘的某个路径下，那么你创建的data/appdatas/cat和data/applogs/cat目录就必须是在D盘下，并且全路径就只能是 d:/data/appdatas/cat d:/data/applogs/cat，千万不要想着把这些个文件夹创建在别的地方。
当然还要一种方式只需要创建一个d:/data/appdatas/cat文件夹的方式，先把这个文件夹路径创建好，然后给自己电脑的环境变量添加一个变量为CAT_HOME的，值就是这个文件夹路径：
这样的话，日志和appdatas最后都会在这个文件夹里保存，还有，如果你的d盘里已经有了一个data文件夹（可能是因为运行其他软件导致有的），直接在这个文件夹里创建appdatas/cat路径即可：
随后在appdatas/cat文件夹里创建两个xml配置文件：
client.xml
&amp;lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&amp;gt; &amp;lt;config mode=&#34;client&#34;&amp;gt; &amp;lt;servers&amp;gt; &amp;lt;server ip=&#34;127.0.0.1&#34; port=&#34;2280&#34; http-port=&#34;8080&#34;/&amp;gt; &amp;lt;/servers&amp;gt; &amp;lt;/config&amp;gt; 我这里只在本地机器部署了，所以ip是127.0.0.1,其他像port和http-port不要修改，并且tomcat运行的端口号也不要修改，让tomcat默认以8080启动即可
datasources.xml
&amp;lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&amp;gt; &amp;lt;data-sources&amp;gt; &amp;lt;data-source id=&#34;cat&#34;&amp;gt; &amp;lt;maximum-pool-size&amp;gt;3&amp;lt;/maximum-pool-size&amp;gt; &amp;lt;connection-timeout&amp;gt;1s&amp;lt;/connection-timeout&amp;gt; &amp;lt;idle-timeout&amp;gt;10m&amp;lt;/idle-timeout&amp;gt; &amp;lt;statement-cache-size&amp;gt;1000&amp;lt;/statement-cache-size&amp;gt; &amp;lt;properties&amp;gt; &amp;lt;driver&amp;gt;com.mysql.jdbc.Driver&amp;lt;/driver&amp;gt; &amp;lt;url&amp;gt;&amp;lt;![CDATA[jdbc:mysql://127.0.0.1:3306/cat]]&amp;gt;&amp;lt;/url&amp;gt; &amp;lt;!-- 请替换为真实数据库URL及Port --&amp;gt; &amp;lt;user&amp;gt;root&amp;lt;/user&amp;gt; &amp;lt;!-- 请替换为真实数据库用户名 --&amp;gt; &amp;lt;password&amp;gt;root&amp;lt;/password&amp;gt; &amp;lt;!-- 请替换为真实数据库密码 --&amp;gt; &amp;lt;connectionProperties&amp;gt;&amp;lt;![CDATA[useUnicode=true&amp;amp;characterEncoding=UTF-8&amp;amp;autoReconnect=true&amp;amp;socketTimeout=120000]]&amp;gt;&amp;lt;/connectionProperties&amp;gt; &amp;lt;/properties&amp;gt; &amp;lt;/data-source&amp;gt; &amp;lt;/data-sources&amp;gt; 填写好你自己的数据库地址以及root用户的密码，因为使用的是5.7版本的数据库，所以像driver无需加cj，connectionProperties中也不需要加serverTimezone参数。
配置数据库时，记得把相应的表也给创建好，数据库名称要和文件里的一致，表的SQL在cat的github文档里也有：">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-10-10T15:22:48+08:00">
    <meta property="article:modified_time" content="2022-10-10T15:22:48+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大众点评Cat实时应用监控平台服务端部署</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>关于cat服务端部署的相关文档地址如下：<br> <a href="https://github.com/dianping/cat/wiki/readme_server">https://github.com/dianping/cat/wiki/readme_server</a><br> 话不多说，接下来就按照官方文档流程走一遍，我这里是使用的Windows系统进行部署。</p> 
<p>第一步确认环境：<br> 我这边使用的是如下环境：<br> jdk: 1.8<br> mysql: 5.7 <em><strong>切记不要用8.x的mysql</strong></em><br> tomcat: 7.0.35<br> 环境也可以不一样，具体参考上面的文档<br> 第二步编写相关配置文件：<br> 因为我们是Windows上部署，所以可以直接跳过官方文档的第一步：<br> <img src="https://images2.imgbox.com/d9/8e/1u4WU67x_o.png" alt="在这里插入图片描述"><br> tomcat conf下的server.xml是否修改不影响，最好是不动任何配置（修改了好像还是乱码）</p> 
<p><img src="https://images2.imgbox.com/2a/95/17jS3TgV_o.png" alt="在这里插入图片描述"><br> <em><strong>这一步很重要</strong></em><br> 因为是在Windows上部署，所以你要确定你的tomcat打算放在哪个盘进行运行，比如你的tomcat解压放在D盘的某个路径下，那么你创建的<code>data/appdatas/cat</code>和<code>data/applogs/cat</code>目录就必须是在D盘下，并且全路径就只能是 <code>d:/data/appdatas/cat</code> <code>d:/data/applogs/cat</code>，千万不要想着把这些个文件夹创建在别的地方。<br> 当然还要一种方式只需要创建一个<code>d:/data/appdatas/cat</code>文件夹的方式，先把这个文件夹路径创建好，然后给自己电脑的环境变量添加一个变量为<code>CAT_HOME</code>的，值就是这个文件夹路径：<br> <img src="https://images2.imgbox.com/e1/f6/khoIA4NU_o.png" alt="在这里插入图片描述"><br> 这样的话，日志和appdatas最后都会在这个文件夹里保存，还有，如果你的d盘里已经有了一个data文件夹（可能是因为运行其他软件导致有的），直接在这个文件夹里创建<code>appdatas/cat</code>路径即可：<br> <img src="https://images2.imgbox.com/a5/d6/EJPtWFPV_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c3/f0/4gI8OffP_o.png" alt="在这里插入图片描述"></p> 
<p>随后在appdatas/cat文件夹里创建两个xml配置文件：<br> <img src="https://images2.imgbox.com/4c/47/ficXmxvs_o.png" alt="在这里插入图片描述"><br> <code>client.xml</code></p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>config</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>client<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servers</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>server</span> <span class="token attr-name">ip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>127.0.0.1<span class="token punctuation">"</span></span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2280<span class="token punctuation">"</span></span> <span class="token attr-name">http-port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>8080<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servers</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>config</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>我这里只在本地机器部署了，所以ip是127.0.0.1,其他像port和http-port不要修改，并且tomcat运行的端口号也不要修改，让tomcat默认以8080启动即可</p> 
<p><code>datasources.xml</code></p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data-sources</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data-source</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cat<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maximum-pool-size</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maximum-pool-size</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>connection-timeout</span><span class="token punctuation">&gt;</span></span>1s<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>connection-timeout</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>idle-timeout</span><span class="token punctuation">&gt;</span></span>10m<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>idle-timeout</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statement-cache-size</span><span class="token punctuation">&gt;</span></span>1000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statement-cache-size</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>driver</span><span class="token punctuation">&gt;</span></span>com.mysql.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>driver</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span><span class="token cdata">&lt;![CDATA[jdbc:mysql://127.0.0.1:3306/cat]]&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>  <span class="token comment">&lt;!-- 请替换为真实数据库URL及Port  --&gt;</span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">&gt;</span></span>  <span class="token comment">&lt;!-- 请替换为真实数据库用户名  --&gt;</span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">&gt;</span></span>  <span class="token comment">&lt;!-- 请替换为真实数据库密码  --&gt;</span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>connectionProperties</span><span class="token punctuation">&gt;</span></span><span class="token cdata">&lt;![CDATA[useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;socketTimeout=120000]]&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>connectionProperties</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>data-source</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>data-sources</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>填写好你自己的数据库地址以及root用户的密码，因为使用的是5.7版本的数据库，所以像driver无需加cj，connectionProperties中也不需要加serverTimezone参数。</p> 
<p>配置数据库时，记得把相应的表也给创建好，数据库名称要和文件里的一致，表的SQL在cat的github文档里也有：<br> <a href="https://github.com/dianping/cat/tree/master/script">https://github.com/dianping/cat/tree/master/script</a></p> 
<p>配置好这两个文件后，去把github上把稳定版本的<code>cat-home.war</code>包下载下来<br> <a href="https://github.com/dianping/cat/releases">https://github.com/dianping/cat/releases</a><br> 文档建议下载<code>v3.1.0</code>的，我这边使用的也是这个版本：<br> <img src="https://images2.imgbox.com/58/21/RlxnvdZZ_o.png" alt="在这里插入图片描述"></p> 
<p>当然你也可以把master分支的cat仓库拉取下来然后自行打包（由于一些依赖问题我并没有成功打包，所以直接使用稳定版本的war包）</p> 
<p>第三步部署项目：<br> 将下载好的<code>cat-home.war</code>名称修改为<code>cat.war</code>然后丢入tomcat的websapp中，然后双击tomcat的startup.bat启动即可！<br> <img src="https://images2.imgbox.com/12/8f/qbrm1cmi_o.png" alt="在这里插入图片描述"><br> 这样就是正常启动了，如果控制台有报错那就得慢慢排查了。<br> 正常启动之后在浏览器输入<a href="http://localhost:8080/cat/r/" rel="nofollow">http://localhost:8080/cat/r/</a><br> 看到如下页面即可<br> <img src="https://images2.imgbox.com/9b/10/LcITfHuW_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9cc20a490b582010429685648926ee16/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">lvgl v8 linux下使用xmake交叉编译移植</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5ae74713e56a614725fcceb27e84b2d5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Node.js 应用部署到 SAP 云平台上访问时出现 502 Bad Gateway 错误分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>