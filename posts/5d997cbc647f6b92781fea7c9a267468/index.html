<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PIL生成图像验证码 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/5d997cbc647f6b92781fea7c9a267468/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="PIL生成图像验证码">
  <meta property="og:description" content="验证码图像生成的原理是这样的：随机地生成若干个字符，并绘制到图像中，然后对图像的背景或前景进行识别难度的处理，处理措施包括：
（1）随机绘制不同颜色的背景点；（
2）使用随机色绘制字符；
（3）在图像中绘制随机的线段；
（4）对图片进行变形、模糊等处理。
（5）显示花、球等实物图像让操作者识别，以增加提交的难度。
#PIL生成图像验证码 from PIL import Image,ImageDraw,ImageFont from numpy.random import randint,random def rndChar(): #产生随机字符 s=&#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789@#$%&amp;amp;*&#34; return s[randint(0,len(s))] def rndColor():#生成随机颜色 return tuple(randint(64,256,3)) w=50*6;h=60 #设置图像的宽度和高度 a=Image.new(&#39;RGB&#39;,(w,h),(255,255,255)) #创建新图像（颜色模式，尺寸，颜色数值） font=ImageFont.truetype(&#34;C:\\Windows\\Fonts\\simsunb.ttf&#34;,48) b=ImageDraw.Draw(a) #创建Draw对象 def createLines(n): #绘制干扰线 for i in range(n): begin=(randint(0,w),randint(0,h)) #起始点 end=(randint(0,w),randint(0,h)) #结束点 b.line([begin,end],fill=rndColor(),width=2) def createPoints(rate): #绘制干扰点 for x in range(w): for y in range(h): if random(1)&amp;lt;=rate: b.point((x,y),fill=rndColor()) def drawStr(): #绘制字符 Str=&#39;&#39; for t in range(6): Chr=rndChar() Str=Str&#43;Chr b.text((50*t&#43;10,5),Chr,font=font,fill=rndColor()) print(Str) createLines(6) createPoints(0.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-02-05T22:14:16+08:00">
    <meta property="article:modified_time" content="2021-02-05T22:14:16+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PIL生成图像验证码</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>验证码图像生成的原理是这样的：随机地生成若干个字符，并绘制到图像中，然后对图像的背景或前景进行识别难度的处理，处理措施包括：<br> （1）随机绘制不同颜色的背景点；（<br> 2）使用随机色绘制字符；<br> （3）在图像中绘制随机的线段；<br> （4）对图片进行变形、模糊等处理。<br> （5）显示花、球等实物图像让操作者识别，以增加提交的难度。</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token comment">#PIL生成图像验证码</span>
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span>ImageDraw<span class="token punctuation">,</span>ImageFont
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>random <span class="token keyword">import</span> randint<span class="token punctuation">,</span>random
<span class="token keyword">def</span> <span class="token function">rndChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token comment">#产生随机字符</span>
    s<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789@#$%&amp;*"</span>

    <span class="token keyword">return</span> s<span class="token punctuation">[</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">rndColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#生成随机颜色</span>
    <span class="token keyword">return</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

w<span class="token operator">=</span><span class="token number">50</span><span class="token operator">*</span><span class="token number">6</span><span class="token punctuation">;</span>h<span class="token operator">=</span><span class="token number">60</span>    <span class="token comment">#设置图像的宽度和高度</span>
a<span class="token operator">=</span>Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">#创建新图像（颜色模式，尺寸，颜色数值）</span>
font<span class="token operator">=</span>ImageFont<span class="token punctuation">.</span>truetype<span class="token punctuation">(</span><span class="token string">"C:\\Windows\\Fonts\\simsunb.ttf"</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">)</span>
b<span class="token operator">=</span>ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment">#创建Draw对象</span>

<span class="token keyword">def</span> <span class="token function">createLines</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment">#绘制干扰线</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        begin<span class="token operator">=</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>w<span class="token punctuation">)</span><span class="token punctuation">,</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">#起始点</span>
        end<span class="token operator">=</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>w<span class="token punctuation">)</span><span class="token punctuation">,</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#结束点</span>
    b<span class="token punctuation">.</span>line<span class="token punctuation">(</span><span class="token punctuation">[</span>begin<span class="token punctuation">,</span>end<span class="token punctuation">]</span><span class="token punctuation">,</span>fill<span class="token operator">=</span>rndColor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">createPoints</span><span class="token punctuation">(</span>rate<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#绘制干扰点</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> random<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>rate<span class="token punctuation">:</span>
                b<span class="token punctuation">.</span>point<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span>fill<span class="token operator">=</span>rndColor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">drawStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#绘制字符</span>
    Str<span class="token operator">=</span><span class="token string">''</span>
    <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        Chr<span class="token operator">=</span>rndChar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        Str<span class="token operator">=</span>Str<span class="token operator">+</span>Chr
        b<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">*</span>t<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Chr<span class="token punctuation">,</span>font<span class="token operator">=</span>font<span class="token punctuation">,</span>fill<span class="token operator">=</span>rndColor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>Str<span class="token punctuation">)</span>
createLines<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
createPoints<span class="token punctuation">(</span><span class="token number">0.15</span><span class="token punctuation">)</span>
drawStr<span class="token punctuation">(</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"figure20.15.png"</span><span class="token punctuation">)</span>

</code></pre> 
<p>运行结果：<br> <img src="https://images2.imgbox.com/e2/0f/qSyerZLh_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e5c9e469d3a065cf35c77d17b2dacd8d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">凑微分公式_高等数学–求积分的一些方法（IV 凑微分法）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f652c6cf428a502048f2f49d0d06e84d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">我的西皮优学习笔记（五）-＞二进制及其表示法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>