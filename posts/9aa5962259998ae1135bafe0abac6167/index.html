<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JAVA学习之Memcached - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/9aa5962259998ae1135bafe0abac6167/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="JAVA学习之Memcached">
  <meta property="og:description" content="JAVA学习之Memcached
1、安装及命令
下载完成后，使用管理员运行cmd，进入memcached的目录下，即memcached.exe所在的目录
安装命令：memcached -d install
启动命令：memcached -d start
修改端口命令： memcached.exe -p 11211 -m 64 （ 指定它的监听端口是11211（这是它的默认端口，可以指定为其它大于1024的端口，因为小于1024的端口已经有了默认指定），最大使用内存为64m）
远程连接命令：telnet 127.0.0.1 11211 （注意：memcached默认的端口就是11211）
链接成功之后，可输入命令：
stats --&amp;gt; 查看状态
quit --&amp;gt; 退出链接
flush_all --&amp;gt; 刷新
存储命令的格式：
&amp;lt;command name&amp;gt; &amp;lt;key&amp;gt; &amp;lt;flags&amp;gt; &amp;lt;exptime&amp;gt; &amp;lt;bytes&amp;gt; &amp;lt;data block&amp;gt; 参数说明如下： &amp;lt;command name&amp;gt; set/add/replace　&amp;lt;key&amp;gt; 查找关键字 &amp;lt;flags&amp;gt; 客户机使用它存储关于键值对的额外信息 &amp;lt;exptime&amp;gt; 该数据的存活时间，0表示永远 &amp;lt;bytes&amp;gt; 存储字节数 &amp;lt;data block&amp;gt; 存储的数据块（可直接理解为key-value结构中的value） 常用的几个命令：add/set/get/delete/gets/cas/replace 2、spring集成memcached过程
首先增加memcached的连接属性文件xmemcached.properties，代码如下：
#连接池大小即客户端个数
memcached.connectionPoolSize=1
memcached.failureMode=true
#server1
memcached.server1.host=127.0.0.1
memcached.server1.port=11211
memcached.server1.weight=1
然后增加spring对xmemcached的整合文件xmemcached.xml，代码如下：
&amp;lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&amp;gt; &amp;lt;beans xmlns=&#34;">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-07-18T11:40:46+08:00">
    <meta property="article:modified_time" content="2020-07-18T11:40:46+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JAVA学习之Memcached</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>JAVA学习之Memcached</p> 
<p>1、安装及命令</p> 
<p>下载完成后，使用管理员运行cmd，进入memcached的目录下，即memcached.exe所在的目录</p> 
<p>安装命令：memcached -d install</p> 
<p>启动命令：memcached -d start</p> 
<p>修改端口命令： memcached.exe -p 11211 -m 64 （ 指定它的监听端口是11211（这是它的默认端口，可以指定为其它大于1024的端口，因为小于1024的端口已经有了默认指定），最大使用内存为64m）</p> 
<p>远程连接命令：telnet 127.0.0.1 11211 （注意：memcached默认的端口就是11211）</p> 
<p>链接成功之后，可输入命令：</p> 
<p>stats --&gt; 查看状态</p> 
<p>quit --&gt; 退出链接</p> 
<p>flush_all --&gt; 刷新</p> 
<p>存储命令的格式：</p> 
<pre><code class="prism language-java">　<span class="token operator">&lt;</span>command name<span class="token operator">&gt;</span> <span class="token generics function"><span class="token punctuation">&lt;</span>key<span class="token punctuation">&gt;</span></span> <span class="token generics function"><span class="token punctuation">&lt;</span>flags<span class="token punctuation">&gt;</span></span> <span class="token generics function"><span class="token punctuation">&lt;</span>exptime<span class="token punctuation">&gt;</span></span> <span class="token generics function"><span class="token punctuation">&lt;</span>bytes<span class="token punctuation">&gt;</span></span>
　　<span class="token operator">&lt;</span>data block<span class="token operator">&gt;</span>

参数说明如下：
　　　　<span class="token operator">&lt;</span>command name<span class="token operator">&gt;</span>   set<span class="token operator">/</span>add<span class="token operator">/</span>replace　　
　　　　<span class="token generics function"><span class="token punctuation">&lt;</span>key<span class="token punctuation">&gt;</span></span>  查找关键字  
　　　　<span class="token generics function"><span class="token punctuation">&lt;</span>flags<span class="token punctuation">&gt;</span></span>  客户机使用它存储关于键值对的额外信息  
　　 　　<span class="token generics function"><span class="token punctuation">&lt;</span>exptime<span class="token punctuation">&gt;</span></span> 该数据的存活时间，<span class="token number">0</span>表示永远  
　　　　<span class="token generics function"><span class="token punctuation">&lt;</span>bytes<span class="token punctuation">&gt;</span></span>  存储字节数  
　　　　<span class="token operator">&lt;</span>data block<span class="token operator">&gt;</span>  存储的数据块（可直接理解为key<span class="token operator">-</span>value结构中的value）

常用的几个命令：add<span class="token operator">/</span>set<span class="token operator">/</span>get<span class="token operator">/</span>delete<span class="token operator">/</span>gets<span class="token operator">/</span>cas<span class="token operator">/</span>replace
</code></pre> 
<p>2、spring集成memcached过程</p> 
<p>首先增加memcached的连接属性文件xmemcached.properties，代码如下：</p> 
<p>#连接池大小即客户端个数<br> memcached.connectionPoolSize=1<br> memcached.failureMode=true<br> #server1<br> memcached.server1.host=127.0.0.1<br> memcached.server1.port=11211<br> memcached.server1.weight=1</p> 
<p>然后增加spring对xmemcached的整合文件xmemcached.xml，代码如下：</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>beans xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
       xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
       xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span>"
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beanshttp<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans<span class="token operator">/</span>spring<span class="token operator">-</span>beans<span class="token operator">-</span><span class="token number">3.1</span><span class="token punctuation">.</span>xsd"<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> properties config   <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"order"</span> value<span class="token operator">=</span><span class="token string">"1"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"ignoreUnresolvablePlaceholders"</span> value<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"locations"</span><span class="token operator">&gt;</span>
            <span class="token generics function"><span class="token punctuation">&lt;</span>list<span class="token punctuation">&gt;</span></span>
                <span class="token generics function"><span class="token punctuation">&lt;</span>value<span class="token punctuation">&gt;</span></span>classpath<span class="token operator">:</span>xmemcached<span class="token punctuation">.</span>properties<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>list<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Memcached配置 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> p<span class="token operator">:</span>connectionPoolSize<span class="token operator">=</span><span class="token string">"${memcached.connectionPoolSize}"</span>   p<span class="token operator">:</span>failureMode<span class="token operator">=</span><span class="token string">"${memcached.failureMode}"</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean   id<span class="token operator">=</span><span class="token string">"memcachedClientBuilder"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"net.rubyeye.xmemcached.XMemcachedClientBuilder"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>constructor<span class="token operator">-</span>arg<span class="token operator">&gt;</span>
            <span class="token generics function"><span class="token punctuation">&lt;</span>list<span class="token punctuation">&gt;</span></span>
                <span class="token operator">&lt;</span>bean <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"java.net.InetSocketAddress"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>constructor<span class="token operator">-</span>arg<span class="token operator">&gt;</span>
                        <span class="token generics function"><span class="token punctuation">&lt;</span>value<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>memcached<span class="token punctuation">.</span>server1<span class="token punctuation">.</span>host<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>constructor<span class="token operator">-</span>arg<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>constructor<span class="token operator">-</span>arg<span class="token operator">&gt;</span>
                        <span class="token generics function"><span class="token punctuation">&lt;</span>value<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>memcached<span class="token punctuation">.</span>server1<span class="token punctuation">.</span>port<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>constructor<span class="token operator">-</span>arg<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>list<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>constructor<span class="token operator">-</span>arg<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>constructor<span class="token operator">-</span>arg<span class="token operator">&gt;</span>
            <span class="token generics function"><span class="token punctuation">&lt;</span>list<span class="token punctuation">&gt;</span></span>
                <span class="token generics function"><span class="token punctuation">&lt;</span>value<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>memcached<span class="token punctuation">.</span>server1<span class="token punctuation">.</span>weight<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>list<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>constructor<span class="token operator">-</span>arg<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"commandFactory"</span> <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>bean <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"net.rubyeye.xmemcached.command.TextCommandFactory"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sessionLocator"</span> <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>bean <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"net.rubyeye.xmemcached.impl.KetamaMemcachedSessionLocator"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"transcoder"</span> <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>bean <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"net.rubyeye.xmemcached.transcoders.SerializingTranscoder"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"connectionPoolSize"</span> value<span class="token operator">=</span><span class="token string">"${memcached.connectionPoolSize}"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"failureMode"</span> value<span class="token operator">=</span><span class="token string">"${memcached.failureMode}"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Use factory bean to build memcached client <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"memcachedClient"</span> factory<span class="token operator">-</span>bean<span class="token operator">=</span><span class="token string">"memcachedClientBuilder"</span> factory<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">"build"</span>  destroy<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">"shutdown"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">&gt;</span>
</code></pre> 
<p>然后在web.xml中增加对此配置文件的加载，代码如下：</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 定义SPRING配置文件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>context<span class="token operator">-</span>param<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">&gt;</span>contextConfigLocation<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">&gt;</span>
    <span class="token operator">/</span>WEB<span class="token operator">-</span>INF<span class="token operator">/</span>conf<span class="token operator">/</span>data<span class="token operator">-</span>source<span class="token punctuation">.</span>xml<span class="token punctuation">,</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token operator">/</span>WEB<span class="token operator">-</span>INF<span class="token operator">/</span>conf<span class="token operator">/</span>dubbo<span class="token operator">/</span>dubbo<span class="token operator">-</span>source<span class="token punctuation">.</span>xml<span class="token punctuation">,</span><span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">/</span>WEB<span class="token operator">-</span>INF<span class="token operator">/</span>conf<span class="token operator">/</span>memcached<span class="token operator">/</span>xmemcached<span class="token punctuation">.</span>xml
  <span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>context<span class="token operator">-</span>param<span class="token operator">&gt;</span>
</code></pre> 
<p>此时就可以使用spring容器中配置好的bean（memcachedClient）来连接memcached来存取值了，但是值得注意的是memcachedClient实例化真的是一个心酸的心路历程，首先我写了一个工具类，然后在工具类中利用注解自动注入memcachedClient这个bean，结果可想而知，在项目启动的时候，工具类都没有实例化，那它里边的memcachedClient更实例化不了了，每次都是空指针…，然后我就换了一种方式，把我存放相关memcached的一些工具方法写到了一个service中，增加了service的注解，然后使用set注入的方式来注入memcachedClient，依然没有成功，还是空指针…，一直以为是没有实例化到spring容器中，其实是因为set注入没有成功，并没有找到原因，工具业务类代码如下：</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>privates<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>privates<span class="token punctuation">.</span>comm<span class="token punctuation">.</span>BaseComm<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>privates<span class="token punctuation">.</span>service<span class="token punctuation">.</span>MemcachedService<span class="token punctuation">;</span>
<span class="token keyword">import</span> net<span class="token punctuation">.</span>rubyeye<span class="token punctuation">.</span>xmemcached<span class="token punctuation">.</span>MemcachedClient<span class="token punctuation">;</span>
<span class="token keyword">import</span> net<span class="token punctuation">.</span>rubyeye<span class="token punctuation">.</span>xmemcached<span class="token punctuation">.</span>exception<span class="token punctuation">.</span>MemcachedException<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Service<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>TimeoutException<span class="token punctuation">;</span>

<span class="token comment">/**
* @author renyf24249
* @version $ID: MemcachedUtils.java, v  2019/2/21 13:45 Exp $
*/</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MemcachedServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">BaseComm</span> <span class="token keyword">implements</span> <span class="token class-name">MemcachedService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> TIME_OUT <span class="token operator">=</span> <span class="token number">36000</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> MemcachedClient memcachedClient<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Object value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> TIME_OUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Object value<span class="token punctuation">,</span> Integer timeOut<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            memcachedClient<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> timeOut<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TimeoutException</span> <span class="token operator">|</span> InterruptedException <span class="token operator">|</span> MemcachedException e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"set memcached error"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> Object <span class="token function">get</span><span class="token punctuation">(</span>String key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> memcachedClient<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TimeoutException</span> <span class="token operator">|</span> InterruptedException <span class="token operator">|</span> MemcachedException e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"get memcached error"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">replace</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Object newValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">replace</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> newValue <span class="token punctuation">,</span>TIME_OUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">replace</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Object newValue<span class="token punctuation">,</span> Integer timeOut<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            memcachedClient<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> timeOut<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TimeoutException</span> <span class="token operator">|</span> InterruptedException <span class="token operator">|</span> MemcachedException e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"replace memcached error"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span>String key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            memcachedClient<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TimeoutException</span> <span class="token operator">|</span> InterruptedException <span class="token operator">|</span> MemcachedException e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"remove memcached error"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后就可以通过调用这个类中的方法操作memcached了。</p> 
<p>3、memcached和redis的优缺点及区别</p> 
<p>1.性能上：<br> 性能上都很出色，具体到细节，由于Redis只使用单核，而Memcached可以使用多核，所以平均每一个核上Redis在存储小数据时比<br> Memcached性能更高。而在100k以上的数据中，Memcached性能要高于Redis，虽然Redis最近也在存储大数据的性能上进行优化，但是比起 Memcached，还是稍有逊色。<br> 2.内存空间和数据量大小：<br> MemCached可以修改最大内存，采用LRU算法。Redis增加了VM的特性，突破了物理内存的限制。redis最大可以达到1GB，而memcache只有1MB<br> 3.操作便利上：<br> MemCached数据结构单一，仅用来缓存数据，而Redis支持更加丰富的数据类型，也可以在服务器端直接对数据进行丰富的操作,这样可以减少网络IO次数和数据体积。<br> 4.可靠性上：<br> MemCached不支持数据持久化，断电或重启后数据消失，但其稳定性是有保证的。Redis支持数据持久化和数据恢复，允许单点故障，但是同时也会付出性能的代价。<br> 5.应用场景：<br> Memcached：动态系统中减轻数据库负载，提升性能；做缓存，适合多读少写，大数据量的情况（如人人网大量查询用户信息、好友信息、文章信息等）。<br> Redis：适用于对读写效率要求都很高，数据处理业务复杂和对安全性要求较高的系统（如新浪微博的计数和微博发布部分系统，对数据安全性、读写要求都很高）。</p> 
<p>综上所诉，其实memached还是有自己的一些生存空间的，如果我们的目的仅仅是提高性能，而且是小数据量，读多写少，我相信memached完胜redis</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c3f8d1b2ec7c51333aa0ecf7ca0b461d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JAVA学习之终端适配（spring根据设备自动切换页面）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5d647b76c341c2c127ea32612ca8a7d6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java学习之spring集成Dubbo</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>