<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Kotlin在处理GET和POST请求的数据问题 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/cdc6f0fd4ef369717845ab9b1e8d8395/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="Kotlin在处理GET和POST请求的数据问题">
  <meta property="og:description" content="1.网络请求获取到的数据流处理
java写法
1 BufferedReader br = new BufferedReader(new InputStreamReader(in, &#34;utf-8&#34;)); 2 3 String line; 4 StringBuffer sb = new StringBuffer(); 5 while ((line = br.readLine()) != null) {//cotlin会出现无限循环的语法错误 6 sb.append(line); 7 } Kotlin改写连接字符的几种写法
写法一
var inStrem: InputStream = response.body().byteStream() var br: BufferedReader = BufferedReader(InputStreamReader(inStrem, &#34;utf-8&#34;)) var line: String?=null var sb: StringBuffer = StringBuffer() while ({ line = br.readLine(); line }() != null) { // &amp;lt;--- The IDE asks me to replace this line for while(true), what the.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2018-03-12T15:28:00+08:00">
    <meta property="article:modified_time" content="2018-03-12T15:28:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Kotlin在处理GET和POST请求的数据问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p>1.网络请求获取到的数据流处理</p> 
 <p>java写法</p> 
 <div class="cnblogs_code"> 
  <pre><span style="color:#008080;">1</span>  BufferedReader br = <span style="color:#0000ff;">new</span> BufferedReader(<span style="color:#0000ff;">new</span> InputStreamReader(in, "utf-8"<span style="color:#000000;">));
</span><span style="color:#008080;">2</span> 
<span style="color:#008080;">3</span> <span style="color:#000000;">                String line;
</span><span style="color:#008080;">4</span>                 StringBuffer sb = <span style="color:#0000ff;">new</span><span style="color:#000000;"> StringBuffer();
</span><span style="color:#008080;">5</span>                 <span style="color:#0000ff;">while</span> ((line = br.readLine()) != <span style="color:#0000ff;">null</span><span style="color:#000000;">) {//cotlin会出现无限循环的语法错误
</span><span style="color:#008080;">6</span> <span style="color:#000000;">                    sb.append(line);
</span><span style="color:#008080;">7</span>                 }</pre> 
 </div> 
 <p>Kotlin改写连接字符的几种写法</p> 
 <p>写法一</p> 
 <div class="cnblogs_Highlighter"> 
  <pre><code class="language-csharp">var inStrem: InputStream = response.body().byteStream()
                    var br: BufferedReader = BufferedReader(InputStreamReader(inStrem, "utf-8"))
                    var line: String?=null
                    var sb: StringBuffer = StringBuffer()

                    while ({ line = br.readLine(); line }() != null) { // &lt;--- The IDE asks me to replace this line for while(true), what the...?
                        sb.append(line)
                    }
</code></pre> 
 </div> 
 <p> 写法二</p> 
 <p> <span class="cnblogs_code"><span style="color:#008080;">1</span> <span style="color:#0000ff;">while</span> ({line = br.readLine();line}()!=<span style="color:#0000ff;">null</span><span style="color:#000000;">) { </span><span style="color:#008080;">2</span> <span style="color:#000000;"> sb.append(line) </span><span style="color:#008080;">3</span> }</span> </p> 
 <p>写法三</p> 
 <p> <span class="cnblogs_code"><span style="color:#000000;"> br.lineSequence().forEach { print(it) sb.append(it) }</span></span>  </p> 
 <p>2.okhttp处理</p> 
 <div class="cnblogs_code"> 
  <pre><span style="color:#0000ff;">public</span> fun connectHttp(url: String) :String?<span style="color:#000000;"> {
        var tempString:String</span>?=<span style="color:#0000ff;">null</span><span style="color:#000000;">
        var client: OkHttpClient </span>=<span style="color:#000000;"> OkHttpClient()
        val requset </span>=<span style="color:#000000;"> Request.Builder()
                .url(url)
                .post(RequestBody.create(MediaType.parse(</span>"text/plain; utf-8"), "this is test"<span style="color:#000000;">))
                .build()<br><br><br>        //异步处理
        client.newCall(requset).enqueue(object : Callback {
            override fun onFailure(request: Request</span>?, e: IOException?<span style="color:#000000;">) {
                TODO(</span>"not implemented") <span style="color:#008000;">//</span><span style="color:#008000;">To change body of created functions use File | Settings | File Templates.</span>
<span style="color:#000000;">            }

            override fun onResponse(response: Response</span>?<span style="color:#000000;">) {
                </span><span style="color:#0000ff;">if</span> (response!!<span style="color:#000000;">.isSuccessful)
                    tempString </span>=<span style="color:#000000;">  response.body().string()



                    TODO(</span>"not implemented") <span style="color:#008000;">//</span><span style="color:#008000;">To change body of created functions use File | Settings | File Templates.</span>
<span style="color:#000000;">            }
        })
        </span><span style="color:#0000ff;">if</span> (tempString!!<span style="color:#000000;">.isEmpty()){
            </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> tempString
        }</span><span style="color:#0000ff;">else</span>
            <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">null</span><span style="color:#000000;">
    }</span></pre> 
 </div> 
 <p> </p> 
 <p>数据体常见的请求属性：</p> 
 <p><span style="color:#1d8711;">/**<br><span style="color:#1d8711;"> * <span style="color:#1d8711;font-family:'宋体';">属性：<br><span style="color:#1d8711;">text/html <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;"> HTML<span style="color:#1d8711;font-family:'宋体';">格式<br><span style="color:#1d8711;">text/plain <span style="color:#1d8711;font-family:'宋体';">：纯文本格式<br><span style="color:#1d8711;">text/xml <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;"> XML<span style="color:#1d8711;font-family:'宋体';">格式<br><span style="color:#1d8711;">image/gif <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;">gif<span style="color:#1d8711;font-family:'宋体';">图片格式<br><span style="color:#1d8711;">image/jpeg <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;">jpg<span style="color:#1d8711;font-family:'宋体';">图片格式<br><span style="color:#1d8711;">image/png<span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;">png<span style="color:#1d8711;font-family:'宋体';">图片格式<br><span style="color:#1d8711;font-family:'宋体';">以<span style="color:#1d8711;">application<span style="color:#1d8711;font-family:'宋体';">开头的媒体格式类型：<br><span style="color:#1d8711;font-family:'宋体';"><br><span style="color:#1d8711;">application/xhtml+xml <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;">XHTML<span style="color:#1d8711;font-family:'宋体';">格式<br><span style="color:#1d8711;">application/xml <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;"> XML<span style="color:#1d8711;font-family:'宋体';">数据格式<br><span style="color:#1d8711;">application/atom+xml <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;">Atom XML<span style="color:#1d8711;font-family:'宋体';">聚合格式<br><span style="color:#1d8711;">application/json <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;"> JSON<span style="color:#1d8711;font-family:'宋体';">数据格式<br><span style="color:#1d8711;">application/pdf <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;">pdf<span style="color:#1d8711;font-family:'宋体';">格式<br><span style="color:#1d8711;">application/msword <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;"> Word<span style="color:#1d8711;font-family:'宋体';">文档格式<br><span style="color:#1d8711;">application/octet-stream <span style="color:#1d8711;font-family:'宋体';">： 二进制流数据（如常见的文件下载）<br><span style="color:#1d8711;">application/x-www-form-urlencoded <span style="color:#1d8711;font-family:'宋体';">：<span style="color:#1d8711;"> &lt;form encType=””&gt;<span style="color:#1d8711;font-family:'宋体';">中默认的<span style="color:#1d8711;">encType<span style="color:#1d8711;font-family:'宋体';">，<span style="color:#1d8711;">form<span style="color:#1d8711;font-family:'宋体';">表单数据被编码为<span style="color:#1d8711;">key/value<span style="color:#1d8711;font-family:'宋体';">格式发送到服务器（表单默认的提交数据的格式）<br><span style="color:#1d8711;font-family:'宋体';"><br><span style="color:#1d8711;font-family:'宋体';">另外一种常见的媒体格式是上传文件之时使用的：<br><span style="color:#1d8711;">multipart/form-data <span style="color:#1d8711;font-family:'宋体';">： 需要在表单中进行文件上传时，就需要使用该格式<br><span style="color:#1d8711;font-family:'宋体';">注意：<span style="color:#1d8711;">MediaType.parse("image/png")<span style="color:#1d8711;font-family:'宋体';">里的<span style="color:#1d8711;">"image/png"<span style="color:#1d8711;font-family:'宋体';">不知道该填什么，可以参考<span style="color:#1d8711;">---<span style="color:#1d8711;font-family:'宋体';">》<span style="color:#1d8711;">http://www.w3school.com.cn/media/media_mimeref.asp<br><span style="color:#1d8711;font-family:'宋体';">如何使用呢？<span style="color:#1d8711;">(<span style="color:#1d8711;font-family:'宋体';">在请求体里面写入类型和需要写入的数据，通过<span style="color:#1d8711;">post<span style="color:#1d8711;font-family:'宋体';">请求<span style="color:#1d8711;">)<br><span style="color:#1d8711;"> */</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
 <p> </p> 
</div> 
<p>转载于:https://www.cnblogs.com/ShengXi-1994/p/8549552.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6218f392476f569ab8b2a2ecdefbec0c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">超级详细的HCL的Telnet服务配置过程（图文）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/186e5f14594940b6876833070cade0ef/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用Kotlin的协程实现简单的异步加载</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>