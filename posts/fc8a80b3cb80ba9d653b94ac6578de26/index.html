<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MATLAB 绘制全国各省 市温度或者湿度地图(附全国省市区县四级地图shp格式) - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/fc8a80b3cb80ba9d653b94ac6578de26/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="MATLAB 绘制全国各省 市温度或者湿度地图(附全国省市区县四级地图shp格式)">
  <meta property="og:description" content="1 效果图 2 代码 clc,clear load(&#39;shpdata.mat&#39;) % save(&#39;shpdata&#39;,&#39;SHP_DATA&#39;) colour_totall=512 shp_data = SHP_DATA.shp_data province_data=shaperead(&#39;maps/bou2_4p.shp&#39;, &#39;UseGeoCoords&#39;, true);% 省 %将省界多边形属性转为线条属性，否则会被覆盖 province_len = length(province_data) for i=1:province_len province_data(i).Geometry = &#39;Line&#39; end num=length(shp_data) %本地图太老没有 香港 澳门 营口 襄阳四个城市 except_city = {&#39;香港&#39; &#39;澳门&#39; &#39;营口&#39; &#39;襄阳&#39; &#39;台湾&#39;} except_num=length(except_city) d=importdata(&#39;temperature.txt&#39;); data=d.data; % 温度数据 city_arr=d.textdata; % 相对应的市名称 datanum = length(data) mycolormap=hot(colour_totall); %将颜色反序 mycolormap = inverted_color(mycolormap) % geo_name={shp_data.NAME}&#39;; for j = 1:num geo_name{j} = shp_data(j).VARNAME_2 end max_temperature = max(data)&#43;2; min_temperature = min(data)-2 n=datanum; % 市数量 symbol_spec=cell(1,n-except_num); % 预定义变量可以加快处理速度 symbol_index=1 for i=1:n tmp_pn=city_arr{i}; %过滤掉四个不在地图内的城市 if ~isempty(findstr(tmp_pn,except_city{1})) || ~isempty(findstr(tmp_pn,except_city{2})) .">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-03-27T18:31:38+08:00">
    <meta property="article:modified_time" content="2020-03-27T18:31:38+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MATLAB 绘制全国各省 市温度或者湿度地图(附全国省市区县四级地图shp格式)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1__0"></a>1 效果图</h3> 
<p><img src="https://images2.imgbox.com/06/6c/BiuPuWkv_o.jpg" alt="在这里插入图片描述"></p> 
<h3><a id="2__2"></a>2 代码</h3> 
<pre><code class="prism language-c">clc<span class="token punctuation">,</span>clear
<span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'shpdata.mat'</span><span class="token punctuation">)</span>
<span class="token operator">%</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token string">'shpdata'</span><span class="token punctuation">,</span><span class="token string">'SHP_DATA'</span><span class="token punctuation">)</span>
colour_totall<span class="token operator">=</span><span class="token number">512</span>
shp_data <span class="token operator">=</span> SHP_DATA<span class="token punctuation">.</span>shp_data

province_data<span class="token operator">=</span><span class="token function">shaperead</span><span class="token punctuation">(</span><span class="token string">'maps/bou2_4p.shp'</span><span class="token punctuation">,</span> <span class="token string">'UseGeoCoords'</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 省

<span class="token operator">%</span>将省界多边形属性转为线条属性，否则会被覆盖
province_len <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>province_data<span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>province_len
    <span class="token function">province_data</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Geometry <span class="token operator">=</span> <span class="token string">'Line'</span>
end



num<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>shp_data<span class="token punctuation">)</span>
<span class="token operator">%</span>本地图太老没有 香港 澳门 营口 襄阳四个城市
except_city <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'香港'</span> <span class="token string">'澳门'</span> <span class="token string">'营口'</span> <span class="token string">'襄阳'</span> <span class="token string">'台湾'</span><span class="token punctuation">}</span>
except_num<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>except_city<span class="token punctuation">)</span>

d<span class="token operator">=</span><span class="token function">importdata</span><span class="token punctuation">(</span><span class="token string">'temperature.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token operator">=</span>d<span class="token punctuation">.</span>data<span class="token punctuation">;</span> <span class="token operator">%</span> 温度数据
city_arr<span class="token operator">=</span>d<span class="token punctuation">.</span>textdata<span class="token punctuation">;</span> <span class="token operator">%</span> 相对应的市名称

datanum <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

mycolormap<span class="token operator">=</span><span class="token function">hot</span><span class="token punctuation">(</span>colour_totall<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span>将颜色反序
mycolormap <span class="token operator">=</span> <span class="token function">inverted_color</span><span class="token punctuation">(</span>mycolormap<span class="token punctuation">)</span>

<span class="token operator">%</span> geo_name<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>shp_data<span class="token punctuation">.</span>NAME<span class="token punctuation">}</span>'<span class="token punctuation">;</span>
<span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>num
    geo_name<span class="token punctuation">{<!-- --></span>j<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">shp_data</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span>VARNAME_2
end

max_temperature <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>
min_temperature <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span>
n<span class="token operator">=</span>datanum<span class="token punctuation">;</span> <span class="token operator">%</span> 市数量

symbol_spec<span class="token operator">=</span><span class="token function">cell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token operator">-</span>except_num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span> 预定义变量可以加快处理速度
symbol_index<span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>n
    tmp_pn<span class="token operator">=</span>city_arr<span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token operator">%</span>过滤掉四个不在地图内的城市
    
    <span class="token keyword">if</span> <span class="token operator">~</span><span class="token function">isempty</span><span class="token punctuation">(</span><span class="token function">findstr</span><span class="token punctuation">(</span>tmp_pn<span class="token punctuation">,</span>except_city<span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">~</span><span class="token function">isempty</span><span class="token punctuation">(</span><span class="token function">findstr</span><span class="token punctuation">(</span>tmp_pn<span class="token punctuation">,</span>except_city<span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token operator">~</span><span class="token function">isempty</span><span class="token punctuation">(</span><span class="token function">findstr</span><span class="token punctuation">(</span>tmp_pn<span class="token punctuation">,</span>except_city<span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">~</span><span class="token function">isempty</span><span class="token punctuation">(</span><span class="token function">findstr</span><span class="token punctuation">(</span>tmp_pn<span class="token punctuation">,</span>except_city<span class="token punctuation">{<!-- --></span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
        <span class="token keyword">continue</span>
    elseif   <span class="token operator">~</span><span class="token function">isempty</span><span class="token punctuation">(</span><span class="token function">findstr</span><span class="token punctuation">(</span>tmp_pn<span class="token punctuation">,</span>except_city<span class="token punctuation">{<!-- --></span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        taiwan_temperature <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token keyword">continue</span>
    end
    
    temperature_t<span class="token operator">=</span><span class="token function">data</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    temperature_t <span class="token operator">=</span> temperature_t<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span>min_temperature<span class="token punctuation">)</span>
    c_index<span class="token operator">=</span><span class="token function">floor</span><span class="token punctuation">(</span> colour_totall <span class="token operator">*</span> temperature_t <span class="token operator">/</span> <span class="token punctuation">(</span>max_temperature<span class="token operator">-</span>min_temperature<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">c_index</span><span class="token punctuation">(</span>c_index<span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    
    geoidx<span class="token operator">=</span> <span class="token function">city_cmp</span><span class="token punctuation">(</span>tmp_pn<span class="token punctuation">,</span>geo_name<span class="token punctuation">)</span>
    
<span class="token operator">%</span>     <span class="token keyword">if</span> symbol_index<span class="token operator">==</span><span class="token number">334</span>
<span class="token operator">%</span>        t<span class="token operator">=</span><span class="token number">1</span> 
<span class="token operator">%</span>     end
    
    <span class="token keyword">if</span> geoidx <span class="token operator">&gt;</span> <span class="token number">0</span>
        city_name<span class="token operator">=</span><span class="token function">geo_name</span><span class="token punctuation">(</span> <span class="token function">geoidx</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        symbol_spec<span class="token punctuation">{<!-- --></span>symbol_index<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'VARNAME_2'</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token punctuation">(</span>city_name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'FaceColor'</span><span class="token punctuation">,</span> <span class="token function">mycolormap</span><span class="token punctuation">(</span> c_index<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        symbol_index <span class="token operator">=</span> symbol_index<span class="token operator">+</span><span class="token number">1</span>
    end
end

<span class="token operator">%</span>增加台湾地区的温度<span class="token punctuation">,</span>将台湾地区视为一个温度
<span class="token operator">%</span>shp 中第<span class="token number">345</span>  <span class="token operator">--</span> <span class="token number">366</span>个元素 共<span class="token number">22</span>个
temperature_t <span class="token operator">=</span> taiwan_temperature<span class="token operator">+</span><span class="token function">abs</span><span class="token punctuation">(</span>min_temperature<span class="token punctuation">)</span>
c_index<span class="token operator">=</span><span class="token function">floor</span><span class="token punctuation">(</span> colour_totall <span class="token operator">*</span> temperature_t <span class="token operator">/</span> <span class="token punctuation">(</span>max_temperature<span class="token operator">-</span>min_temperature<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> j<span class="token operator">=</span><span class="token number">345</span><span class="token punctuation">:</span><span class="token number">366</span>
    symbol_spec<span class="token punctuation">{<!-- --></span>symbol_index<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'VARNAME_2'</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token function">geo_name</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'FaceColor'</span><span class="token punctuation">,</span> <span class="token function">mycolormap</span><span class="token punctuation">(</span> c_index<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    symbol_index <span class="token operator">=</span> symbol_index<span class="token operator">+</span><span class="token number">1</span>
end
<span class="token operator">%</span> 显示地图
figure
ax<span class="token operator">=</span><span class="token function">worldmap</span><span class="token punctuation">(</span><span class="token string">'china'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span> 使用worldmap的坐标轴作图
<span class="token function">setm</span><span class="token punctuation">(</span>ax<span class="token punctuation">,</span><span class="token string">'grid'</span><span class="token punctuation">,</span><span class="token string">'off'</span><span class="token punctuation">)</span> <span class="token operator">%</span> 关闭grid
<span class="token function">setm</span><span class="token punctuation">(</span>ax<span class="token punctuation">,</span><span class="token string">'frame'</span><span class="token punctuation">,</span><span class="token string">'off'</span><span class="token punctuation">)</span> <span class="token operator">%</span> 关闭边框
<span class="token function">setm</span><span class="token punctuation">(</span>ax<span class="token punctuation">,</span><span class="token string">'parallellabel'</span><span class="token punctuation">,</span><span class="token string">'off'</span><span class="token punctuation">)</span> <span class="token operator">%</span> 关闭坐标轴标记
<span class="token function">setm</span><span class="token punctuation">(</span>ax<span class="token punctuation">,</span><span class="token string">'meridianlabel'</span><span class="token punctuation">,</span><span class="token string">'off'</span><span class="token punctuation">)</span> <span class="token operator">%</span> 关闭坐标轴标记

<span class="token operator">%</span> 最关键的两个语句
symbols<span class="token operator">=</span><span class="token function">makesymbolspec</span><span class="token punctuation">(</span><span class="token string">'Polygon'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token string">'default'</span><span class="token punctuation">,</span><span class="token string">'FaceColor'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.9</span> <span class="token number">0.9</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token string">'LineStyle'</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token string">'LineWidth'</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token string">'EdgeColor'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    symbol_spec<span class="token punctuation">{<!-- --></span><span class="token punctuation">:</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span>
<span class="token function">geoshow</span><span class="token punctuation">(</span>shp_data<span class="token punctuation">,</span><span class="token string">'SymbolSpec'</span><span class="token punctuation">,</span>symbols<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token operator">%</span> 图的标注
<span class="token operator">%</span> 在图像右侧显示bar
<span class="token function">colormap</span><span class="token punctuation">(</span>mycolormap<span class="token punctuation">)</span>
hcb<span class="token operator">=</span><span class="token function">colorbar</span><span class="token punctuation">(</span><span class="token string">'EastOutside'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
step<span class="token operator">=</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>max_temperature<span class="token operator">-</span>min_temperature<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>hcb<span class="token punctuation">,</span><span class="token string">'YTick'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>hcb<span class="token punctuation">,</span><span class="token string">'YTickLabel'</span><span class="token punctuation">,</span><span class="token function">num2cell</span><span class="token punctuation">(</span>min_temperature<span class="token punctuation">:</span>step<span class="token punctuation">:</span>max_temperature<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token operator">%</span> 给图像加标题
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'中国各省市地区温度分布图（单位：℃）'</span><span class="token punctuation">)</span>
<span class="token function">geoshow</span><span class="token punctuation">(</span>province_data<span class="token punctuation">,</span><span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token string">'black'</span><span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">1.5</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="3_114"></a>3说明</h3> 
<p>1、网上有关于全国各省的温度分布的博客，但是只绘制了各省的数据图，于是在网上下载了一份包含市、县的地图，由于是国外网站下载的，其中省市名称汉字显示乱码，没办别的办法，硬着头皮，将shp文件读取后存成一个对象文件shpdata.mat，手动将市区的乱码给改写了，因为没找到修改乱码的办法。。。<br> 2、代码中最关键的地方在于首先画各市的地图的时候,画完需要把省界加上去,这个时候如果不修改province_data的Geometry属性’Polygon’,为‘line’，那么第二次调用gepshow的时候就会覆盖上一次图，很好理解，第一次一个位置画了个多边形，第二次又画了一个大小一样的，当然覆盖了，所以想要显示省界，必须把第二次画的图属性改为’line’</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3af7dd9562d1202f9046ae602ad838e3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">HCL配置SSH远程登录实验</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f21463674fdfe69230b4250876d2b40a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">nginx启动报错：/usr/local/nginx/sbin/nginx: error while loading shared libraries: libcrypto.so.1.1:</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>