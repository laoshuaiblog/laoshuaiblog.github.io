<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux系统centos7安装、配置、远程连接mysql8.0.35、开机自启动（究级无敌宇宙第一详细） - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/6bf1260ade47808516617b9ed87622fe/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="Linux系统centos7安装、配置、远程连接mysql8.0.35、开机自启动（究级无敌宇宙第一详细）">
  <meta property="og:description" content="准备 首先需要卸载掉centos7中自带的mariadb，先执行
rpm -qa | grep mariadb # 查看系统中安装的mariadb 如果有输出，则执行，否则进入第一步 ，开始下载mysql安装包
rpm -e --nodeps 【上面命令出现的文件名】 # 删除系统自带的mariadb 查看是否安装 libaio yum list installed | grep libaio 没有安装则执行安装命令
yum install -y libaio 一、下载mysql8.0.35安装包 官方下载地址：MySQL :: Download MySQL Community Server
这里我选择的是.xz格式的包。
这里有一个坑，注意看图中每个包名中都带有(glibc 2.28)，需要去linux控制台中执行下面的命令确认自己的glibc版本，很重要！！！很重要！！！很重要！！！
ldd --version # 查看自己linux的glibc版本号 这里可以看到我的版本号是2.17
所以在下载glibc为2.17的包，下载页面向下翻就可以找到。
可能有人不确定自己的系统是64位还是32位，执行下面命令去确定哈。
uname -m # 查看系统是64位还是32位 二、解压安装包 下载好以后，使用xshell或者其它工具把包放在linux的 /usr/local 下并解压，因为我下载的是.xz格式的包，所以执行下面命令解压。
cd /usr/local tar -Jxvf /usr/local/mysql-8.0.35-linux-glibc2.17-x86_64.tar.xz 三、文件夹重命名 mv mysql-8.0.35-linux-glibc2.17-x86_64 mysql8 # 文件夹重命名 rm -rf mysql-8.0.35-linux-glibc2.17-x86_64.tar.xz # 删除压缩文件 四、添加path环境变量 在linux中添加path变量的目的是为了能在全局使用mysql命令。">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-08T11:37:33+08:00">
    <meta property="article:modified_time" content="2023-12-08T11:37:33+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux系统centos7安装、配置、远程连接mysql8.0.35、开机自启动（究级无敌宇宙第一详细）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>准备</h2> 
<p>首先需要卸载掉centos7中自带的mariadb，先执行</p> 
<pre><code class="language-bash">rpm -qa | grep mariadb  # 查看系统中安装的mariadb</code></pre> 
<p>如果有输出，则执行，否则进入第一步 ，开始下载mysql安装包</p> 
<pre><code class="language-bash">rpm -e --nodeps 【上面命令出现的文件名】  # 删除系统自带的mariadb </code></pre> 
<p>查看是否安装 libaio </p> 
<pre><code class="hljs">yum list installed | grep libaio</code></pre> 
<p> 没有安装则执行安装命令</p> 
<pre><code class="hljs">yum install -y libaio</code></pre> 
<h2>一、下载mysql8.0.35安装包</h2> 
<p>官方下载地址：<a href="https://dev.mysql.com/downloads/mysql/" rel="nofollow" title="MySQL :: Download MySQL Community Server">MySQL :: Download MySQL Community Server</a></p> 
<p>这里我选择的是.xz格式的包。</p> 
<p><img alt="" height="838" src="https://images2.imgbox.com/9a/c0/i3q0kviG_o.png" width="1114"></p> 
<blockquote> 
 <p><u>这里有一个坑，注意看图中每个包名中都带有(glibc 2.28)，需要去linux控制台中执行下面的命令确认自己的glibc版本，很重要！！！很重要！！！很重要！！！</u></p> 
</blockquote> 
<pre><code class="language-bash">ldd --version  # 查看自己linux的glibc版本号</code></pre> 
<p>这里可以看到我的版本号是2.17</p> 
<p><img alt="" height="101" src="https://images2.imgbox.com/79/7c/tNEkfZzI_o.png" width="545"></p> 
<p>所以在下载glibc为2.17的包，下载页面向下翻就可以找到。</p> 
<p><img alt="" height="213" src="https://images2.imgbox.com/dc/e8/Kbk2m7pj_o.png" width="765"></p> 
<p>可能有人不确定自己的系统是64位还是32位，执行下面命令去确定哈。</p> 
<pre><code class="language-bash">uname -m # 查看系统是64位还是32位</code></pre> 
<h2>二、解压安装包</h2> 
<p>下载好以后，使用xshell或者其它工具把包放在linux的 /usr/local 下并解压，因为我下载的是.xz格式的包，所以执行下面命令解压。</p> 
<pre><code class="language-bash">cd /usr/local
tar -Jxvf /usr/local/mysql-8.0.35-linux-glibc2.17-x86_64.tar.xz </code></pre> 
<h2>三、文件夹重命名</h2> 
<pre><code class="language-bash">mv mysql-8.0.35-linux-glibc2.17-x86_64 mysql8  # 文件夹重命名
rm -rf mysql-8.0.35-linux-glibc2.17-x86_64.tar.xz  # 删除压缩文件</code></pre> 
<h2>四、添加path环境变量</h2> 
<p>在linux中添加path变量的目的是为了能在全局使用mysql命令。</p> 
<h3>1. 临时添加</h3> 
<pre><code class="language-bash">export PATH=$PATH:/usr/local/mysql8/bin  # 临时添加path变量，系统重启后失效</code></pre> 
<h3>2. 永久添加</h3> 
<pre><code class="language-bash">echo "export PATH=$PATH:/usr/local/mysql8/bin" &gt;&gt;/etc/profile  # 编辑 /etc/profile 文件
source /etc/profile    # 使更改生效</code></pre> 
<h2>五、查看安装结果</h2> 
<pre><code class="language-bash">mysql --version</code></pre> 
<p>出现以下内容表示安装成功。</p> 
<p><img alt="" height="36" src="https://images2.imgbox.com/fa/6a/5FhwuNNr_o.png" width="525"></p> 
<h2>六、创建用户、组</h2> 
<p>linux中创建用户、组的目的是为了实现权限隔离。建就完事了。</p> 
<pre><code class="language-bash">groupadd mysql  # 创建用户组mysql
useradd -r -g mysql mysql  # 创建用户mysq（-r 创建系统用户  -g 分组）</code></pre> 
<h2>七、创建目录 </h2> 
<pre><code class="language-bash">mkdir -p /data/mysql8/datas  # 数据目录
mkdir -p /data/mysql8/logs  # 日志目录</code></pre> 
<h2> 八、赋予权限</h2> 
<h3>1. 更改文件夹所属用户组</h3> 
<pre><code class="language-bash">chown -R mysql:mysql /data/mysql8</code></pre> 
<h3>2. 更改文件夹权限</h3> 
<pre><code class="language-bash">chmod -R 750 /data/mysql8/datas
chmod -R 750 /data/mysql8/logs</code></pre> 
<h2>九、创建配置文件</h2> 
<pre><code class="language-bash">vim /etc/my.cnf  # 编辑 /etc/my.cnf
# 没有这个文件不要紧，编辑后保存即可</code></pre> 
<p>将以下内容粘贴进my.cnf,然后执行 :wq 保存并退出。</p> 
<blockquote> 
 <p>如果创建的目录跟上面步骤中的不一致，需要对下面的内容进行更改。</p> 
</blockquote> 
<pre><code class="language-bash">[mysql]
#默认字符集
default-character-set=utf8mb4
[client]
port       = 3306
socket     = /tmp/mysql.sock

[mysqld]
port       = 3306
server-id  = 3306
socket     = /tmp/mysql.sock
# 安装目录
basedir    = /usr/local/mysql8
# 数据存放目录
datadir    = /data/mysql8/datas/mysql
log-bin    = /data/mysql8/datas/mysql/mysql-bin
innodb_data_home_dir      =/data/mysql8/datas/mysql
innodb_log_group_home_dir =/data/mysql8/datas/mysql
#日志及进程数据的存放目录
log-error =/data/mysql8/logs/mysql.log
pid-file  =/data/mysql8/logs/mysql.pid
# 服务端使用的字符集默认为8比特编码
character-set-server=utf8mb4
lower_case_table_names=1
autocommit =1
# 创建新表时将使用的默认存储引擎
default_storage_engine = InnoDB</code></pre> 
<h2>十、初始化MySQL</h2> 
<p>执行命令</p> 
<pre><code class="language-bash">mysqld --defaults-file=/etc/my.cnf --basedir=/usr/local/mysql8 --datadir=/data/mysql8/datas/mysql --user=mysql --initialize-insecure</code></pre> 
<p>各参数意义<br>             --defaults-file: 指定配置文件 （放在--initialize-insecure前）<br>             --user: 指定用户<br>             --basedir: 指定安装目录<br>             --datadir: 指定初始化数据目录<br>             --initialize-insecure: 初始化不设置密码（若无该参数，则随机生成密码，需在 /data/mysql8/logs/mysql.log 查看）</p> 
<h2>十一、启动MySQL</h2> 
<p>若没有配置环境变量，即没有执行第四步，则执行该命令</p> 
<pre><code class="language-bash">/usr/local/mysql8/bin/mysqld_safe --defaults-file=/usr/local/mysql8/my.cnf &amp;</code></pre> 
<p>已经配置好了环境变量，则执行</p> 
<pre><code class="language-bash">mysqld_safe --defaults-file=/etc/my.cnf &amp;</code></pre> 
<h2> 十二、查看是否启动成功</h2> 
<pre><code class="language-bash">ps -ef | grep mysql</code></pre> 
<p> 如下图3306端口已被mysql占用，表示启动成功。<img alt="" height="85" src="https://images2.imgbox.com/9b/4f/J7KjIQc6_o.png" width="1200"></p> 
<h2> 十三、登录MySQL</h2> 
<pre><code class="language-bash">mysql -uroot   # 因为初始化mysql时添加了 --initialize-insecure，所以可以无密码进入</code></pre> 
<h2>十四、 修改密码</h2> 
<h3>1. 修改密码</h3> 
<pre><code class="language-bash">ALTER USER 'root'@'localhost' IDENTIFIED BY '新密码';</code></pre> 
<p><img alt="" height="45" src="https://images2.imgbox.com/a5/de/Wx682O8N_o.png" width="497"></p> 
<h3>2. 刷新权限</h3> 
<pre><code class="language-bash">FLUSH PRIVILEGES;</code></pre> 
<p> <img alt="" height="37" src="https://images2.imgbox.com/4b/c3/votqW6vc_o.png" width="385"></p> 
<h3>3. 退出重登</h3> 
<p><img alt="" height="261" src="https://images2.imgbox.com/15/41/ASCVVhRq_o.png" width="611"></p> 
<h2>十五、远程连接MySQL</h2> 
<h3>1. 创建远程连接用户（需要登录mysql）</h3> 
<ul><li> <pre><code class="language-bash">use mysql;

SELECT user,host,plugin,authentication_string FROM user;</code></pre> <p><img alt="" height="259" src="https://images2.imgbox.com/5f/ad/omiJCyBw_o.png" width="975"></p> </li><li> <p><u>修改 root 用户的host，host修改成功后，可以直接去 15.2 开放防火墙端口了</u></p> </li></ul> 
<pre><code>UPDATE user SET host='%' WHERE user='root';
FLUSH PRIVILEGES;
select user,host from user;  # 查看root用户的host字段是否更新为 %</code></pre> 
<ul><li> <p>创建用户， %表示通配符，任意主机都可访问</p> </li></ul> 
<pre><code class="language-bash">CREATE user 'root'@'%';</code></pre> 
<ul><li> <p>设置初始密码</p> </li></ul> 
<pre><code class="language-bash">ALTER USER 'root'@'%' IDENTIFIED BY '密码';</code></pre> 
<ul><li>分配权限</li></ul> 
<pre><code class="language-bash">GRANT ALL PRIVILEGES ON *.* TO 'root'@'%';</code></pre> 
<ul><li>刷新权限</li></ul> 
<pre><code class="language-bash">FLUSH PRIVILEGES;</code></pre> 
<ul><li>查看是否有新建的用户</li></ul> 
<pre><code class="language-bash">SELECT user,host,plugin,authentication_string FROM user;</code></pre> 
<p> 可以看到host为%的root用户已经创建。<img alt="" height="426" src="https://images2.imgbox.com/9c/b2/dsMXeX5q_o.png" width="986"></p> 
<h3>2.  配置linux的防火墙</h3> 
<pre><code class="language-bash">firewall-cmd --query-port=3306/tcp  # 查看端口状态
firewall-cmd --add-port=3306/tcp --permanent  # 永久开放端口
systemctl restart firewalld  # 重启防火墙</code></pre> 
<p> <img alt="" height="131" src="https://images2.imgbox.com/b3/73/eJKAv2nP_o.png" width="594"></p> 
<h3>3. 远程连接 </h3> 
<p>以idea内嵌datagrip示例，我的虚拟机ip是 192.168.232.132。</p> 
<p><img alt="" height="285" src="https://images2.imgbox.com/26/27/BTLhbCJ7_o.png" width="634"></p> 
<p> <img alt="" height="669" src="https://images2.imgbox.com/b5/fa/QMd4EiJ3_o.png" width="554"></p> 
<p>用户密码为第十五步 1 中创建的用户密码。</p> 
<p><img alt="" height="669" src="https://images2.imgbox.com/c7/92/mhowwv4E_o.png" width="794"></p> 
<h2>十六、开机自启动 </h2> 
<ul><li>先将 /usr/local/mysql8/support-files/ 文件夹下的mysql.server文件复制到 /etc/rc.d/init.d/ 目录下的 mysqld 中。</li></ul> 
<pre><code>cp /usr/local/mysql8/support-files/mysql.server /etc/rc.d/init.d/mysqld</code></pre> 
<ul><li>赋予可执行权限</li></ul> 
<pre><code>chmod +x /etc/init.d/mysqld</code></pre> 
<ul><li>添加为服务</li></ul> 
<pre><code>chkconfig --add mysqld</code></pre> 
<ul><li>查看服务列表</li></ul> 
<pre><code>chkconfig --list</code></pre> 
<p> 看到mysqld 后面3、4、5都为on表示成功；</p> 
<p> <img alt="" height="201" src="https://images2.imgbox.com/91/82/Vt026jfU_o.png" width="659"></p> 
<p> 否则执行</p> 
<pre><code>chkconfig --level 345 mysqld on</code></pre> 
<p>然后 reboot 机器，查看mysql进程状态。</p> 
<h2>十七、集群部署<a class="has-card" href="https://blog.csdn.net/zaixiaqin/article/details/134736716?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22134736716%22%2C%22source%22%3A%22zaixiaqin%22%7D" title="centos7部署mysql8.0.35，主从复制，主主集群-CSDN博客"><span class="link-card-box"><span class="link-title">centos7部署mysql8.0.35，主从复制，主主集群-CSDN博客</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/e3/1c/K1cw8rn2_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/zaixiaqin/article/details/134736716?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22134736716%22%2C%22source%22%3A%22zaixiaqin%22%7D</span></span></a></h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ccf514965e159263e4bb852297e08021/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">我的Android播放器封装经验</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b0aa0db67c09248e40ffc6aa5ea5f52e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">浅谈Elasticsearch备份和恢复</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>