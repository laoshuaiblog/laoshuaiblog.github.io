<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>dorado 7 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/8a6f8d4ceb5ad424f00d1a5c03fc3867/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="dorado 7">
  <meta property="og:description" content="通用代码
lookupCode lookupName
性别 $${dorado.getDataProvider(&#34;sysLookupTypeAction#getValueByCode&#34;).getResult(&#39;PLATFORM_SEX&#39;)}
有效标识 $${dorado.getDataProvider(&#34;sysLookupTypeAction#getValueByCode&#34;).getResult(&#39;PLATFORM_VALID_FLAG&#39;)}
储值卡标识 $${dorado.getDataProvider(&#34;sysLookupTypeAction#getValueByCode&#34;).getResult(&#39;IF_TRANSACT&#39;)}
储值卡类型 $${dorado.getDataProvider(&#34;sysLookupTypeAction#getValueByCode&#34;).getResult(&#39;CARD_TYPE&#39;)}
认识本店途径 $${dorado.getDataProvider(&#34;sysLookupTypeAction#getValueByCode&#34;).getResult(&#39;KNOW_APPROACH&#39;)}
1、弹出页面的嵌入路径
${web.contextPath}/avicit/platform6/modules/train/examshopmember/view/ExamShopMemberAdd.d7
${web.contextPath}/avicit/platform6/modules/train/examshopmemberexercise/view/ExamShopMemberExerciseEdit.d7
memberDataUpdateAction memberDataDeleteAction dialogAddOrEdit
2、添加页插入空数据：self.get(&#34;#dataSetExamShopMemberExercise&#34;).insert();
3、添加页保存方法：view.get(&#34;#memberDataUpdateAction&#34;).execute(); 执行成功后关闭弹出页，刷新父页面数据：
var ds =view.get(&#34;dataSetExamShopMember&#34;);
ds.clear();
ds.insert();
parent.refreshAdd();
4、添加页取消方法：
var ds =view.id(&#34;dataSetExamShopMember&#34;);
ds.clear();
ds.insert();
parent.refreshAdd();
5、编辑按钮的方法：
var dataGrid = view.get(&#34;#MainData&#34;);
var selections = dataGrid.get(&#34;selection&#34;); if (selections.length == 0) {
dorado.MessageBox.alert(&#34;请选择记录&#34;);
return &#34;false&#34;;
}
if (selections.length &amp;gt; 1) {
dorado.MessageBox.alert(&#34;只允许选择一条数据记录!&#34;);
return &#34;false&#34;;
}
var id =selections[0].get(&#34;ID&#34;);
view.get(&#34;#editIframe&#34;).set(&#34;path&#34;,&#34;${web.contextPath}/avicit/platform6/modules/train/examshopmember/view/ExamShopMemberEdit.d7?id=&#34;&#43;id);
view.get(&#34;#dialogEdit&#34;).show();
6、编辑页保存的方法：view.get(&#34;#memberDataUpdateAction&#34;).execute();
执行成功后关闭弹出页，刷新父页面数据：">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2013-10-30T15:14:06+08:00">
    <meta property="article:modified_time" content="2013-10-30T15:14:06+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">dorado 7</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><br> 通用代码<br> lookupCode  <br> lookupName<br> 性别      $${dorado.getDataProvider("sysLookupTypeAction#getValueByCode").getResult('PLATFORM_SEX')}<br> 有效标识  $${dorado.getDataProvider("sysLookupTypeAction#getValueByCode").getResult('PLATFORM_VALID_FLAG')}<br> 储值卡标识   $${dorado.getDataProvider("sysLookupTypeAction#getValueByCode").getResult('IF_TRANSACT')}<br> 储值卡类型   $${dorado.getDataProvider("sysLookupTypeAction#getValueByCode").getResult('CARD_TYPE')}<br> 认识本店途径   $${dorado.getDataProvider("sysLookupTypeAction#getValueByCode").getResult('KNOW_APPROACH')}</p> 
<p>1、弹出页面的嵌入路径<br> ${web.contextPath}/avicit/platform6/modules/train/examshopmember/view/ExamShopMemberAdd.d7<br> ${web.contextPath}/avicit/platform6/modules/train/examshopmemberexercise/view/ExamShopMemberExerciseEdit.d7</p> 
<p><br> memberDataUpdateAction    memberDataDeleteAction  dialogAddOrEdit</p> 
<p>2、添加页插入空数据：self.get("#dataSetExamShopMemberExercise").insert();</p> 
<p>3、添加页保存方法：view.get("#memberDataUpdateAction").execute();   <br> 执行成功后关闭弹出页，刷新父页面数据：<br> var ds =view.get("dataSetExamShopMember");<br> ds.clear();<br> ds.insert();<br> parent.refreshAdd();<br> 4、添加页取消方法：<br> var ds =view.id("dataSetExamShopMember");<br> ds.clear();<br> ds.insert();<br> parent.refreshAdd();<br> 5、编辑按钮的方法：<br> var dataGrid = view.get("#MainData");<br> var selections = dataGrid.get("selection"); <br> if (selections.length == 0) {<!-- --><br>  dorado.MessageBox.alert("请选择记录");<br>  return "false";<br> }<br> if (selections.length &gt; 1) {<!-- --><br>  dorado.MessageBox.alert("只允许选择一条数据记录!");<br>  return "false";<br> }</p> 
<p>var id =selections[0].get("ID");<br> view.get("#editIframe").set("path","${web.contextPath}/avicit/platform6/modules/train/examshopmember/view/ExamShopMemberEdit.d7?id="+id);<br> view.get("#dialogEdit").show();</p> 
<p>6、编辑页保存的方法：view.get("#memberDataUpdateAction").execute();<br> 执行成功后关闭弹出页，刷新父页面数据：<br> parent.refreshEdit();<br> 7、编辑页的取消方法：parent.refreshEdit();<br> 8、隐藏显示某个字段<br> var value = view.get("#CONSUME_CARD_FLAG.value");<br> dorado.MessageBox.alert(value);<br> if(value == '1'){<!-- --><br>  view.get("#CONSUME_CARD_TYPE").set("visible",true);<br>  view.get("#CONSUME_CARD_MONEY").set("visible",true);<br> } else {<!-- --><br>  view.get("#CONSUME_CARD_TYPE").set("visible",true);<br>  view.get("#CONSUME_CARD_MONEY").set("visible",true);</p> 
<p> var panelCompany = this.id("PanelMain");<br>      panelCompany.set("visible",true);<br>   //隐藏表格 列<br>   view.id("MainData").getColumn("SearchActionSubject").set("visible",false);<br>   //显示按钮<br>   var kpi = this.id("editActionChangeButton");//变更行动方案<br>           kpi.set("visible",true);//显示编制积分卡按钮<br> 9、获取树的当前节点数据<br> var currentEitity = view.get("#classDataTree").get("currentEntity");<br> currentEitity.get("id");<br> 10、刷新数据<br> buyRecordDataSet.flushAsync();<br> 11、调用ajaxAction，动态传参数<br> var dataSetSql = view.get("#dataSetSql");<br> var code = view.get("#sqlQueryCondition.entity.code");<br> var name = view.get("#sqlQueryCondition.entity.name");<br> var parentId = view.get("#dataSetTypeSysProfile").getData("#").get("id");<br> var judgeSqlValueAction = view.get("#judgeSqlValueAction");<br> judgeSqlValueAction.set("parameter",{parentId:parentId});<br> judgeSqlValueAction.execute(function(sqlValue){<!-- --><br>  if(sqlValue==""){<!-- --><br>  }else{<!-- --><br>   dataSetSql.set("parameter",{sqlValue:sqlValue,code:code,name:name});<br>   dataSetSql.flushAsync();<br>  }<br> });<br> 12、ajax校验的动态传参数，beforeExecute方法，例子参考sysLookupType.view.xml中的dataSysLookupTlLanguage的sysLanguageCode<br>  var ds = view.get("#dataSetSysLookupTl");<br>  var dsParent = view.get("#dataSetSysLookupType");<br>  var id = view.get("#dataSetSysLookupType").getData("#.#sysLookup.id");<br>  var sysLanguageCode = ds.getData("#.sysLanguageCode");<br>  arg.parameter = {sysLanguageCode:sysLanguageCode,pId:id};<br>  后台action获取的方法的参数为(Map&lt;String,String&gt; params)<br>  if (null != params) { <br>  sysLanguageCode = (String)params.get("sysLanguageCode"); <br>  pId = (String)params.get("pId"); <br> }<br> 13、主页面的方法<br> refreshAdd = function(){<!-- --><br>  if (view.get("#dialogAdd")) {<!-- --><br>   view.get("#dialogAdd").hide();<br>   refresh();<br>  }<br> }<br> refreshEdit = function(){<!-- --><br>  if (view.get("#dialogEdit")) {<!-- --><br>   view.get("#dialogEdit").hide();<br>   refresh();<br>  }<br> }<br> refresh = function(){<!-- --><br>  var ds = view.id("dataSetExamShopMember");<br>  var entityList =ds.getData(); <br>  entityList.clear();<br>  entityList.gotoPage(entityList.pageNo);<br>  var grid =view.id("MainData");<br>  grid.set("selection", null);<br> }<br> ---------------<br> 读取properties文件的值<br> 按钮名称：<br> \#buttonAddRow.caption=添加<br> caption属性：<br> dataTypeSysWordTemplet.readTemplet=查看模板<br> 取值：${res['dataTypeSysWordTemplet.readTemplet']}<br> 值：查看模板<br> -------------------------<br> 树datatree<br> 取值<br> view.get("datatree").get('data').get("ID");<br> --------------------<br> --重置form<br> var ds=this.id('dataSetQuery');<br> var cur=ds.getData('#');<br> cur.clearData();<br> var form=this.id('queryForm');<br> form.set('entity',{});<br> ---------------<br> /校验 begin DingRui 2013-06-14///<br> var data = view.get("#dataSetOcmActPlan.data:#");<br> var actCode = data.get("ACT_CODE");<br> var actName = data.get("ACT_NAME");<br> var hrDeptId = data.get("HR_DEPT_ID");<br> var startDate = data.get("ACT_START_DATE");<br> var endDate = data.get("ACT_END_DATE");</p> 
<p> </p> 
<p> </p> 
<p>log4j.logger.com.bstek.dorado.jdbc=DEBUG <br> Inltex easy meeting classic 会议软件风也轻狂，梦也嚣张，看夜雨潇潇洒洒.；<br> 缓存<br> -Xmx512m -XX:MaxPermSize=512m<br> -Xmx256m -XX:MaxPermSize=256m<br> 以前项目的D:\Program Files\apache-tomcat-6.0.20<br> 代码我已配置好，你们只需改一下cinfigure-debug文件里的view.root=file:F:\\workSpace v6\\182OCm\\src\;</p> 
<p>Dorado7 Tomcat路径：D:\Dorado7\ProgramProject\apache-tomcat-6.0.35<br> E:\Workspaces\Workspace_Platform_V6\182OCM\webapp\WEB-INF\dorado-home<br> RD<br> import avicit.platform6.core.api.system.syslog.service.SysLogUtil;d<br> 系统部门<br> create table sys_dept_mac as (select *  from sys_dept)<br> ${res['process.Catalog.Change']}<br> 改数据源登陆用户的话得改两个地方：configure*.properties;  jdbc.properties<br> ----接收参数<br> var flag="${param.flag}";//1公司级;2专业级<br> var proid = top.$.cookie('proid');</p> 
<p>蓝色圆点图片<br> &gt;images/tblue.gif<br> 绿色圆点<br> &gt;images/tgreen.gif<br> 红色圆点<br> &gt;images/tred.gif<br> 黄色圆点<br> &gt;images/tyellow.gif</p> 
<p>查询图片<br>  url(&gt;skin&gt;common/icons.gif) -40px -100px<br> 添加图片<br>  url(&gt;skin&gt;common/icons.gif) -120px -0px<br> 删除图片<br>  url(&gt;skin&gt;common/icons.gif) -140px -0px<br> 取消图片<br>  url(&gt;skin&gt;common/icons.gif) -140px -0px<br> 保存图片<br>  url(&gt;skin&gt;common/icons.gif) -140px -20px<br> -----返回上一步<br> window.history.back();<br> var id="${request.getParameter('id')}";<br> ------通过重定向返回某个页面<br> parent.window.location="${web.contextPath}/avicit/platform6/modules/system/sysdashboard/index.jsp";</p> 
<p>另存为[方形框框]<br>  url(&gt;skin&gt;common/icons.gif) -140px -20px<br>  ---发布按钮<br>  url(&gt;skin&gt;common/icons.gif) -20px 0px<br>  ---<br>  编辑按钮<br>  url(&gt;skin&gt;common/icons.gif) -200px -0px<br> var dataset = view.id("dataSetSingleChensAgain");<br> dataset.getData("#").cancel();<br> 重置按钮<br>  url(&gt;skin&gt;common/icons.gif) -100px -20px<br>  var ds=this.id('dataSetQuery');<br> var cur=ds.getData('#');<br> cur.clearData();<br> var form=this.id('queryForm');<br> form.set('entity',{});<br> SYS_APPLICATION_ID<br> ---------<br> var parameter = view.get("#queryForm.entity");<br> view.get("#dataSetIbscSummarizeV").set("parameter",parameter).flushAsync();<br> ---------<br> var flag="${param.flag}";<br> --------<br> --<br> -----遇到编辑，详细页面加载数据不正确<br> 需要手动加载<br> var id="${param.id}";<br> view.get("#dataSetOcmGraphCard").set("parameter",{ID:id}).flushAsync();<br> return true;<br> ------------------<br> ---</p> 
<p>点击查询弹出页面<br> this.get("#dialogQuery").show();<br> 能够获取到数据</p> 
<p>singleChensAgainAction#saveSingleChensAgain</p> 
<p>singleChensAgainAction#saveTAddSingleChensAgain<br> var view = this;<br> var dataGrid = view.get("#MainData");<br> var selections = dataGrid.get("selection"); //获得当前选中的项<br> if (selections.length == 0) {<!-- --><br>  dorado.MessageBox.alert("请选择记录");<br>  return;<br> }else {<!-- --><br>  dorado.MessageBox.confirm('您真的要删除吗？',function(){<!-- --><br>   var dataArray = new Array();<br>   var i = 0;<br>   selections.each(function(selection){<!-- --><br>    dataArray[i] = {id:selection.get('ID')};<br>    i++;<br>   });<br>   view.get("#deleteAction").set("parameter",eval(dataArray));<br>   view.get("#deleteAction").execute(function(){<!-- --><br>    // 刷新不回首页，只在当前页的方法。 <br>    var ds = view.id("dataSetSingleChensAgain");<br>    var entityList =ds.getData(); <br>    entityList.clear();<br>    entityList.gotoPage(entityList.pageNo);<br>   });<br>  });<br> }<br> ------弹出添加页面<br> 在view的onReady()事件中<br> this.createSubMenu = function(){<!-- --><br>  var dataset = view.id("dataSetTestSingle");<br>  dataset.insert();<br>     var dialog = view.id("dialogAdd");<br>     dialog.set("caption", "添加");<br>     dialog.show();<br> }</p> 
<p>dataSetSingleChensAgain<br> DialogAddNew</p> 
<p>this.get("#DialogAdd").show();</p> 
<p> </p> 
<p>---------------返回DialogAddNew<br> var dialog = this.id("dialogAdd");<br> dialog.hide();<br> //var ds = view.id("CompositeTestSingle");<br> //var entityList =ds.getData(); <br> //entityList.clear();<br> //entityList.gotoPage(entityList.pageNo);<br> //ds.flushAsync();<br> -------------------<br> ---弹出编辑页面<br> var dataGrid = view.get("#MainData");<br>  var selection = dataGrid.get("selection"); //获得当前选中的项<br>  if(selection==null){<!-- --><br>   dorado.MessageBox.alert("请选择一条要编辑的记录！");<br>  }</p> 
<p> if (selection.length == 1) {<!-- --><br>   var currentData = selection[0];<br>   var id =currentData.get("ID");<br>    var ds = view.id("dataSetmac");<br>    ds.set("parameter",{ID:id});<br>    ds.flushAsync();<br>    var dialog = this.id("dialogAdd");<br>    dialog.set("caption", "編輯");<br>    dialog.show();<br>  }else if(selection.length &gt; 1){<!-- --><br>      dorado.MessageBox.alert("只能选择一条要编辑的记录！");<br>   return;<br>  } else{<!-- --><br>   dorado.MessageBox.alert("请选择一条要编辑的记录！");<br>  }<br> ---------------设置查询条件<br> var parameter = view.get("#queryForm.entity");<br> view.get("#dataSetSingleChensAgain").set("parameter",parameter).flushAsync();<br> ------------------<br> var ds=this.id('dataSetQuery');<br> var cur=ds.getData('#');<br> cur.clearData();&amp;#xD<br> var form=this.id('queryForm');<br> form.set('entity',{});<br> --------------------<br> if(arg.keyCode==13){<!-- --><br> var parameter = view.get("#queryForm.entity");<br> view.get("#dataSetSingleChensAgain"").set("parameter"",parameter).flushAsync();<br> }<br> ------<br> var dataset = view.id("dataSetSingleChensAgain");<br> dataset.getData("").cancel();</p> 
<p> &lt;Button id="buttonSave"&gt;<br>           &lt;ClientEvent name="onClick"&gt;<br> var action = this.id("saveAction");<br> var dialog = this.id("dialogAdd");<br> action.execute(function(){dialog.hide();});    </p> 
<p><br> &lt;/ClientEvent&gt;<br>           &lt;Property name="caption"&gt;保存&lt;/Property&gt;<br>           &lt;Property name="icon"&gt;url(&gt;skin&gt;common/icons.gif) -280px -220px&lt;/Property&gt;<br>         &lt;/Button&gt;<br>   <br>   <br>   //this.get("#DialogAdd").show();</p> 
<p><br> var dataGrid = view.get("#MainData");<br>  var selection = dataGrid.get("selection"); //获得当前选中的项<br>  if(selection==null){<!-- --><br>   dorado.MessageBox.alert("请选择一条要编辑的记录！");<br>  }</p> 
<p> if (selection.length == 1) {<!-- --><br>   var currentData = selection[0];<br>   var id =currentData.get("ID");<br>   alert(id);<br>   var ds = view.id("dataSetSingleChensAgain");<br>   ds.set("parameter",{ID:id});<br>   ds.flushAsync();<br>   var dialog = this.id("DialogAdd");<br>   dialog.set("caption", "編輯");<br>   dialog.show();<br>  }else if(selection.length &gt; 1){<!-- --><br>      dorado.MessageBox.alert("只能选择一条要编辑的记录！");<br>   return;<br>  } else{<!-- --><br>   dorado.MessageBox.alert("请选择一条要编辑的记录！");<br>  }<br>  <br>  [CompositeSingleChensAgain]<br>  jdbcProvider<br>  <br>  ------在dataPolit的事件 onSubControlAction(self,arg)<br>  中点击添加按钮，添加数据<br>  switch(arg.code){<!-- --><br>     case "+":<br>     var entityList = this.id("dataSet").getData();<br>     entityList.insert();<br>     var dialog =this.id("dialog");<br>     dialog.show();<br>     arg.processDefault = false;<br>     break;<br>  }<br>  -----<br>  点击添加，把主界面遮罩。添加页显示<br>  var entity=this.id("dataSet").getData("#");<br>  entity.cancel();<br>  var dialog=this.id("dialog");<br>  dialog.hide();<br>  <br>  ---------------<br>  查询按钮<br>  var parameter = view.get("#queryForm.entity");<br> var dataset = view.get("#dataSetTestChens514").set("parameter",parameter);<br> dataset.flushAsync();<br> alert(parameter.get("LOOKUP_TYPE"));<br>  -----=---通用代码<br>  $${dorado.getDataProvider ("sysLookupTypeAction#getValueByCode").getResult('PLATFORM_SYS_USER_FLAG')}<br> lookupCode<br> lookupName<br>  ---------------<br>  <br>  testChens514Action#saveTestChens514<br> 正在执行<br> 保存成功</p> 
<p>CompositeTestChens514<br> CompositeTestChens514<br> argument type dismatch  是dataType 字段的类型不匹配..Number(16) 对应的是bigdecenum.有时候生成为Double了，报错了就。</p> 
<p><br> var parameter = view.get("#queryForm.entity");<br> view.get("#dataSetTestSingle").set("parameter",parameter).flushAsync();<br> Inltex easy meeting classic 会议软件<br> -----------------------------<br> CompositeTestChens514  dataType<br> dataSetOcmGoalsManager</p> 
<p>metaData<br>      jdbc.model  CompositeTestChens514<br>   <br>   取消<br>   var dataset = view.id("dataSetTestChens514");<br> dataset.getData("#").cancel();<br> //getData返回数据集封装的数据<br> 查询<br> this.get("#dialogQuery").show();<br> ------系统语言<br> languageCode<br> $${dorado.getDataProvider("sysLookupTypeAction#getSysLanguageByCode").getResult('')}<br> languageName<br> -----状态<br> lookupCode<br> $${dorado.getDataProvider ("sysLookupTypeAction#getValueByCode").getResult('OCM_MISSION_MANAGER_STAT')}<br> lookupName<br> -----------执行action后关闭窗体------<br> var action = this.id("AddAction");<br> var dialog = this.id("dialogAdd");<br> action.execute(function(){dialog.hide();}); </p> 
<p>-------------<br> var dataset = view.id("dataSetTrainTestZhangkp");<br> dataset.getData("#").cancel();<br> this.id("dialogAdd").hide();<br> -------------------------<br> var ds = view.id("dataSetOcmGoalsManager");<br> var cur=ds.getData('#');<br> var id = cur.get("ID")<br> ds.set("parameter",{<!-- --><br>     ID: id<br> });<br> ds.flushAsync();<br> var dialog = this.id("dialogGoalsAdd");<br> dialog.set("caption","編輯");<br> dialog.show();<br> view.id("dataSetAddForm").flushAsync();<br> --------------------------------<br> 提示确认，取消不操作；这样取Action执行execute()<br> dorado.MessageBox.confirm('您确定发布本信息么？',function(){<!-- --><br>    // view.get("#publishAction").set("parameter",{ID:id});<br>     view.get("#publishAction").execute();<br> })<br> ------------提示操作，确认关闭窗体----------<br> dorado.MessageBox.confirm('您尚未保存数据，【确认】将不保存数据？',function(){<!-- --><br>     var dataset = view.get("#dataSetAddForm");<br>     var data = dataset.getData("#");<br>     data.cancel();<br>     var dialog = view.get("#dialogGoalsAdd");<br>     dialog.hide();<br> })<br> -----------<br> var ds = view.id("dataSetOcmGoalsManager");<br> var cur=ds.getData('#');<br> var status = cur.get("DATA_STAT")<br> ds.set("parameter",{<!-- --><br>     DATA_STAT: status<br> });<br> ds.flushAsync();<br> ------------table---onRenderCell<br> var a=arg.data.get("NAME");<br> if(a=='chens0002'){<!-- --><br>  arg.dom.innerHTML='lizhigang';<br> }</p> 
<p>--------------------<br> ajaxAction<br> 用注解@Expose<br> 普通action<br> 用注解@DataResolver<br> ------</p> 
<p><br> dorado7增删改<br> view视图-------------------------------------------------<br> oncreate()<br> /**<br>  * 用于table列显示不全内容加tip提示<br>  * @param {Object} arg table列中参数arg<br>  * @param {Object} canShu 对于字段名称<br>  * @param {Object} Split 列中显示的字节数<br>  */<br> $showTip = function(arg,canShu,Split){<!-- --><br>  //根据传入字段名称获取值<br>     var ziDuan = arg.data.get(canShu);<br>     var countLength = 0;<br>  //获取字符串所占字节数<br>     String.prototype.getBytes = function(){<!-- --><br>         var cArr = this.match(/[^\x00-\xff]/ig);<br>         return this.length + (cArr == null ? 0 : cArr.length);<br>     }    <br>  countLength = ziDuan.getBytes();<br>     var allLength = 0;//定义一个分割线<br>     var weiZhi = 0;//定义截取位置<br>     for (i = 0; i &lt; ziDuan.length; i++) {<!-- --><br>         if (allLength &gt; Split) {<!-- --><br>             weiZhi = i;<br>             break;<br>         } else {<!-- --><br>             allLength += ziDuan.substring(i,i + 1).getBytes();<br>         }   <br>   <br>   }  <br>     if (weiZhi == 0) {<!-- --><br>         weiZhi = ziDuan.length;<br>     }    <br>  var show = "";//定义table中显示内容<br>     if (weiZhi &lt; ziDuan.length) {<!-- --><br>         show = ziDuan.substring(0,weiZhi) + "...";<br>     }    else {<!-- --><br>         show = ziDuan;<br>     }   <br>   arg.dom.innerHTML = "&lt;a title='" + ziDuan + "'&gt;" + show + "&lt;/a&gt;";<br> }<br> ------------------------------------------<br> --beforeRefreshDom()--首页默认加载条件数据<br> //只加载状态为已发布的记录<br> view.get("#dataSetOcmMissionManager").set("parameter",{P_DATA_STAT:5}).flushAsync();<br> return true;<br> ------------------------------<br> dialogQuery属性<br> 查询按钮事件onClick()<br> var parameter = view.get("#queryForm.entity");<br> view.get("#dataSetOcmMissionManager").set("parameter",parameter).flushAsync();<br> -------------------------------------<br> 重置按钮事件<br> var ds=this.id('dataSetQuery');<br> var cur=ds.getData('#');<br> cur.clearData();<br> var form=this.id('queryForm');<br> form.set('entity',{});<br> -----------------------------------------------<br> 设置几列属性<br> cols:*,*,*<br> 模式窗口：modal:true<br> --------------------------------<br> 界面布局<br> Panel<br> 所有使用到的控件的id或者name，或者caption某一项必须起名称，要设置，不要留空<br> --<br> 首页面添加按钮事件<br>  var dataset = view.id("dataSetAddForm");<br>  dataset.insert();<br>     var dialog = view.id("dialogMissionAdd");<br>     dialog.show();<br> -------------------------------------------<br> -----------------------------------<br> 首页面编辑onclick<br> var record = view.get("#dataSetOcmGoalsManager").getData().getFirst();<br> var id= record.get("ID");<br> if(record != null)<br> {<!-- --><br>  //只能修改已发布<br>   var ds = view.id("dataSetAddForm");<br>         ds.set("parameter",{P_ID: id}).flushAsync();<br>   var dialog = this.id("dialogGoalsEdit");<br>   dialog.show();<br> }else{<!-- --><br>   dorado.MessageBox.alert("没有可修改的数据！");<br>   return;<br> }<br> -------------------------------------------<br> 选择我们所要编辑的页面<br> //获取当前用户选中的一行数据<br> var ds = this.get("#dataSetOcmGraphCard").getData("#");<br> //没有数据<br> if (typeof(ds) == "undefined") {<!-- --><br>     dorado.MessageBox.alert("没有可修改的数据！");<br>     return;<br> }else {<!-- --><br>     var id = ds.get("id");<br>     if (id != null) {<!-- --><br>         //只能修改已发布<br>         var ds = view.id("dataSetEditForm");<br>         ds.set("parameter",{<!-- --><br>             Card_Id: id<br>         }).flushAsync();<br>         var dialog = this.id("dialogEditCard");<br>         dialog.show();<br>     }<br> }    </p> 
<p>--------------------------------------------<br> ---首页弹出页面过滤状态为0 的数据展示出来<br> var ds = view.id("dataSetPubData");<br> ds.set("parameter",{P_DATA_STAT:0}).flushAsync();<br> var dialog = view.id("dialogMissionPub");<br> dialog.show();<br> ----------------------<br> Action<br> 删除的action子集属性<br> updateAction控件设置属性dataPath是：[#current];<br> 保存和修改是同一个Action，子集是属性dataPath是：!DIRTY_TREE<br> dataResolver:ocmMissionManagerAction#deleteBatch<br> 类里边注解用@DataResolver<br> executingMessage:正在保存<br> successMessage:<br> 控件的子集updateItem:<br> 子集属性：dataPath:[#current]<br> dataSet:dataSetPubData<br> --------------------------------------<br> 添加页面的保存按钮onclick事件：<br> ---这里没有像后台传入多余的参数直接绑定action后台执行保存<br> var data = view.get("#dataSetAddForm.data:#");<br> var mission = data.get("MISSION");<br> var hope = data.get("HOPE");<br> if(typeof(mission)== "undefined" || typeof(hope)== "undefined"){<!-- --><br>  dorado.MessageBox.alert("请确保【企业使命】和【企业愿景】字段值不为空");<br>  return;<br> }else{<!-- --><br>  mission = mission.replace(/(^\s*)|(\s*$)/g, "");<br>     hope = hope.replace(/(^\s*)|(\s*$)/g, "");<br> }<br> if((mission == null || mission == "" || typeof(mission)== "undefined") || (hope == null || hope == "" || typeof(hope)== "undefined")){<!-- --><br>  dorado.MessageBox.alert("请确保【企业使命】和【企业愿景】字段值不为空");<br>  return;<br> }</p> 
<p>var action = view.id("addAction");<br> var dialog = view.id("dialogMissionAdd");<br> action.execute(function(){dialog.hide();});    <br> -------------------------------------------<br> 添加页面发布事件，向后台传入了参数值，处理后返回关闭窗体<br> var data = view.get("#dataSetAddForm.data:#");<br> var mission = data.get("MISSION");<br> var hope = data.get("HOPE");<br> if(typeof(mission)== "undefined" || typeof(hope)== "undefined"){<!-- --><br>  dorado.MessageBox.alert("请确保【企业使命】和【企业愿景】字段值不为空");<br>  return;<br> }else{<!-- --><br>  mission = mission.replace(/(^\s*)|(\s*$)/g, "");<br>     hope = hope.replace(/(^\s*)|(\s*$)/g, "");<br> }<br> if((mission == null || mission == "" || typeof(mission)== "undefined") || (hope == null || hope == "" || typeof(hope)== "undefined")){<!-- --><br>  dorado.MessageBox.alert("请确保【企业使命】和【企业愿景】字段值不为空");<br>  return;<br> }<br> //传入后台json数据<br> var dataValues={<!-- --><br>  mission:data.get("MISSION"),<br>  hope:data.get("HOPE"),<br>  dataStat:"5"<br> };<br> dorado.MessageBox.confirm('您确定发布本信息么？',function(){<!-- --><br>  var action = view.id("pubAction");<br>  var dialog = view.id("dialogMissionAdd");<br>  action.set("parameter",dataValues).execute(function(result){<!-- --><br>      //主界面修改后刷新主数据<br>      view.id("dataSetOcmMissionManager").flushAsync();<br>   dialog.hide();<br>        });<br>  <br>  }<br> )<br> -----------------------------------------------------<br> 添加页面取消按钮<br> dorado.MessageBox.confirm('您尚未保存数据，【确认】将不保存数据？',function(){<!-- --><br>  var dataset = view.id("dataSetAddForm");<br>  dataset.getData("#").cancel();<br>  view.id("dialogMissionAdd").hide();<br>  }<br> )<br> ----------------------------------------<br> 编辑页面保存按钮事件：<br> var data = view.get("#dataSetAddForm.data:#");<br> var mission = data.get("MISSION").replace(/(^\s*)|(\s*$)/g, "");<br> var hope = data.get("HOPE").replace(/(^\s*)|(\s*$)/g, "");<br> if((mission == null || mission == "") || (hope == null || hope == "")){<!-- --><br>  dorado.MessageBox.alert("请确保【企业使命】和【企业愿景】字段值不为空");<br>  return;<br> }</p> 
<p>var action = this.id("addAction");<br> var dialog = this.id("dialogMissionEdit");<br> action.execute(function(){<!-- --><br>  dialog.hide();<br>  //主界面修改后刷新主数据<br>  view.id("dataSetOcmMissionManager").flushAsync();<br>  //发布页面编辑完成后刷新发布页面数据<br>  view.id("dataSetPubData").flushAsync();<br>  });    <br> ------------------------------------------------<br> dorado.MessageBox.confirm('您尚未保存数据，【确认】将不保存数据？',function(){<!-- --><br>  var dataset = view.id("dataSetAddForm");<br>  dataset.getData("#").cancel();<br>  view.id("dialogMissionEdit").hide();<br>  }<br> ) <br> ----------------------------<br> 发布页面的发布按钮事件<br> 封装了一个json，向后台传了数据id,mession,hope三个字段的值后台处理后返回刷新数据<br> var data = view.get("#dataSetPubData.data:#");<br> var dataValues={<!-- --><br>  id:data.get("ID"),<br>  mission:data.get("MISSION"),<br>  hope:data.get("HOPE"),<br>  dataStat:"5"<br> };<br> dorado.MessageBox.confirm('您确定发布本信息么？',function(){<!-- --><br>  var action = view.id("pubAction");<br>  var dialog = view.id("dialogMissionAdd");<br>  action.set("parameter",dataValues).execute(function(result){<!-- --><br>      dialog.hide();<br>    //主界面修改后刷新主数据<br>    view.id("dataSetOcmMissionManager").flushAsync();<br>    //发布页面编辑完成后刷新发布页面数据<br>    view.id("dataSetPubData").flushAsync();<br>   <br>        });<br>  <br>  }<br> )<br> -----------------------------<br> 发布页面上的编辑事件</p> 
<p>//当前行数据ID<br> var currentId = view.get("#dataSetPubData.data:#").get("ID")<br> //用于判断发布页面时候存在数据<br> var record = view.get("#dataSetPubData").getData().getFirst();<br> //实际也可以通过record.get("ID");取到当前选中数据的ID<br> if(record != null)<br> {<!-- --><br>  //只能修改已发布<br>   var ds = view.id("dataSetAddForm");<br>         ds.set("parameter",{P_ID:currentId}).flushAsync();<br>   var dialog = view.id("dialogMissionEdit");<br>   dialog.show();<br> }else{<!-- --><br>   dorado.MessageBox.alert("没有可修改的数据！");<br>   return;<br> }<br> ------------------------------------------</p> 
<p>发布页面的删除事件<br> //当前行数据ID<br> var currentId = view.get("#dataSetPubData.data:#").get("ID")<br> //用于判断发布页面时候存在数据<br> var record = view.get("#dataSetPubData").getData().getFirst();<br> var dataArray = new Array();<br> if(record != null){<!-- --><br>  dorado.MessageBox.confirm('您真的要删除吗？',function(){<!-- --><br>   dataArray[0] = {id:currentId};<br>   view.get("#deleteAction").set("parameter",eval(dataArray));<br>   view.get("#deleteAction").execute(function(){<!-- --><br>    // 刷新不回首页，只在当前页的方法。 <br>    var ds = view.id("dataSetPubData");<br>    ds.flushAsync();<br>   });<br>  });<br>  <br>  <br> }else{<!-- --><br>  dorado.MessageBox.alert("没有可删除的记录");<br>  return;<br> }</p> 
<p>view.id("dialogMissionPub").hide();</p> 
<p>-----------------------------<br> 编辑选中当前选中的进行编辑</p> 
<p>//当前行数据ID<br> var currentId = view.get("#dataSetPubData.data:#").get("ID")<br> //用于判断发布页面时候存在数据<br> var record = view.get("#dataSetPubData").getData().getFirst();<br> if(record != null)<br> {<!-- --><br>  //只能修改已发布<br>   var ds = view.id("dataSetAddForm");<br>         ds.set("parameter",{P_ID:currentId}).flushAsync();<br>   var dialog = view.id("dialogGoalsEdit");<br>   dialog.show();<br> }else{<!-- --><br>   dorado.MessageBox.alert("没有可修改的数据！");<br>   return;<br> }<br> ------------------------------------------------------------<br> dataTreeGrid</p> 
<p>==<br>  dataTreeGrid <br>  处理子部门级的数据，<br>  dataType的字段中有一个字段用于存储展开的子节点的ID<br>  例如：oldProcessDefinitions；字段的属性dataType:为集合[dataTypePlatformProcessDefinition]<br>  对应的dataSet的属性中<br>  dataProvider:avicit.bpm.processDefinitionManagerAction#findProcessDefinition2  找该节点下的子节点。<br>  dataType属性是一个集合：[dataTypePlatformProcessDefinition]<br>  loadMode:preload<br>  ===控件dataTreeGrid<br>  currentNodeDataPath:CURRENT_MENU<br>  dataSet:dataSetPlatformProcessDefinition<br>  dataType:dataTypePlatformProcessDefinition<br>  defaulticon: url(&gt;skin&gt;common/icons.gif) -260px -260px<br>  dynaRowHeight:true<br>  selectionMode:multiRows<br>  treeColumn:id  作为树型列的列名<br>  --------------------------<br>  绑定字段:BindingConfigs<br>  childrenProperty:oldProcessDefinitions<br>  expandLevel:2<br>  hasChild:true<br>  labelProperty:id----显示字段<br>  recursive；true<br>  -----------------<br>  currentNode : dorado.widget.tree.Node from TreeGrid当前节点。<br>  currentEntity : Object|dorado.Entity from TreeGrid当前数据实体。<br>  showFilterBar : boolean from TreeGrid[ReadOnly] 是否表格过滤栏。<br> highlightCurrentRow : boolean ( = true )from AbstractGrid高亮显示当前行。<br> highlightHoverRow : boolean ( = true )from AbstractGrid高亮显示鼠标悬停的行。<br> rowHeight : int ( = 18 )from AbstractGrid默认的行高。<br> headerRowHeight : int ( = 22 )from AbstractGrid默认的标题栏行高。<br> scrollMode : String ( = "lazyRender" )from AbstractGrid滚动模式。<br> fixedColumnCount : int from AbstractGrid最左边锁定的列数。<br> currentColumn : dorado.widget.grid.Column|String|int from AbstractGrid当前列。<br> dataColumns : dorado.widget.grid.DataColumn[] from AbstractGrid[ReadOnly] <br> 表格中所有数据列的数组。<br> selectionMode : String ( = "none" )from AbstractGrid选择模式。<br> selection : Object|Object[] from AbstractGrid表格中的当前选中项。<br> itemModel : dorado.widget.list.ItemModel from AbstractList[ReadOnly] <br>  dragMode : String ( = "item" )from AbstractList[WriteBeforeReady] <br> 拖拽模式。<br>  dropMode : String ( = "insertItems" )from AbstractList[WriteBeforeReady] <br> 拖放模式。<br> nodes : dorado.util.KeyedList|[Object]|[dorado.widget.tree.Node] from AbstractTree子节点集合。<br> showLines : boolean from AbstractTree[WriteBeforeReady] <br> 是否显示连接树节点的线。<br> firstNode : dorado.widget.tree.Node from AbstractTree[ReadOnly] <br> 返回树中的第一个有效节点。<br> getCurrentItem (  ) : Object|dorado.Entityfrom AbstractGrid返回当前行所对应的数据。<br>  selectAll (  ) : voidfrom AbstractGrid全选。<br>  unselectAll (  ) : voidfrom AbstractGrid全部不选。<br>  selectInvert (  ) : voidfrom AbstractGrid反向选择。<br>  refreshSummary (  ) : voidfrom AbstractGrid刷新（即重新计算）表格中的汇总数据。<br> refresh ( boolean delay ) : voidfrom RenderableElement刷新此对象的显示。<br>  clearNodes (  ) : voidfrom AbstractTree清除树中的所有树节点。<br> refreshNode ( dorado.widget.tree.Node node ) : voidfrom AbstractTree刷新某树节点的显示。<br>  ---------------------------------------------------------------<br> exceptionHandlers<br> properties<br> key<br> id<br> version int<br> packageName<br> deploymentTime<br> deploymentDbid<br> isSuspended</p> 
<p>imageResourceName<br> name<br> description<br> deploymentId<br> oldProcessDefinitions<br> designer<br> deployer</p> 
<p> insert ( dorado.Entity|Object [data] ) : dorado.Entityfrom DataSet向数据集中添加一条顶层记录。<br>  MESSAGE_REFRESH : int from DataSet通知监听器       需要进行数据刷新的消息。<br>  MESSAGE_DATA_CHANGED : int from DataSet表示        数据实体中的属性值发生变化的消息。<br>  MESSAGE_ENTITY_STATE_CHANGED : int from DataSet表示数据实体的状态变化的消息。<br>  MESSAGE_DELETED : int from DataSet表示         实体集合中 有数据实体   被删除的消息。<br>  MESSAGE_INSERTED : int from DataSet表示        实体集合中 添加了新数据实体的消息。<br>  MESSAGE_CURRENT_CHANGED : int from DataSet表示实体集合中  当前数据实体发生改变的消息。<br>  MESSAGE_REFRESH_ENTITY : int from DataSet通知监听器需要针对某个数据实体进行数据刷新的消息。</p> 
<p>---<br> arg.dom.innerHTML= "&lt;input id='operateKpibtn' name='operateKpibtn' type='button' value='编制积分卡' class='pbutton4' οnclick='operateKPI()'&gt;";</p> 
<p>-------------------------------<br> 编辑超链接<br> arg.dom.innerHTML="&lt;a href =\"javascript:window.showDetilInfo('"+arg.data.get("ID")+"')\"&gt;查看&lt;/a&gt;"<br> show = ziDuan.substring(0,weiZhi) + "...";<br> ---------------------------------<br> onReady：第一次加载页面时起作用，以后都不加载。<br> edit_overall_goals<br> alert(document.getElementById("edit_overall_goals"));<br> onRenderCell : b当表格控件渲染其中的某个数据单元格时触发的事件。<br> onDataChange :EntityDataType当某个此类型的dorado.Entity中的属性值被改变后触发的事件。</p> 
<p><br> var dialog = view.id("dialogGoalsEdit");<br> dialog.hide();<br> return false;<br> --------------------------------<br> 删除成功后执行成功<br> var ds= this.id("datasetTest");<br> var entityList=dataSet.getData();<br> entityList.clear();<br> entityList.gotoPage(entityList.pageNo);<br> -----------------------------<br> 设置弹出页的路径。。加两参数<br> view.get("#editSysUserIframe").set("path","${web.contextPath}/avicit/platform6/modules/system/sysuser/view/sysuser_edit.d7?sysUserId=" + currentData.get("id") + "&amp;flag=read");<br> -------------------流程启动按钮事件--只需要更改dataSet和formCode<br> packages：bpmclientjs,bpmclientcss<br> //获取当前用户选中的一行数据<br> var ds = this.get("#dataSetStudyBusinessTrip").getData("#");<br> //将数据转换为JSON格式的字符串，该字符串传递给流程启动函数<br> var json = ds.toJSON();<br> //表单代码定义，这个表单代码必须在表单管理中已经定义<br> var formCode = "StudyBusinessTrip";<br> //打开流程选择对话框<br> var processDef = new StartProcessByFormCode();<br> processDef.SetFormCode(formCode);<br> StartProcessByFormCode.prototype.doStart = function(pdId){<!-- --><br>  /* 将表单代码、业务数据、流程定义ID提交到Java端 */<br>  var data = "processDefId="+pdId+"&amp;formCode="+formCode+"&amp;jsonString="+JSON.stringify(json);<br>  jQuery.ajax({<!-- --><br>   type : "POST",<br>   data : data,<br>   url : getPath() + "/platform/bpm/clientbpmoperateaction/dostart",<br>   dataType : "json",<br>   success : function(msg) {<!-- --><br>    if(msg!=null&amp;&amp;msg.error!=null){<!-- --><br>     window.alert(msg.error);<br>     return;<br>    }else{<!-- --><br>     var processInstanceId = msg.processInstanceId; //流程实例ID<br>     var taskUrl = msg.taskUrl; //待办URL<br>     //打开待办审批页面<br>     parent.window.location.replace(getPath()+"/"+taskUrl);<br>    }<br>   }<br>  });<br> };<br> processDef.start();<br> --------------------------------------------------------------------------<br> ---详细viewonCreate事件<br> 详细toolbar---HtmlContainer[dock]设置属性：id为toolbar_content<br> content:&lt;div id="bpmToolBar"&gt;&lt;/div&gt;<br> contentOverFlow:hidden<br> 流程意见<br> HtmlContainer：id为bpmidea_content<br> &lt;div id="idea"&gt;&lt;/div&gt;<br> --------------------------------------<br> create = function(){<!-- --><br>  view.get("#updateAction").execute();<br> }</p> 
<p>window.getFormDataJson = function(){<!-- --><br>  var ds = view.get("#dataSetStudyBusinessTrip").getData("#");<br>  var jsonString = dorado.JSON.stringify(ds.toJSON());<br>  framework.variable = jsonString;<br> };<br> ---还有onReady事件<br> self.get("#dataSetStudyBusinessTrip").insert();<br> //画流程按钮部分<br> var entryId = "${param.entryId}";<br> var executionId = "${param.executionId}";<br> var taskId = "${param.taskId}";<br> var formId = "${param.id}";<br> var toolbar = new ToolBar(entryId,executionId, taskId,'bpmToolBar', formId);<br> //画流审批意见<br> new IdeaManage.getIdea(entryId);<br> -----------------------------------------------------------------<br> @Override<br> public StudyBusinessTrip getStudyBusinessTripById(String id) {<!-- --><br> StudyBusinessTrip h = (StudyBusinessTrip)hibernateDao.getSession().get(<br>  StudyBusinessTrip.class, id);<br> return h;<br> }</p> 
<p>------------------------------<br> 首页面跳转详细页---标题链接跳转<br> jQuery(arg.dom).empty();<br> jQuery(arg.dom).xCreate({<!-- --><br>     tagName: "A",<br>     href:"#",<br>     content:arg.data.get("USERID"),<br>  style:"font-size:13px",<br>     onclick: function() {<!-- --><br>   var id =arg.data.get("ID");<br>   view.get("#detailIframe").set("path","${web.contextPath}/avicit/platform6study/bpm/studybusinesstrip/view/StudyBusinessTripDetail.d7?id="+id);<br>   view.get("#dialogDetail").show();<br>     }<br> });<br>  --------------------<br>  ------------配工作流-------首页dataSet上要配属性：studyBusinessTripAction#getDataWithBpmEntryV<br> 导入四个包[CompositeStudyBusinessTrip]</p> 
<p>import org.springframework.beans.factory.annotation.Autowired;<br> import com.bstek.dorado.jdbc.iapi.IJdbcDao;<br> import com.bstek.dorado.jdbc.iapi.annotation.JdbcDaor;<br> import com.bstek.dorado.data.provider.Criteria;<br>  @Autowired<br>  @JdbcDaor<br>  private IJdbcDao jdbcDao;<br>  @DataProvider<br>  public void getDataWithBpmEntryV(Criteria criteria, Object parameter, Page page) {<!-- --><br>   jdbcDao.page("CompositeStudyBusinessTrip", criteria, parameter, page);<br>   Collection&lt;Record&gt; records = page.getEntities();<br>   for (Record r: records){<!-- --><br>    String activityNames = "测试A";<br>      //bpmToolService.getActivityNamesByFormId(r.getString("ID").toString()) ;<br>    String state = "已经完成";<br>      //bpmToolService.getProcessStateByFormId(r.getString("ID").toString()) ;<br>    r.put("ACTIVITY_NAMES", activityNames);<br>    r.put("ACTIVITY_STATE", state);<br>   }<br>  }<br>  -----------------获取控件现在只让用view.get("#dataset")------------<br>  接收后台return id;的值拿到放入dataSet中<br> var dataset= view.get("#dataSetOcmGraphCard");<br> var data =dataset.getData("#");<br> data.set("ID",arg.result);<br> view.get("#dataSetOcmGraphCard").getData("#").set("ID",arg.result);<br> -----------------<br> 主子表加载第一条:给子表一个主表的ID<br> var id = view.get("#dataSetOcmGraphCard").getData().getFirst().get("ID");<br> var ds = view.id("dataSetProfession");<br>         ds.set("parameter",{ID:id}).flushAsync();<br> -----------END--------------------<br> ---<br> ---获得当前dataGrid行的数据<br> var table=view.get("#MainData");<br> var currentId=table.getCurrentItem().get("ID");<br> ----<br> dataGrid 对指定的列进行排序<br> public sort (column ,desc)<br> 对指定的列中的数据进行排序。<br> --<br> table.highlightItem();默认高亮显示当前行<br> ------------------------view中通过joson封装数据对象，必须有ID，否则后台映射不到(Map2Pojo)<br> @Expose<br>  public void operateOcmCardPub(Map&lt;String, Object&gt; values)throws Exception {<!-- --><br>   OcmGraphCard ocmGraphCards = new OcmGraphCard();<br>   PojoUtil.Map2Pojo(values, ocmGraphCards);<br>   ocmGraphCardService.publishUpdateOcmCardPub(ocmGraphCards);<br>  }<br> ------------------- MainData<br>  var table=view.get("#MainDataprofession");<br> var id=table.getCurrentItem().get("ID");<br> var sign=table.getCurrentItem().get("IS_SIGN");<br> var entryId=table.getCurrentItem().get("entryId");<br> var executionId=table.getCurrentItem().get("executionId");<br> var taskId =entryId;<br> var act =1;//操作 =1;查看详情= 2<br> if((entryId == null || entryId == "" || typeof(entryId)== "undefined")){entryId="";}<br> if((executionId == null || executionId == "" || typeof(executionId)== "undefined")){executionId="";}<br> if((taskId == null || taskId == "" || typeof(taskId)== "undefined")){taskId="";}<br> view.get("#operateKpiIframe").set("path","${web.contextPath}/avicit/ocm/kpimanager/ocmkpiwrite/view/OcmKpiWrite.d7?id="+id+"&amp;sign="+sign+"&amp;act=1&amp;entryId="+entryId+"&amp;executionId="+executionId+"&amp;taskId="+taskId);<br> view.get("#dialogOperateKpi").show();<br> --------------------------<br> 表字段的拼接显示数据<br> var YEAR_FROM =arg.data.get("YEAR_FROM");<br> var YEAR_TO = arg.data.get("YEAR_TO");<br> arg.dom.innerHTML = YEAR_FROM +"-"+ YEAR_TO;<br> ----<br> 页面参数接收<br> $isSign = "${request.getParameter('sign')}";</p> 
<p>var flag="${param.flag}";//1公司级;2专业级</p> 
<p>---去空格<br> overall_goals =overall_goals.replace(/(^\s*)|(\s*$)/g,"");<br> --<br> typeof(overall_goals) == "undefined"</p> 
<p>--------全局js方法调用<br> $SendWarnMessage('dataSetOcmGraphCard',data_State);<br>  dorado.MessageBox.alert("状态为【"+$WarnMessage+"】的数据不允许变更!");<br>  return;</p> 
<p>-<br> var dsMain = this.get("#dataSetOcmGraphCard").getData("#");<br> var MainCard_state=dsMain.get("DATA_STAT");<br> if(MainCard_state&gt;=5&amp;&amp;MainCard_state!=16){//首先满足公司级state&gt;=5且不等于16<br>  if(data_State==0){//在满足公司级前提下，只允许编辑专业级的草稿<br>  <br>    }else{<!-- --><br>  $SendWarnMessage('dataSetProfession',data_State);<br>  dorado.MessageBox.alert("状态为【"+$WarnMessage+"】的数据不允许变更!");<br>  return;<br>     }<br> }else{<!-- --><br>  $SendWarnMessage('dataSetOcmGraphCard',MainCard_state);<br>  dorado.MessageBox.alert("状态为【"+$WarnMessage+"】的数据不允许变更!");<br>  return;<br> }</p> 
<p>----------------------文字链接--------------------<br> arg.dom.innerHTML="&lt;a href =\"javascript:window.showMainFileUpload('"+arg.data.get("ID")+"')\"&gt;浏览&lt;/a&gt;"</p> 
<p>----------</p> 
<p>readWordTemplet<br> readAttachTemplet</p> 
<p>editWordTemplet<br> editAttachTemplet</p> 
<p>updateWordTemplet<br> updateAttachTemplet</p> 
<p>wordTempletDetailManage<br> attachTempletDetailManage</p> 
<p><br> attachTempletIFrame<br> dialogAttachTemplet</p> 
<p>dataGridSysAttachTemplet</p> 
<p><br> dialogEditForm<br> dataSetMainSubEditForm</p> 
<p>dataSetOcmStrategicPlanAddForm<br> dataSetOcmStrategicPlan</p> 
<p>dataTypeSysAttachTemplet</p> 
<p>dataTypeSysAttachTempletDetail<br> ----------------------------<br> dataSetSysAttachTemplet<br> dataSetSysAttachTempletDetail</p> 
<p>dataSetSysAttachTempletQuery<br> dataSetSysAttachTempletDetailQuery</p> 
<p>dialogFileUpload<br> dialogSysAttachTempletAdd</p> 
<p>avicit.ocm.ocmstraplanmain.domain.SysAttachment<br> avicit.ocm.ocmstraplanmain.domain.SysAttachTempletDetail<br> sys_att什么表</p> 
<p><br> sysWordTempletAction#getSysWordTempletListByPage</p> 
<p>sysAttachTempletAction#getSysAttachTempletListByPage<br> sysAttachTempletDetailAction#getSysAttachTempletDetailListByPage</p> 
<p>SysAttachTempletServiceImpl</p> 
<p>buttonAddSysAttachTemplet<br> updateActionSaveSysAttachTemplet</p> 
<p><br> dataSetSysAttachment</p> 
<p>ATTACH_NAME VARCHAR2(200) N   <br> PARENT_TABLE_ID VARCHAR2(30) Y   <br> PARENT_REGISTER_ID VARCHAR2(32) N   <br> ATTACH_BLOB BLOB Y   <br> ATTACH_TYPE VARCHAR2(20) Y   <br> ATTACH_SIZE NUMBER(20) Y </p> 
<p><br> ${web.contextPath}/avicit/platform6/modules/system/sysfileupload/view/sysfileupload.d7  <br> uploadDialog<br> uploadFileIFrame</p> 
<p><br> <a target="_blank" href="http://localhost:8080/1/avicit/ocm/ocmstraplanmain/view/SysAttachment.d7" rel="nofollow noopener noreferrer">http://localhost:8080/1/avicit/ocm/ocmstraplanmain/view/SysAttachment.d7</a>?<br> id=8a58bca33f756dd9013f756f4aee000a<br> &amp;BusinessTableName=OCM_STRA_PLAN_MAIN</p> 
<p><br> fileuploadBusinessId<br> fileuploadBusinessTableName</p> 
<p><br> dataSetSysAttachment<br> :P_PARENT_REGISTER_ID</p> 
<p> var ds = view.get("#dataSetSysAttachment");<br>         ds.set("parameter",{<!-- --><br>             P_PARENT_REGISTER_ID: '${param.id}'<br>         }).flushAsync();</p> 
<p>-------设置默认值<br> view.get("#dataSetOcmGraphCard").getData("#").set("YEAR_FROM",2013);<br> view.get("#dataset").getData("#").set("字段",值);<br> ------------处理日期格式-----<br> var  data=new Date();<br> var year=data.getFullYear();<br> view.get("#dataSetOcmGraphCard").getData("#").set("YEAR_FROM",year-5);<br> view.get("#dataSetOcmGraphCard").getData("#").set("YEAR_TO",year);<br> var month=data.getMonth()+1;<br> var day=data.getDay();<br> view.get("#dataSetOcmGraphCard").getData("#").set("REVIEW_DATE",data.getFullYear()+"-"+month+"-"+day);<br> ---URL<br> ${request.getContextPath()}/dorado/uploader/fileupload<br> ---<br> return (SysFileUpload)getSession().get(SysFileUpload.class,id);</p> 
<p>/*<br>  * 清空<br>  */<br> $clearUploadQueue = function(){<!-- --><br>  var uploadAction = view.get('#batchUpload');<br>  view.get("#dataSetFiles").get("data").each(function(entity){<!-- --><br>   uploadAction.removeFile(entity.get('id'));<br>  });<br>  view.get("#dataSetFiles").clear();<br> }<br> ----------------------------<br> 平台上传组件的路径<br> ${web.contextPath}/avicit/platform6/modules/system/sysfileupload/view/sysfileupload.d7<br> ----------判断WORD<br> var ds= view.get("#dataSetSysAttachment").getData("#");<br>  var docType=ds.get("attachName");<br>  docIndex=docType.indexOf(".");<br>     docType=docType.substring(docIndex+1);<br>  if(docType=="doc"||docType=="docx"){<!-- --><br>   return docType<br>  }else{<!-- --><br>      return;<br>  }<br> --------------dataSetFiles------------</p> 
<p><br> /**<br>  var dataset = view.id("dataSetOcmStrategicPlanAddForm");<br>  dataset.insert();<br>  //每次进入添加页面情况dataset值<br>     view.get("#dataSetMainSubAddForm").clear();<br>     var dialog = view.id("dialogAddForm");<br>     dialog.show();<br>    **/ </p> 
<p>view.get("#addOcmStrategicframe").set("path","${web.contextPath}/avicit/ocm/ocmstraplanmain/view/OcmStraPlanMainAdd.d7");<br>     view.get("#dialogAddStrategic").set('caption','添加战略规划').show();<br>   <br>   -----------------------------------------<br> -<br> //修改dataset中数据的状态&amp;#xD;<br> var ds = view.get("#dataSetTrainProjectDingr").getData("#");<br> ds.setState(dorado.Entity.STATE_NEW);<br> --------------------------------<br> var id =  view.id("dataSetOcmStrategicPlanEditForm").getData("#.ID");<br> var name =  view.id("dataSetOcmStrategicPlanEditForm").getData("#.STRATEGIC_PLAN_NAME");<br> --------------------------------------</p> 
<p>/************显示浏览附件的表格列********************/<br> window.showAttachColumn = function(){<!-- --><br>  var addMainData= view.get("#AddMainData").getColumn("attachFileMain");<br>    if(typeof(AddMainData)!="undefined"){<!-- --><br>     obj.set("visible",true);<br>    }<br>    var addSubData view.get("#AddSubData").getColumn("attachFileSub");<br>     if(typeof(addSubData)!="undefined"){<!-- --><br>     addSubData.set("visible",true);<br>    }<br> }<br> /********************************/<br>   <br>   //update chens <br>  String findSqlmain = "select id from OCM_STRA_PLAN_MAIN where ocm_strategic_plan_id= '"+id;<br>  List  listmain = hibernateDao.findBySQL(findSqlmain);<br>  if(listmain != null &amp;&amp; listmain.size()&gt;0){<!-- --><br>   for (int i =0; i&lt;listmain.size();i++){<!-- --><br>    String updateId = listmain.get(i).toString();<br>   }<br>  }<br>   -----------------流程详细页关闭按钮-----<br>   if(parent.refreshDetail==null){<!-- --><br>  parent.window.location="${web.contextPath}/avicit/platform6/modules/system/sysdashboard/index.jsp";<br>     return;<br> }<br> parent.refreshDetail()<br> ---------------dropdown的items属性--property属性id-</p> 
<p>${dorado.getDataProvider("sysRoleAction#getSysRoleList").getResult()}</p> 
<p>onclose()事件中<br> var value = arg.selectedValue;<br> self._items.each(function(obj){<!-- --><br>  if(value == obj.id){<!-- --><br>   //arg.selectedValue = obj.roleName;<br>  }<br> });<br> ------------------------<br> eMail 效验<br> // E-mail值检测<br> $isMailAddress = function (name){ <br>  if(name=='' || typeof(name) == 'undefined' || name == null)return true;<br>  i = name.indexOf("@");<br>  j = name.lastIndexOf("@");<br>  if(i == -1)<br>   return false;<br>  if(i != j)<br>   return false;<br>  if(i == name.length)<br>   return false;<br>  return true;<br> }<br> =-----form表单重新赋值<br> view.get("#dataFormAddKPI").get("entity").set("WEIGHT", weight);;<br>  view.set("#dataFormAddKPI.entity");<br> --------Tab标签的显影<br> var formcodepara="${param.formcodepara}";<br> if(formcodepara=='A'){<!-- --><br> view.get("#tabControl2").getTab("actProShow").set("visible",true);<br> }else{<!-- --><br>  view.get("#tabControl2").getTab("actProShow").set("visible",false);<br> } <br> ---------------------------------------------------------<br> --------网络摘抄，待验证---在一个view中通过js代码使得另一个view的tabControl动态创建tab<br> 其中---两个view<br> 其中一个view的tabControl里面包含一个IFrameTab,IFrameTab内包含另一个view；子view中的<br> dataGrid的一个dataColumn渲染了一个超链接，要实现点击链接，在父页面的TabControl中动态的创建<br> 一个新的IFrameTab<br> ------实现过程<br> 在OnCellRender()里写如下代码：<br>    $(arg.dom).empty.xCreate({<!-- --><br>      tagName:'A',<br>   href:'#',<br>   content:'Click Me'<br>    })<br>    <br>    $(arg.dom).off('click','A','**').on('click','A',function(){<!-- --><br>              anotherView.get("tabcontrolId").addTab(new dorado.widget.tab.IFrameTab({name:'',caption:'',path:''}))<br>    })<br> ---------------------------------------------------------------------------<br>    ///获得中文字符长度begin //<br> String.prototype.getBytes = function(){<!-- --><br>     var cArr = this.match(/[^\x00-\xff]/ig);<br>     return this.length + (cArr == null ? 0 : cArr.length);<br> }<br> ///获得中文字符长度 end//</p> 
<p> </p> 
<p>///校验字段的长度 begin//<br> lengthValidate = function(fields, describe, length){<!-- --><br>  var flag = true;<br>  var data = view.get("#dataSetOcmKpiWrite.data:#");<br>  var field = data.get(fields);<br>  if(field != null){<!-- --><br>   if(field.getBytes() &gt; length){<!-- --><br>    dorado.MessageBox.alert("【" + describe + "】文本内容过多，长度应小于" + length + "个字符！");<br>    flag = false;<br>   }<br>  }<br>  return flag;<br> }<br> ///校验字段的长度 end//<br> ///校验名称长度 begin 2013-10-18 chens/<br> //在dataType里边这样写<br> var name = arg.entity.get("PLAN_NAME");<br> if(name != null){<!-- --><br>  if(name.getBytes() &gt; 180){<!-- --><br>   dorado.MessageBox.alert("【总规划名称】文本内容过多，长度应小于180个字符！");<br>   return;<br>  }<br> }<br> ///校验名称长度 end/<br> ---------------------------------------------------------------------------------------</p> 
<p>var type = arg.data.get("TYPE");<br> var change =  arg.data.get("CHANGE_STATE");<br> if(type != 3){<!-- --><br>  if(change == "A"){//绿色<br>   arg.dom.style.background = "#37FF37" //"#37B44A" <br>  }else if(change == "U"){//蓝色<br>   arg.dom.style.background = "#C1EFEF"//"#00BFF3" <br>  }else if(change == "D"){//红色<br>   arg.dom.style.background = "#FDDFED"//"#EE1D24" <br>  }else{<!-- --><br>   arg.dom.style.background = "" <br>  }<br> }else{<!-- --><br>  arg.dom.style.background = "" <br> }<br> arg.processDefault = true;<br> -----------------------------------------------------<br> 遍历树结构的表<br> SELECT *<br>   FROM ocm_kpi_write_act_v<br>  WHERE ocm_graph_card_id = '8a58bc943f9d7e35013f9d7fb2dc0003'<br> CONNECT BY PRIOR ID = parent_id<br>  START WITH parent_id = '-1';</p> 
<p>select *<br>   from ocm_kpi_write_act_vs m<br>  where m.OCM_GRAPH_CARD_ID = '8a58bc943f9d7e35013f9d7fb2dc0003';<br> ------------------------------------------------------------------<br> SELECT * <br>   FROM OCM_KPI_WRITE_V <br>   WHERE ocm_graph_card_id='8a58bc883f884a4d013f88666ad90006' <br>  CONNECT BY PRIOR ID = parent_id <br>  START WITH parent_id ='-1'<br>   --8a58bc943f9d7e35013f9d7fb2dc0003<br>   <br> select * <br>   from ocm_kpi_write_vs t <br>   where t.OCM_GRAPH_CARD_ID ='8a58bc943f9d7e35013f9d7fb2dc0003';</p> 
<p>  OCM_KPI_WRITE_V<br>   <br>   OCM_KPI_WRITE_VS<br>   ----------------------------------------------<br> -----------dataType属性beforeDataChange------判断开始日期小于结束日期<br> switch(arg.property){<!-- --><br>  case "ACT_START_DATE" :<br>   var endDate = arg.entity.get("ACT_END_DATE")<br>   var startDate = arg.newValue;<br>   var ds = view.id("dataSetOcmActPlan").getData("#");<br>   if(startDate&gt;endDate){<!-- --><br>    dorado.MessageBox.alert("字段【开始时间】不能大于字段【结束时间】");<br>   arg.entity.set("ACT_END_DATE",arg.newValue)<br>   }<br>  break;<br>  case "ACT_END_DATE" :<br>   var startDate = arg.entity.get("ACT_END_DATE")<br>    var endDate = arg.newValue;<br>    var ds = view.id("dataSetOcmActPlan").getData("#");<br>    if(startDate&gt;endDate){<!-- --><br>     dorado.MessageBox.alert("字段【结束时间】不能小于字段【开始时间】");<br>    arg.entity.set("ACT_START_DATE",arg.newValue)<br>    }<br>  break;<br> }<br> ------------------------------------------------------------------------------------<br> dataTree的宽窄属性:position:200;<br> --------------从session中获取当前登录人的部门ID-------------------------------------------------------------------<br> public String getSessionDeptId(){<!-- --><br>   return SessionHelper.getCurrentDeptId();<br>  }<br> String userId = SessionHelper.getLoginSysUserId();<br>   String ip = SessionHelper.getClientIp();</p> 
<p>----------------------------------------<br> 部门ID转NAME---:要注意名字的统一<br> @Transient<br>  public String getHrDeptName() {<!-- --><br>   SysDeptLoader sdLoader = SpringFactory.getBean("SysDeptLoader");<br>   String hrDeptName = sdLoader.getSysDeptNameBySysDeptId(this.getHrDeptId(), "zh_CN");<br>   return hrDeptName;<br>  }<br> --------------------------------<br> POJO首页返回流程状态<br> ---<br> @Autowired<br>  @JdbcDaor<br>  private IJdbcDao jdbcDao;<br>  <br>  @Autowired<br>  CommonHibernateDao commonHibernateDao;<br>  <br>  @DataProvider<br>  public void getDataWithBpmEntryV(Criteria criteria, Object parameter, Page page) {<!-- --><br>   jdbcDao.page("CompositeOcmGraphCard", criteria, parameter, page);<br>   Collection&lt;Record&gt; records = page.getEntities();<br>   for (Record r: records){<!-- --><br>    String activityNames=new BpmEntity().getEntityActivityNamesByFormId(commonHibernateDao,r.getString("ID").toString());<br>    /*//String activityNames = "测试综合图卡";<br>    bpmToolService.getActivityNamesByFormId(r.getString("ID").toString()) ;<br>    //String state = "已经完成";<br>    bpmToolService.getProcessStateByFormId(r.getString("ID").toString()) ;*/<br>    String state = new BpmEntity().getEntityStateByFromId(commonHibernateDao,r.getString("ID").toString());<br>    //流程实例ID<br>    String entryId =  new BpmEntity().getEntityIdByFromId(commonHibernateDao, r.getString("ID").toString());<br>    String executionId =  new BpmEntity().getExecutionId(commonHibernateDao, r.getString("ID").toString());<br>    String taskId =  new BpmEntity().getTaskId(commonHibernateDao, r.getString("ID").toString());<br>    <br>    r.put("ATTRIBUTE_10", entryId);<br>    r.put("ACTIVITY_NAMES", activityNames);<br>    r.put("ACTIVITY_STATE", state);<br>    r.put("ATTRIBUTE_09", executionId);<br>    r.put("ATTRIBUTE_08", taskId);<br>   }<br>  }<br> --------------------------------------------------------------------- <br> var data = view.get("#dataSetAddForm.data:#");<br> --------------------------------</p> 
<p>dataTree树上高亮显示<br> ---------------<br> var ocmKpiWriteId =view.get('#dataSetOcmActPlan').getData('#').get('ocmKpiWriteId');<br> var firstNode =view.get("#dataTree").get('firstNode');<br> queryNode(firstNode,true);<br> return true;<br> ------------------树节点上取值-----<br>    var currentEntity = this.id("treeGrid").get("currentEntity");<br> if (currentEntity) {<!-- --><br>  //根节点和战略角度节点不能被删除<br>         if (currentEntity.get("PARENT_ID") !=-1 &amp;&amp; currentEntity.get("TYPE") !="3" ) {<!-- --><br> ---<br> //递归查找树上对应节点  mac2013-7-10<br> function queryNode(node,sign){<!-- --><br>  if(sign){<!-- --><br>   var nodes=node.get('nodes');<br>   nodes.each(function(obj){  <br>        var OCM_KPI_WRITE_ID=obj.get('data').get('OCM_KPI_WRITE_ID');<br>    //alert(obj.get('data').get('NAME')+"OCM_KPI_WRITE_ID---"+OCM_KPI_WRITE_ID+"---"+ocmKpiWriteId);<br>           if(obj.get('data').get('OCM_KPI_WRITE_ID')==ocmKpiWriteId){<!-- --><br>      //alert(obj.get('data').get('NAME')+'!!!!!');<br>     obj.highlight(); <br>     return false;<br>     }else{<!-- --><br>      var sd=queryNode(obj,true);<br>     }<br>   });<br>  }else{<!-- --><br>   //alert(1);<br>   return false;<br>  }<br> }<br> ----------------------------------------------------------<br> table行高亮显示<br> --<br> var change = arg.data.get("CHANGE_STATE");<br> if (change == "A") {//绿色<br>     arg.dom.style.background = "#fff100" //"#37B44A" <br> }else if (change == "U") {//蓝色<br>         arg.dom.style.background = "#00FF00"//"#00BFF3" <br> }else if (change == "D") {//红色<br>             arg.dom.style.background = "#EE1D24" <br> }else {<!-- --><br>   arg.dom.style.background = ""<br> }<br> arg.processDefault = true;<br> ----------------操作，详细链接--------------------------------------<br> var id = arg.data.get("id");</p> 
<p>jQuery(arg.dom).empty();<br> jQuery(arg.dom).xCreate({<!-- --><br>     tagName: "A",<br>     href: "#",<br>     content: "详细",<br>     style: "font-size:13px",<br>     onclick: function(){<!-- --><br>   view.get("#detailIframe").set("path","${web.contextPath}/avicit/ocm/kpimanager/ocmactplan/view/actsubproject/OcmActSubProjectDetail.d7?isFlow=true&amp;id=" + id);<br>   view.get("#dialogDetail").show();<br>  }});<br> ------------------------------------------------<br> var button1 = $DomUtils.xCreate({<!-- --><br>  tagName: "button",<br>  id:"button1",<br>  content: "Click Me",// 定义按钮的标题 <br>  onclick: function(){<!-- --><br>   // 定义onclick事件    <br>   alert("Button clicked.");<br>  }},{<!-- --><br>  tagName: "button",<br>  content: "Click You",// 定义按钮的标题 <br>  onclick: function(){<!-- --><br>   // 定义onclick事件   <br>  }}  <br> );<br> -------------------------------------------<br> //找到dataTreeGrid的property列绑定onGetCellEditor监听事件<br> view.get("#dataTreeGrid1").findColumns(property)[0].set({<!-- --><br>     trigger: view.get("#recommendDropdown"),   //绑定下拉框<br>     onGetCellEditor :function(self, arg){<!-- --><br>         //获取ajax对象<br>         var ajaxGetListAction = view.get("#ajaxGetDropDownItem");<br>        <br>         //设置ajax请求参数<br>         ajaxGetListAction.set("parameter",param);</p> 
<p>        //执行ajaxAction请求获取下拉框值<br>         ajaxGetListAction.execute(function(result){<!-- --><br>         view.get("#recommendDropdown").set("items",result);<br>         });<br>     }<br> });<br> ----------------------------<br> onGetCellEditor :function(self, arg){<!-- --><br>     arg.editor.set("trigger",view.get("#recommendDropdown"))<br>  }<br> -----------------<br> ---------------------------table设置某一列的只读---------<br>  view.get("#MainData").findColumns("YEAR_FROM")[0].set({<!-- --><br>    // trigger: ,   //绑定下拉框<br>     onRenderCell :function(self, arg){<!-- --><br>  var v= arg.data.get("YEAR_FROM");<br>        if(v=='2012'){     <br>     arg.cellEditor.createEditorControl();//获取对应的Editor对象<br>   // arg.editor.set("readOnly",true);<br>     }else{<!-- --><br>     // arg.editor.set("readOnly",false);<br>     }<br>     }<br> });<br> --------------------------------------------<br> jQuery(arg.dom).empty();<br> jQuery(arg.dom).xCreate({<!-- --><br>     tagName: "A",<br>     href:"#",<br>     content:arg.data.get("YEAR_FROM"),<br>  style:"font-size:12px;color:red"<br> });<br> ----------------------------------<br> ---js替换访问路径------------------<br> $ReportRoot="rqreport/reportJsp/showReport.jsp?raq=/subjectOcmCardReport.raq&amp;cardId=";<br> var rootPath='${web.contextPath}';<br> var ServerNAME=rootPath.substring(1);<br> localPath=rootPath.replace(ServerNAME,$ReportRoot);<br> -------------------------------------------</p> 
<p>----------------------------------------<br> dynaRowHeight : boolean from AbstractGrid[WriteBeforeReady] <br> 是否支持动态行高的功能。<br> ----------------------------------------------<br> stretchcolumnsmode<br> 表格列的宽度调整模式<br> ---------------</p> 
<p>--dataTreeGrid的Column的属性onRenderCell事件<br> var context = {};<br> var status = arg.data.get("planType");<br> var png="";<br> if(status == '晴天'){<!-- --><br>  png = "qing";<br> }else if(status == '阴天'){<!-- --><br>  png = "yin";<br> } else if(status == '大雨'){<!-- --><br>  png = "yu";</p> 
<p>} else if(status == '多云'){<!-- --><br>  png = "duoyun";<br> } else{<!-- --><br>  arg.dom.innerHtml ="&lt;a href=#&gt;"+status+"&lt;/a&gt;";<br> }<br> arg.dom.innerHTML="&lt;img src ='../../../../images/"+png+".png' height = '20px' alt ="+status+"&gt;"+status;<br> dorado.TipManager.initTip(arg.dom.parentNode, {<!-- --><br>   content : {<!-- --><br>    tagName : "IMG",<br>    src : $url("../../../../images/"+png+".png"),<br>    style : "width: 128px; height: 128px; margin: 8px"<br>   },<br>   arrowDirection : "top",<br>   arrowAlign : "left"<br>  });<br> ------------------------------------<br> table判断当前数据是否存在<br> var table = view.get("#MainDataprofession");<br> if(null!=table.getCurrentItem()){ <br> -------------------------------------<br> view.get("#menuOrg").show({<!-- --><br>  position:{<!-- --><br>   left:arg.event.pageX,<br>   top:arg.event.pageY<br>  }<br> });<br> -------------------------------<br> 平台选人页<br> [{loginName:CREATED_BY},{name:CREATED_BY_NAME}]</p> 
<p><br> selectUser_Trigger<br> ---------------------、<br> 树节点onRenderNode()事件<br> var selected = arg.node.get("data.searchSelectedFlag");<br> arg.dom.style.fontWeight = selected ? "bold" : "";<br> arg.dom.style.background = selected ? "#3399ff" : "";<br> arg.dom.style.padding = selected ? "0 4px" : "";<br> arg.dom.style.color = selected ? "white" : "";<br> arg.processDefault = true;<br> -------------------------------------------------<br> El表达式<br> 两种EL表达式<br> –静态EL表达式：${expression} ，在创建目标对象癿过程中一次性癿求值。<br> –劢态EL表达式：$${expression}，以劢态代理癿方式创建目标对象，并在外界每一次读取相应属性时迕行求值。<br> ?基本诧法<br> –${3x2} =6<br> –${3&gt;2} =true<br> –${empty(foo)} - empty()是内置癿函数，用亍刞断传入参数是否为null戒空字符串。<br> –${foo&gt;0? "enabled":"disabled"} - 条件表达式。<br> –${foo["bar"]}戒${foo.bar]} - 读取map中癿bar键值。<br> -----------------------------------------------------<br> ----dorado系统变量和参数<br> 不线程无关（仸何配置文件中都可以使用）<br> –null - 表示null<br> –env - 用亍获取系统环境变量。${env.JAVA_HOME}戒${env["JAVA_HOME"]}<br> –system - Java癿系统属性，即System.getProperties()对象。<br> –configure - 用亍获取Dorado7癿配置信息。${configure["runMode"]}<br> ?不线程相关（通常仅在处理Http请求癿线程中可以使用）<br> –argument - 用亍获取当前配置文件中癿参数值，仅可用亍View.xml<br> –context - 当前线程中癿DoradoContext。<br> –ctx - 用亍简化对DoradoContext癿getAttribute方法癿访问。${ctx["foo"]}相当亍${context.getAttribute("foo")}<br> –util - 基本工具类，见com.bstek.dorado.core.el.ExpressionUtilsObject癿javadoc。<br> –request - 当前癿HttpServletRequest对象。<br> –req - 用亍简化对request癿getAttribute方法癿访问。 ${req["foo"]}相当亍${request.getAttribute("foo")}<br> –param - 用亍简化对request癿getParameter方法癿访问。 ${param["foo"]}相当亍${request.getParameter("foo")}<br> –session - 当前癿HttpSession对象。<br> –servletContext - 当前癿SerlvetContext对象。<br> –web - 基本工具类，见com.bstek.dorado.web.WebExpressionUtilsObject癿javadoc。<br> ?如有需要，开发人员可以自行扩展出更多癿隐式变量。<br> ------------------------------------------------------------------<br> 特殊EL隐式变量<br> $${this}或$${this.foo}<br> –此种隐式变量通常只用在DataType癿Reference属性中。<br> this表示当前正在处理癿数据实体对象，即系统正在尝试获取该数据实体对象癿Reference属性癿值。<br> –此种EL表达式癿实际求值范围是在Client端癿JavaScript环境中<br> ------------------------------------------------------------------<br> ------------布局<br> Dorado7目前提供癿布局管理器：<br> –DockLayout 停靠式布局<br> –AnchorLayout 锚定式布局<br> –FormLayout 表单时布局<br> –HBoxLayout 水平箱式布局<br> –VBoxLayout 垂直箱式布局<br> –NativeLayout （其实什么都丌做癿布局）<br> -----------------------------------------------<br> ----添加事件<br> 一个事件下可添加多个监听函数，可使用下面癿两种方法。<br> button1.set("onClick", function(self) {<!-- --><br> // 此方法只能定义一个监听函数<br> });<br> 戒<br> button1.addListener("onClick", function(self) {<!-- --><br> //此方法可以为一个事件添加多个监听函数<br> });<br> ?Dorado7中所有癿事件都只支持self和arg返两个事件参数。<br> –self总是激发事件癿对象自身。<br> –arg癿类型不具体癿事件类型有关，很多情况下是一个JSON对象，其中可能包含有非常丰富癿传入信息。</p> 
<p>-----------------------------------------<br> ---processDefault----<br> 很多beforeXXX事件癿arg参数中都支持一个名为processDefault癿可写属性，用亍通知系统是否要执行该事件所代表癿后续操作。<br> employeeDataType.addListener("beforeRemove", function(self, arg) {<!-- --><br> if (arg.entity.get("married")) {<!-- --><br> dorado.MessageBox.alert("已婚癿员工丌能被初除！");<br> arg.processDefault = false;<br> }<br> });<br> ?抛出一个异常，同样可以达刡类似癿目癿。<br> employeeDataType.addListener("beforeRemove", function(self, arg) {<!-- --><br> if (arg.entity.get("married")) {<!-- --><br> throw new dorado.Exception("已婚癿员工丌能被初除！");<br> }<br> });<br> -------------------------------------<br> ---手动创建一个button按钮拥戴了特殊的$type类型<br> 例如下面癿代码也可以用来创建一个Button。<br> {<!-- --><br> $type: "Button",<br> caption: "Say Hello"，<br> onClick: function(self, arg) {<!-- --><br> dorado.MessageBox.alert("Hello!");<br> }<br> }<br> ------------------------------<br> 获取控件推荐的方法<br> –this.get("#buttonOK") 今后推荐癿方法，原因是当你需要迕一步操作buttonOK时会非常方便。<br> 例如this.get("#buttonOK.caption")可以直接获得Button癿caption属性。<br> -------------------------------<br> 根据标签获得一批对象癿方法包括：<br> this.get("^foo") 今后推荐癿方法。例如：this.set("^foo.disabled", true)<br> this.tag("foo") 今后丌再推荐。<br> ------------------------------<br> View癿get和set中更多使用技巧<br> –this.get("title") - 读取View自身癿属性<br> –this.get("#buttonOK")<br> –this.get("^foo")<br> –this.get("@DataTypeProduct") - 根据名称获得某个DataType<br> ----------------------------------------<br> ?$url() - 用亍转换URL<br> –"&gt;images/icon.gif"将转换为"/appContextPath/images/icon.gif"<br> –"skin&gt;widget.css"将转换为Dorado当前当前皮肤路徂下癿widget.css癿URL。<br> 因为skin是预设癿URL前缀代表当前皮肤癿根路径<br> --------------------------------------<br> ?$DomUtils.xCreate() - 根据以JSON形式定义癿组件癿模板信息快速癿创建DOM元素<br> $DomUtils.xCreate({<!-- --><br> tagName: "button",<br> content: "Click Me",// 定义按钮癿标题<br> style: {// 定义按钮癿style<br> border: "1px black solid",<br> backgroundColor: "white"<br> },<br> onclick: function() {// 定义onclick事件<br> alert("Button clicked.");<br> }<br> });<br> -----------------------------------<br> dorado遍历循环数组list<br> 数组.each() - Dorado7扩展了标准癿Array使乊可支持each迭代，<br> 除Array之外Dorado7还提供EntityList、KeyedList等集合特性癿对象也支持each迭代。<br> var s = '';<br> ['A', 'B', 'C'].each(function(item) {<!-- --><br> s += item;<br> });<br> // 最终绌果为s == "ABC"<br> --------------------<br> 刜步接触一系列对象<br> –DataSet - 数据集<br> –DataType - 数据类型（通常用亍描述以数据实体及其中各个属性）<br> –DataProvider - 用亍为Dorado提供数据（即将业务逡辑层中癿数据寻入刡Dorado中）<br> –DataResolver - 不DataProvider癿作用相反，用亍将Dorado中癿数据交迓给业务逡辑层。<br> --------------------------------------------<br> DataPath癿一些示例(1)<br> null(即空) - 相当亍直接迒回被查询癿数据。<br>  - 同上。<br> [#current] -表示顶层集合中癿当前Department。<br> # - 同上。<br> [#dirty] - 表示顶层集合中所有在客户端被改变过癿（包含被初除癿）Department。<br> #.employees - 表示顶层集合中当前Department中所有癿Employee。<br> #.#employees - 表示顶层集合中当前Department中癿当前Employee。<br> .departments(R) - 表示除顶层Department外所有其它Department癿集合。<br> #departments(R) - 表示各层当前Department癿集合。<br> #departments(leaf) - 表示最末端癿当前Department。即通过丌断癿尝试获取当前Department中癿当前Department，直刡最末端那个Department。<br> departments(R).employees[@.get("salary")&gt;5000 &amp;&amp; @.get("sex")=="male"] - 表示所有Department中癿薪水高亍5000癿男性Employee。<br> departments(R).employees.id - 表示迒回所有Employee对象癿id属性值癿集合。<br> ----------取值--------------------------------------<br> DataSet.getData和DataSet.queryData<br> –getData默认只迒回DataPath命中癿第一笔数据，可能是Entity，也可能是EntityList。<br> –queryData返回DataPath完整的执行结果，且默认只返回Entity（只在使用#等确定只可能有最多一个命中数据实体癿DataPath时）或Entity癿数组。</p> 
<p>-----------------------------------------------<br> Trigger表示文本编辑框右侧癿快捷按钮<br> DropDown是Trigger癿一种特例，特指各种下拉框<br> TabControl比较常用的属性包括：<br> ? AwaysShowButtons 显示导航按钮<br> ? CurrentTab 当前默认的标签页<br> ? ShowMenuButton 显示菜单按钮<br> ? TabMinWidth 标签页签的最小宽度<br> ? TabPlacment 标签页签的显示位置<br> 其它属性可以通过Client API查询。<br> ------------------------</p> 
<p>----<br> 在树节点的OnDataRowClick中编写代码打开tab标签页<br> 我们用IframeTab打开tabControl;</p> 
<p>// 定义Tab变量<br> var tab = {};<br> // self 代表事件所属的控件，此处指 Tree对象<br> // self.get("currentNode")表示获取当前被点击的节点。<br> with (self.get("currentNode")) {<!-- --><br> // 制定当前的tab为IFrameTab<br> tab.$type = "IFrame";<br> // 定义新Tab的标签<br> tab.caption = get("label");<br> // 定义Tab的Path<br> // get("userData")表示获取当前节点的UserData属性，<br> // 也就是刚才设定的 sample.chapter01.HelloWorld.d<br> tab.path = get("userData");<br> tab.name = get("label");<br> tab.closeable = true;<br> }<br> // 如果当前节点有指定的Path则打开新的tab<br> if (tab.path) {<!-- --><br> with (this.get("#tabControl")) {<!-- --><br> // 根据name查找是否已经打开过当前的Tab。<br> // 如果没有打开过，则需要添加一个新的Tab<br> var currentTab = getTab(tab.name);<br> if(currentTab){<!-- --><br> tab = currentTab;<br> }else{<!-- --><br> // 获取ID为tabControl的对象，并添加一个新的Tab<br> // 设定ID为tabControl的对象的当前Tab为新创建的Tab<br> tab = addTab(tab);<br> }<br> // 设定当前的Tab为制定的tab<br> set("currentTab", tab);<br> }<br> }<br> ------------------------------------<br> 在action的onSuccess事件中<br> self.get("returnValue")的含义就是获得ajax调用返回的结果；<br> 例子：<br> // 获取用户在editor中的输入值<br> var value = this.get("#editor1.value");<br> // 把输入的值作为参数传递给action2并触发Ajax2的执行<br> // 当ajax2执行成功后会触发回调函数方法，在这里就是function(result){..}<br> // 执行结果作为参数传递给方法。这里的执行结果为result对象<br> this.get("#action2").set("parameter",value).execute(function(result){<!-- --><br> dorado.MessageBox.alert(result);<br> })</p> 
<p>----------------<br> 在button1的onclick事件中编写的代码：<br> // 获取AjaxAction对象<br> var action = this.get("#aciton1");<br> // 调用Dorado提供的prompt方法<br> dorado.MessageBox.prompt("Please input two numbers here", {<!-- --><br> // 默认的值<br> defaultText: "3,5",<br> // 当用户提交输入的数值时触发的回调方法，参数为输入的值<br> callback: function(text){<!-- --><br> var nums = text.split(",");<br> // 将参数拼装成JSON形式<br> var parameter = {<!-- --><br> num1: nums[0],<br> num2: nums[1]<br> };<br> // 调用AjaxAction<br> action.set("parameter", parameter).execute(function(result){<!-- --><br> dorado.MessageBox.alert(nums[0] + " * " + nums[1] + " = " + result);<br> });<br> }<br> });<br> --------------------=======================================================<br> ajax返回多个参数例子<br> 后台方法：<br> @Expose<br> public Properties getSystemInfo() {<!-- --><br> Properties info = new Properties();<br> info.setProperty("product", DoradoAbout.getProductTitle());<br> info.setProperty("vendor", DoradoAbout.getVendor());<br> info.setProperty("version", DoradoAbout.getVersion());<br> return info;<br> }<br> --<br> 在action的onSuccess事件中编写代码：<br> var info = self.get("returnValue");<br> dorado.MessageBox.alert("product :" + info.product + "\n" +<br> "vendor :" +<br> info.vendor +<br> "\n" +<br> "version : " +<br> info.version);<br> ------------------------------------------------------------------<br> Listener:这样配置<br> listener ：spring:dynaView1#beforeButton2Init（类#方法名）类注解@Component<br> Caption ：测试按钮<br> id ：button2<br> -------<br>  if(str.substr(0,4)!="010-" || str.substr(4).length!=8 || <br>              isNaN(parseFloat(str.substr(4)))) <br>    alert("无效的电话号码！");</p> 
<p>ocm_commom_if_p.Get_DeptName_ByIds(ISSUE_RANGE) AS ISSUE_RANGE_NAME,</p> 
<p> pt6.get_session_info.Get_User_Id  NAME,<br> -----------------<br> jsp获取根路径<br> &lt;<a target="_blank" href="mailto:%@page" rel="nofollow noopener noreferrer">%@page</a> import="avicit.platform6.commons.utils.ViewUtil"%&gt;<br> &lt;%<br> /* String path = request.getContextPath();<br> out.println(path); */<br> out.print(ViewUtil.getRequestPath(request)+"platform/ocm/OcmKpiWriteChangeAction/updateZlMapXml.action");<br> %&gt;<br> ---<br> 路由设条件<br> 流程expr脚本写法<br> #{流程变量=="1"}<br> -------------------<br> 数据库里边更改流程按钮的顺序<br> bpm_button流程按钮<br> 由字段button_order控制</p> 
<p>getProcessTaskParameter(formId);<br> ---<br> ||||||||||||||||||||||||||||||||||||||||||||||<br> 流程引擎入口<br> processEngine<br> ---<br> 组织机构适配器<br> OrganAdapter比如取所有的用户，或者通过用户id取对象；<br> |||||||||||||||||||||||||||||||||||||||||||<br> 流程发布主表 bpm_deployment<br> 流程发布子表 bpm_deployprop<br> 流程大字段 表：bpm_lob</p> 
<p>流程表单权限配置表： bpm_ext_form_securior</p> 
<p>bpm_ext_task_attribute t where t.pd_id='';流程定义id可以把废的流程从表里删掉<br> bpm_form 流程表单</p> 
<p>bpm_hist_procinst t 流程实例表<br> bpm_hist_task  流程代办表</p> 
<p>---<br> bpm_track  流程跟踪表   流程实例id：hprocl_  select * from bpm_track t where t.hprocl_='20143233';</p> 
<p><br> ---------------------<br> 如果只是单线流程<br> 只有一个流程实例id一个executeId;<br> --------------------<br> 如果有分支的话，有一个流程实例id,多个executeId;<br> ------------------------<br> 保存表单<br> 固定js写法<br> window.saveFormData = function(processInstanceId,executionId){}<br> ------------------------------------<br> dataType的onDataChange事件里边<br> switch(arg.property){<!-- --><br>  case "ISSUE_RANGE":<br>  var id = arg.newValue;<br>  if($dialogFlag =="PubEdit"){<!-- --><br>   //通过手写回传值<br>  view.id($subDataName).getCurrentItem().set("issueRange",id)<br>  }else{<!-- --><br>  //通过手写回传值<br>  view.id($subDataName).getCurrentItem().set("ISSUE_RANGE",id)<br>  }<br>  break;<br>  case "ISSUE_RANGE_NAME":<br>  var deptName = arg.newValue;<br>   if($dialogFlag =="PubEdit"){<!-- --><br>    //通过手写回传值<br>   view.id($subDataName).getCurrentItem().set("issueRangeName",deptName)<br>   }else{<!-- --><br>   //通过手写回传值<br>   view.id($subDataName).getCurrentItem().set("ISSUE_RANGE_NAME",deptName) <br>   }<br>  break;<br> }<br> -----------------<br> js处理日期<br> var date = new Date(); </p> 
<p>2 date.formatDate("Y-m-d");   // 返回类似"2000-09-25"的字符串 </p> 
<p>3 date.formatDate("H:i:s");   // 返回类似"23:10:30"的字符串 </p> 
<p>4 date.formatDate("Y年m月d日 H点i分s秒");   // 返回类似"2000年09月25日 23点10分30秒"的字符串 </p> 
<p>var dateFrom =review_Date.formatDate("Y-m-d 00:00:00");<br> var dateTo =review_Date.formatDate("Y-m-d 23:59:59");<br> dbm文件的日期格式必须是TIMESTAMP-DateTime否则查不出来</p> 
<p>parameter.set("P_REVIEW_DATE_From",dateFrom);<br> parameter.set("P_REVIEW_DATE_To",dateTo);<br> -----------------------<br> 流程详细页，启动按钮打开详细页方法<br> top.addTab("人生若只如初见",encodeURI("${web.contextPath}/"+taskUrl+""),"dorado/client/skins/~current/common/icons.gif","taskTodo"," -0px -120px");<br> 替换//parent.window.location.replace(getPath()+"/"+taskUrl);<br> ----------------------------------------------<br> 现在生产的模块实现类里边会报红<br> 1SysLogUtil<br> import avicit.platform6.modules.system.syslog.service.SysLogUtil;<br> 把上面的替换成下面的这个<br> import avicit.platform6.core.api.system.syslog.service.SysLogUtil;<br> -------------------------<br> /**<br>  * Date转String<br>  * @param {Object} date<br>  */<br> date2Str =  function(date){<!-- --><br>  if (date != null) {<!-- --><br>   var newDate = new Date();<br>   newDate.setTime(date);<br>   var year = newDate.getFullYear();<br>   var month = newDate.getMonth() &lt; 9 ? "0" + (newDate.getMonth() + 1) : (newDate.getMonth() + 1);<br>   var day = newDate.getDate() &lt; 9 ? "0" + newDate.getDate() : newDate.getDate();<br>   var dateStr = year + "-" + month + "-" + day;<br>   return dateStr;<br>  }else{<!-- --><br>   return "";<br>  }<br> }<br> ---------------------------------------<br> /**<br>   * 获取当前登录用户所在部门id以及用户id<br>   */<br>  @Expose<br>  public String getCurrentDeptId(){<!-- --><br>   String name = SessionHelper.getLoginSysUser().getName();<br>   String id = SessionHelper.getLoginSysUser().getId();<br>   return SessionHelper.getCurrentDeptId()+","+SessionHelper.getCurrentDeptTl().getDeptName();<br>  }<br> -----dorodo获取当前登陆用户id当前登录人id<br>  var currentUser = '${session.getAttribute('userId')}';<br> ----=dorado获取部门id <br>  var currentDeptId = '${session.getAttribute('CURRENT_DEPT').getId()}';<br>  --------------------------getSecretLevel<br>  var currentUser = '${session.getAttribute('CURRENT_LOGINUSER').getId()}';<br>  var currentUser = '${session.getAttribute('CURRENT_LOGINUSER').getSecretLevel()}';<br>  //$deptId='${session.getAttribute('CURRENT_DEPT').getId()}';<br> //$secretLevel='${session.getAttribute('CURRENT_LOGINUSER').getSecretLevel()}';<br> ---------------------------------------------------------------------------<br>  <br>  一：在数据的添加时一般注意的方法<br> 在主从表中的添加方法中，在datapilot中的onSubControlAction(self.arg)中的代码是:<br>  var code = arg.code;<br>    <br>    switch(code){<!-- --><br>      case "+":<br>      //得到主表的数据集对象<br>      var dataset = this.get("#dataSetMainSubAddForm");<br>      <br>      //得到主表的数据集<br>      var ds = dataset.getData("#");<br>      <br>      //根据主表的数据集得到其中的那个reference对应的数据集<br>      var subdataset = ds.get("ocmStraPlanMainChild");<br>      <br>      //根据得到的数据集向其中插入一条对象，注意的是：这里的deptId不是数据库中的字段，而是实体类的属性<br>      subdataset.insert({deptId:currentDept.get("id")});<br>      <br>      //防止系统自动的添加一行<br>      arg.processDefault = false;<br>      break;<br>    }<br> -------------------------------------------------<br> <a target="_blank" href="http://blog.csdn.net/q326527970/article/details/6966317" rel="noopener noreferrer">http://blog.csdn.net/q326527970/article/details/6966317</a><br> <a target="_blank" href="http://blog.csdn.net/q326527970/article/category/928276" rel="noopener noreferrer">http://blog.csdn.net/q326527970/article/category/928276</a><br> <a target="_blank" href="http://wiki.bsdn.org/pages/viewpage.action?pageId=9176117" rel="nofollow noopener noreferrer">http://wiki.bsdn.org/pages/viewpage.action?pageId=9176117</a><br> <a target="_blank" href="http://wiki.bsdn.org/pages/viewpage.action?pageId=3670442" rel="nofollow noopener noreferrer">http://wiki.bsdn.org/pages/viewpage.action?pageId=3670442</a><br> var dsBranch = this.id("dsBranch");var branch = dsBranch.getData("#");//获取当前的分公司实体对象var dept = dsBranch.getData("#.#.dept");//获取当前分公司的当前部门实体对象var employee = dsBranch.getData("#.#dept.#employee");//获取当前分公司的当前部门的当前员工实体对象 <br> ------------------------------<br> var parameter = view.get("#queryForm.entity");<br> var actCode = parameter.get("actCode");<br> ---------------table 列上的onGetCellEditor事件置空列值<br> arg.data.set("ISSUE_RANGE_NAME",'')<br> arg.data.set("ISSUE_RANGE",'')<br> --------------table列上onRenderCell 上语法dom对象<br> arg.dom.innerHTML="";<br> ------------查询处理日期<br> var dateFrom = view.get("#dataSetQuery").getData("#").get("P_CHECK_DATE_FROM");<br> var dateTo = view.get("#dataSetQuery").getData("#").get("P_CHECK_DATE_TO");<br> //将查询区审核开始时间设置为当天最小时间--审核结束时间设置为最大时间<br> if(typeof(dateFrom)!='undefined'){<!-- --><br> dateFrom = dateFrom.formatDate("Y-m-d 00:00:00")<br> view.get("#dataSetQuery").getData("#").set("P_CHECK_DATE_FROM",dateFrom)<br> }<br> if(typeof(dateTo)!='undefined'){<!-- --><br> dateTo = dateTo.formatDate("Y-m-d 23:59:59")<br> view.get("#dataSetQuery").getData("#").set("P_CHECK_DATE_TO",dateTo)<br> }<br> var parameter = view.get("#queryForm.entity");<br> view.get("#dataSetMcjBusinessInfo").set("parameter",parameter).flushAsync();</p> 
<p>--------------------------------<br> form中的Link<br> href:javascript:window.showMainFileUpload("QUALITY_MANAGE_FILE")<br> ------------------------------</p> 
<p>///控制列表只能单选 begin 2013-07-07 DingRui/<br> var dataGrid = view.get("#MainData");<br> var selections = dataGrid.get("selection"); <br> if (selections.length == 0) {<!-- --><br>  dorado.MessageBox.alert("请选择记录");<br>  return "false";<br> }<br> if (selections.length &gt; 1) {<!-- --><br>  dorado.MessageBox.alert("只允许选择一条数据记录!");<br>  return "false";<br> }<br> ///控制列表只能单选 end/<br> parseInt($secretLevel);<br> planDate.substring(0,4)</p> 
<p>var date = new Date();<br> var Y=date.getFullYear();<br> var M=(date.getMonth())+1;<br> var D=date.getDate();<br> ----------------table 行背景颜色-----------------<br> //反馈时间<br> var factFinishDate =  arg.data.get("FACT_FINISH_DATE");<br> //里程碑时间<br> var planDate =  arg.data.get("PLAN_DATE");<br> //当前系统时间<br> var date = new Date();<br> var Y=date.getFullYear();<br> var M=(date.getMonth())+1;<br> var D=date.getDate();<br> //里程碑年\月\日<br> planDateY = planDate.formatDate("Y-m-d").substring(0,4);//2012-12-09<br> planDateM = planDate.formatDate("Y-m-d").substring(5,7);<br> planDateD = planDate.formatDate("Y-m-d").substring(8,10);</p> 
<p>//反馈时间<br> var factFinishDate =  arg.data.get("FACT_FINISH_DATE");<br> //里程碑时间<br> var planDate =  arg.data.get("PLAN_DATE");<br> //当前系统时间<br> var date = new Date();<br> var date1=     date.formatDate("Y-m-d");<br> var date2 =  date1.replace(/-/g,"/");<br> var toDate = new Date(date2);<br> var planDate1= planDate.formatDate("Y-m-d");<br> var planDate2=  planDate1.replace(/-/g,"/");<br> var toPlan = new Date(planDate2);<br> if(factFinishDate != null &amp;&amp; factFinishDate !=""){ <br> var factFinishDate1= factFinishDate.formatDate("Y-m-d");<br> var finishDate2=  factFinishDate1.replace(/-/g,"/");<br> var toFinish= new Date(finishDate2);<br>        if(toFinish.getTime()&gt;toPlan.getTime()){<!-- --><br>      arg.dom.style.background = "#FFFF00";//黄色<br>     }else{<!-- --><br>      arg.dom.style.background = "#00B050";//绿色<br>     }<br> }else{<!-- --><br>  if(toDate.getTime()&gt;toPlan.getTime()){<!-- --><br>   arg.dom.style.background = "#FF0000";//红色<br>  }else{<!-- --><br>   arg.dom.style.background = "#000798";//蓝色<br>  }<br> }<br> //alert(toFinish.getTime());<br> --------------------------------------------------------------------------<br> /**<br>  * 随机生成32位字符串<br>  */<br> $getRandomString = function(){<!-- --><br>    len = 32;<br>     var $chars = '0123456789abcdefhijkmnprstwxyz'; // 默认去掉了容易混淆的字符oOLl,9gq,Vv,Uu,I1<br>     var maxPos = $chars.length;<br>     var pwd = '';<br>     for (i = 0; i &lt; len; i++) {<!-- --><br>         pwd += $chars.charAt(Math.floor(Math.random() * maxPos));<br>     }<br>     return pwd;<br> }<br> ----------------------------------<br> //在保存按钮的事件里边调用检验中文长度的校验<br> ///获得中文字符长度 begin 2013-07-01 DingRui//<br> String.prototype.getBytes = function(){<!-- --><br>     var cArr = this.match(/[^\x00-\xff]/ig);<br>     return this.length + (cArr == null ? 0 : cArr.length);<br> }<br> ///获得中文字符长度 end//</p> 
<p>///校验字段的长度 begin 2013-07-01 DingRui//<br> //在dataType的字段上，添加自定义效验，<br> lengthValidate = function(fields, describe, length){<!-- --><br>  var flag = true;<br>  var data = view.get("#dataSetOcmKpiWrite.data:#");<br>  var field = data.get(fields);<br>  if(field != null){<!-- --><br>   if(field.getBytes() &gt; length){<!-- --><br>    dorado.MessageBox.alert("【" + describe + "】文本内容过多，长度应小于" + length + "个字符！");<br>    flag = false;<br>   }<br>  }<br>  return flag;<br> }<br> ///校验字段的长度 end//<br> 例子：if(describe != null){<!-- --><br>  if(describe.getBytes() &gt; 1000){<!-- --><br>   dorado.MessageBox.alert("【描述】文本内容过多，长度应小于1000个字符！");<br>   return;<br>  }<br> }<br> 金额格式 displayFormat:#,##0.00<br> ///<br>  var adata = arg.data;<br>  var id = adata.get("ID");<br>  var data = view.get("#dataSetFeedBack.data").first(); <br>  var count = 0;<br>  while(data!=null){<!-- --><br>   var fid = data.get("MCJ_PRODUCT_INFO_ID");<br>   if(fid==id){<!-- --><br>    count++;<br>   }<br>   data = view.get("#dataSetFeedBack.data").next();<br>  }<br>  if(count&gt;0){<!-- --><br>   var javaScript ="javascript:showFeedInfo('"+arg.data.get("ID")+"','"+arg.data.get("PRODUCT_NAME")+"')" ;<br>   arg.dom.innerHTML="&lt;a href = # onclick ="+javaScript+"&gt;编辑&lt;/a&gt;"<br>  }else{<!-- --><br>   var javaScript ="javascript:showFeedInfo('"+arg.data.get("ID")+"','"+arg.data.get("PRODUCT_NAME")+"')" ;<br>   arg.dom.innerHTML="&lt;a href = # onclick ="+javaScript+"&gt;填写&lt;/a&gt;"<br>  }<br> -----------------------------------------------------------------<br> view 的onCreate事件中调用后台<br> $importDocByArmyDemand= function(){<!-- --><br>  //获取查询区数据<br>   var data =  view.get("#dataSetQuery").getData("#");<br>   var unitName = typeof(data.get("P_UNIT_NAME")) == 'undefined' ? "" : data.get("P_UNIT_NAME") ;<br>   var manageDept = typeof(data.get("P_MANAGE_DEPT")) == 'undefined'? "" : data.get("P_MANAGE_DEPT") ;<br>   var hrDeptName = typeof(data.get("P_HR_DEPT_NAME")) == 'undefined' ? "" : data.get("P_HR_DEPT_NAME") ;<br>   var unitType = typeof(data.get("P_UNIT_TYPE")) == 'undefined'? "" : data.get("P_UNIT_TYPE") ;<br>   var provinceCode = typeof(data.get("P_PROVINCE_CODE")) == 'undefined'? "" : data.get("P_PROVINCE_CODE") ;<br>   var dataParas = "unitName="+unitName+"&amp;manageDept="+manageDept+"&amp;hrDeptName="+hrDeptName+ "&amp;unitType="+unitType+"&amp;provinceCode="+provinceCode;<br>   dorado.MessageBox.confirm('确认生成军用单位名录编制？',function(){<!-- --><br>    var urls = '${web.contextPath}/platform/mcj/mcjarmyinfoword/mcjArmyInfoExpWord?'+ encodeURI(dataParas);<br>       window.open(urls,"_self");<br>   });<br> }</p> 
<p>------------------------------------------------------------------------------<br> ---view全选然后将对象放入数组中<br> !function(){<!-- --><br>  var uploadAction = view.get('#uaUpload2');<br>  var selections = view.get('#dgFiles.selection');</p> 
<p> if(!selections || selections.length == 0){<!-- --><br>   return;<br>  }<br>  if(!selections.length){<!-- --><br>   selections = [selections];<br>  }</p> 
<p> var selectionCopy = [];<br>  for (var i = 0; i &lt; selections.length; i++) {<!-- --><br>   selectionCopy.push(selections[i]);<br>  }<br>     <br>  for(var i=0;i&lt;selectionCopy.length;i++){<!-- --><br>   var entity = selectionCopy[i];<br>   if(entity){<!-- --><br>    uploadAction.removeFile(entity.get('id'));<br>    entity.remove();<br>   }<br>  }<br> };<br> ----------------------------------------------<br> 获取dataset对应的查询form表单的值<br> var entityList = this.id("dataSetOmsMonthReportGrid").queryData ();<br> --------------------------------------------<br> dataTyp中只有id的时候，还有一种方式显示name页不用写视图<br> 引入一个虚拟字段.reference，设置属性：dataProvider:类#方法<br> parameter：$${this.BUSINESS_TYPE}<br> -0-------------------------<br> 给文本框赋值<br> this.get("#TextEditor_Id").doSetText("我的全部");<br> 取值<br> this.get("#TextEditor_Id.value")<br> ---------------------<br> ------------------------===<br> 文本框的Map属性加通用代码，trigger属性设置属性<br> 给文本框加一个下拉列表，在属性上绑定trigger/然后在TextEditor的属性onAttributeChange中写入下面代码<br> 实现树动态扩展层次。(dataTreeGrid控件的层次扩展)<br> var treeGird = this.id("weaveOmsPlanOperateTreeGrid");</p> 
<p>switch (this.get("#treeExpendText.value")) {<!-- --><br>     case "1":<br>         treeGird.get("bindingConfigs")[0].expandLevel = 1;<br>         this.id("dataSetOmsPlanOperateGridV").flush();<br>         break;<br>     case "2":<br>         treeGird.get("bindingConfigs")[0].expandLevel = 2;<br>         this.id("dataSetOmsPlanOperateGridV").flush();<br>         break;<br>     case "3":<br>         treeGird.get("bindingConfigs")[0].expandLevel = 3;<br>         this.id("dataSetOmsPlanOperateGridV").flush();<br>         break;<br>     case "4":<br>         treeGird.get("bindingConfigs")[0].expandLevel = 4;<br>         this.id("dataSetOmsPlanOperateGridV").flush();<br>         break;<br>     case "5":<br>         treeGird.get("bindingConfigs")[0].expandLevel = 5;<br>         this.id("dataSetOmsPlanOperateGridV").flush();<br>         break;<br> }<br> ------------------------------------------------------------<br> 给树节点添加图表<br> 在dataTreeGrid的属性onRenderNode事件里边写下面代码<br> var node = arg.node,data = node.get("data");</p> 
<p>if (data.get("planType") == '1') {<!-- --><br>     $(arg.dom).empty().xCreate([{<!-- --><br>         tagName: "IMG",<br>         src: $url("&gt;images/wbs.gif"),<br>         style: "left: 4px;top: 4px"<br>     },{<!-- --><br>         tagName: "SPAN",<br>         contentText: node.get("label")<br>     }]);<br> }<br> if (data.get("planType") == '2') {<!-- --><br>     $(arg.dom).empty().xCreate([{<!-- --><br>         tagName: "IMG",<br>         src: $url("&gt;images/task.gif"),<br>         style: "left: 4px;top: 4px"<br>     },{<!-- --><br>         tagName: "SPAN",<br>         contentText: node.get("label")<br>     }]);<br> }</p> 
<p>if (data.get("planType") == 'PRO') {<!-- --><br>     $(arg.dom).empty().xCreate([{<!-- --><br>         tagName: "IMG",<br>         src: $url("&gt;images/pro.gif"),<br>         style: "left: 4px;top: 4px"<br>     },{<!-- --><br>         tagName: "SPAN",<br>         contentText: node.get("label")<br>     }]);<br> }<br> -----------------------------------------------<br> 当前树，判断满足逻辑条件后的节点显示显影<br> ///<br> var treeGrid = this.id("weaveOmsPlanOperateTreeGrid");<br> //获去项目信息节点实例<br> var firstNode = treeGrid.get("firstNode");<br> var firstEntity = firstNode.get("data");</p> 
<p>var fbUserId = firstEntity.get("puid");//项目信息节点发布范围人员userIds<br> var projPrincipal = firstEntity.get("projPrincipal"); //项目信息节点项目主管<br> var hrDeptId = arg.data.get("hrDeptId");//当前树节点部门id</p> 
<p>if(arg.data.get("planName")!=undefined){<!-- --><br>  //当前节点不为根节点时<br> if(arg.data.get("id")!=firstEntity.get("id")){<!-- --><br>  //当前用户 不为 项目信息项目主管 <br> if(projPrincipal!=$currentUserId){<!-- --><br>  //当前登录人部门与经营计划节点责任部门不一致时<br>  if($currentDeptId!=hrDeptId){<!-- --><br>   //当前登录人不在项目信息节点的发布范围内<br>   fbUserId=","+fbUserId+",";<br>   var curUserId = ","+$currentUserId+",";<br>   if(fbUserId.indexOf(curUserId)==-1){<!-- --><br>    var currentNodes = 0;<br>    var currentParents = 0; <br>    var childCommand = view.get("#selectActionChildIsYz");<br>    childCommand.set("parameter",{nodeId:arg.data.get("id")}).execute(function(result){<!-- --><br>     currentNodes = result;<br>    });<br>    var selectParentNodesMatchHrDeptId = view.get("#selectParentNodesMatchHrDeptId");<br>    selectParentNodesMatchHrDeptId.set("parameter",{id:arg.data.get("id"),hrDeptId:hrDeptId}).execute(function(result){<!-- --><br>     currentParents = result ;<br>    });<br>    //alert("currentNodes="+currentNodes+"currentParents="+currentParents);<br>    if(currentNodes !=1 &amp;&amp; (currentParents==0 || currentParents==null)){<!-- --><br>      //删除当前节点<br>      arg.node.remove(); <br>    }<br>    <br>   }<br>  }<br>  }<br> }<br> }</p> 
<p>-----------------------------------------------------------------------------------------------<br> 根据条件动态的给树节点显示复选框，树的onDataNodeCreate事件中<br> if (arg.data.get("planStatus")=="1" &amp;&amp; arg.data.get("planStatus")!="9"){<!-- --><br>    arg.node.set("checkable",true);<br>  } </p> 
<p>if (arg.data.get("planStatus")=="9" &amp;&amp; arg.data.get("parentId")=='ROOT' &amp;&amp; arg.data.get("planType")=='PRO'){<!-- --><br>  var action = view.get("#issueCountAction");<br>  var id = arg.data.get("id");<br>      action.set('parameter',{'id':id}).execute(function(result){<!-- --><br>   if (result !=1 ){<!-- --><br>    arg.node.set("checkable",true);<br>   }<br>  })<br> }<br> ----------------------------------------<br> 在dataTreeGrid的事件onNodeCheckedChange</p> 
<p>var treeGrid = view.get("#omsPlanOperateTreeGridSendAuditing");<br>  var currentNode = treeGrid.get("currentNode");<br> //当前数据的父节点<br>  var checkable = currentNode.get("checkable");<br>  if (checkable==true){<!-- --><br>   if  (currentNode.get("checked")==true){<!-- --><br>                $checkchild(currentNode);<br>         }else{<!-- --><br>       $uncheckchild(currentNode);<br>   }<br>  }</p> 
<p>/**<br>  * 选中所有的子节点<br>  * @param {Object} treeGrid<br>  */<br> $checkchild = function(currentNode){<!-- --><br>  // 判断是否存在复选框<br>   currentNode.set("checked",true);<br>   var hasChildIs = currentNode.get("hasChild")<br>       if (hasChildIs==true) {<!-- --><br>           currentNode.expand();<br>           var nodes = currentNode.get("nodes");<br>           var curNode;<br>           if (nodes != null) {<!-- --><br>               var iter = nodes.iterator();<br>               while (iter.hasNext()) {<!-- --><br>                   curNode = iter.next();<br>        var checkable = curNode.get("checkable");<br>         if (checkable==true){<!-- --><br>             curNode.set("checked",true);<br>         }<br>                   $checkchild(curNode);<br>               }        <br>       } <br>        }    <br> }<br> ---<br> /**<br>  * 不选中所有的子节点<br>  * @param {Object} treeGrid<br>  */<br> $uncheckchild = function(currentNode){<!-- --><br>  // 判断是否存在复选框<br>   currentNode.set("checked",false);<br>   var hasChildIs = currentNode.get("hasChild")<br>       if (hasChildIs==true) {<!-- --><br>           currentNode.expand();<br>           var nodes = currentNode.get("nodes");<br>           var curNode;<br>           if (nodes != null) {<!-- --><br>               var iter = nodes.iterator();<br>               while (iter.hasNext()) {<!-- --><br>                   curNode = iter.next();<br>       var checkable = curNode.get("checkable");<br>        if (checkable==true){<!-- --><br>          curNode.set("checked",false);<br>        }<br>                   $uncheckchild(curNode);<br>               }        <br>       } <br>        }    <br> }<br> --------------------------------------------------------------------</p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p><br>  </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8318940d757170a22c360f05163b68da/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数电考试前粗糙复习</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8c3cdef082ca84f0df6dd8dec32a9ee1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux shell 用sed命令在文本的行尾或行首添加字符</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>