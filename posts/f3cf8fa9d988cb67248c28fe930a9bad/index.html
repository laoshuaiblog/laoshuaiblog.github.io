<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Modbus协议介绍及Modbus TCP - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/f3cf8fa9d988cb67248c28fe930a9bad/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="Modbus协议介绍及Modbus TCP">
  <meta property="og:description" content="这里写目录标题 一、Modbus起源1.起源2.分类3.优势4.应用场景5.ModbusTCP特点⭐⭐⭐ 二、Modbus TCP协议格式1.报文头2.寄存器3.功能码4.协议包书写模板总结 一、Modbus起源 1.起源 Modbus由Modicon公司于1979年开发，是一种工业现场总线协议标准。
Modbus通信协议具有多个变种，其中有支持串口，以太网多个版本，其中最著名的是Modbus RTU、Modbus ASCII和Modbus TCP三种
其中Modbus TCP是在施耐德收购Modicon后1997年发布的。
2.分类 1）Modbus RTU
运行在串口上的协议，采用二进制的表现形式以及紧凑型数据结构，通信效率高，应用比较广泛
2）Modbus ASCII
运行在串口上的协议，采用ASCII码进行传输，并且利用特殊字符作为字节开始和结束的标志，传输效率远远低于Modbus RTU ，只有通信数据量比较少时才会考虑它
3）Modbus TCP
运行在以太网上的协议
3.优势 免费、简单、容易使用
4.应用场景 Modbus协议是现在国内工业领域应用最多的协议，不只PLC设备，各种终端设备，比如水控机、水表、电表、工业秤、各种采集设备
5.ModbusTCP特点⭐⭐⭐ 1）采用主从问答方式通信
2）Modbus TCP协议属于应用层协议，基于传输层TCP进行传输
3）Modbus TCP默认端口号502
二、Modbus TCP协议格式 ModbusTcp协议包含三部分：报文头、功能码、数据
Modbus TCP/IP协议最大数据帧长度为260字节
1.报文头 包含7个字节，分别是：
2.寄存器 寄存器分类：线圈、离散量输入、保持寄存器、输入寄存器
1）离散量和线圈 其实就是位寄存器（每个寄存器数据占1字节），工业上主要用于控制IO设备。 线圈寄存器，类比为开关量，每一个bit都对应一个信号的开关状态。所以一个byte就可以同时控制8路的信号。比如控制外部8路io的高低。 线圈寄存器支持读也支持写，写在功能码里面又分为写单个线圈寄存器和写多个线圈寄存器。
对应上面的功能码也就是：0x01 0x05 0x0f离散输入寄存器，离散输入寄存器就相当于线圈寄存器的只读模式，他也是每个bit表示一个开关量，而他的开关量只能读取输入的开关信号，是不能够写的。比如我读取外部按键的按下还是松开。
所以功能码也简单就一个读的 0x02 2）输入和保持寄存器是字寄存器（每个寄存器数据占2个字节），工业上主要用于存储工业设备的值。 保持寄存器，这个寄存器的单位不再是bit而是两个byte，也就是可以存放具体的数据量的，并且是可读写的。比如我我设置时间年月日，不但可以写也可以读出来现在的时间。写也分为单个写和多个写
所以功能码有对应的三个：0x03 0x06 0x10输入寄存器，这个和保持寄存器类似，但是也是只支持读而不能写。一个寄存器也是占据两个byte的空间。类比我我通过读取输入寄存器获取现在的AD采集值
对应的功能码也就一个 0x04 📢线圈寄存和保持寄存器是可读可写的，离散输入寄存器和输入寄存器只能读不可写。
3.功能码 4.协议包书写模板总结 读操作
主机-&amp;gt;从机：
报文头(7字节) &#43; 功能码(1字节) &#43; 起始地址(2字节) &#43; 数量(2字节)">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-12T21:00:49+08:00">
    <meta property="article:modified_time" content="2023-09-12T21:00:49+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Modbus协议介绍及Modbus TCP</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>这里写目录标题</h4> 
 <ul><li><a href="#Modbus_2" rel="nofollow">一、Modbus起源</a></li><li><ul><li><a href="#1_3" rel="nofollow">1.起源</a></li><li><a href="#2_7" rel="nofollow">2.分类</a></li><li><a href="#3_14" rel="nofollow">3.优势</a></li><li><a href="#4_16" rel="nofollow">4.应用场景</a></li><li><a href="#5ModbusTCP_18" rel="nofollow">5.ModbusTCP特点⭐⭐⭐</a></li></ul> 
  </li><li><a href="#Modbus_TCP_22" rel="nofollow">二、Modbus TCP协议格式</a></li><li><ul><li><a href="#1_26" rel="nofollow">1.报文头</a></li><li><a href="#2_29" rel="nofollow">2.寄存器</a></li><li><a href="#3_43" rel="nofollow">3.功能码</a></li><li><a href="#4_45" rel="nofollow">4.协议包书写模板总结</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="Modbus_2"></a>一、Modbus起源</h2> 
<h3><a id="1_3"></a>1.起源</h3> 
<p>Modbus由Modicon公司于1979年开发，是一种工业现场总线协议标准。<br> Modbus通信协议具有多个变种，其中有支持串口，以太网多个版本，其中最著名的是<strong>Modbus RTU</strong>、<strong>Modbus ASCII</strong>和<strong>Modbus TCP</strong>三种<br> 其中Modbus TCP是在施耐德收购Modicon后1997年发布的。</p> 
<h3><a id="2_7"></a>2.分类</h3> 
<p>1）Modbus RTU<br> 运行在<mark>串口</mark>上的协议，采用<mark>二进制</mark>的表现形式以及<mark>紧凑型数据结构</mark>，<mark>通信效率高</mark>，应用比较<mark>广泛</mark><br> 2）Modbus ASCII<br> 运行在<mark>串口</mark>上的协议，采用<mark>ASCII码</mark>进行传输，并且<mark>利用特殊字符作为字节开始和结束的标志</mark>，<mark>传输效率远远低于Modbus RTU</mark> ，只有通信数据量比较少时才会考虑它<br> 3）Modbus TCP<br> 运行在以太网上的协议</p> 
<h3><a id="3_14"></a>3.优势</h3> 
<p>免费、简单、容易使用</p> 
<h3><a id="4_16"></a>4.应用场景</h3> 
<p>Modbus协议是现在国内工业领域应用最多的协议，不只PLC设备，各种终端设备，比如水控机、水表、电表、工业秤、各种采集设备</p> 
<h3><a id="5ModbusTCP_18"></a>5.ModbusTCP特点⭐⭐⭐</h3> 
<p>1）采用<mark>主从问答方式</mark>通信<br> 2）Modbus TCP协议<mark>属于应用层协议</mark>，基于传输层<mark>TCP</mark>进行传输<br> 3）Modbus TCP<mark>默认端口号<strong>502</strong></mark></p> 
<h2><a id="Modbus_TCP_22"></a>二、Modbus TCP协议格式</h2> 
<p>ModbusTcp协议包含三部分：报文头、功能码、数据<br> <img src="https://images2.imgbox.com/f9/21/ACko31pP_o.png" alt="在这里插入图片描述"><br> Modbus TCP/IP协议最大数据帧长度为260字节</p> 
<h3><a id="1_26"></a>1.报文头</h3> 
<p>包含7个字节，分别是：<br> <img src="https://images2.imgbox.com/de/fd/y06BvxUg_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_29"></a>2.寄存器</h3> 
<p>寄存器分类：<strong>线圈</strong>、<strong>离散量输入</strong>、<strong>保持寄存器</strong>、<strong>输入寄存器</strong></p> 
<ul><li>1）离散量和线圈 其实就是位寄存器（每个寄存器数据占1字节），工业上主要用于控制IO设备。 
  <ul><li><em><strong>线圈寄存器</strong></em>，类比为开关量，每一个bit都对应一个信号的开关状态。所以一个byte就可以同时控制8路的信号。比如控制外部8路io的高低。 线圈寄存器<code>支持读也支持写</code>，写在功能码里面又分为写单个线圈寄存器和写多个线圈寄存器。<br> 对应上面的功能码也就是：0x01 0x05 0x0f</li><li><em><strong>离散输入寄存器</strong></em>，离散输入寄存器就相当于线圈寄存器的只读模式，他也是每个bit表示一个开关量，而他的开关量只能读取输入的开关信号，是<code>不能够写</code>的。比如我读取外部按键的按下还是松开。<br> 所以功能码也简单就一个读的 0x02</li></ul> </li><li>2）输入和保持寄存器是字寄存器（每个寄存器数据占2个字节），工业上主要用于存储工业设备的值。 
  <ul><li><em><strong>保持寄存器</strong></em>，这个寄存器的单位不再是bit而是两个byte，也就是可以存放具体的数据量的，并且是<code>可读写</code>的。比如我我设置时间年月日，不但可以写也可以读出来现在的时间。写也分为单个写和多个写<br> 所以功能码有对应的三个：0x03 0x06 0x10</li><li><em><strong>输入寄存器</strong></em>，这个和保持寄存器类似，但是也是<code>只支持读而不能写</code>。一个寄存器也是占据两个byte的空间。类比我我通过读取输入寄存器获取现在的AD采集值<br> 对应的功能码也就一个 0x04</li></ul> </li></ul> 
<p>📢线圈寄存和保持寄存器是可读可写的，离散输入寄存器和输入寄存器只能读不可写。</p> 
<h3><a id="3_43"></a>3.功能码</h3> 
<p><img src="https://images2.imgbox.com/e8/53/sZ7HrQyP_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_45"></a>4.协议包书写模板总结</h3> 
<ul><li> <p>读操作</p> 
  <ul><li> <p>主机-&gt;从机：<br> <strong>报文头(7字节) + <mark>功能码</mark>(1字节) + <mark>起始地址</mark>(2字节) + 数量(2字节)</strong></p> </li><li> <p>从机-&gt;主机：<br> <strong>报文头(7字节) + <mark>功能码</mark>(1字节) + <mark>字节计数</mark>(1字节) + 数据（n字节）</strong></p> </li></ul> </li><li> <p>写单个</p> 
  <ul><li>主机-&gt;从机：<br> <strong>报文头(7字节) + <mark>功能码</mark>(1字节) + <mark>地址</mark>(2字节) + <mark>数据/断通标志</mark>(2字节)</strong><br> 断通标志：0xff 00（开） 0x00 00（关）</li><li>从机-&gt;主机：<br> 原文返回</li></ul> </li><li> <p>写多个：</p> 
  <ul><li>主机-&gt;从机：<br> <strong>报文头(7字节) + <mark>功能码</mark>(1字节) + <mark>起始地址</mark>(2字节) + <mark>数量</mark>(2字节，线圈数/寄存器数) + <mark>字节计数</mark>(1字节) + == 数据==（n字节）</strong></li><li>从机-&gt;主机：<br> <strong>报文头(7字节) + <mark>功能码</mark>(1字节) + <mark>起始地址</mark>(2字节) + <mark>数量</mark>(2字节，线圈数/寄存器数)</strong></li></ul> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3d0271e87b2585b3208ce43131082f44/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android | ADB 命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f0cd03f308767e01e74960eb1e64daf0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java项目开发：基于spark的新闻推荐系统的设计与实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>