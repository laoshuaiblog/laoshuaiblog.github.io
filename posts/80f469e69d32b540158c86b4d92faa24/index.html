<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>centos7上安装redis - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/80f469e69d32b540158c86b4d92faa24/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="centos7上安装redis">
  <meta property="og:description" content="一、直接单机版安装 1、Redis是基于C语言编写的，因此首先需要安装Redis所需要的gcc依赖
yum install -y gcc tcl 2、官网上下载依赖包来安装，官网地址
直接官网上下载，上传到服务器上，下载地址
直接使用wget的方式下载
wget https://shuiping.oss-cn-shenzhen.aliyuncs.com/redis-6.2.6.tar.gz 3、把文件放在/usr/local/src目录下
4、解压文件
tar -xzf redis-6.2.6.tar.gz 5、进入解压后的文件夹下，编译安装
make &amp;amp;&amp;amp; make install 6、默认的安装路径是在 /usr/local/bin目录下
redis-cli：是redis提供的命令行客户端redis-server：是redis的服务端启动脚本redis-sentinel：是redis的哨兵启动脚本 7、直接启动
./redis-server 8、进入redis-cli中查看版本号
[root@iZwz9et2qekjwu8mwmxgxhZ bin]# ./redis-cli 127.0.0.1:6379&amp;gt; info server # Server redis_version:6.2.6 redis_git_sha1:00000000 redis_git_dirty:0 redis_build_id:a90324d212372b79 redis_mode:standalone os:Linux 3.10.0-957.21.3.el7.x86_64 x86_64 arch_bits:64 multiplexing_api:epoll atomicvar_api:atomic-builtin gcc_version:4.8.5 process_id:27941 process_supervised:no run_id:156053feefd85fba87a4e027dc72fa8fbae4df95 tcp_port:6379 server_time_usec:1689563133774537 uptime_in_seconds:20 uptime_in_days:0 hz:10 configured_hz:10 lru_clock:11841533 executable:/usr/local/bin/./redis-server config_file: io_threads_active:0 127.0.0.1:6379&amp;gt; 9、使用配置文件启动，并且再后台启动，配置文件的路径/usr/local/src/redis-6.2.6下的redis.conf文件
10、先拷贝一份
cp redis.conf redis.conf.bck 11、然后修改redis.conf文件中的一些配置
# 允许访问的地址，默认是127.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-07-17T12:49:06+08:00">
    <meta property="article:modified_time" content="2023-07-17T12:49:06+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">centos7上安装redis</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="_0"></a>一、直接单机版安装</h4> 
<ul><li> <p>1、<code>Redis</code>是基于<code>C</code>语言编写的，因此首先需要安装<code>Redis</code>所需要的<code>gcc</code>依赖</p> <pre><code class="prism language-properties">yum install -y gcc tcl
</code></pre> </li><li> <p>2、官网上下载依赖包来安装，<a href="https://redis.io/" rel="nofollow">官网地址</a></p> 
  <ul><li> <p>直接官网上下载，上传到服务器上，<a href="https://redis.io/download/#redis-downloads" rel="nofollow">下载地址</a></p> </li><li> <p>直接使用<code>wget</code>的方式下载</p> <pre><code class="prism language-properties">wget https://shuiping.oss-cn-shenzhen.aliyuncs.com/redis-6.2.6.tar.gz
</code></pre> </li></ul> </li><li> <p>3、把文件放在<code>/usr/local/src</code>目录下</p> </li><li> <p>4、解压文件</p> <pre><code class="prism language-properties">tar -xzf redis-6.2.6.tar.gz
</code></pre> </li><li> <p>5、进入解压后的文件夹下，编译安装</p> <pre><code class="prism language-properties">make &amp;&amp; make install
</code></pre> </li><li> <p>6、默认的安装路径是在 <code>/usr/local/bin</code>目录下</p> 
  <ul><li><code>redis-cli</code>：是<code>redis</code>提供的命令行客户端</li><li><code>redis-server</code>：是<code>redis</code>的服务端启动脚本</li><li><code>redis-sentinel</code>：是<code>redis</code>的哨兵启动脚本</li></ul> </li><li> <p>7、直接启动</p> <pre><code class="prism language-properties">./redis-server
</code></pre> </li><li> <p>8、进入<code>redis-cli</code>中查看版本号</p> <pre><code class="prism language-properties">[root@iZwz9et2qekjwu8mwmxgxhZ bin]# ./redis-cli
127.0.0.1:6379&gt; info server
# Server
redis_version:6.2.6
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:a90324d212372b79
redis_mode:standalone
os:Linux 3.10.0-957.21.3.el7.x86_64 x86_64
arch_bits:64
multiplexing_api:epoll
atomicvar_api:atomic-builtin
gcc_version:4.8.5
process_id:27941
process_supervised:no
run_id:156053feefd85fba87a4e027dc72fa8fbae4df95
tcp_port:6379
server_time_usec:1689563133774537
uptime_in_seconds:20
uptime_in_days:0
hz:10
configured_hz:10
lru_clock:11841533
executable:/usr/local/bin/./redis-server
config_file:
io_threads_active:0
127.0.0.1:6379&gt; 
</code></pre> </li><li> <p>9、使用配置文件启动，并且再后台启动，配置文件的路径<code>/usr/local/src/redis-6.2.6</code>下的<code>redis.conf</code>文件</p> </li><li> <p>10、先拷贝一份</p> <pre><code class="prism language-properties">cp redis.conf redis.conf.bck
</code></pre> </li><li> <p>11、然后修改<code>redis.conf</code>文件中的一些配置</p> <pre><code class="prism language-properties"># 允许访问的地址，默认是127.0.0.1，会导致只能在本地访问。修改为0.0.0.0则可以在任意IP访问，生产环境不要设置为0.0.0.0
bind 0.0.0.0
# 守护进程，修改为yes后即可后台运行
daemonize yes 
# 密码，设置后访问Redis必须输入密码
requirepass 123456
</code></pre> <pre><code class="prism language-properties"># 监听的端口
port 6379
# 工作目录，默认是当前目录，也就是运行redis-server时的命令，日志、持久化等文件会保存在这个目录
dir .
# 数据库数量，设置为1，代表只使用1个库，默认有16个库，编号0~15
databases 1
# 设置redis能够使用的最大内存
maxmemory 512mb
# 日志文件，默认为空，不记录日志，可以指定日志文件名
logfile "redis.log"
</code></pre> </li><li> <p>12、进入目录下<code>/usr/local/src/redis-6.2.6</code></p> <pre><code class="prism language-properties">redis-server redis.conf
</code></pre> </li><li> <p>13、进入命令窗口</p> <pre><code class="prism language-properties">redis-cli
auth 123456
</code></pre> </li></ul> 
<h4><a id="_121"></a>二、设置开机启动</h4> 
<ul><li> <p>1、创建一个文件</p> <pre><code class="prism language-properties">vim /etc/systemd/system/redis.service
</code></pre> </li><li> <p>2、<code>/etc/systemd/system/redis.service</code>的文件内容</p> <pre><code class="prism language-properties">[Unit]
Description=redis-server
After=network.target

[Service]
Type=forking
ExecStart=/usr/local/bin/redis-server /usr/local/src/redis-6.2.6/redis.conf
PrivateTmp=true

[Install]
WantedBy=multi-user.target
</code></pre> </li><li> <p>3、重新加载配置服务</p> <pre><code class="prism language-properties">systemctl daemon-reload
</code></pre> </li><li> <p>4、常见命令</p> <pre><code class="prism language-properties"># 启动
systemctl start redis
# 停止
systemctl stop redis
# 重启
systemctl restart redis
# 查看状态
systemctl status redis
# 开始自启
systemctl enable redis
</code></pre> </li></ul> 
<h4><a id="docker_168"></a>三、使用<code>docker</code>安装</h4> 
<ul><li> <p>1、安装<code>docker</code></p> <pre><code class="prism language-properties">yum install docker
</code></pre> </li><li> <p>2、几个常见的命令</p> <pre><code class="prism language-properties">service docker start
service docker stop
service docker restart
</code></pre> </li><li> <p>3、下载文件</p> <pre><code class="prism language-properties">docker pull redis:6.0.10
</code></pre> </li><li> <p>4、本地创建一个配置文件<code>/root/redis/conf/redis.conf</code></p> <pre><code class="prism language-properties">bind 0.0.0.0
protected-mode yes
port 6379
tcp-backlog 511
timeout 0
tcp-keepalive 0
loglevel notice
logfile ""
databases 16
save 900 1
save 300 10
save 60 10000
stop-writes-on-bgsave-error yes
rdbcompression yes
rdbchecksum yes
dbfilename dump.rdb
dir ./
requirepass 123456
</code></pre> </li><li> <p>5、使用镜像创建容器</p> <pre><code class="prism language-properties">docker run -it -d --name redis -m 300m --net=host \
-v /root/redis/conf:/usr/local/etc/redis redis:6.0.10 \
redis-server /usr/local/etc/redis/redis.conf
</code></pre> </li><li> <p>6、进入容器中查看版本号及设置一个值,本地查看</p> <pre><code class="prism language-properties">docker  exec -it 8cf81a077db8 /bin/bash

</code></pre> </li></ul> 
<h4><a id="yum_226"></a>四、直接使用<code>yum</code>安装</h4> 
<ul><li>1、<a href="https://www.cnblogs.com/rslai/p/8249812.html" rel="nofollow">参考文档</a></li></ul> 
<h4><a id="redis_230"></a>五、<code>redis</code>持久化</h4> 
<ul><li> <p>1、<code>RDB</code>模式，默认的方式,使用快照的模式</p> <pre><code class="prism language-properties"># 900秒内,如果至少有一个key被修改，则执行bgsave操作,如果save "" 表示禁止使用RDB持久化
save 900 1
save 300 10
save 60 10000
stop-writes-on-bgsave-error yes
# 是否压缩
rdbcompression yes
rdbchecksum yes
# RDB文件名称
dbfilename dump.rdb
# 文件保存的路径目录
dir ./
</code></pre> </li><li> <p>2、<code>AOF</code>模式</p> 
  <ul><li> <p><code>AOF</code>默认是关闭的,需要修改<code>redis.conf</code>配置文件来开启<code>AOF</code></p> <pre><code class="prism language-properties"># 默认是no表示不开启,如果要开启改为yes
appendonly no
# AOF文件名称
appendfilename "appendonly.aof"
</code></pre> </li><li> <p><code>AOF</code>持久化频率</p> <pre><code class="prism language-properties"># 表示每执行一次写命令,立即会记录到AOF文件中
# appendfsync always 
# 写命令执行完成，先放入到AOF缓冲区，然后每隔1秒将缓冲区的数据写入到AOF中,默认的方式
appendfsync everysec
# 写命令执行完成，先放入到AOF缓冲区,由操作系统决定何时写入本地文件中
# appendfsync no
</code></pre> </li><li> <p><code>redis</code>触发阀值自动重写<code>AOF</code>文件</p> <pre><code class="prism language-properties"># 文件比上次文件,增长超过多少百分比触发重写
auto-aof-rewrite-percentage 100
# AOF文件体积最小多大以上才触发重写
auto-aof-rewrite-min-size 64mb
</code></pre> </li></ul> </li><li> <p>3、<code>RDB</code>和<code>AOF</code>的对比</p> 
  <table><thead><tr><th></th><th>RDB</th><th>AOF</th></tr></thead><tbody><tr><td>持久化方式</td><td>定时对整个内存做快照</td><td>记录每一次执行的命令</td></tr><tr><td>数据完整性</td><td>不完整,两次备份之间会丢失</td><td>相对完整，取决于刷盘策略</td></tr><tr><td>文件大小</td><td>会有压缩，文件提交小</td><td>记录命令，文件体积大</td></tr><tr><td>宕机恢复速度</td><td>很快</td><td>慢</td></tr><tr><td>数据恢复优先级</td><td>低，因为数据完整性不如AOF</td><td>高，因为数据完整性高</td></tr><tr><td>系统资源占用</td><td>高、大量CPU和内存消耗</td><td>低，主要是磁盘IO资源，但是AOF重写时会占用大量的CPU和内存资源</td></tr><tr><td>使用场景</td><td>可以容忍数分钟的数据丢失，追求快的启动速度</td><td>对数据安全性要求较高</td></tr></tbody></table></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1868dfa767be59240a52db1741093103/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">亲测有效！！解决MySQL8误删root账号无法登录的问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/86e08306b36b9409406771deae6486d2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">面试：浏览器的本地存储</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>