<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用SOS - 在Visual Studio中启用非托管代码调试来支持本机代码调试 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/7a17d3a4a36f45239cd376108786e7e9/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="使用SOS - 在Visual Studio中启用非托管代码调试来支持本机代码调试">
  <meta property="og:description" content="SOS(Son of Strike)扩展调试器可以用来显示CLR数据结构的内容。SOS是作为.net framework的一部分安装的(SOS.dll)，位于%windir%\Microsoft.NET\Framework\v*.*.****(版本号)\目录下。在使用SOS(加载SOS.dll)进行调试的步骤： Step1 在Visual Studio中设置项目属性,以启动托管调试:Visual Studio打开要调试的项目，菜单-&amp;gt;项目(Project)-&amp;gt;Project属性-&amp;gt;调试-&amp;gt;启用非托管代码调试，如下图所示： Step2 在代码中设置断点-&amp;gt;F5启动调试，运行到断点处；
Step3 设置Symbol目录：
如果不设置Symbol目录，运行下面的命令时会提示“PDB symbol for mscorwks.dll not loaded”，这里我们只需要再设置下Symbol目录就行了：菜单-&amp;gt;工具-&amp;gt;选项-&amp;gt;调试-&amp;gt;符号，设置如下：
Step4 菜单-&amp;gt;调试(Debug)-&amp;gt;窗口(Windows)-&amp;gt;即时(Immediate)，在打开的“即时窗口”中输入“!load sos.dll”来加载SOS.dll，如果加载成功，则会提示“已加载扩展%windir%\Microsoft.NET\Framework\v*.*.****(版本号)\sos.dll”；
Step5 在“即时窗口”中输入“!help”可以获得调试命令列表(如下)，输入&#34;!help &amp;lt;command&amp;gt;&#34; 可以获得该命令的详细信息.
! help
------------------------------------------------------------------------------- SOS is a debugger extension DLL designed to aid in the debugging of managed
programs. Functions are listed by category, then roughly in order of
importance. Shortcut names for popular functions are listed in parenthesis.
Type &#34; !help &amp;lt;functionname&amp;gt; &#34; for detailed info on that function.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-07-05T01:03:19+08:00">
    <meta property="article:modified_time" content="2019-07-05T01:03:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用SOS - 在Visual Studio中启用非托管代码调试来支持本机代码调试</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <br> 
 <br>   SOS(Son of Strike)扩展调试器可以用来显示CLR数据结构的内容。SOS是作为.net framework的一部分安装的(SOS.dll)，位于%windir%\Microsoft.NET\Framework\v*.*.****(版本号)\目录下。在使用SOS(加载SOS.dll)进行调试的步骤： 
 <br> 
 <font color="#0000ff"><strong>Step1</strong> </font>在Visual Studio中设置项目属性,以启动托管调试:Visual Studio打开要调试的项目，菜单-&gt;项目(Project)-&gt;Project属性-&gt;调试-&gt;启用非托管代码调试，如下图所示： 
 <br> 
 <img alt="" src="https://images2.imgbox.com/e1/9f/BKlKaUDR_o.png"> 
 <p><font color="#0000ff"><strong>Step2</strong> </font>在代码中设置断点-&gt;F5启动调试，运行到断点处；</p> 
 <p><strong><font color="#0000ff">Step3 </font></strong>设置Symbol目录：<br>    如果不设置Symbol目录，运行下面的命令时会提示“PDB symbol for mscorwks.dll not loaded”，这里我们只需要再设置下Symbol目录就行了：菜单-&gt;工具-&gt;选项-&gt;调试-&gt;符号，设置如下：<br><img alt="" src="https://images2.imgbox.com/8f/ab/eNGQTun9_o.png"></p> 
 <p><br><strong><font color="#0000ff">Step4</font></strong> 菜单-&gt;调试(Debug)-&gt;窗口(Windows)-&gt;即时(Immediate)，在打开的“即时窗口”中输入“!load sos.dll”来加载SOS.dll，如果加载成功，则会提示“已加载扩展%windir%\Microsoft.NET\Framework\v*.*.****(版本号)\sos.dll”；<br><img alt="" src="https://images2.imgbox.com/bf/91/j9yJiO8J_o.png"></p> 
 <p><br><font color="#0000ff"><strong>Step5</strong></font> 在“即时窗口”中输入“!help”可以获得调试命令列表(如下)，输入"!help &lt;command&gt;" 可以获得该命令的详细信息.</p> 
 <div style="border-right:.5pt solid;border-top:.5pt solid;background:#e6e6e6;border-left:.5pt solid;border-bottom:.5pt solid;"> 
  <div> 
   <img alt="" src="https://images2.imgbox.com/a8/d8/iqFIam0k_o.gif" align="top"> 
   <span style="color:#000000;">!</span> 
   <span style="color:#000000;">help<br><img alt="" src="https://images2.imgbox.com/33/e1/kJq36pGB_o.gif" align="top"></span> 
   <span style="color:#000000;">-------------------------------------------------------------------------------</span> 
   <span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/1d/1d/RTgzP0qz_o.gif" align="top">SOS </span> 
   <span style="color:#0000ff;">is</span> 
   <span style="color:#000000;"> a debugger extension DLL designed to aid </span> 
   <span style="color:#0000ff;">in</span> 
   <span style="color:#000000;"> the debugging of managed<br><img alt="" src="https://images2.imgbox.com/95/3c/1tXnvj4S_o.gif" align="top">programs. Functions are listed by category, then roughly </span> 
   <span style="color:#0000ff;">in</span> 
   <span style="color:#000000;"> order of<br><img alt="" src="https://images2.imgbox.com/91/a3/6r7uzwlL_o.gif" align="top">importance. Shortcut names </span> 
   <span style="color:#0000ff;">for</span> 
   <span style="color:#000000;"> popular functions are listed </span> 
   <span style="color:#0000ff;">in</span> 
   <span style="color:#000000;"> parenthesis.<br><img alt="" src="https://images2.imgbox.com/aa/48/F9lc6exd_o.gif" align="top">Type </span> 
   <span style="color:#000000;">"</span> 
   <span style="color:#000000;">!help &lt;functionname&gt;</span> 
   <span style="color:#000000;">"</span> 
   <span style="color:#000000;"> </span> 
   <span style="color:#0000ff;">for</span> 
   <span style="color:#000000;"> detailed info on that function. <br><img alt="" src="https://images2.imgbox.com/9a/31/uh6w11WG_o.gif" align="top"><br><img alt="" src="https://images2.imgbox.com/79/7e/CQcfN1ID_o.gif" align="top">Object Inspection                  Examining code and stacks<br><img alt="" src="https://images2.imgbox.com/19/7f/Bb5Q33HQ_o.gif" align="top"></span> 
   <span style="color:#000000;">-----------------------------</span> 
   <span style="color:#000000;">      </span> 
   <span style="color:#000000;">-----------------------------</span> 
   <span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/c3/a1/SrDagbXu_o.gif" align="top">DumpObj (</span> 
   <span style="color:#0000ff;">do</span> 
   <span style="color:#000000;">)                       Threads<br><img alt="" src="https://images2.imgbox.com/53/b5/XcAtJSXZ_o.gif" align="top">DumpArray (da)                     CLRStack<br><img alt="" src="https://images2.imgbox.com/11/b9/TpKA1Num_o.gif" align="top">DumpStackObjects (dso)             IP2MD<br><img alt="" src="https://images2.imgbox.com/59/17/oJzqin1R_o.gif" align="top">DumpHeap                           U<br><img alt="" src="https://images2.imgbox.com/9e/c5/lxoBm7LX_o.gif" align="top">DumpVC                             DumpStack<br><img alt="" src="https://images2.imgbox.com/30/27/6oUTf8dn_o.gif" align="top">GCRoot                             EEStack<br><img alt="" src="https://images2.imgbox.com/0c/dd/x0ecjwpn_o.gif" align="top">ObjSize                            GCInfo<br><img alt="" src="https://images2.imgbox.com/91/12/wjXpu0eA_o.gif" align="top">FinalizeQueue                      EHInfo<br><img alt="" src="https://images2.imgbox.com/4c/63/LZm0G4Oy_o.gif" align="top">PrintException (pe)                COMState<br><img alt="" src="https://images2.imgbox.com/ef/64/jZNV6bjU_o.gif" align="top">TraverseHeap                       BPMD <br><img alt="" src="https://images2.imgbox.com/ee/29/l7BWHhqN_o.gif" align="top"><br><img alt="" src="https://images2.imgbox.com/c0/e0/PkyUnuqf_o.gif" align="top">Examining CLR data structures      Diagnostic Utilities<br><img alt="" src="https://images2.imgbox.com/a8/80/EpsEFWO1_o.gif" align="top"></span> 
   <span style="color:#000000;">-----------------------------</span> 
   <span style="color:#000000;">      </span> 
   <span style="color:#000000;">-----------------------------</span> 
   <span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/00/83/xK3TdZID_o.gif" align="top">DumpDomain                         VerifyHeap<br><img alt="" src="https://images2.imgbox.com/ac/d4/T9RvOXQ9_o.gif" align="top">EEHeap                             DumpLog<br><img alt="" src="https://images2.imgbox.com/7b/a3/KCNN3LMX_o.gif" align="top">Name2EE                            FindAppDomain<br><img alt="" src="https://images2.imgbox.com/23/c3/lFN97GAi_o.gif" align="top">SyncBlk                            SaveModule<br><img alt="" src="https://images2.imgbox.com/2b/0c/MZ24cQTv_o.gif" align="top">DumpMT                             GCHandles<br><img alt="" src="https://images2.imgbox.com/2f/5c/gKH2G92M_o.gif" align="top">DumpClass                          GCHandleLeaks<br><img alt="" src="https://images2.imgbox.com/93/b5/ij6Yn7hc_o.gif" align="top">DumpMD                             VMMap<br><img alt="" src="https://images2.imgbox.com/2e/40/s8QbGQbT_o.gif" align="top">Token2EE                           VMStat<br><img alt="" src="https://images2.imgbox.com/ef/4e/XBX7bNQ1_o.gif" align="top">EEVersion                          ProcInfo <br><img alt="" src="https://images2.imgbox.com/af/32/WffjiZfj_o.gif" align="top">DumpModule                         StopOnException (soe)<br><img alt="" src="https://images2.imgbox.com/45/b0/v6ZboyX4_o.gif" align="top">ThreadPool                         MinidumpMode DumpAssembly                       <br><img alt="" src="https://images2.imgbox.com/8f/53/MbUVBBYQ_o.gif" align="top">DumpMethodSig                      <br><img alt="" src="https://images2.imgbox.com/10/90/QFJbbRsc_o.gif" align="top">DumpRuntimeTypes                   Other<br><img alt="" src="https://images2.imgbox.com/81/5f/5VB30bKJ_o.gif" align="top">DumpSig                            </span> 
   <span style="color:#000000;">-----------------------------</span> 
   <span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/99/a9/wrSE8E9d_o.gif" align="top">RCWCleanupList                     FAQ<br><img alt="" src="https://images2.imgbox.com/d1/05/nDeAFGSs_o.gif" align="top">DumpIL</span> 
  </div> 
 </div> 
 <p><br>    安装VS2003时，也会安装SOS的帮助文档，位于目录Program Files\Microsoft Visual Studio .NET 2003\SDK\v1.1\Tool Developers Guide\Samples\sos下；但VS2005中貌似没有安装该帮助文档，这里有更详细的文档<a href="http://msdn2.microsoft.com/en-us/library/ms954594.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/ms954594.aspx</a>...。我将这两份文档放在我的cnblogs上，可以从这里(<a href="http://files.cnblogs.com/happyhippy/sos.rar" rel="nofollow">http://files.cnblogs.com/happyhippy/sos.rar</a>)下载。</p> 
 <p> </p> 
</div> 
<p>转载于:https://www.cnblogs.com/happyhippy/archive/2007/04/11/710930.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/11813e907fa50285bbc054869373da50/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">hadoop安装需要开放的端口</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ac0dc89d882a059469d703fd3a6284d5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">年华</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>