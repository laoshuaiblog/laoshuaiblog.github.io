<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>STM32学习笔记（2）- 软件keil5安装和新建工程 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/9b36204f05bc352bdd7e0be3e9eb1cab/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="STM32学习笔记（2）- 软件keil5安装和新建工程">
  <meta property="og:description" content="无人问津也好，技不如人也罢，都应静下心来，去做该做的事。
最近在学STM32，所以也开贴记录一下主要内容，省的过目即忘。视频教程为江科大（改名江协科技），网站jiangxiekeji.com
软件安装 keil5 MDK 如果已经安装keil5 C51，可以放在同一个安装目录下，这样MDK和C51就可以共存。
安装时间较久，耐心等待即可。
安装器件支持包 因为ARM芯片型号太多，可选择特定的支持包安装
新建工程-Software Packs（为STM32系列支持包）
新建工程-Legacy Device Database（为C51系列支持包）
离线安装 双击安装STM32F1XX即可
在线安装（拓展部分） 防止以后开发新的芯片找不到型号 需联网，下载较慢
国产芯片GD32F103C8
安装完后关掉整个界面即可
然后新建工程选择对应的支持包就好。
软件注册 点击ADD LIC 安装STLINK驱动 此电脑-右键-属性-设备管理器
说明电脑没有安装STLINK的驱动 双击对应的安装即可，设备管理器-通用串行总线 查看到ST-LINK就是安装好了
安装JLINK驱动 安装USB转串口驱动 这个USB转串口的芯片是CH340，和51单片机一样
然后在设备管理器-端口-CH340表示安装成功。
新建工程 STM32程序编写分三种：
一是寄存器，和C51一样，直接对寄存器配置；
二是库函数，使用ST官方封装好的函数来间接配置寄存器。本教程使用此方法。
三是基于HAL库，用图形化界面快速配置STM32，能快速上手，但会对底层不了解。
以下为库函数的目录
下面开始新建库函数的工程
1、新建一个文件夹来存工程 如D:\software\STM32project
2、新建工程模板 打开keil5 - project - new uVision project -D:\software\STM32project - 新建文件夹（2-1 工程模板）- Project 3、复制启动文件 D:\software\STM32入门教程资料\固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x\startup\arm 把这些启动文件复制到 2-1 工程模板 文件夹 的新建文件夹Start中
D:\software\STM32入门教程资料\固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x的
stm32f10x.h文件是STM32的头文件、
两个system文件是用来配置时钟的，这三个文件同样复制到Start文件中。
4、内核寄存器的文件 D:\software\STM32入门教程资料\固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\CoreSupport的两个cm3文件也复制到Start文件夹">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-22T12:25:00+08:00">
    <meta property="article:modified_time" content="2024-03-22T12:25:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">STM32学习笔记（2）- 软件keil5安装和新建工程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>无人问津也好，技不如人也罢，都应静下心来，去做该做的事。</p> 
<p></p> 
<p>最近在学STM32，所以也开贴记录一下主要内容，省的过目即忘。视频教程为江科大（改名江协科技），网站jiangxiekeji.com</p> 
<p></p> 
<h2 style="background-color:transparent;">软件安装</h2> 
<h3 style="background-color:transparent;">keil5 MDK</h3> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/48/62/DJXxVqDs_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/d4/71/1VZdilO4_o.png" width="1200"></p> 
<p> 如果已经安装keil5 C51，可以放在同一个安装目录下，这样MDK和C51就可以共存。</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/cb/b4/oicuVf7R_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/14/3f/7rBNGcgf_o.png" width="1200"></p> 
<p> 安装时间较久，耐心等待即可。</p> 
<h3>安装器件支持包</h3> 
<p>因为ARM芯片型号太多，可选择特定的支持包安装</p> 
<p>新建工程-Software Packs（为STM32系列支持包）</p> 
<p>新建工程-Legacy Device Database（为C51系列支持包）</p> 
<p class="img-center"><img alt="" height="669" src="https://images2.imgbox.com/d2/0d/EhCF0RZQ_o.png" width="889"></p> 
<h4>离线安装</h4> 
<p>双击安装STM32F1XX即可</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/24/92/VvXM0QsN_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/3c/4d/5E893exF_o.png" width="1200"></p> 
<h4>在线安装（拓展部分）</h4> 
<p>防止以后开发新的芯片找不到型号 </p> 
<p>需联网，下载较慢</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/25/76/21AIbSvL_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/ff/56/pgNsm2Ah_o.png" width="1200"></p> 
<p> 国产芯片GD32F103C8</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/9f/ad/8AH33Iq1_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/a7/e6/DJWfDs8Q_o.png" width="1200"></p> 
<p>安装完后关掉整个界面即可</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/4b/e4/Mp4JpiTP_o.png" width="1200"></p> 
<p> 然后新建工程选择对应的支持包就好。</p> 
<h3>软件注册</h3> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/21/da/oNiC5Q9i_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/80/f4/dUYAn55x_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/10/ad/Xv4PtUh9_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/75/ba/FSAa8OUu_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/b7/64/EyjBNxRO_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/83/0f/aMuMCnU5_o.png" width="1200"></p> 
<p>点击ADD LIC </p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/64/1d/KaHWUi2c_o.png" width="1200"></p> 
<h3>安装STLINK驱动 </h3> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/18/40/tFPt8tWB_o.png" width="1200"></p> 
<p> 此电脑-右键-属性-设备管理器</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/02/f9/LshTGcMx_o.png" width="1200"></p> 
<p>说明电脑没有安装STLINK的驱动 </p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/f0/e8/0MXW1OJP_o.png" width="1200"></p> 
<p> 双击对应的安装即可，设备管理器-通用串行总线  查看到ST-LINK就是安装好了</p> 
<h3>安装JLINK驱动</h3> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/b0/b1/S3eWH7XX_o.png" width="1200"></p> 
<h3>安装USB转串口驱动</h3> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/de/ca/w2Cxjsma_o.png" width="1200"></p> 
<p>这个USB转串口的芯片是CH340，和51单片机一样</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/4a/26/tbM2O4aA_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/f7/7e/iQo5H34W_o.png" width="1200"></p> 
<p> 然后在设备管理器-端口-CH340表示安装成功。</p> 
<p></p> 
<h2>新建工程</h2> 
<p>STM32程序编写分三种：</p> 
<p>一是寄存器，和C51一样，直接对寄存器配置；</p> 
<p>二是库函数，使用ST官方封装好的函数来间接配置寄存器。本教程使用此方法。</p> 
<p>三是基于HAL库，用图形化界面快速配置STM32，能快速上手，但会对底层不了解。</p> 
<p></p> 
<p>以下为库函数的目录</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/86/e2/02TMG7zK_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/c0/f0/bA8aeTmi_o.png" width="1200"></p> 
<p></p> 
<p>下面开始新建库函数的工程</p> 
<h3 style="background-color:transparent;">1、新建一个文件夹来存工程</h3> 
<p>如D:\software\STM32project</p> 
<h3 style="background-color:transparent;">2、新建工程模板</h3> 
<p>打开keil5 - project - new uVision project -D:\software\STM32project - 新建文件夹（2-1 工程模板）- Project </p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/2a/29/4o3bPWZf_o.png" width="1200"></p> 
<h3 style="background-color:transparent;">3、复制启动文件</h3> 
<p>D:\software\STM32入门教程资料\固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x\startup\arm 把这些启动文件复制到 2-1 工程模板 文件夹 的新建文件夹Start中</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/8b/de/Tcwe8dic_o.png" width="1200"></p> 
<p></p> 
<p>D:\software\STM32入门教程资料\固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x的</p> 
<p>stm32f10x.h文件是STM32的头文件、</p> 
<p>两个system文件是用来配置时钟的，这三个文件同样复制到Start文件中。</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/4e/2f/4WcG6Uvo_o.png" width="1200"></p> 
<h3 style="background-color:transparent;">4、内核寄存器的文件 </h3> 
<p>D:\software\STM32入门教程资料\固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\CoreSupport的两个cm3文件也复制到Start文件夹</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/ae/34/MlaFwE60_o.png" width="1200"></p> 
<p>到这里，工程的必要文件已复制完成。</p> 
<h3 style="background-color:transparent;"> 5、添加启动文件到工程中</h3> 
<p>把project-target-Source Group 1的名称改为Start</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/71/f6/j4n7Jsnr_o.png" width="1200"></p> 
<p>添加启动文件，选中后点击add</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/83/7e/aojwUXvt_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/a6/fd/qpS5JZlD_o.png" width="1200"></p> 
<p> </p> 
<p> Start文件夹中的.c、.h文件都要添加进来。</p> 
<p>这些都是STM32基础的、不需修改的文件。</p> 
<h3 style="background-color:transparent;">6、工程选项添加头文件路径</h3> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/bb/6a/QaDeHDJO_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/15/71/3XcwKO75_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/41/62/0jCs600W_o.png" width="1200"></p> 
<h3 style="background-color:transparent;"> 7、新建main函数</h3> 
<p>在2-1 工程模板文件夹中新建User文件夹</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/1f/b9/QECpI3pk_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/06/50/5jWKGMXu_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/ea/0d/peRNUbyO_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/51/ab/JHvmDa0p_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/6b/36/ZWtapRRV_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/78/80/B3sGKnjb_o.png" width="1200"></p> 
<p> 插入头文件后，写个main空函数，最后一行要是空行，不然会有警告。</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/fc/30/BXItAN7N_o.png" width="1200"></p> 
<pre><code class="hljs">#include "stm32f10x.h"                  // Device header

int main(void)
{
	while(1)
	{
		
	}

}
</code></pre> 
<p> 然后点击build按钮，编译并建造工程，显示0错误、0警告就说明新建工程成功。</p> 
<p>CTRL+鼠标滚轮可缩放页面</p> 
<p>点击扳手工具，选择UTF8，防止中文乱码；左下角TAP改为4</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/60/56/bVCEjpFW_o.png" width="1200"></p> 
<h3>8、STLINK下载程序 </h3> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/33/c1/3IZD9C5W_o.png" width="1200"></p> 
<p>点击魔术棒-debug-选择STLINK下载</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/72/c0/KBCCscpw_o.png" width="1200"></p> 
<p> 点击settings</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/4a/59/kWBgzpWf_o.png" width="1200"></p> 
<p> 确认后重新编译一次，无错误即可点击load，下载程序进STM32</p> 
<h3 style="background-color:transparent;">9、新建Library</h3> 
<p>这里的步骤是为了使用库函数，需要做的一些操作。</p> 
<p>在2-1 工程模板文件夹中新建Library文件夹</p> 
<p>D:\software\STM32入门教程资料\固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\STM32F10x_StdPeriph_Driver\src中的文件都是库函数的源文件，把这些文件都复制到Library文件夹</p> 
<p>D:\software\STM32入门教程资料\固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\STM32F10x_StdPeriph_Driver\inc中的文件都是库函数的头文件，也把这些文件都复制到Library文件夹</p> 
<p>回到keil5，同样在target右键，添加组Library，右键添加已存在的文件，打开Library，CTRL+A，ADD。</p> 
<p>还需再添加一个文件才能使用库函数，D:\software\STM32入门教程资料\固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Project\STM32F10x_StdPeriph_Template的这三个文件复制到User文件夹中，并在keil5的User组中添加进来</p> 
<p class="img-center"><img alt="" height="399" src="https://images2.imgbox.com/07/26/r4zCgYww_o.png" width="566"></p> 
<p>还需要一个宏定义才能用库函数， 在stm32f10x.h中找到字符串（USE_STDPERIPH_DRIVER）复制，粘贴在魔术棒 - C/C++ - Define中，这样就可包含在库函数中。</p> 
<p>同样，在魔术棒 - C/C++ - Include paths中添加User和Library的路径</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/9f/be/nBfoIb2z_o.png" width="1200"></p> 
<p>点击三个箱子的按钮，可以移动target组的位置</p> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/04/cc/jF3htbgx_o.png" width="1200"></p> 
<h3 style="background-color:transparent;"> 10、点灯</h3> 
<p>这里用PC13点亮STM32核心板上的灯为例子</p> 
<pre><code class="hljs">#include "stm32f10x.h"                  // Device header

int main(void)
{
	RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC,ENABLE);//配置时钟(选择外设，选择状态)
	GPIO_InitTypeDef GPIO_Initstructure;//定义GPIO结构体
	GPIO_Initstructure.GPIO_Mode = GPIO_Mode_Out_PP;
	GPIO_Initstructure.GPIO_Pin = GPIO_Pin_13;
	GPIO_Initstructure.GPIO_Speed = GPIO_Speed_50MHz;
//	GPIO_SetBits(GPIOC,GPIO_Pin_13);//将PC13设为高电平
	GPIO_ResetBits(GPIOC,GPIO_Pin_13);//将PC13设为低电平
	GPIO_Init(GPIOC,&amp;GPIO_Initstructure);//配置端口模式（选择哪个GPIO，参数的结构体）
	while(1)
	{
		
	}

}
</code></pre> 
<h3>11、新建工程步骤总结</h3> 
<p class="img-center"><img alt="" height="1080" src="https://images2.imgbox.com/6f/74/Uai5gQxX_o.png" width="1200"></p> 
<p> ​​​​​</p> 
<p class="img-center"><img alt="" height="891" src="https://images2.imgbox.com/e4/a3/mJwyT0ON_o.png" width="1200"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5c6a683fb654a78e2a565ce4741282b3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于SSM&#43;Jsp&#43;Mysql的高校二手交易平台</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/05d23b15ff9b830bd5b37374fbfcf9ea/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">达梦数据库导出数据表结构为excel或html或文本</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>