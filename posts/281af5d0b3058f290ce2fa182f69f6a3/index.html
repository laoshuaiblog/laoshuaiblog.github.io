<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>批处理文件——多个QQ一键登录 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/281af5d0b3058f290ce2fa182f69f6a3/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="批处理文件——多个QQ一键登录">
  <meta property="og:description" content="偶然看到有的同学登录PC的QQ，发现他有很多QQ，每登录一个要切换一个，虽然记住了密码，但还是不方便，于是想通过批处理来实现“一键登录”的功能。以下内容为作者的假想，如有雷同，实属巧合！
具体的实现步骤如下：
(1)首先，查看QQ安装时的文档位置（用于保存用户登录历史记录），我的是：C:\Users\David\Documents\TencentFiles\All Users\QQ；如图1所示：
图1 数据信息所在目录
(2)目录下有三个后缀名为db的文件：
History.db是一个存放所有历史登录记录的表，该表是有序的，第一个记录就是客户端最近一次登录的QQ用户；
Perfre.db则是实际登录的QQ用户，每次打开客户端，都会从History.db中取出第一个记录（即第一个QQ用户）存入Perfre.db并登录，里面保存的是一个用户的信息；
Registry.db保存的应该就是Perfre.db中保存的登录用户的信息，包括QQ头像，登录设置（代理，端口号，自定义图像和好友列表等用户信息），如下图所示：
图2 登录客户端 图3 设置信息窗口
(3)三者的执行顺序简介：在启动QQ.exe应用程序的时候，首先就是加载History.db文件，于是在客户端可以看到我们之前在本地PC所登录的所有历史记录；其次，动态创建Perfre.db文件，从History.db文件取出第一个QQ用户记录信息，保存在Perfre.db文件中；Registry.db文件也是动态生成的，它根据Perfre.db文件中的用户唯一标识符，在Misc文件夹(图1所示)下找到此用户的代理，端口号，自定义图像和好友列表等用户信息，最后登录，后面还要检验密码什么的就不在本博文的研究范围内了。
(4)既然这样，我们就可以写一个bat批处理脚本来实现多个QQ用户同时登录了，当然，这也是一个一劳永逸的办法，刚开始比较麻烦一点。
1) 在&#34;C:\Users\David\Documents\TencentFiles\All Users\QQ &#34;文件夹(这里每个人的文件夹可能不一样)分别创建文件夹1、2、3、……(要登录几个QQ就创建几个)；
2) 登录第一个QQ，输入账号密码，勾选自动登录。登录成功后，将History.db文件剪切到文件夹1；
3) 登录第二个QQ，同上，将History.db文件剪切到文件夹2，依次类推，直到所有登录的QQ所创建的History.db文件都备份好；
4) 在任何地方创建一个QQlogin.bat批处理文件，该脚本代码如下：
del &#34;C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db&#34; copy &#34;C:\Users\David\Documents\Tencent Files\All Users\QQ\1\History.db&#34; &#34;C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db&#34; start D:\Progra~1\Tencent\QQ\Bin\qq.exe ping 127.0.0.1 -n 7 del &#34;C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db&#34; copy &#34;C:\Users\David\Documents\Tencent Files\All Users\QQ\2\History.db&#34; &#34;C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db&#34; start D:\Progra~1\Tencent\QQ\Bin\qq.exe ping 127.0.0.1 -n 7 del &#34;C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db&#34; copy &#34;C:\Users\David\Documents\Tencent Files\All Users\QQ\3\History.db&#34; &#34;C:\Users\David\Documents\Tencent Files\All Users\QQ\History.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2014-03-24T13:55:50+08:00">
    <meta property="article:modified_time" content="2014-03-24T13:55:50+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">批处理文件——多个QQ一键登录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="font-size:14px"><span style="white-space:pre"></span></span></p> 
<p>       偶然看到有的同学登录PC的QQ，发现他有很多QQ，每登录一个要切换一个，虽然记住了密码，但还是不方便，于是想通过批处理来实现“一键登录”的功能。以下内容为作者的假想，如有雷同，实属巧合！</p> 
<p>       具体的实现步骤如下：</p> 
<p>       (1)首先，查看QQ安装时的文档位置（用于保存用户登录历史记录），我的是：C:\Users\David\Documents\TencentFiles\All Users\QQ；如图1所示：</p> 
<p><img src="https://images2.imgbox.com/a0/63/LbLUQe8j_o.png" alt=""><br> </p> 
<p style="text-align:center"><img src="" alt=""><img src="" alt=""><br> </p> 
<p align="center"></p> 
<p align="center">图1 数据信息所在目录</p> 
<p>       (2)目录下有三个后缀名为db的文件：</p> 
<p><strong>History.db</strong>是一个存放所有历史登录记录的表，该表是有序的，第一个记录就是客户端最近一次登录的QQ用户；</p> 
<p><strong>Perfre.db</strong>则是实际登录的QQ用户，每次打开客户端，都会从History.db中取出第一个记录（即第一个QQ用户）存入Perfre.db并登录，里面保存的是一个用户的信息；</p> 
<p><strong>Registry.db</strong>保存的应该就是Perfre.db中保存的登录用户的信息，包括QQ头像，登录设置（代理，端口号，自定义图像和好友列表等用户信息），如下图所示：</p> 
<p style="text-align:center"><img src="https://images2.imgbox.com/d5/d8/OzVqMXcZ_o.png" alt="">     <img src="" alt="">                  <img src="" alt=""></p> 
<p style="text-align:center">                                图2 登录客户端                                                                                   </p> 
<p style="text-align:center"><img src="https://images2.imgbox.com/1b/b9/NEjXZMPE_o.png" alt=""><br> </p> 
<p style="text-align:center"> 图3 设置信息窗口</p> 
<p>       (3)三者的执行顺序简介：在启动QQ.exe应用程序的时候，首先就是加载<strong>History.db</strong>文件，于是在客户端可以看到我们之前在本地PC所登录的所有历史记录；其次，动态创建<strong>Perfre.db</strong>文件，从<strong>History.db</strong>文件取出第一个QQ用户记录信息，保存在<strong>Perfre.db</strong>文件中；<strong>Registry.db文件</strong>也是动态生成的，它根据<strong>Perfre.db</strong>文件中的用户唯一标识符，在<strong>Misc</strong>文件夹(图1所示)下找到此用户的代理，端口号，自定义图像和好友列表等用户信息，最后登录，后面还要检验密码什么的就不在本博文的研究范围内了。</p> 
<p>       (4)既然这样，我们就可以写一个bat批处理脚本来实现多个QQ用户同时登录了，当然，这也是一个一劳永逸的办法，刚开始比较麻烦一点。</p> 
<p>1)       在"C:\Users\David\Documents\TencentFiles\All Users\QQ "文件夹(这里每个人的文件夹可能不一样)分别创建文件夹1、2、3、……(要登录几个QQ就创建几个)；</p> 
<p>2)       登录第一个QQ，输入账号密码，<strong>勾选自动登录</strong>。登录成功后，将<strong>History.db</strong>文件剪切到文件夹1；</p> 
<p>3)       登录第二个QQ，同上，将<strong>History.db</strong>文件剪切到文件夹2，依次类推，直到所有登录的QQ所创建的<strong>History.db</strong>文件都备份好；</p> 
<p>4)       在任何地方创建一个<strong>QQlogin.bat</strong>批处理文件，该脚本代码如下：</p> 
<p></p> 
<pre><code class="language-plain">del "C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db"
copy "C:\Users\David\Documents\Tencent Files\All Users\QQ\1\History.db" "C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db"

start D:\Progra~1\Tencent\QQ\Bin\qq.exe
ping 127.0.0.1 -n 7

del "C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db"
copy "C:\Users\David\Documents\Tencent Files\All Users\QQ\2\History.db" "C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db"

start D:\Progra~1\Tencent\QQ\Bin\qq.exe
ping 127.0.0.1 -n 7
 
del "C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db"
copy "C:\Users\David\Documents\Tencent Files\All Users\QQ\3\History.db" "C:\Users\David\Documents\Tencent Files\All Users\QQ\History.db"
start D:\Progra~1\Tencent\QQ\Bin\qq.exe
ping 127.0.0.1 -n 7
 
del /q History.db
cls
</code></pre> 
<br> 
<p></p> 
<p>根据你的QQ所在目录修改批处理文件中的对应目录，有几个QQ同时登录就有几段代码，修改对应的文件夹即可，比如我实验的是3个，所以就有三段代码；“ping 127.0.0.1 -n 7”代码后面的7表示几秒，可能需要做调整，避免瞬间同时登录导致<strong>History.db</strong>文件没来得及复制发生错误；</p> 
<p>5)       这里已经是完成了原先的目的，但是有一点不足之处就是运行的时候会弹出CMD的黑色窗口；我在这里做个小小的改进，让窗口在后台进行，原有的<strong>QQlogin.bat</strong>批处理文件不需要做任何修改，仅需要创建一个<strong>go.vbs</strong>的文件（<strong>QQlogin.bat和go.vbs在同一个目录下</strong>），文件代码为：</p> 
<p> </p> 
<pre><code class="language-plain">Set shell = Wscript.createobject("wscript.shell")

a = shell.run ("C:\Users\David\Desktop\QQlogin.bat",0) </code></pre>这里也需要修改对于那个的bat路径； 
<p></p> 
<p>双击运行<strong>go.vbs</strong>文件，即可实现多个QQ同时登录；要是你不想双击，也可以采用快捷键，创建一个<strong>go.vbs</strong>文件的快捷方式（放在桌面上或者附加到开始菜单），则直接使用快捷键（我的是Ctrl+Alt+K）就可以了，例子如下图4：</p> 
<p style="text-align:center"><img src="https://images2.imgbox.com/5f/7e/2KzM2VLZ_o.png" align="middle" alt=""><br> </p> 
<p style="text-align:center"><img src="" alt=""><br> </p> 
<p align="center"></p> 
<p align="center">图4 快捷键修改</p> 
<p>注：</p> 
<p>1在批处理文件中只需要操作<strong>History.db</strong>文件的原因是，另外两个文件是基于<strong>History.db</strong>文件动态生成的，因此不用全部操作。</p> 
<p>2博文最后提到的快接键方式运行，由于vbs是一个脚本文件，无法附加到开始菜单，作者没有仔细研究。</p> 
<p>3批处理文件中每个QQ都附加一段代码显得代码量繁琐，可以使用类似for循环或者while循环的方式，留给读者搞定。</p> 
<p><br> </p> 
<p>本文版权归作者和CSDN所有，欢迎转载，转载请注明出处：<a target="_blank" href="http://blog.csdn.net/thebestdavid/article/details/21946555" rel="noopener noreferrer">http://blog.csdn.net/thebestdavid/article/details/21946555</a></p> 
<p><br> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0a4f75ac24d748e6612719ec8ff4f97b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SplitContainer容器控件左右Panel大小调整</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6352888e66ea0cf48c7deed48bb5aca9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43; 指针与作用域</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>