<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux 环境下搭建 ElasticSearch （CentOS 7） - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/1d243a818f69061d5a2ab56a94e0797f/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="Linux 环境下搭建 ElasticSearch （CentOS 7）">
  <meta property="og:description" content="一、执行解压操作 创建一个安装目录，解压到此文件夹。
mkdir /usr/local/es
将上传的 es 包进行解压到指定文件夹位置，注意后面的-C 大写。 tar -zxvf elasticsearch-7.4.0-linux-x86_64.tar.gz -C /usr/local/es
二、创建新用户 因为安全问题，不允许root用户直接运行，先进行创建新用户。
useradd caojun
passwd caojun
接着输入自己的密码即可。接着授权
chown -R caojun:caojun /usr/local/es/elasticsearch-7.4.0
三、修改配置文件 elasticsearch.yml 这是没有安装vim 导致，安装vim命令如下
yum -y install vim*
vim /usr/local/es/elasticsearch-7.4.0/config/elasticsearch.yml
主要修改一下五处：按照截图中修改，只需要注释前面的 #
cluster.name：配置elasticsearch的集群名称，默认是elasticsearch。建议修改成一个有意义的名称
node.name：节点名，elasticsearch会默认随机指定一个名字，建议指定一个有意义的名称，方便管理
network.host：设置为0.0.0.0允许外网访问
http.port：Elasticsearch的http访问端口
cluster.initial_master_nodes：初始化新的集群时需要此配置来指定参与选举的master（注意：需要添加自己虚拟机的地址，图中没有显示[&#34;192.168.101.128&#34;]）
四、启动 ElasticSearch 切换到刚刚自己新建的用户
第一步：su caojun
第二步：cd /usr/local/es/elasticsearch-7.4.0/bin
第三步：./elasticsearch
出现问题如下：需要修改虚拟机配置文件了
五、修改虚拟机配置文件 第一步：su root
第二步：sudo vi /etc/security/limits.conf
添加如下两句配置
caojun soft nofile 65536
caojun hard nofile 65536
退出保存成功
第三步：sudo vi /etc/security/limits.d/20-nproc.conf">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-11-25T21:18:58+08:00">
    <meta property="article:modified_time" content="2023-11-25T21:18:58+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux 环境下搭建 ElasticSearch （CentOS 7）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>一、执行解压操作</h4> 
<p>创建一个安装目录，解压到此文件夹。</p> 
<blockquote> 
 <p>mkdir /usr/local/es</p> 
</blockquote> 
<p>将上传的 es 包进行解压到指定文件夹位置，注意后面的-C 大写。 </p> 
<blockquote> 
 <p>tar -zxvf elasticsearch-7.4.0-linux-x86_64.tar.gz -C /usr/local/es</p> 
</blockquote> 
<h4>二、创建新用户</h4> 
<p>因为安全问题，不允许root用户直接运行，先进行创建新用户。</p> 
<blockquote> 
 <p>useradd caojun<br> passwd caojun<br> 接着输入自己的密码即可。接着授权</p> 
 <p>chown -R caojun:caojun /usr/local/es/elasticsearch-7.4.0</p> 
</blockquote> 
<p> <img alt="" height="182" src="https://images2.imgbox.com/d0/1a/sLbjvfpf_o.png" width="657"></p> 
<h4>三、修改配置文件  elasticsearch.yml</h4> 
<p>这是没有安装vim 导致，安装vim命令如下</p> 
<blockquote> 
 <p>yum -y install vim*</p> 
</blockquote> 
<blockquote> 
 <p>vim /usr/local/es/elasticsearch-7.4.0/config/elasticsearch.yml</p> 
</blockquote> 
<p>主要修改一下五处：按照截图中修改，只需要注释前面的 #</p> 
<p><img alt="" height="117" src="https://images2.imgbox.com/55/87/MOegaNtG_o.png" width="801"></p> 
<p><img alt="" height="117" src="https://images2.imgbox.com/ff/56/8ouQub8G_o.png" width="735"></p> 
<p><img alt="" height="169" src="https://images2.imgbox.com/de/04/HXZ6X1ep_o.png" width="785"></p> 
<p><img alt="" height="89" src="https://images2.imgbox.com/32/af/3S3RRzuK_o.png" width="655"></p> 
<p>cluster.name：配置elasticsearch的集群名称，默认是elasticsearch。建议修改成一个有意义的名称<br> node.name：节点名，elasticsearch会默认随机指定一个名字，建议指定一个有意义的名称，方便管理<br> network.host：设置为0.0.0.0允许外网访问<br> http.port：Elasticsearch的http访问端口<br> cluster.initial_master_nodes：初始化新的集群时需要此配置来指定参与选举的master（<span style="color:#fe2c24;"><strong>注意：需要添加自己虚拟机的地址，图中没有显示["192.168.101.128"]）</strong></span></p> 
<h4>四、启动 ElasticSearch</h4> 
<p>切换到刚刚自己新建的用户</p> 
<blockquote> 
 <p>第一步：su caojun<br> 第二步：cd /usr/local/es/elasticsearch-7.4.0/bin<br> 第三步：./elasticsearch</p> 
</blockquote> 
<p>出现问题如下：需要修改虚拟机配置文件了</p> 
<p><img alt="" height="271" src="https://images2.imgbox.com/7a/5f/tcWswoX1_o.png" width="1125"></p> 
<h4>五、修改虚拟机配置文件</h4> 
<blockquote> 
 <p>第一步：su root<br> 第二步：sudo vi /etc/security/limits.conf<br> 添加如下两句配置</p> 
 <p>caojun soft nofile 65536<br> caojun hard nofile 65536</p> 
 <p>退出保存成功</p> 
</blockquote> 
<p><img alt="" height="216" src="https://images2.imgbox.com/ae/a5/gLT3N9mm_o.png" width="625"></p> 
<blockquote> 
 <p>第三步：sudo vi /etc/security/limits.d/20-nproc.conf</p> 
 <p>添加以下三句配置<br> caojun     soft     nofile    65536<br> caojun     hard    nofile    65536<br> *              hard    nproc     4096</p> 
 <p>退出保存成功<br> 第四步：sudo vi /etc/sysctl.conf</p> 
 <p>添加以下一句配置<br> vm.max_map_count=655360<br> 第五步：重新加载</p> 
 <p>sysctl -p</p> 
</blockquote> 
<h4>六、重新启动 ElasticSearch</h4> 
<blockquote> 
 <p>第一步：su caojun<br> 第二步：cd /usr/local/es/elasticsearch-7.4.0/bin<br> 第三步：./elasticsearch</p> 
</blockquote> 
<p><img alt="" height="260" src="https://images2.imgbox.com/34/fa/6pkX4Nk4_o.png" width="651"><br> 如上图说明启动成功。</p> 
<h4>七、查看是否启动命令</h4> 
<blockquote> 
 <p>ps -ef|grep elastic</p> 
</blockquote> 
<p><img alt="" height="176" src="https://images2.imgbox.com/4c/f7/GaIrNee2_o.png" width="649"></p> 
<h4>八、访问 ElasticSearch</h4> 
<p>先关闭防火墙，切换到 root，在进行关闭，不同的版本命令不一样，自行百度即可。这里是CentOS 7版本的命令。</p> 
<blockquote> 
 <p>systemctl stop firewalld<br> systemctl status firewalld</p> 
</blockquote> 
<p> <img alt="" height="209" src="https://images2.imgbox.com/38/5b/CRnoxfO3_o.png" width="767"></p> 
<h4>九、访问</h4> 
<p>最后用一个浏览器访问即可，我这里是 window 主机浏览器访问 vm 虚拟机的，要指定虚拟机 ip 地址端口。，下图表示成功访问，出现刚刚配置的相关信息。</p> 
<p><img alt="" height="276" src="https://images2.imgbox.com/5c/d0/TR3sFypQ_o.png" width="513"></p> 
<blockquote> 
 <p>插件下载<br><strong><span style="color:#fe2c24;">IK分词器</span>：https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.15.2/elasticsearch-analysis-ik-7.15.2.zip</strong></p> 
 <p><strong><span style="color:#fe2c24;">pinyin分词器</span>：https://github.com/medcl/elasticsearch-analysis-pinyin/releases/download/v7.15.2/elasticsearch-analysis-pinyin-7.15.2.zip</strong></p> 
 <p><strong>将下载且编译好的<span style="color:#fe2c24;">zip包进行解压</span>，进行拷贝，上传到ElasticSerach的 <span style="color:#fe2c24;">plugins</span>的文件夹下(/usr/local/elasticsearch-7.15.2/plugins)</strong></p> 
</blockquote> 
<h3>启动kibana</h3> 
<blockquote> 
 <p>步骤一：cd /usr/local/ esclient/kibana-7.4.0-linux-x86_64/bin</p> 
 <p>步骤二：修改配置文件</p> 
 <p>vim /esclient/kibana-7.4.0-linux-x86_64/config/kibana.yml</p> 
 <pre><code>server.port: 5601
server.host: "0.0.0.0"
server.name: "kibana-itcast"
elasticsearch.hosts: ["192.168.101.128:9200"]
elasticsearch.requestTimeout: 99999
</code></pre> 
 <p>步骤三：./kibana --allow-root</p> 
 <p>浏览器访问：192.168.101.128:5601</p> 
 <p><span style="color:#fe2c24;"><strong>查看所有索引命令：GET _cat/indices</strong></span></p> 
 <p><span style="color:#fe2c24;"><strong>查看对应索引命令：GET filesearch/_search</strong></span></p> 
 <p><span style="color:#fe2c24;"><strong>删除索引命令：DELETE filesearch</strong></span></p> 
</blockquote> 
<pre><code class="language-java">PUT /filesearch
{
  "mappings": {
    "properties": {
      "userFileId": {
        "type": "keyword"
      },
      "fileId": {
        "type": "keyword"
      },
      "fileName": {
        "type": "text",
        "fields": {
          "keyword": {
            "type": "keyword",
            "ignore_above": 256
          }
        }
      },
      "content": {
        "type": "text"
      },
      "fileUrl": {
        "type": "keyword"
      },
      "fileSize": {
        "type": "long"
      },
      "storageType": {
        "type": "integer"
      },
      "identifier": {
        "type": "keyword"
      },
      "userId": {
        "type": "long"
      },
      "filePath": {
        "type": "keyword"
      },
      "extendName": {
        "type": "keyword"
      },
      "isDir": {
        "type": "integer"
      },
      "uploadTime": {
        "type": "date",
        "format": "yyyy-MM-dd HH:mm:ss"
      },
      "deleteFlag": {
        "type": "integer"
      },
      "deleteTime": {
        "type": "date",
        "format": "yyyy-MM-dd HH:mm:ss"
      },
      "deleteBatchNum": {
        "type": "keyword"
      },
      // 可根据需要添加其他字段及其配置
    }
  }
}
</code></pre> 
<p> 扩展功能 </p> 
<h3>docker安装</h3> 
<h4>一、yum安装</h4> 
<blockquote> 
 <p>yum install -y yum-utils \<br>            device-mapper-persistent-data \<br>            lvm2 --skip-broken</p> 
</blockquote> 
<h4>二、更新本地镜像源</h4> 
<blockquote> 
 <p># 设置docker镜像源<br> sudo yum-config-manager \<br>     --add-repo \<br>     https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo<br>     <br> sed -i 's/download.docker.com/mirrors.aliyun.com\/docker-ce/g' /etc/yum.repos.d/docker-ce.repo<br> ​<br> yum makecache fast </p> 
</blockquote> 
<h4>三、安装docker</h4> 
<blockquote> 
 <p>yum install -y docker-ce </p> 
</blockquote> 
<p>启动docker需要关闭防火墙</p> 
<blockquote> 
 <p># 关闭<br> systemctl stop firewalld<br> # 禁止开机启动防火墙<br> systemctl disable firewalld </p> 
</blockquote> 
<h3>docker镜像安装onlyoffice在线办公</h3> 
<h4>拉取镜像</h4> 
<blockquote> 
 <p>docker pull onlyoffice/documentserver</p> 
</blockquote> 
<h4>快速启动</h4> 
<blockquote> 
 <p>docker run -i -t -d -p 80:80 --restart=always onlyoffice/documentserver </p> 
</blockquote> 
<h4>访问</h4> 
<blockquote> 
 <p>http://192.168.101.128/welcome/ </p> 
</blockquote> 
<p>nacos个人额外项目</p> 
<blockquote> 
 <p>docker run -d --name nacos -p 8848:8848 nacos/nacos-server </p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d9cf958a23798ecc4eca857e704aeae1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">pytorch 卷积层 padding_mode=‘circular’ 的小 bug</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0f0d1072e11b3c5386e82a1b0918cadf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">RabbitMQ之延迟消息实战</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>