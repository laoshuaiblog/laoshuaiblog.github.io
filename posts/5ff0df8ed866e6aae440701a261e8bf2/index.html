<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>easyui datagrid rowediting使用心得 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/5ff0df8ed866e6aae440701a261e8bf2/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="easyui datagrid rowediting使用心得">
  <meta property="og:description" content="前不久使用了easyui的tree，现如今换了项目组，居然整个页面都是使用easyui的，而今我写的模块需要rowediting，有了easyui-tree的使用，我多少对easyui有了一定的了解，在使用rowediting的时候也算的上是熟路，但是奈何框架是封装的框架，有好多规则需要遵守，最后无奈的发现我不是轻车了，可谓之“重车熟路”。
言归正传，使用easyui，必须要把其需要的js、css都准备好了，这个就不多说了，需要的官网上下载。在官网上给的demo中已经有的基本使用的发放了。调用方式如下代码：
&amp;lt;!DOCTYPE html&amp;gt; &amp;lt;html&amp;gt; &amp;lt;head&amp;gt; &amp;lt;meta charset=&#34;UTF-8&#34;&amp;gt; &amp;lt;title&amp;gt;Row Editing in DataGrid - jQuery EasyUI Demo&amp;lt;/title&amp;gt; &amp;lt;link rel=&#34;stylesheet&#34; type=&#34;text/css&#34; href=&#34;../../themes/default/easyui.css&#34;&amp;gt; &amp;lt;link rel=&#34;stylesheet&#34; type=&#34;text/css&#34; href=&#34;../../themes/icon.css&#34;&amp;gt; &amp;lt;link rel=&#34;stylesheet&#34; type=&#34;text/css&#34; href=&#34;../demo.css&#34;&amp;gt; &amp;lt;script type=&#34;text/javascript&#34; src=&#34;../../jquery.min.js&#34;&amp;gt;&amp;lt;/script&amp;gt; &amp;lt;script type=&#34;text/javascript&#34; src=&#34;../../jquery.easyui.min.js&#34;&amp;gt;&amp;lt;/script&amp;gt; &amp;lt;/head&amp;gt; &amp;lt;body&amp;gt; &amp;lt;h2&amp;gt;Row Editing in DataGrid&amp;lt;/h2&amp;gt; &amp;lt;div class=&#34;demo-info&#34;&amp;gt; &amp;lt;div class=&#34;demo-tip icon-tip&#34;&amp;gt;&amp;lt;/div&amp;gt; &amp;lt;div&amp;gt;Click the row to start editing.&amp;lt;/div&amp;gt; &amp;lt;/div&amp;gt; &amp;lt;div style=&#34;margin:10px 0;&#34;&amp;gt;&amp;lt;/div&amp;gt; &amp;lt;table id=&#34;dg&#34; class=&#34;easyui-datagrid&#34; title=&#34;Row Editing in DataGrid&#34; style=&#34;width:700px;height:auto&#34; data-options=&#34; iconCls: &#39;icon-edit&#39;, singleSelect: true, toolbar: &#39;#tb&#39;, url: &#39;datagrid_data1.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2014-05-13T16:13:37+08:00">
    <meta property="article:modified_time" content="2014-05-13T16:13:37+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">easyui datagrid rowediting使用心得</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="font-size:18px"><span style="white-space:pre"></span>前不久使用了easyui的tree，现如今换了项目组，居然整个页面都是使用easyui的，而今我写的模块需要rowediting，有了easyui-tree的使用，我多少对easyui有了一定的了解，在使用rowediting的时候也算的上是熟路，但是奈何框架是封装的框架，有好多规则需要遵守，最后无奈的发现我不是轻车了，可谓之“重车熟路”。</span></p> 
<p><span style="font-size:18px"><span style="white-space:pre"></span>言归正传，使用easyui，必须要把其需要的js、css都准备好了，这个就不多说了，需要的<a target="_blank" href="http://www.jeasyui.com/" rel="nofollow noopener noreferrer">官网</a>上下载。在官网上给的demo中已经有的基本使用的发放了。调用方式如下代码：</span></p> 
<p><span style="font-size:18px"></span></p> 
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
	&lt;meta charset="UTF-8"&gt;
	&lt;title&gt;Row Editing in DataGrid - jQuery EasyUI Demo&lt;/title&gt;
	&lt;link rel="stylesheet" type="text/css" href="../../themes/default/easyui.css"&gt;
	&lt;link rel="stylesheet" type="text/css" href="../../themes/icon.css"&gt;
	&lt;link rel="stylesheet" type="text/css" href="../demo.css"&gt;
	&lt;script type="text/javascript" src="../../jquery.min.js"&gt;&lt;/script&gt;
	&lt;script type="text/javascript" src="../../jquery.easyui.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;h2&gt;Row Editing in DataGrid&lt;/h2&gt;
	&lt;div class="demo-info"&gt;
		&lt;div class="demo-tip icon-tip"&gt;&lt;/div&gt;
		&lt;div&gt;Click the row to start editing.&lt;/div&gt;
	&lt;/div&gt;
	&lt;div style="margin:10px 0;"&gt;&lt;/div&gt;
	
	&lt;table id="dg" class="easyui-datagrid" title="Row Editing in DataGrid" style="width:700px;height:auto"
			data-options="
				iconCls: 'icon-edit',
				singleSelect: true,
				toolbar: '#tb',
				url: 'datagrid_data1.json',
				method: 'get',
				onClickRow: onClickRow
			"&gt;
		&lt;thead&gt;
			&lt;tr&gt;
				&lt;th data-options="field:'itemid',width:80"&gt;Item ID&lt;/th&gt;
				&lt;th data-options="field:'productid',width:100,
						formatter:function(value,row){
							return row.productname;
						},
						editor:{
							type:'combobox',
							options:{
								valueField:'productid',
								textField:'productname',
								url:'products.json',
								required:true
							}
						}"&gt;Product&lt;/th&gt;
				&lt;th data-options="field:'listprice',width:80,align:'right',editor:{type:'numberbox',options:{precision:1}}"&gt;List Price&lt;/th&gt;
				&lt;th data-options="field:'unitcost',width:80,align:'right',editor:'numberbox'"&gt;Unit Cost&lt;/th&gt;
				&lt;th data-options="field:'attr1',width:250,editor:'text'"&gt;Attribute&lt;/th&gt;
				&lt;th data-options="field:'status',width:60,align:'center',editor:{type:'checkbox',options:{on:'P',off:''}}"&gt;Status&lt;/th&gt;
			&lt;/tr&gt;
		&lt;/thead&gt;
	&lt;/table&gt;

	&lt;div id="tb" style="height:auto"&gt;
		&lt;a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-add',plain:true" οnclick="append()"&gt;Append&lt;/a&gt;
		&lt;a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-remove',plain:true" οnclick="removeit()"&gt;Remove&lt;/a&gt;
		&lt;a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-save',plain:true" οnclick="accept()"&gt;Accept&lt;/a&gt;
		&lt;a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-undo',plain:true" οnclick="reject()"&gt;Reject&lt;/a&gt;
		&lt;a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-search',plain:true" οnclick="getChanges()"&gt;GetChanges&lt;/a&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>至于工具栏的操作方式的js有很多种，其中我看着比较好的一种多行多种操作后同时提交的方法，这个是在网上查到的，具体地址找不到了，我就把代码贴下： 
<p></p> 
<p><span style="font-size:18px"></span></p> 
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Row Editing in DataGrid - jQuery EasyUI Demo&lt;/title&gt;
    &lt;link rel="stylesheet" type="text/css" href="../../themes/default/easyui.css"&gt;
    &lt;link rel="stylesheet" type="text/css" href="../../themes/icon.css"&gt;
    &lt;link rel="stylesheet" type="text/css" href="../demo.css"&gt;
    &lt;script type="text/javascript" src="../../jquery.min.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="../../jquery.easyui.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h2&gt;Row Editing in DataGrid&lt;/h2&gt;
&lt;script type="text/javascript"&gt;
    $(function () {
        var $dg = $("#dg");
        $dg.datagrid({
            url: "data.json",
            width: 700,
            height: 250,
            columns: [
                [
                    {
                        field: 'code',
                        title: 'Code',
                        width: 100,
                        editor: "validatebox"
                    },
                    {
                        field: 'name',
                        title: 'Name',
                        width: 200,
                        editor: "validatebox"
                    },
                    {
                        field: 'price',
                        title: 'Price',
                        width: 200,
                        align: 'right',
                        editor: "numberbox"
                    }
                ]
            ],
            toolbar: [
                {
                    text: "添加",
                    iconCls: "icon-add",
                    handler: function () {
                        $dg.datagrid('appendRow', {});
                        var rows = $dg.datagrid('getRows');
                        $dg.datagrid('beginEdit', rows.length - 1);
                    }
                },
                {
                    text: "编辑",
                    iconCls: "icon-edit",
                    handler: function () {
                        var row = $dg.datagrid('getSelected');
                        if (row) {
                            var rowIndex = $dg.datagrid('getRowIndex', row);
                            $dg.datagrid('beginEdit', rowIndex);
                        }
                    }
                },
                {
                    text: "删除",
                    iconCls: "icon-remove",
                    handler: function () {
                        var row = $dg.datagrid('getSelected');
                        if (row) {
                            var rowIndex = $dg.datagrid('getRowIndex', row);
                            $dg.datagrid('deleteRow', rowIndex);
                        }
                    }
                },
                {
                    text: "结束编辑",
                    iconCls: "icon-cancel",
                    handler: endEdit
                },
                {
                    text: "保存",
                    iconCls: "icon-save",
                    handler: function () {
                        endEdit();
                        if ($dg.datagrid('getChanges').length) {
                            //获得增加数据
                            var inserted = $dg.datagrid('getChanges', "inserted");
                            //获得删除数据
                            var deleted = $dg.datagrid('getChanges', "deleted");
                            //获得修改数据
                            var updated = $dg.datagrid('getChanges', "updated");

                            var effectRow = new Object();
                            if (inserted.length) {
                                effectRow["inserted"] = JSON.stringify(inserted);
                                alert("insert:" + JSON.stringify(inserted));
                            }
                            if (deleted.length) {
                                effectRow["deleted"] = JSON.stringify(deleted);
                                alert("delete:" + JSON.stringify(deleted));
                            }
                            if (updated.length) {
                                effectRow["updated"] = JSON.stringify(updated);
                                alert("update:" + JSON.stringify(deleted));
                            }

                            $.post("servlet/commit", effectRow,function (rsp) {
                                if (rsp.status) {
                                    $.messager.alert("提示", "提交成功！");
                                    $dg.datagrid('acceptChanges');
                                }
                            }, "JSON").error(function () {
                                        $.messager.alert("提示", "提交错误了！");
                                    });
                        }
                    }
                }
            ]
        });

        function endEdit() {
            var rows = $dg.datagrid('getRows');
            for (var i = 0; i &lt; rows.length; i++) {
                $dg.datagrid('endEdit', i);
            }
        }
    });
&lt;/script&gt;
&lt;table id="dg" title="批量操作"&gt;&lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<br> 以上是html和js代码，下来我大体的说下后台获取方式： 
<p></p> 
<p><span style="font-size:18px"></span></p> 
<pre><code class="language-java">以增加为例:
//设置请求编码
req.setCharacterEncoding("UTF-8");
//获取json字符串
String inserted = req.getParameter("inserted");
if(inserted != null){
	//把json字符串转换成对象
	List&lt;Bean&gt; listInserted = JSON.parseArray(inserted, Bean.class);
       //TODO 你的操作。。。。。。

}


//bean,抽象前台数据为对象，

public class Bean {
	private String code;
	private String name;
	private Double price;
	.....set get 方法省略
}</code></pre> 
<br> 这个应该可以看懂吧，如果有不懂的地方可以留言。这个是一种很好很快捷的提交数据方式。但是我由于一些特殊原因没法使用，所以下面我发下我的提交数据方式： 
<p></p> 
<p><span style="font-size:18px"></span></p> 
<pre><code class="language-html">function update() {
		$('#dg').datagrid('beginEdit', editIndex);
	}
	function removeit() {
		if (editIndex == undefined) {return}
		var obj = $('#dg').datagrid('getRows')[editIndex];
		var id = obj["id"];
		if(id!=null&amp;&amp;id!=""){
		 $.messager.confirm("操作提示", "您确定要执行删除该属性吗？", function () {
				$('#dg').datagrid('deleteRow', editIndex);
				$('#classActionForm')
						.form(
								'submit',
								{
									url : 'deleteActionClass.cncc?id=' + id,
									onSubmit : function() {
										if ($(this).form("validate")) {
										} else {
											return false;
										}
									},
									success : function(data) {
										var temp = eval('(' + data + ')'); // change the JSON string to javascript object  
										if (temp.success) {
											$.messager.alert('提示', "操作成功", 'info');
											$("#dg")
													.datagrid(
															{
																iconCls : 'icon-edit',
																singleSelect : true,
																toolbar : '#tb',
																url : 'getActionList.cncc?type=${fiatclass.name }&amp;randnum='+Math.floor(Math.random()*1000000),
																loadMsg : '数据加载中请稍后……',
																method : 'get',
																onClickRow : onClickRow
															});
											//$("#dg").datagrid('reload');//重新加载
										} else {
											$.messager.alert("提示", "操作失败，失败原因："
													+ temp.msg);
										}
									}
								});
				editIndex = undefined;
			 });
		}else{
			 $('#dg').datagrid('rejectChanges');
				editIndex = undefined;
		 }
		
	}
	function accept() {
		$('#dg').datagrid('acceptChanges');
		var obj = $('#dg').datagrid('getRows')[editIndex];
		var actionName = obj["actionName"];
		var actionRemark = obj["actionRemark"];
		var id = obj["id"];
		var displayed = obj["displayed"];
		/*if (displayed == "是") {
			displayed = 1;
		} else {
			displayed = 0;
		}*/
		var used = obj["used"];
		/*if (used == "是") {
			used = 1;
		} else {
			used = 0;
		}*/
		$('#classActionForm')
				.form(
						'submit',
						{
							url : 'saveClassAction.cncc?id='
									+ id
									+ "&amp;actionName="
									+ actionName
									+ "&amp;actionRemark="
									+ actionRemark
									+ "&amp;displayed="
									+ displayed
									+ "&amp;used="
									+ used
									+ "&amp;classid=${fiatclass.id }&amp;classname=${fiatclass.name }",
							onSubmit : function() {
								if ($(this).form("validate")) {
								} else {
									return false;
								}
							},
							success : function(data) {
								var temp = eval('(' + data + ')'); // change the JSON string to javascript object  
								if (temp.success) {
									$.messager.alert('提示', "操作成功", 'info');
									$("#dg")
											.datagrid(
													{
														iconCls : 'icon-edit',
														singleSelect : true,
														toolbar : '#tb',
														url : 'getActionList.cncc?type=${fiatclass.name }&amp;randnum='+Math.floor(Math.random()*1000000),
														loadMsg : '数据加载中请稍后……',
														method : 'get',
														onClickRow : onClickRow
													});
									//$("#dg").datagrid('reload');//重新加载
								} else {
									$.messager.alert("提示", "操作失败，失败原因："
											+ temp.msg);
									$("#f-submit").linkbutton("enable");
									$("#f-cancel").linkbutton("enable");
								}
							}
						});
	}
	function reject() {
		$('#dg').datagrid('rejectChanges');
		editIndex = undefined;
	}</code></pre> 
<br> 以上是我的提交数据的方式，我采用的方式单行数据提交，也就是每次新增或修改或删除都进行一次提交。至于后台获取数据的方式大家应该都知道，不过这里我多一句嘴：request.getParameter("name")来获取。 
<p></p> 
<p><span style="font-size:18px"><span style="white-space:pre"></span>到了这里本来可以结束了，不过想到一个问题，在这个表单中，我们还是会遇到一个小问题，我在这里也说下。关于列表中的ID这一列数据，为了数据安全或者是没有展示的必要性，我们都不需要此列，但是修改的时候这个id值就是必不可少的一个东西，所以我们需要做到的是它即存在，又不可见，也就是隐藏起来，又啰嗦了，直接粘方法吧：</span></p> 
<pre><code class="language-html">$(function(){
		$("#dg").datagrid({    	
		onLoadSuccess:function(){
	  	 	$('#dg').datagrid("hideColumn","id");      
//$('#dg').datagrid("showColumn","id");   
	   	}});
	});</code></pre>其中hideColumn是隐藏方法，showColumn是将隐藏的展示出来，id是所隐藏的列。 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6352888e66ea0cf48c7deed48bb5aca9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43; 指针与作用域</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5e53894a8a6c2c4b37a563fe2cbe44d7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">simulink的相关东西</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>