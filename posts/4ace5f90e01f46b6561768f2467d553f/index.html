<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Pandas】Dataframe - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/4ace5f90e01f46b6561768f2467d553f/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="【Pandas】Dataframe">
  <meta property="og:description" content="文章目录 1. 基本概念及创建1.1 DataFrame简介1.2 创建 Dataframe(1) 方法一：由数组/list组成的字典(2) 方法二：由Series组成的字典(3) 方法三：通过二维数组直接创建(4) 方法四：由字典组成的列表(5) 方法五：由字典组成的字典 2. Dataframe 索引2.1 选择行与列(1) 直接访问：***只能访问列***(2) df.loc[]函数：按行列名取数(3) df.iloc[]函数：按下标数字取数(4) df.ix[]函数(5) 布尔型索引(6) 多重索引--- 判断返回类型是Series还是Dataframe小技巧 3. 基本技巧3.1 查看收尾n行、转置3.2 添加与修改3.3 删除3.4 对齐3.5 排序1 - 按值排序 .sort_values3.6 排序2 - 索引排序 .sort_index 4. 数值计算和统计基础1.基本参数：axis、skipna2.主要数学计算方法，可用于Series和DataFrame（1）3.主要数学计算方法，可用于Series和DataFrame（2）4.唯一值：.unique()5.值计数：.value_counts()6.成员资格：.isin() 5. 文本数据1.通过str访问，且自动排除丢失/ NA值2.字符串常用方法（1） - lower，upper，len，startswith，endswith3.字符串常用方法（2） - strip4.字符串常用方法（3） - replace5.字符串常用方法（4） - split、rsplit6.字符串索引7.一个值得学习的小例子 1. 基本概念及创建 1.1 DataFrame简介 Dataframe是一个表格型的数据结构，带有index（行标签） 和 columns（列标签） 的 二维数组DataFrame的每一列的数据类型相同，相当于一个Series,列名就是Series.nameimport pandas as pd import numpy as np data = { &#39;name&#39;: [&#39;Mary&#39;, &#39;Jack&#39;], &#39;age&#39;: [12, 18], &#39;sex&#39;: [&#39;女&#39;, &#39;男&#39;] } frame = pd.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-15T16:07:46+08:00">
    <meta property="article:modified_time" content="2023-09-15T16:07:46+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Pandas】Dataframe</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1__1" rel="nofollow">1. 基本概念及创建</a></li><li><ul><li><a href="#11_DataFrame_2" rel="nofollow">1.1 DataFrame简介</a></li><li><a href="#12__Dataframe_35" rel="nofollow">1.2 创建 Dataframe</a></li><li><ul><li><a href="#1_list_36" rel="nofollow">(1) 方法一：由数组/list组成的字典</a></li><li><a href="#2_Series_60" rel="nofollow">(2) 方法二：由Series组成的字典</a></li><li><a href="#3__83" rel="nofollow">(3) 方法三：通过二维数组直接创建</a></li><li><a href="#4__92" rel="nofollow">(4) 方法四：由字典组成的列表</a></li><li><a href="#5__100" rel="nofollow">(5) 方法五：由字典组成的字典</a></li></ul> 
  </li></ul> 
  </li><li><a href="#2_Dataframe__111" rel="nofollow">2. Dataframe 索引</a></li><li><ul><li><a href="#21__112" rel="nofollow">2.1 选择行与列</a></li><li><ul><li><a href="#1_font_colorbluefont_113" rel="nofollow">(1) 直接访问：<font color="blue">***只能访问列***</font></a></li><li><a href="#2_dfloc_132" rel="nofollow">(2) df.loc[]函数：按行列名取数</a></li><li><a href="#3_dfiloc_172" rel="nofollow">(3) df.iloc[]函数：按下标数字取数</a></li><li><a href="#4_dfix_206" rel="nofollow">(4) df.ix[]函数</a></li><li><a href="#5__239" rel="nofollow">(5) 布尔型索引</a></li><li><a href="#6__305" rel="nofollow">(6) 多重索引</a></li><li><a href="#_SeriesDataframe_329" rel="nofollow">--- 判断返回类型是Series还是Dataframe小技巧</a></li></ul> 
  </li></ul> 
  </li><li><a href="#3__332" rel="nofollow">3. 基本技巧</a></li><li><ul><li><ul><li><a href="#31_n_333" rel="nofollow">3.1 查看收尾n行、转置</a></li><li><a href="#32__366" rel="nofollow">3.2 添加与修改</a></li><li><a href="#33__402" rel="nofollow">3.3 删除</a></li><li><a href="#34__417" rel="nofollow">3.4 对齐</a></li><li><a href="#35_1___sort_values_437" rel="nofollow">3.5 排序1 - 按值排序 .sort_values</a></li><li><a href="#36_2___sort_index_469" rel="nofollow">3.6 排序2 - 索引排序 .sort_index</a></li></ul> 
  </li></ul> 
  </li><li><a href="#4__508" rel="nofollow">4. 数值计算和统计基础</a></li><li><ul><li><ul><li><ul><li><ul><li><a href="#1axisskipna_509" rel="nofollow">1.基本参数：axis、skipna</a></li><li><a href="#2SeriesDataFrame1_550" rel="nofollow">2.主要数学计算方法，可用于Series和DataFrame（1）</a></li><li><a href="#3SeriesDataFrame2_620" rel="nofollow">3.主要数学计算方法，可用于Series和DataFrame（2）</a></li><li><a href="#4unique_665" rel="nofollow">4.唯一值：.unique()</a></li><li><a href="#5value_counts_682" rel="nofollow">5.值计数：.value_counts()</a></li><li><a href="#6isin_695" rel="nofollow">6.成员资格：.isin()</a></li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#5__732" rel="nofollow">5. 文本数据</a></li><li><ul><li><ul><li><ul><li><ul><li><a href="#1str_NA_734" rel="nofollow">1.通过str访问，且自动排除丢失/ NA值</a></li><li><a href="#21__lowerupperlenstartswithendswith_798" rel="nofollow">2.字符串常用方法（1） - lower，upper，len，startswith，endswith</a></li><li><a href="#32__strip_844" rel="nofollow">3.字符串常用方法（2） - strip</a></li><li><a href="#43__replace_890" rel="nofollow">4.字符串常用方法（3） - replace</a></li><li><a href="#54__splitrsplit_910" rel="nofollow">5.字符串常用方法（4） - split、rsplit</a></li><li><a href="#6_967" rel="nofollow">6.字符串索引</a></li><li><a href="#7_1002" rel="nofollow">7.一个值得学习的小例子</a></li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1__1"></a>1. 基本概念及创建</h2> 
<h3><a id="11_DataFrame_2"></a>1.1 DataFrame简介</h3> 
<ol><li>Dataframe是一个表格型的数据结构，带有<strong>index（行标签）</strong> 和 <strong>columns（列标签）</strong> 的 <strong>二维数组</strong></li><li>DataFrame的每一列的数据类型相同，相当于一个Series,列名就是Series.name<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Mary'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'sex'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>frame<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>index<span class="token punctuation">)</span>  <span class="token comment"># 行标签</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>columns<span class="token punctuation">)</span> <span class="token comment"># 列标签</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>values<span class="token punctuation">)</span>  <span class="token comment"># 查看值，为二维数组</span>
</code></pre> </li><li>修改行/列标签：<em><strong>column只是改变已有的列顺序，不能改变成设置的列，但是index可以</strong></em><pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Mary'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token string">'sex'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment"># 1. 在创建时修改</span>
frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 修改行标签，可以重新赋值</span>
frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> columns <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 修改列标签顺序，以及选择哪些列生成数据，也就是新列标签元素个数可以小于原列标签元素个数</span>
<span class="token comment"># 2. 创建后修改</span>
frame<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span> <span class="token comment"># 修改行标签，可以重新赋值</span>
frame<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span> <span class="token comment"># 修改行标签，只能修改顺序, 且 新列标签元素个数必须等于原列标签元素个数</span>
</code></pre> </li></ol> 
<h3><a id="12__Dataframe_35"></a>1.2 创建 Dataframe</h3> 
<h4><a id="1_list_36"></a>(1) 方法一：由数组/list组成的字典</h4> 
<ol><li> <p>由数组/list组成的字典 创建Dataframe，columns为字典key，index为默认数字标签</p> <pre><code class="prism language-python">data1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Mary'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'sex'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
frame1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>frame1<span class="token punctuation">)</span>
</code></pre> <p><img src="https://images2.imgbox.com/c2/3f/IGexLvSm_o.png" alt="在这里插入图片描述"></p> </li><li> <p>所有的数组/list <font color="red"><strong>长度必须保持一致</strong></font>，否则会报错</p> <pre><code class="prism language-python">data2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'one'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>     
    <span class="token string">'tow'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>   
frame2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>frame2<span class="token punctuation">)</span>  <span class="token comment"># 报错</span>
</code></pre> </li></ol> 
<h4><a id="2_Series_60"></a>(2) 方法二：由Series组成的字典</h4> 
<ol><li> <p>由Seris组成的字典 创建Dataframe，columns为字典key，index为Series的标签（如果Series没有指定标签，则是默认数字标签）</p> <pre><code class="prism language-python">data1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">'one'</span><span class="token punctuation">:</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token string">'two'</span><span class="token punctuation">:</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>  
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span>
</code></pre> <p><img src="https://images2.imgbox.com/6a/13/bD5q8kvK_o.png" alt="在这里插入图片描述"></p> </li><li> <p>所有的Series <font color="red"><strong>长度可以不一致</strong></font></p> <pre><code class="prism language-python">data2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">'one'</span><span class="token punctuation">:</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token string">'two'</span><span class="token punctuation">:</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df2<span class="token punctuation">)</span>
</code></pre> <p><img src="https://images2.imgbox.com/0f/85/c6KPDOkw_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<h4><a id="3__83"></a>(3) 方法三：通过二维数组直接创建</h4> 
<pre><code class="prism language-python">arr <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'c1'</span><span class="token punctuation">,</span> <span class="token string">'c2'</span><span class="token punctuation">,</span> <span class="token string">'c3'</span><span class="token punctuation">,</span> <span class="token string">'c4'</span><span class="token punctuation">,</span> <span class="token string">'c5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># column的元素个数必须与二维数组列数相同</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/51/29/LwfEMQfu_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="4__92"></a>(4) 方法四：由字典组成的列表</h4> 
<pre><code class="prism language-python">d <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'one'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'one'</span><span class="token punctuation">:</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">:</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">]</span>  <span class="token comment"># 列表中的每一个字典，相当于一行</span>
f <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>d<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8b/28/FV9yPJuR_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="5__100"></a>(5) 方法五：由字典组成的字典</h4> 
<pre><code class="prism language-python">data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token string">'Jack'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token string">'Mary'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'sex'</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>     <span class="token comment"># 相当于指定行标签</span>
f <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/04/bf/ZtjIgWNS_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="2_Dataframe__111"></a>2. Dataframe 索引</h2> 
<h3><a id="21__112"></a>2.1 选择行与列</h3> 
<h4><a id="1_font_colorbluefont_113"></a>(1) 直接访问：<font color="blue"><em><strong>只能访问列</strong></em></font></h4> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                   index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df

<span class="token comment"># 1. 访问一列：</span>
<span class="token comment"># 返回Series：</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>a<span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 返回Dataframe：</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 2. 访问多列</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 返回Dataframe</span>
</code></pre> 
<h4><a id="2_dfloc_132"></a>(2) df.loc[]函数：按行列名取数</h4> 
<blockquote> 
 <p>注意：</p> 
 <ol><li><mark><code>loc[]</code>切片函数，左边是行切片，表示从哪一行到哪一行；右边是列切片，表示从哪一列到哪一列。</mark></li><li>关于返回的数据类型： 
   <ol><li>返回<code>Series</code>类型，在切片位置传入一个列/行名，比如<code>df.loc[: 'column_name']</code></li><li>返回<code>Dataframe</code>类型，在切片位置传入带列/列名的列表，比如<code>df.loc[:, ['column_name']]</code></li></ol> </li><li>关于df有无行列标签： 
   <ol><li>有行列名时，可通过行列名访问。比如：<code>df.loc['one':'three', ['a']]</code></li><li>没有行列名时，行名/列名都是从0开始编号，所以此时行名/列名都是数字，可通过数字访问。比如：<code>df.loc[:, 2:3]</code></li></ol> </li></ol> 
</blockquote> 
<ol><li> <p>列：</p> <pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                   index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df

<span class="token comment"># 1. 访问一列：</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment"># 返回 Series</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 返回 Dataframe</span>

<span class="token comment"># 2. 访问多列</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 等价于 print(df.loc['one':'three', ['a', 'c']])  # 选择不相邻的列</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 当多列相邻时，可用切片简化</span>
</code></pre> </li><li> <p>行：</p> <pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                  index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df

<span class="token comment"># 1. 访问单行</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token comment"># 2. 访问多行</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> 
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">:</span><span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>   <span class="token comment"># 当多行相邻时，可用切片简化</span>
</code></pre> </li></ol> 
<h4><a id="3_dfiloc_172"></a>(3) df.iloc[]函数：按下标数字取数</h4> 
<p><code>df.iloc[]函数</code> 与 <code>df.loc[]函数</code> 基本一样，只是前者是通过下标访问：<br> 需要注意：<code>df.iloc[]函数</code>获取的列，是左闭右开；<code>df.loc[]函数</code> 获取的列是左闭右闭。</p> 
<ol><li>列：<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                   index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df

<span class="token comment"># 1. 访问一列：</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 返回 Series</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 返回 DataFrame</span>

<span class="token comment"># 2. 访问多列</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment"># 当多列相邻时，可用切片简化</span>
</code></pre> </li><li>行：只能切片访问<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                  index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df

<span class="token comment"># 1. 访问单行</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># 返回 Series</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># 返回 Series</span>

<span class="token comment"># 2. 访问多行</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> 
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>   <span class="token comment"># 当多列相邻时，可用切片简化</span>
</code></pre> </li></ol> 
<h4><a id="4_dfix_206"></a>(4) df.ix[]函数</h4> 
<table><thead><tr><th>df.loc[]</th><th>[]  左闭右闭</th><th>行标签/列标签</th></tr></thead><tbody><tr><td>df.iloc[]</td><td>[)  左闭右开</td><td>数字索引</td></tr><tr><td>df.ix[]</td><td>数字是[) 行/列标签是[]</td><td>具有上面的两种功能：数字索引、行/列标签</td></tr></tbody></table> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                   index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>ix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 结果：</span>
               a          b          c          d
one    <span class="token number">63.666351</span>  <span class="token number">61.163233</span>  <span class="token number">31.822639</span>  <span class="token number">78.653631</span>
two    <span class="token number">49.693777</span>  <span class="token number">52.420641</span>  <span class="token number">42.267130</span>  <span class="token number">53.031000</span>
three  <span class="token number">44.693220</span>  <span class="token number">16.741017</span>  <span class="token number">11.834082</span>  <span class="token number">97.288596</span>
               a          c
one    <span class="token number">63.666351</span>  <span class="token number">31.822639</span>
two    <span class="token number">49.693777</span>  <span class="token number">42.267130</span>
three  <span class="token number">44.693220</span>  <span class="token number">11.834082</span>
             b          c
one  <span class="token number">61.163233</span>  <span class="token number">31.822639</span>
two  <span class="token number">52.420641</span>  <span class="token number">42.267130</span>
             a          c
one  <span class="token number">63.666351</span>  <span class="token number">31.822639</span>
two  <span class="token number">49.693777</span>  <span class="token number">42.267130</span>
</code></pre> 
<hr> 
<h4><a id="5__239"></a>(5) 布尔型索引</h4> 
<ol><li> <p>布尔类型的行列共用</p> <pre><code class="prism language-python"><span class="token comment"># 和Series原理相同</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                   index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">,</span><span class="token string">'four'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token operator">&gt;</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token operator">&gt;</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 传入每个指的布尔值</span>

<span class="token comment"># 结果：</span>
               a          b          c          d
one    <span class="token number">17.212809</span>  <span class="token number">74.314714</span>  <span class="token number">10.156837</span>  <span class="token number">72.622754</span>
two    <span class="token number">88.294727</span>  <span class="token number">48.804259</span>  <span class="token number">31.103894</span>  <span class="token number">20.837973</span>
three  <span class="token number">95.101094</span>  <span class="token number">34.875227</span>  <span class="token number">78.032575</span>  <span class="token number">93.951124</span>
four   <span class="token number">94.727082</span>  <span class="token number">43.795659</span>  <span class="token number">86.518682</span>  <span class="token number">90.068478</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
           a      b      c      d
one    <span class="token boolean">False</span>   <span class="token boolean">True</span>  <span class="token boolean">False</span>   <span class="token boolean">True</span>
two     <span class="token boolean">True</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>
three   <span class="token boolean">True</span>  <span class="token boolean">False</span>   <span class="token boolean">True</span>   <span class="token boolean">True</span>
four    <span class="token boolean">True</span>  <span class="token boolean">False</span>   <span class="token boolean">True</span>   <span class="token boolean">True</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
               a          b          c          d
one          NaN  <span class="token number">74.314714</span>        NaN  <span class="token number">72.622754</span>
two    <span class="token number">88.294727</span>        NaN        NaN        NaN
three  <span class="token number">95.101094</span>        NaN  <span class="token number">78.032575</span>  <span class="token number">93.951124</span>
four   <span class="token number">94.727082</span>        NaN  <span class="token number">86.518682</span>  <span class="token number">90.068478</span>
</code></pre> </li><li> <p>布尔类型的行与列</p> <pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">'key1'</span><span class="token punctuation">:</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'key2'</span><span class="token punctuation">:</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'abcde'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------'</span><span class="token punctuation">)</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">:</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">:</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">:</span><span class="token boolean">False</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">)</span>

s2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'key1'</span><span class="token punctuation">:</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">'key2'</span><span class="token punctuation">:</span><span class="token boolean">False</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">[</span>s2<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 结果：</span>
   key1  key2
a     <span class="token number">0</span>     <span class="token number">5</span>
b     <span class="token number">1</span>     <span class="token number">6</span>
c     <span class="token number">2</span>     <span class="token number">7</span>
d     <span class="token number">3</span>     <span class="token number">8</span>
e     <span class="token number">4</span>     <span class="token number">9</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
   key1  key2
a     <span class="token number">0</span>     <span class="token number">5</span>
c     <span class="token number">2</span>     <span class="token number">7</span>
key1     <span class="token boolean">True</span>
key2    <span class="token boolean">False</span>
dtype<span class="token punctuation">:</span> <span class="token builtin">bool</span>
Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span>
</code></pre> </li></ol> 
<h4><a id="6__305"></a>(6) 多重索引</h4> 
<pre><code class="prism language-python"><span class="token comment"># 多重索引：比如同时索引行和列</span>
<span class="token comment"># 先选择列再选择行 —— 相当于对于一个数据，先筛选字段，再选择数据量</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                   index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">,</span><span class="token string">'four'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment"># 选择a列的one，three行</span>

<span class="token comment"># 结果：</span>
               a          b          c          d
one    <span class="token number">73.315488</span>  <span class="token number">34.853760</span>  <span class="token number">22.059922</span>  <span class="token number">44.274220</span>
two     <span class="token number">7.484602</span>  <span class="token number">22.595569</span>  <span class="token number">32.362358</span>  <span class="token number">26.621247</span>
three  <span class="token number">21.273322</span>  <span class="token number">16.585421</span>  <span class="token number">48.346943</span>  <span class="token number">49.811086</span>
four   <span class="token number">79.518511</span>   <span class="token number">4.416195</span>  <span class="token number">29.054869</span>  <span class="token number">76.588620</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
one      <span class="token number">73.315488</span>
three    <span class="token number">21.273322</span>
Name<span class="token punctuation">:</span> a<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> float64
</code></pre> 
<h4><a id="_SeriesDataframe_329"></a>— 判断返回类型是Series还是Dataframe小技巧</h4> 
<ul><li><font color="blue" size="4"><em><strong>看<code>df</code>后面有几层<code>[]</code>括号，一层就是<code>Series</code>，二层就是<code>Dataframe</code></strong></em></font></li></ul> 
<h2><a id="3__332"></a>3. 基本技巧</h2> 
<h4><a id="31_n_333"></a>3.1 查看收尾n行、转置</h4> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token comment"># .head()查看头部数据,不带参数默认是5行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  

<span class="token comment"># .tail()查看尾部数据,不带参数默认是5行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  

<span class="token comment"># 转置</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
</code></pre> 
<pre><code># 结果：
          a         b
0  0.178140  0.626120
1  0.875550  0.106871
2  0.051926  0.959511
3  0.770076  0.005052
4  0.846975  0.292112
         a         b
0  0.17814  0.626120
1  0.87555  0.106871
          a         b
3  0.770076  0.005052
4  0.846975  0.292112
         0         1         2         3         4
a  0.17814  0.875550  0.051926  0.770076  0.846975
b  0.62612  0.106871  0.959511  0.005052  0.292112
</code></pre> 
<h4><a id="32__366"></a>3.2 添加与修改</h4> 
<ol><li>先获取Series，再用loc[]获取元素，最后直接修改元素即可</li><li>直接添加一列或者一行</li></ol> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'abcde'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token comment"># 修改元素值：</span>
df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token comment"># 添加元素值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'添加-------'</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">300</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<pre><code># 结果：
    a   b   c   d   e
0   0   1   2   3   4
1   5   6   7   8   9
2  10  11  12  13  14
3  15  16  17  18  19
     a   b   c   d   e
0  100   1   2   3   4
1    5   6   7   8   9
2   10  11  12  13  14
3   15  16  17  18  19
添加-------
     a   b   c   d   e    f
0  100   1   2   3   4  300
1    5   6   7   8   9  300
2   10  11  12  13  14  300
3   15  16  17  18  19  300
</code></pre> 
<h4><a id="33__402"></a>3.3 删除</h4> 
<pre><code class="prism language-python">f <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'abcde'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token comment"># drop()语句删除列, 需要指定 axis = 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'e'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># inplace=False → 删除后生成新的数据，不改变原数据</span>

<span class="token comment"># drop()删除行，不需要指定 axis = 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># inplace=False → 删除后生成新的数据，不改变原数据</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/38/ca/rkqDmSGd_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="34__417"></a>3.4 对齐</h4> 
<pre><code class="prism language-python">df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1 <span class="token operator">+</span> df2<span class="token punctuation">)</span>
<span class="token comment"># DataFrame对象之间的数据自动按照列和索引（行标签）对齐</span>
</code></pre> 
<pre><code># 结果：
          A         B         C   D
0 -0.286501  0.101564  0.934023 NaN
1  0.002405 -0.674116 -1.688925 NaN
2 -1.374691  0.188597  0.161464 NaN
3 -1.209863 -1.844409 -0.591461 NaN
4 -2.605153 -1.473555  1.891570 NaN
5  2.782283  1.193310 -1.139518 NaN
6  1.494297  1.553604  3.075171 NaN
7       NaN       NaN       NaN NaN
8       NaN       NaN       NaN NaN
9       NaN       NaN       NaN NaN
</code></pre> 
<h4><a id="35_1___sort_values_437"></a>3.5 排序1 - 按值排序 .sort_values</h4> 
<pre><code class="prism language-python"><span class="token comment"># 同样适用于Series</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                 columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token comment"># 单列排序</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># ascending参数：设置升序降序，默认升序</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'多列排序------'</span><span class="token punctuation">)</span>
<span class="token comment"># 多列排序，按列顺序排序</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 先按a排序，如果a的值相同，则按d的值排序</span>
</code></pre> 
<pre><code># 结果：
           a          b          c          d
0  36.300085  90.999611  87.883077  39.251081
1  16.769310  99.653961  66.176705  10.763438
2  69.271539  94.620625  16.709941  95.833152
3  31.870412  92.897303  45.783337  43.051783
           a          b          c          d
2  69.271539  94.620625  16.709941  95.833152
0  36.300085  90.999611  87.883077  39.251081
3  31.870412  92.897303  45.783337  43.051783
1  16.769310  99.653961  66.176705  10.763438
多列排序------
           a          b          c          d
1  16.769310  99.653961  66.176705  10.763438
3  31.870412  92.897303  45.783337  43.051783
0  36.300085  90.999611  87.883077  39.251081
2  69.271539  94.620625  16.709941  95.833152
</code></pre> 
<h4><a id="36_2___sort_index_469"></a>3.6 排序2 - 索引排序 .sort_index</h4> 
<pre><code class="prism language-python"><span class="token comment"># 与.sort_values类似</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                  index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span>
                  index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'h'</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">,</span><span class="token string">'g'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 按照index排序</span>
<span class="token comment"># 默认 ascending=True, inplace=False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df2<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code># 结果：
           a          b          c          d
5  10.912363  66.069285  75.108926  50.976926
4  10.068745  89.445559  68.636782  56.758989
3   5.706953  17.755349  10.428633  31.123841
2  87.497426  76.308941  85.110218  97.168951
           a          b          c          d
2  87.497426  76.308941  85.110218  97.168951
3   5.706953  17.755349  10.428633  31.123841
4  10.068745  89.445559  68.636782  56.758989
5  10.912363  66.069285  75.108926  50.976926
           a          b          c          d
h  70.385483  10.462891  83.496788  82.744301
s  12.271862  25.484720  18.975885  25.769192
x  83.282964  58.578331   5.013539  12.543449
g  62.352057  18.190354  71.342096  28.424552
           a          b          c          d
g  62.352057  18.190354  71.342096  28.424552
h  70.385483  10.462891  83.496788  82.744301
s  12.271862  25.484720  18.975885  25.769192
x  83.282964  58.578331   5.013539  12.543449
</code></pre> 
<h2><a id="4__508"></a>4. 数值计算和统计基础</h2> 
<h6><a id="1axisskipna_509"></a>1.基本参数：axis、skipna</h6> 
<pre><code>import numpy as np
import pandas as pd

df = pd.DataFrame({'key1':[4,5,3,np.nan,2], # 不是基本类型的元素会记为NaN
                 'key2':[1,2,np.nan,4,5],   
                 'key3':[1,2,3,'j','k']},   # 不一样的类型，会向大的类型转换
                 index = ['a','b','c','d','e'])
print(df)

m = df.mean() # 求每列的平均值
print(m, type(m)) # 对每一列求平均值(非数字的不计算在内，比如字符串)，为NaN的当作不存在（不做加数也不做除数），然后将结果和列名组成Series
# 单独统计某一列
print('单独统计一列:', df['key2'].mean())

# axis参数：默认为0，以列来计算，axis=1，以行来计算，这里就按照行来汇总了
print(df.mean(axis=1))  # 也可以先转置，用mean()，再转置
# skipna参数：是否忽略NaN，默认True，如False，有NaN的列统计结果仍未NaN
print(df.mean(skipna=False))

# 结果：
   key1  key2 key3
a   4.0   1.0    1
b   5.0   2.0    2
c   3.0   NaN    3
d   NaN   4.0    j
e   2.0   5.0    k
key1    3.5
key2    3.0
dtype: float64 &lt;class 'pandas.core.series.Series'&gt;
单独统计一列: 3.0
a    2.5
b    3.5
c    3.0
d    4.0
e    3.5
dtype: float64
key1   NaN
key2   NaN
dtype: float64
</code></pre> 
<h6><a id="2SeriesDataFrame1_550"></a>2.主要数学计算方法，可用于Series和DataFrame（1）</h6> 
<pre><code>df = pd.DataFrame({'key1':np.arange(10),
                  'key2':np.random.rand(10)*10})
print(df)
print('-----')

print(df.count(),'→ count统计非Na值的数量\n')
print(df.min(),'→ min统计最小值\n',df['key2'].max(),'→ max统计最大值\n')
print(df.quantile(q=0.75),'→ quantile统计分位数，参数q确定位置\n')
print(df.sum(),'→ sum求和\n')
print(df.mean(),'→ mean求平均值\n')
print(df.median(),'→ median求算数中位数，50%分位数\n')
print(df.std(),'\n',df.var(),'→ std,var分别求标准差，方差\n')
print(df.skew(),'→ skew样本的偏度\n')
print(df.kurt(),'→ kurt样本的峰度\n')
# 以上都可以用axis、skipna参数调整

# 结果：
   key1      key2
0     0  0.221860
1     1  5.431973
2     2  2.416677
3     3  4.770743
4     4  8.675935
5     5  7.304455
6     6  9.634564
7     7  8.857369
8     8  5.373542
9     9  3.293329
-----
key1    10
key2    10
dtype: int64 → count统计非Na值的数量

key1    0.00000
key2    0.22186
dtype: float64 → min统计最小值
 9.634563862337554 → max统计最大值

key1    6.750000
key2    8.333065
Name: 0.75, dtype: float64 → quantile统计分位数，参数q确定位置

key1    45.000000
key2    55.980447
dtype: float64 → sum求和

key1    4.500000
key2    5.598045
dtype: float64 → mean求平均值

key1    4.500000
key2    5.402758
dtype: float64 → median求算数中位数，50%分位数

key1    3.027650
key2    3.062325
dtype: float64 
 key1    9.166667
key2    9.377834
dtype: float64 → std,var分别求标准差，方差

key1    0.000000
key2   -0.318676
dtype: float64 → skew样本的偏度

key1   -1.200000
key2   -0.757927
dtype: float64 → kurt样本的峰度
</code></pre> 
<h6><a id="3SeriesDataFrame2_620"></a>3.主要数学计算方法，可用于Series和DataFrame（2）</h6> 
<pre><code>df = pd.DataFrame({
    'key1': np.arange(5),
    'key2': np.arange(10, 15)
})
print(df)
print(df.cumsum())
# 样本值的累计和，依次向上累计
print('---样本值的累计和')
df['key_s1'] = df['key1'].cumsum()
df['key_s2'] = df['key2'].cumsum()
print(df)
print('----样本值的累计积')
df['key_s3'] = df['key1'].cumprod()
df['key_s4'] = df['key2'].cumprod()
print(df)

# 结果：
   key1  key2
0     0    10
1     1    11
2     2    12
3     3    13
4     4    14
   key1  key2
0     0    10
1     1    21
2     3    33
3     6    46
4    10    60
---样本值的累计和
   key1  key2  key_s1  key_s2
0     0    10       0      10
1     1    11       1      21
2     2    12       3      33
3     3    13       6      46
4     4    14      10      60
----样本值的累计积
   key1  key2  key_s1  key_s2  key_s3  key_s4
0     0    10       0      10       0      10
1     1    11       1      21       0     110
2     2    12       3      33       0    1320
3     3    13       6      46       0   17160
4     4    14      10      60       0  240240
</code></pre> 
<h6><a id="4unique_665"></a>4.唯一值：.unique()</h6> 
<pre><code>s = pd.Series(list('abacgg'))
sq = s.unique()  # 去掉后面重复的value
print(s)
print(sq, type(sq))  # 得到一个唯一值数组

# 结果：
0    a
1    b
2    a
3    c
4    g
5    g
dtype: object
['a' 'b' 'c' 'g'] &lt;class 'numpy.ndarray'&gt;
</code></pre> 
<p><strong>注意：unique()方法只有Series有，DataFrame没有</strong></p> 
<h6><a id="5value_counts_682"></a>5.值计数：.value_counts()</h6> 
<pre><code>s = pd.Series(list('abacgg'))
sv = s.value_counts(sort=False) # 默认sout为True也就是默认会将index排序
print(sv)

# 结果：
a    2
c    1
g    2
b    1
dtype: int64
</code></pre> 
<p><strong>注意：value_counts()也是只能用于Series</strong></p> 
<h6><a id="6isin_695"></a>6.成员资格：.isin()</h6> 
<pre><code># 就是元素是否在Series或者DataFrame中

s = pd.Series(np.arange(5))
df = pd.DataFrame({
    'key1': ['ab', 'a', 'cd'],
    'key2': ['b', 'bc', 'cd']
})
print(s)
print(df)
print(s.isin([4]))
print(df.isin(['c', 'a']))

# 结果：
0    0
1    1
2    2
3    3
4    4
dtype: int32
  key1 key2
0   ab    b
1    a   bc
2   cd   cd
0    False
1    False
2    False
3    False
4     True
dtype: bool
    key1   key2
0  False  False
1   True  False
2  False  False
</code></pre> 
<hr> 
<h2><a id="5__732"></a>5. 文本数据</h2> 
<p>主要内容：Pandas针对字符串配备的一套方法，使其易于对数组的每个元素进行操作</p> 
<h6><a id="1str_NA_734"></a>1.通过str访问，且自动排除丢失/ NA值</h6> 
<pre><code># 通过str访问，且自动排除丢失/ NA值
# 牢记： str 是对所有的元素进行操作

s = pd.Series(['A','b','C','bbhello','123',np.nan,'hj'])
df = pd.DataFrame({'key1':list('abcdef'),
                  'key2':['hee','fv','w','hija','123',np.nan]})
print(s)
print(df)
print('-----')

print(s.str.count('b'))
print(df['key2'].str.upper())
print('-----')
# 直接通过.str调用字符串方法
# 可以对Series、Dataframe使用
# 自动过滤NaN值

df.columns = df.columns.str.upper()
print(df)
# df.columns是一个Index对象，也可使用.str

# 结果:
0          A
1          b
2          C
3    bbhello
4        123
5        NaN
6         hj
dtype: object
  key1  key2
0    a   hee
1    b    fv
2    c     w
3    d  hija
4    e   123
5    f   NaN
-----
0    0.0
1    1.0
2    0.0
3    2.0
4    0.0
5    NaN
6    0.0
dtype: float64
0     HEE
1      FV
2       W
3    HIJA
4     123
5     NaN
Name: key2, dtype: object
-----
  KEY1  KEY2
0    a   hee
1    b    fv
2    c     w
3    d  hija
4    e   123
5    f   NaN
</code></pre> 
<p><strong>注意：str只是Series有的属性，对于DataFrame没有</strong></p> 
<h6><a id="21__lowerupperlenstartswithendswith_798"></a>2.字符串常用方法（1） - lower，upper，len，startswith，endswith</h6> 
<pre><code>s = pd.Series(['A','b','bbhello','123',np.nan])

print(s.str.lower(),'→ lower小写\n')
print(s.str.upper(),'→ upper大写\n')
print(s.str.len(),'→ len字符长度\n')
print(s.str.startswith('b'),'→ 判断起始是否为a\n')
print(s.str.endswith('3'),'→ 判断结束是否为3\n')

# 结果：
0          a
1          b
2    bbhello
3        123
4        NaN
dtype: object → lower小写

0          A
1          B
2    BBHELLO
3        123
4        NaN
dtype: object → upper大写

0    1.0
1    1.0
2    7.0
3    3.0
4    NaN
dtype: float64 → len字符长度

0    False
1     True
2     True
3    False
4      NaN
dtype: object → 判断起始是否为a

0    False
1    False
2    False
3     True
4      NaN
dtype: object → 判断结束是否为3
</code></pre> 
<h6><a id="32__strip_844"></a>3.字符串常用方法（2） - strip</h6> 
<pre><code>s = pd.Series([' jack', 'jill ', ' jesse ', 'frank'])
df = pd.DataFrame(np.random.randn(3, 2), columns=[' Column A ', ' Column B '],
                  index=range(3))
print(s)
print(df)
print('-----')

print(s.str.strip())  # 去除字符串中的空格
print(s.str.lstrip())  # 去除字符串中的左空格
print(s.str.rstrip())  # 去除字符串中的右空格

df.columns = df.columns.str.strip()
print(df)
# 这里去掉了columns的前后空格，但没有去掉中间空格
# 结果：
0       jack
1      jill 
2     jesse 
3      frank
dtype: object
    Column A    Column B 
0   -0.491619   -0.219010
1   -0.217828    0.629777
2   -1.072765    1.182866
-----
0     jack
1     jill
2    jesse
3    frank
dtype: object
0      jack
1     jill 
2    jesse 
3     frank
dtype: object
0      jack
1      jill
2     jesse
3     frank
dtype: object
   Column A  Column B
0 -0.491619 -0.219010
1 -0.217828  0.629777
2 -1.072765  1.182866
</code></pre> 
<h6><a id="43__replace_890"></a>4.字符串常用方法（3） - replace</h6> 
<pre><code>df = pd.DataFrame(np.random.randn(3, 2), columns=[' Column A ', ' Column B '],
                  index=range(3))
df.columns = df.columns.str.replace(' ','-')
print(df)
# 替换

df.columns = df.columns.str.replace('-','hehe',n=1)  # n：替换个数
print(df)

#  结果：
   -Column-A-  -Column-B-
0   -0.008104    0.257773
1   -0.623774    0.721328
2   -0.060201   -0.493679
   heheColumn-A-  heheColumn-B-
0      -0.008104       0.257773
1      -0.623774       0.721328
2      -0.060201      -0.493679
</code></pre> 
<h6><a id="54__splitrsplit_910"></a>5.字符串常用方法（4） - split、rsplit</h6> 
<pre><code>s = pd.Series(['a,b,c','1,2,3',['a,,,c'],np.nan])
# 类似字符串的split
print(s.str.split(','))
print('-----')

# 直接索引得到一个list
print(s.str.split(',')[0])
print('-----')

print(s.str.split(',').str[0]) # str[0]可以用get(0)代替
print(s.str.split(',').str.get(1))
print('-----')

# 可以使用expand可以轻松扩展此操作以返回DataFrame
# n参数限制分割数
# rsplit类似于split，反向工作，即从字符串的末尾到字符串的开头
print(s.str.split(',', expand=True))
print(s.str.split(',', expand=True, n = 1))
print(s.str.rsplit(',', expand=True, n = 1))

# 结果：
0    [a, b, c]
1    [1, 2, 3]
2          NaN
3          NaN
dtype: object
-----
['a', 'b', 'c']
-----
0      a
1      1
2    NaN
3    NaN
dtype: object
0      b
1      2
2    NaN
3    NaN
dtype: object
-----
     0    1    2
0    a    b    c
1    1    2    3
2  NaN  NaN  NaN
3  NaN  NaN  NaN
     0    1
0    a  b,c
1    1  2,3
2  NaN  NaN
3  NaN  NaN
     0    1
0  a,b    c
1  1,2    3
2  NaN  NaN
3  NaN  NaN
</code></pre> 
<h6><a id="6_967"></a>6.字符串索引</h6> 
<pre><code>s = pd.Series(['A','b','C','bbhello','123',np.nan,'hj'])
df = pd.DataFrame({'key1':list('abcdef'),
                  'key2':['hee','fv','w','hija','123',np.nan]})

print(s.str[0])  # 取第一个字符串
print(s.str[:2])  # 取前两个字符串
print(df['key2'].str[0]) 
# str之后和字符串本身索引方式相同

# 结果：
0      A
1      b
2      C
3      b
4      1
5    NaN
6      h
dtype: object
0      A
1      b
2      C
3     bb
4     12
5    NaN
6     hj
dtype: object
0      h
1      f
2      w
3      h
4      1
5    NaN
Name: key2, dtype: object
</code></pre> 
<h6><a id="7_1002"></a>7.一个值得学习的小例子</h6> 
<pre><code>df = pd.DataFrame({'name':['jack','tom','Marry','zack','heheda'],
                  'gender':['M ','M','   F','  M ','  F'],
                  'score':['90-92-89','89-78-88','90-92-95','78-88-76','60-60-67']})
df['name'] = df['name'].str.capitalize()
df['gender'] = df['gender'].str.strip()
df['math'] = df['score'].str.split('-', expand=True)[0]   # 这个值得学习
print(df)

# 结果：
     name gender     score math
0    Jack      M  90-92-89   90
1     Tom      M  89-78-88   89
2   Marry      F  90-92-95   90
3    Zack      M  78-88-76   78
4  Heheda      F  60-60-67   60
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3e2f55d5018bd2e83111a5b1f32ee480/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">快捷记录(持续更新)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/faf9981350c9bce39ce943b9fc65bd63/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Redux持久化及其持久化失效之刷新页面数据会重置问题解决</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>