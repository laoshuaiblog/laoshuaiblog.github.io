<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>flask web学习之表单（一） - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/f09c24b8dffade3f72c9d5431da59c2f/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="flask web学习之表单（一）">
  <meta property="og:description" content="文章目录 一、使用Flask-WTF处理表单1.1 安装Flask-WTF库1.2 定义WTForms表单类常用的WTForm字段实例化字段类常用参数常用的WTForm验证器 1.3 输出HTML代码使用render_kw属性在调用字段时传入 1.4 在模板中渲染表单 在web程序中，表单是用户交互最常见的方式之一。用户注册、登陆、撰写文章、编辑设置无一不用到表单。
一、使用Flask-WTF处理表单 1.1 安装Flask-WTF库 pipenv install flask-wtf pip install flask-wtf flask-wtf默认为每个表单开启CSRF保护，它会为我们自动生成和验证CSRF令牌。所以我们应该设置：
app.secret_key = &#39;dadesjdajdhadheuisdjakj&#39; 1.2 定义WTForms表单类 from wtforms import Form, StringField, IntegerField, validators class MyForm(Form): name = StringField(&#39;name&#39;, [validators.Length(min=4, max=25)]) age = IntegerField(&#39;Age&#39;, [validators.NumberRange(min=0, max=100)]) 在这个例子中，我们使用了StringField和IntegerField来分别定义了name和age两个字段。每个字段都有一个标签（即’Name’和’Age’），以及一些验证器（validators）来验证用户提交的数据是否符合要求。例如，validators.Length(min=4, max=25)表示name字段的长度必须在4到25个字符之间，而validators.NumberRange(min=0, max=100)表示age字段的值必须在0到100之间。
常用的WTForm字段 字段类说明对应的html表示StringField（文本字段）用于接收文本输入&amp;lt;input type=&#34;text&#34;&amp;gt;PasswordField（密码字段）用于接收密码输入&amp;lt;input type=&#34;password&#34;&amp;gt;TextAreaField（多行文本字段）用于接收多行文本输入&amp;lt;textarea&amp;gt;&amp;lt;/textarea&amp;gt;IntegerField（整数字段）用于接收整数输入&amp;lt;input type=&#34;number&#34;&amp;gt;BooleanField（布尔字段用于接收布尔值输入&amp;lt;input type=&#34;checkbox&#34;&amp;gt;SelectField（下拉选择字段）用于从预定义选项中选择一个值。&amp;lt;select&amp;gt;&amp;lt;option&amp;gt;...&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;RadioField（单选按钮字段）用于从预定义选项中选择一个值。&amp;lt;input type=&#34;radio&#34;&amp;gt;FileField（文件上传字段）用于上传文件。&amp;lt;input type=&#34;file&#34;&amp;gt; 实例化字段类常用参数 参数说明label字段的标签（Label）或名称（Name），用于在表单中标识该字段。validators包含一个或多个验证器对象的列表，用于验证输入数据是否符合指定规则。default字段的默认值。description字段的描述信息，通常用于在页面上显示字段的说明文本。render_kw包含一些HTML属性和值的字典，用于向字段的HTML表示中添加额外的属性和样式。choices可选的预定义选项列表，用于下拉选择字段和单选按钮字段。coerce指定将输入值转换为另一种类型的函数，例如将字符串转换为整数。filters包含一个或多个过滤器对象的列表，用于在表单提交前对输入数据进行处理。 常用的WTForm验证器 验证器说明DataRequired验证字段必须包含数据。Length验证输入数据的长度是否在指定范围内。Email验证输入数据是否为有效的电子邮件地址。EqualTo验证两个字段的值是否相等。NumberRange验证输入数据是否在指定的数字范围内。Regexp使用正则表达式验证输入数据是否符合指定模式。 name = StringField(&#39;Your name&#39;, validators=[DataRequired(message=u&#39;名字不能为空&#39;)]) 当使用flask-wtf定义表单时，我们仍然使用WTForm提供的字段类和验证器，创建的形式也一样，只是表单类要继承flask-wtf提供的FlaskForm类。
from flask_wtf import FlaskForm from wtforms import StringField, IntegerField, validators class MyForm(FlaskForm): name = StringField(&#39;name&#39;, [validators.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-11T22:44:26+08:00">
    <meta property="article:modified_time" content="2024-01-11T22:44:26+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">flask web学习之表单（一）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><a href="#FlaskWTF_2" rel="nofollow">一、使用Flask-WTF处理表单</a></li><li><ul><li><a href="#11_FlaskWTF_3" rel="nofollow">1.1 安装Flask-WTF库</a></li><li><a href="#12_WTForms_12" rel="nofollow">1.2 定义WTForms表单类</a></li><li><ul><li><a href="#WTForm_22" rel="nofollow">常用的WTForm字段</a></li><li><a href="#_34" rel="nofollow">实例化字段类常用参数</a></li><li><a href="#WTForm_46" rel="nofollow">常用的WTForm验证器</a></li></ul> 
     </li><li><a href="#13_HTML_69" rel="nofollow">1.3 输出HTML代码</a></li><li><ul><li><a href="#render_kw_71" rel="nofollow">使用render_kw属性</a></li><li><a href="#_76" rel="nofollow">在调用字段时传入</a></li></ul> 
     </li><li><a href="#14__82" rel="nofollow">1.4 在模板中渲染表单</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<blockquote> 
 <p>在web程序中，表单是用户交互最常见的方式之一。用户注册、登陆、撰写文章、编辑设置无一不用到表单。</p> 
</blockquote> 
<h4><a id="FlaskWTF_2"></a>一、使用Flask-WTF处理表单</h4> 
<h5><a id="11_FlaskWTF_3"></a>1.1 安装Flask-WTF库</h5> 
<pre><code>pipenv install flask-wtf
pip install flask-wtf
</code></pre> 
<p>flask-wtf默认为每个表单开启CSRF保护，它会为我们自动生成和验证CSRF令牌。所以我们应该设置：</p> 
<pre><code>app.secret_key = 'dadesjdajdhadheuisdjakj'
</code></pre> 
<h5><a id="12_WTForms_12"></a>1.2 定义WTForms表单类</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wtforms <span class="token keyword">import</span> Form<span class="token punctuation">,</span> StringField<span class="token punctuation">,</span> IntegerField<span class="token punctuation">,</span> validators

<span class="token keyword">class</span> <span class="token class-name">MyForm</span><span class="token punctuation">(</span>Form<span class="token punctuation">)</span><span class="token punctuation">:</span>
	name <span class="token operator">=</span> StringField<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>validators<span class="token punctuation">.</span>Length<span class="token punctuation">(</span><span class="token builtin">min</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	age <span class="token operator">=</span> IntegerField<span class="token punctuation">(</span><span class="token string">'Age'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>validators<span class="token punctuation">.</span>NumberRange<span class="token punctuation">(</span><span class="token builtin">min</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，我们使用了StringField和IntegerField来分别定义了name和age两个字段。每个字段都有一个标签（即’Name’和’Age’），以及一些验证器（validators）来验证用户提交的数据是否符合要求。例如，validators.Length(min=4, max=25)表示name字段的长度必须在4到25个字符之间，而validators.NumberRange(min=0, max=100)表示age字段的值必须在0到100之间。</p> 
<h6><a id="WTForm_22"></a>常用的WTForm字段</h6> 
<table><thead><tr><th>字段类</th><th>说明</th><th>对应的html表示</th></tr></thead><tbody><tr><td>StringField（文本字段）</td><td>用于接收文本输入</td><td><code>&lt;input type="text"&gt;</code></td></tr><tr><td>PasswordField（密码字段）</td><td>用于接收密码输入</td><td><code>&lt;input type="password"&gt;</code></td></tr><tr><td>TextAreaField（多行文本字段）</td><td>用于接收多行文本输入</td><td><code>&lt;textarea&gt;&lt;/textarea&gt;</code></td></tr><tr><td>IntegerField（整数字段）</td><td>用于接收整数输入</td><td><code>&lt;input type="number"&gt;</code></td></tr><tr><td>BooleanField（布尔字段</td><td>用于接收布尔值输入</td><td><code>&lt;input type="checkbox"&gt;</code></td></tr><tr><td>SelectField（下拉选择字段）</td><td>用于从预定义选项中选择一个值。</td><td><code>&lt;select&gt;&lt;option&gt;...&lt;/option&gt;&lt;/select&gt;</code></td></tr><tr><td>RadioField（单选按钮字段）</td><td>用于从预定义选项中选择一个值。</td><td><code>&lt;input type="radio"&gt;</code></td></tr><tr><td>FileField（文件上传字段）</td><td>用于上传文件。</td><td><code>&lt;input type="file"&gt;</code></td></tr></tbody></table> 
<h6><a id="_34"></a>实例化字段类常用参数</h6> 
<table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>label</td><td>字段的标签（Label）或名称（Name），用于在表单中标识该字段。</td></tr><tr><td>validators</td><td>包含一个或多个验证器对象的列表，用于验证输入数据是否符合指定规则。</td></tr><tr><td>default</td><td>字段的默认值。</td></tr><tr><td>description</td><td>字段的描述信息，通常用于在页面上显示字段的说明文本。</td></tr><tr><td>render_kw</td><td>包含一些HTML属性和值的字典，用于向字段的HTML表示中添加额外的属性和样式。</td></tr><tr><td>choices</td><td>可选的预定义选项列表，用于下拉选择字段和单选按钮字段。</td></tr><tr><td>coerce</td><td>指定将输入值转换为另一种类型的函数，例如将字符串转换为整数。</td></tr><tr><td>filters</td><td>包含一个或多个过滤器对象的列表，用于在表单提交前对输入数据进行处理。</td></tr></tbody></table> 
<h6><a id="WTForm_46"></a>常用的WTForm验证器</h6> 
<table><thead><tr><th>验证器</th><th>说明</th></tr></thead><tbody><tr><td>DataRequired</td><td>验证字段必须包含数据。</td></tr><tr><td>Length</td><td>验证输入数据的长度是否在指定范围内。</td></tr><tr><td>Email</td><td>验证输入数据是否为有效的电子邮件地址。</td></tr><tr><td>EqualTo</td><td>验证两个字段的值是否相等。</td></tr><tr><td>NumberRange</td><td>验证输入数据是否在指定的数字范围内。</td></tr><tr><td>Regexp</td><td>使用正则表达式验证输入数据是否符合指定模式。</td></tr></tbody></table> 
<pre><code>name = StringField('Your name', validators=[DataRequired(message=u'名字不能为空')])
</code></pre> 
<p><strong>当使用flask-wtf定义表单时，我们仍然使用WTForm提供的字段类和验证器，创建的形式也一样，只是表单类要继承flask-wtf提供的FlaskForm类。</strong></p> 
<pre><code>from flask_wtf import FlaskForm
from wtforms import StringField, IntegerField, validators

class MyForm(FlaskForm):
	name = StringField('name', [validators.Length(min=4, max=25)])
	age = IntegerField('Age', [validators.NumberRange(min=0, max=100)])
</code></pre> 
<h5><a id="13_HTML_69"></a>1.3 输出HTML代码</h5> 
<p>默认情况下，WTForm输出的字段HTML代码只包含id和name属性，属性值均为表单类中对应的字段属性名称。如果要添加额外的属性，通常有两种方法：</p> 
<h6><a id="render_kw_71"></a>使用render_kw属性</h6> 
<pre><code>username = StringField('Username', render_kw={'placeholder': '请输入你的账号'})
</code></pre> 
<h6><a id="_76"></a>在调用字段时传入</h6> 
<pre><code>form.username(style='width;200px;', class_='bar')
</code></pre> 
<p>class 是python的保留关键字，在这里我们使用class_来代替class,渲染后会得到正确的class属性。</p> 
<h5><a id="14__82"></a>1.4 在模板中渲染表单</h5> 
<pre><code>&lt;form method="POST" action="{<!-- -->{ url_for('submit_form') }}"&gt;
  {<!-- -->{ form.hidden_tag() }}
  
  &lt;div class="form-group"&gt;
    {<!-- -->{ form.username.label(class="form-label") }}
    {<!-- -->{ form.username(class="form-control", placeholder="Enter your username") }}
    {% for error in form.username.errors %}
      &lt;span class="text-danger"&gt;{<!-- -->{ error }}&lt;/span&gt;
    {% endfor %}
  &lt;/div&gt;
  
  &lt;div class="form-group"&gt;
    {<!-- -->{ form.password.label(class="form-label") }}
    {<!-- -->{ form.password(class="form-control", placeholder="Enter your password") }}
    {% for error in form.password.errors %}
      &lt;span class="text-danger"&gt;{<!-- -->{ error }}&lt;/span&gt;
    {% endfor %}
  &lt;/div&gt;
  
  &lt;button type="submit" class="btn btn-primary"&gt;Submit&lt;/button&gt;
&lt;/form&gt;
</code></pre> 
<p>使用rener_kw字典或是在调用字段时传入参数来定义字段的额外HTML属性，通过这种方式添加css类，我们可以编写一个BootStrap风格的表单。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/57c797b891d680b39ee10317a2301b7e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue中，页面监听store中数据 的变化以及时做出相应，watch、computed与store的getter属性协调</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f59a7dbc25393d7ea4cc389512f09099/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux系统安全及应用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>