<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Vue】中Key的作用 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/c1047b00eead8a84a898e2a791b707a2/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="【Vue】中Key的作用">
  <meta property="og:description" content="Vue中key的作用 虚拟DOM 虚拟DOM 本质上是一个js对象 ，通过对象来表示真实的DOM结构。
key是虚拟DOM对象的标识，当状态中的数据发生变化时，Vue会根据 新数据 生成 新的虚拟DOM
key的原理及作用 Key是对节点进行的一个标识，在Vue中，Key作为Vue中对比算法的标识，在数据修改后，可以通过Key进行这个唯一标识进行对比虚拟DOM，从而决定对节点的重新加载以及复用
Key是虚拟DOM对象的标识，当数据发生变化时，Vue会根据【新数据】生成【新的虚拟DOM】, 随后Vue进行【新虚拟DOM】与【旧虚拟DOM】的差异比较。
Key的对比规则 旧虚拟DOM中找到了与新虚拟DOM相同的key：
若虚拟DOM中内容没变, 直接使用之前的真实DOM！若虚拟DOM中内容变了, 则生成新的真实DOM，随后替换掉页面中之前的真实DOM。 旧虚拟DOM中未找到与新虚拟DOM相同的key
创建新的真实DOM，随后渲染到到页面。实例展示 实例展示 前端代码展示
&amp;lt;!DOCTYPE html&amp;gt; &amp;lt;html&amp;gt; &amp;lt;head&amp;gt; &amp;lt;meta charset=&#34;UTF-8&#34; /&amp;gt; &amp;lt;title&amp;gt;key的原理&amp;lt;/title&amp;gt; &amp;lt;script type=&#34;text/javascript&#34; src=&#34;../js/vue.js&#34;&amp;gt;&amp;lt;/script&amp;gt; &amp;lt;/head&amp;gt; &amp;lt;body&amp;gt; &amp;lt;div id=&#34;root&#34;&amp;gt; &amp;lt;!-- 遍历数组 --&amp;gt; &amp;lt;h2&amp;gt;人员列表（遍历数组）&amp;lt;/h2&amp;gt; &amp;lt;button @click.once=&#34;add&#34;&amp;gt;添加一个老刘&amp;lt;/button&amp;gt; &amp;lt;ul&amp;gt; &amp;lt;li v-for=&#34;(p,index) of persons&#34; :key=&#34;index&#34;&amp;gt; {{p.name}}-{{p.age}} &amp;lt;input type=&#34;text&#34;&amp;gt; &amp;lt;/li&amp;gt; &amp;lt;/ul&amp;gt; &amp;lt;/div&amp;gt; &amp;lt;script type=&#34;text/javascript&#34;&amp;gt; Vue.config.productionTip = false new Vue({ el: &#39;#root&#39;, data: { persons: [ { id: &#39;001&#39;, name: &#39;张三&#39;, age: 18 }, { id: &#39;002&#39;, name: &#39;李四&#39;, age: 19 }, { id: &#39;003&#39;, name: &#39;王五&#39;, age: 20 } ] }, methods: { add() { const p = { id: &#39;004&#39;, name: &#39;老刘&#39;, age: 40 } this.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-03-14T10:39:37+08:00">
    <meta property="article:modified_time" content="2023-03-14T10:39:37+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Vue】中Key的作用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Vuekey_0"></a>Vue中key的作用</h2> 
<h3><a id="DOM_2"></a>虚拟DOM</h3> 
<p>虚拟DOM <strong>本质上是一个js对象</strong> ，通过对象来表示真实的DOM结构。</p> 
<p>key是虚拟DOM对象的标识，当状态中的数据发生变化时，Vue会根据 新数据 生成 新的虚拟DOM</p> 
<h3><a id="key_8"></a>key的原理及作用</h3> 
<p>Key是对节点进行的一个标识，在Vue中，<strong>Key作为Vue中对比算法的标识</strong>，在数据修改后，可以通过Key进行这个唯一标识进行对比虚拟DOM，从而决定对节点的重新加载以及复用</p> 
<p>Key是虚拟DOM对象的标识，当数据发生变化时，Vue会根据【新数据】生成【新的虚拟DOM】, 随后Vue进行【新虚拟DOM】与【旧虚拟DOM】的差异比较。</p> 
<h3><a id="Key_14"></a>Key的对比规则</h3> 
<ul><li> <p>旧虚拟DOM中找到了与新虚拟DOM相同的key：</p> 
  <ul><li>若虚拟DOM中内容没变, 直接使用之前的真实DOM！</li><li>若虚拟DOM中内容变了, 则生成新的真实DOM，随后替换掉页面中之前的真实DOM。</li></ul> </li><li> <p>旧虚拟DOM中未找到与新虚拟DOM相同的key</p> 
  <ul><li>创建新的真实DOM，随后渲染到到页面。实例展示</li></ul> </li></ul> 
<h3><a id="_25"></a>实例展示</h3> 
<p><img src="https://images2.imgbox.com/6b/5b/9KfmGjW3_o.png" alt="在这里插入图片描述"></p> 
<p><strong>前端代码展示</strong></p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>key的原理<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span> src<span class="token operator">=</span><span class="token string">"../js/vue.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"root"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 遍历数组 <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>人员列表（遍历数组）<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>button @click<span class="token punctuation">.</span>once<span class="token operator">=</span><span class="token string">"add"</span><span class="token operator">&gt;</span>添加一个老刘<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>li v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(p,index) of persons"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
				<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>p<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">-</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>p<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token punctuation">}</span>
				<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">&gt;</span>
		Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span>

		<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#root'</span><span class="token punctuation">,</span>
			<span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">persons</span><span class="token operator">:</span> <span class="token punctuation">[</span>
					<span class="token punctuation">{<!-- --></span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'001'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token punctuation">{<!-- --></span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'002'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token punctuation">{<!-- --></span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'003'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span>
				<span class="token punctuation">]</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'004'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'老刘'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">40</span> <span class="token punctuation">}</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>persons<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> 
<p>在列表渲染中，使用的是<strong>index</strong>作为key，并没有选择data中的<strong>person.id</strong>作为key，并且在输入框输入对应的信息</p> 
<p><img src="https://images2.imgbox.com/c6/a9/7GZNh7iH_o.png" alt="在这里插入图片描述"></p> 
<p>然后点击添加一个老刘，看会出现什么情况</p> 
<p><img src="https://images2.imgbox.com/a5/50/AkXi90j7_o.png" alt="在这里插入图片描述"></p> 
<p>此时我们会发现，当点击按钮添加信息后，备注项输入框内容发生了错误，添加人员后，备注项内容并没有跟随对应的节点，此时我们再使用<strong>person.id</strong>作为key，则发现就不会出现这种情况</p> 
<p>使用<strong>person.id</strong>作为key：</p> 
<p><img src="https://images2.imgbox.com/86/52/YpdmI2WB_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="indexkey_95"></a>index作为key时为什么会出现错乱的原理</h3> 
<p><img src="https://images2.imgbox.com/df/a9/dGzGG9Ei_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="personidkey_99"></a>person.id作为key时的实现原理</h3> 
<p><img src="https://images2.imgbox.com/ea/af/MJlZFWC5_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="indexkey_104"></a>用index作为key可能会引发的问题：</h3> 
<p>在使用中并不是不能用index左右key，只是在以下情况下使用index作为key可能会出现错乱</p> 
<ol><li>若对数据进行：逆序添加、逆序删除等破坏顺序操作:</li></ol> 
<p>​ 会产生没有必要的真实DOM更新 ==&gt; 界面效果没问题, 但效率低。</p> 
<ol start="2"><li>如果结构中还包含输入类的DOM：</li></ol> 
<p>​ 会产生错误DOM更新 ==&gt; 界面有问题。</p> 
<h3><a id="key_116"></a>开发中如何选择key</h3> 
<ol><li> <p>最好使用每条数据的唯一标识作为key, 比如id、手机号、身份证号、学号等唯一值。</p> </li><li> <p>如果结构中还包含输入类的DOM：</p> </li></ol> 
<p>​ 会产生错误DOM更新 ==&gt; 界面有问题。</p> 
<h3><a id="key_126"></a>开发中如何选择key</h3> 
<ol><li> <p>最好使用每条数据的唯一标识作为key, 比如id、手机号、身份证号、学号等唯一值。</p> </li><li> <p>如果不存在对数据的逆序添加、逆序删除等破坏顺序操作，仅用于渲染列表用于展示，使用index作为key是没有问题的。</p> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/95da96f9744d18ded4ab0160f5f74e7d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在 tomcat 内部署简单的 html 网页</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/261ace9f5cb308bb379e2ed8fe7f9673/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Node笔记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>