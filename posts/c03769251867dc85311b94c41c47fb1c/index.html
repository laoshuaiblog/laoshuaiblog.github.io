<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>详解聚类评估 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/c03769251867dc85311b94c41c47fb1c/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="详解聚类评估">
  <meta property="og:description" content="详解聚类评估 详解聚类评估估计聚类趋势方法一：观察聚类误差是否随聚类类别数量的增加而单调变化方法二：Hopkins Statistic（霍普金斯统计量） 判定数据簇数方法一：经验法方法二：手肘法方法三：交叉验证法 测定聚类质量外在方法（有监督方法）Jaccard Coefficient, JC（Jaccard系数）purity(纯度)sklearn 中 Purity 的实现 Fowlkes and Mallows Index, FMI（FM指数）sklearn中FMI的实现 Rand Index, RI（兰德系数）Adjusted Rand index, ARI （调整兰德系数）sklearn中Adjusted Rand index ，ARI 的实现 Normalized Mutual Information, NMI（标准化后的互信息）sklearn 中 Normalized Mutual Information, NMI 的实现 Adjusted Mutual Information, AMI（标准化后的互信息）sklearn 中 Adjusted Mutual Information, AMI 的实现 Homogeneity, completeness and V-measuresklearn 中Homogeneity, completeness and V-measure 的实现 内在方法 （无监督方法）Silhouette Coefficient（轮廓系数）sklearn 中 轮廓系数的实现 Calinski-Harabaz Indexsklearn 中 Calinski-Harabasz Index 的实现 详解聚类评估 估计聚类趋势 这一步骤是检测数据分布中是否存在非随机的簇结构 。">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-11-06T17:00:41+08:00">
    <meta property="article:modified_time" content="2019-11-06T17:00:41+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">详解聚类评估</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>详解聚类评估</h4> 
 <ul><li><a href="#_1" rel="nofollow">详解聚类评估</a></li><li><ul><li><a href="#_2" rel="nofollow">估计聚类趋势</a></li><li><ul><li><a href="#_8" rel="nofollow">方法一：观察聚类误差是否随聚类类别数量的增加而单调变化</a></li><li><a href="#Hopkins_Statistic_11" rel="nofollow">方法二：Hopkins Statistic（霍普金斯统计量）</a></li></ul> 
   </li><li><a href="#_19" rel="nofollow">判定数据簇数</a></li><li><ul><li><a href="#_21" rel="nofollow">方法一：经验法</a></li><li><a href="#_24" rel="nofollow">方法二：手肘法</a></li><li><a href="#_27" rel="nofollow">方法三：交叉验证法</a></li></ul> 
   </li><li><a href="#_30" rel="nofollow">测定聚类质量</a></li><li><ul><li><a href="#_31" rel="nofollow">外在方法（有监督方法）</a></li><li><ul><li><a href="#Jaccard_Coefficient_JCJaccard_36" rel="nofollow">Jaccard Coefficient, JC（Jaccard系数）</a></li><li><a href="#purity_39" rel="nofollow">purity(纯度)</a></li><li><ul><li><a href="#sklearn__Purity__42" rel="nofollow">sklearn 中 Purity 的实现</a></li></ul> 
     </li><li><a href="#Fowlkes_and_Mallows_Index_FMIFM_51" rel="nofollow">Fowlkes and Mallows Index, FMI（FM指数）</a></li><li><ul><li><a href="#sklearnFMI_54" rel="nofollow">sklearn中FMI的实现</a></li></ul> 
     </li><li><a href="#Rand_Index_RI_66" rel="nofollow">Rand Index, RI（兰德系数）</a></li><li><a href="#Adjusted_Rand_index_ARI__71" rel="nofollow">Adjusted Rand index, ARI （调整兰德系数）</a></li><li><ul><li><a href="#sklearnAdjusted_Rand_index_ARI__74" rel="nofollow">sklearn中Adjusted Rand index ，ARI 的实现</a></li></ul> 
     </li><li><a href="#Normalized_Mutual_Information_NMI_85" rel="nofollow">Normalized Mutual Information, NMI（标准化后的互信息）</a></li><li><ul><li><a href="#sklearn__Normalized_Mutual_Information_NMI__87" rel="nofollow">sklearn 中 Normalized Mutual Information, NMI 的实现</a></li></ul> 
     </li><li><a href="#Adjusted_Mutual_Information_AMI_96" rel="nofollow">Adjusted Mutual Information, AMI（标准化后的互信息）</a></li><li><ul><li><a href="#sklearn__Adjusted_Mutual_Information_AMI__99" rel="nofollow">sklearn 中 Adjusted Mutual Information, AMI 的实现</a></li></ul> 
     </li><li><a href="#Homogeneity_completeness_and_Vmeasure_112" rel="nofollow">Homogeneity, completeness and V-measure</a></li><li><ul><li><a href="#sklearn_Homogeneity_completeness_and_Vmeasure__118" rel="nofollow">sklearn 中Homogeneity, completeness and V-measure 的实现</a></li></ul> 
    </li></ul> 
    </li><li><a href="#__135" rel="nofollow">内在方法 （无监督方法）</a></li><li><ul><li><a href="#Silhouette_Coefficient_137" rel="nofollow">Silhouette Coefficient（轮廓系数）</a></li><li><ul><li><a href="#sklearn___144" rel="nofollow">sklearn 中 轮廓系数的实现</a></li></ul> 
     </li><li><a href="#CalinskiHarabaz_Index_154" rel="nofollow">Calinski-Harabaz Index</a></li><li><ul><li><a href="#sklearn__CalinskiHarabasz_Index__161" rel="nofollow">sklearn 中 Calinski-Harabasz Index 的实现</a></li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>详解聚类评估</h2> 
<h3><a id="_2"></a>估计聚类趋势</h3> 
<p>这一步骤是检测数据分布中<strong>是否存在非随机的簇结构</strong> 。</p> 
<p>如果数据是基本随机的，那么聚类的结果也是毫无意义的 。</p> 
<h4><a id="_8"></a>方法一：观察聚类误差是否随聚类类别数量的增加而单调变化</h4> 
<p>如果数据是<strong>基本随机</strong>的，即不存在非随机簇结构。那么<strong>聚类误差随聚类类别数量增加而变化的幅度应该较不显著</strong>，并且也找不到一个合适的 K 对应数据的真实簇数。</p> 
<h4><a id="Hopkins_Statistic_11"></a>方法二：Hopkins Statistic（霍普金斯统计量）</h4> 
<p>判断数据在空间上的随机性<br> <img src="https://images2.imgbox.com/35/47/WrUfkDGz_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/dd/d2/Go0cqePd_o.png" alt="在这里插入图片描述"><br> 如果<strong>样本接近随机分布</strong> H 的值接近于 0.5</p> 
<p>如果<strong>聚类趋势明显</strong> H 的值接近于 1</p> 
<h3><a id="_19"></a>判定数据簇数</h3> 
<p>K-均值这样的算法需要数据集的簇数作为参数，簇数也可以看作是数据集的有趣并且重要的概括统计量。因此，在使用聚类算法导出详细的簇之前，估计簇数是可取的。</p> 
<h4><a id="_21"></a>方法一：经验法</h4> 
<p><img src="https://images2.imgbox.com/55/fa/lmB6mv9N_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_24"></a>方法二：手肘法</h4> 
<p>给定k&gt;0,使用像K-均值这样的算法对数据集聚类，并计算簇内方差和var(k)。然后，绘制var关于k的曲线。曲线的<strong>第一个（或最显著的）拐点</strong>暗示“正确的”簇数。</p> 
<h4><a id="_27"></a>方法三：交叉验证法</h4> 
<p>将数据分为m部分；用m-1部分获得聚类模型，余下部分评估聚类质量（测试样本与类中心的距离和）；对k&gt;0重复m次，比较总体质量，选择能获得最好聚类质量的k</p> 
<h3><a id="_30"></a>测定聚类质量</h3> 
<h4><a id="_31"></a>外在方法（有监督方法）</h4> 
<p>需要基准数据。用一定的度量评判聚类结果与基准数据的符合程度。</p> 
<p>（基准是一种理想的聚类，通常由专家构建）</p> 
<h5><a id="Jaccard_Coefficient_JCJaccard_36"></a>Jaccard Coefficient, JC（Jaccard系数）</h5> 
<p><img src="https://images2.imgbox.com/ad/a1/mdUCME5R_o.png" alt="在这里插入图片描述"> <img src="https://images2.imgbox.com/75/a0/dqZ9uqeG_o.png" alt="在这里插入图片描述"><br> 结果值均在[0,1]区间，值越大越好。</p> 
<h5><a id="purity_39"></a>purity(纯度)</h5> 
<p><img src="https://images2.imgbox.com/6a/3f/NELWivzw_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/22/9a/PVbX1waX_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="sklearn__Purity__42"></a>sklearn 中 Purity 的实现</h6> 
<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_true <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_pred <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> metric<span class="token punctuation">.</span>compute_purity<span class="token punctuation">(</span>labels_pred<span class="token punctuation">,</span> labels_true<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="Fowlkes_and_Mallows_Index_FMIFM_51"></a>Fowlkes and Mallows Index, FMI（FM指数）</h5> 
<p><img src="https://images2.imgbox.com/89/9c/O98fAr0i_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ef/f7/6sr0Wl2Y_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="sklearnFMI_54"></a>sklearn中FMI的实现</h6> 
<pre><code class="prism language-python">
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_true <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_pred <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> metrics<span class="token punctuation">.</span>fowlkes_mallows_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>  
<span class="token number">0.47140</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p>结果值均在[0,1]区间，值越大越好。</p> 
<h5><a id="Rand_Index_RI_66"></a>Rand Index, RI（兰德系数）</h5> 
<p><img src="https://images2.imgbox.com/31/04/d5YTclzC_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d8/e0/KZtuCB0y_o.png" alt="在这里插入图片描述"><br> ( a+b+c+d=m(m-1)/2 )<br> 结果值均在[0,1]区间，值越大越好。</p> 
<h5><a id="Adjusted_Rand_index_ARI__71"></a>Adjusted Rand index, ARI （调整兰德系数）</h5> 
<p><img src="https://images2.imgbox.com/92/6c/00y8Lqwz_o.png" alt="在这里插入图片描述"><br> ARI的取值范围 [-1,1] ，值越大意味着聚类结果与真实情况越吻合，广义定义上来说，ARI 衡量的是两个数据分布的吻合程度</p> 
<h6><a id="sklearnAdjusted_Rand_index_ARI__74"></a>sklearn中Adjusted Rand index ，ARI 的实现</h6> 
<pre><code class="prism language-python">
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_true <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_pred <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
 
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> metrics<span class="token punctuation">.</span>adjusted_rand_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>  
<span class="token number">0.24</span>
</code></pre> 
<h5><a id="Normalized_Mutual_Information_NMI_85"></a>Normalized Mutual Information, NMI（标准化后的互信息）</h5> 
<p><img src="https://images2.imgbox.com/57/a0/E2sf2zT6_o.png" alt="在这里插入图片描述">MI和NMI 利用互信息的方法来衡量聚类效果，取值范围 [0,1] ，值越大意味着聚类结果与真实情况越吻合，</p> 
<h6><a id="sklearn__Normalized_Mutual_Information_NMI__87"></a>sklearn 中 Normalized Mutual Information, NMI 的实现</h6> 
<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_true <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_pred <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> metrics<span class="token punctuation">.</span>normalized_mutual_info_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="Adjusted_Mutual_Information_AMI_96"></a>Adjusted Mutual Information, AMI（标准化后的互信息）</h5> 
<p><img src="https://images2.imgbox.com/d5/b9/AvQz0YT8_o.png" alt="在这里插入图片描述"><br> AMI 利用互信息的方法来衡量聚类效果，取值范围 [-1,1] ，值越大意味着聚类结果与真实情况越吻合，广义定义上来说，ARI 衡量的是两个数据分布的吻合程度</p> 
<h6><a id="sklearn__Adjusted_Mutual_Information_AMI__99"></a>sklearn 中 Adjusted Mutual Information, AMI 的实现</h6> 
<pre><code class="prism language-python">
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_true <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_pred <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
 
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> metrics<span class="token punctuation">.</span>adjusted_mutual_info_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span> 
</code></pre> 
<h5><a id="Homogeneity_completeness_and_Vmeasure_112"></a>Homogeneity, completeness and V-measure</h5> 
<p><strong>同质性homogeneity</strong>：每个群集只包含单个类的成员。</p> 
<p><strong>完整性completeness</strong>：给定类的所有成员都分配给同一个群集。</p> 
<p>两者的调和平均<strong>V-measure</strong></p> 
<h6><a id="sklearn_Homogeneity_completeness_and_Vmeasure__118"></a>sklearn 中Homogeneity, completeness and V-measure 的实现</h6> 
<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_true <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels_pred <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
 
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> metrics<span class="token punctuation">.</span>homogeneity_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>  
<span class="token number">0.66</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> metrics<span class="token punctuation">.</span>completeness_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span> 
<span class="token number">0.42</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> metrics<span class="token punctuation">.</span>v_measure_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>    
<span class="token number">0.51</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<h4><a id="__135"></a>内在方法 （无监督方法）</h4> 
<p>无需基准数据。类内聚集程度和类间离散程度</p> 
<h5><a id="Silhouette_Coefficient_137"></a>Silhouette Coefficient（轮廓系数）</h5> 
<p><img src="https://images2.imgbox.com/00/f1/AD4ECPIT_o.png" alt="在这里插入图片描述"><br> α（p）反映的是 p 所属簇中数据的紧凑程度，<br> b（p） 反映的是该簇与其他临近簇的分离程度 。<br> 显然 ， b（p） 越大， α（p） 越小，对应的聚类质量越好，</p> 
<p>轮廓系数的取值范围为 [-1,1] ，分数越大越好</p> 
<h6><a id="sklearn___144"></a>sklearn 中 轮廓系数的实现</h6> 
<pre><code class="prism language-python">
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> kmeans_model <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels <span class="token operator">=</span> kmeans_model<span class="token punctuation">.</span>labels_
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> metrics<span class="token punctuation">.</span>silhouette_score<span class="token punctuation">(</span>X<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> metric<span class="token operator">=</span><span class="token string">'euclidean'</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="CalinskiHarabaz_Index_154"></a>Calinski-Harabaz Index</h5> 
<p>Calinski-Harabasz分数值ss的数学计算公式是<br> <img src="https://images2.imgbox.com/2f/da/AIbUi9tZ_o.png" alt="在这里插入图片描述"><br> 也就是说，类别内部数据的协方差越小越好，类别之间的协方差越大越好，这样的Calinski-Harabasz分数会高。</p> 
<p>相比于轮廓系数计算速度非常快啊！</p> 
<h6><a id="sklearn__CalinskiHarabasz_Index__161"></a>sklearn 中 Calinski-Harabasz Index 的实现</h6> 
<p>在scikit-learn中， Calinski-Harabasz Index对应的方法是metrics.calinski_harabaz_score.</p> 
<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> kmeans_model <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> labels <span class="token operator">=</span> kmeans_model<span class="token punctuation">.</span>labels_
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> metrics<span class="token punctuation">.</span>calinski_harabaz_score<span class="token punctuation">(</span>X<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>  

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d88d398cf9376ab9c65df54fd445cdeb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">hadoop搭建</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/69f46e64b377e0c0cb4b725e4d78ebcc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL约束类型</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>