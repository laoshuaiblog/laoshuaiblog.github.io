<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>只知道删除单张表的数据？不知道删除多张表的数据？ - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/8b417871ca6971e71a93327035a55ba3/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="只知道删除单张表的数据？不知道删除多张表的数据？">
  <meta property="og:description" content="一些废话
可能在某某一天，你在删除表的数据的时候，不想一张表一张表的去删除，想把两个表的数据同时删除；然后你就会去搜索，然后你就很有很有很有很有可能会看到 me 的这篇优质（呸！！！）文章了~
嗯，没错，是这么个道理......
本文章赞助商：DataGrip（不是广告哇！！！Σ( ° △ °|||)︴）。
目录
一、删除多表数据
二、删除多表数据（两张表有外键关系）
2.1、设置外键
方法一：SQL 语句 方法二：图形化界面
2.2、解决方法
方法一（简单版）：关闭外键约束
方法二（麻烦版）：修改删除/更新行为
一、删除多表数据 我这里有两张表，分别是学生表（student）和学生成绩表（achievement）。
/*1、学生表*/ create table student( ID int, Name varchar(20) ); /*给学生表插入数据*/ insert into student(ID, Name) values (1,&#39;海绵宝宝&#39;), (2,&#39;派大星&#39;), (3,&#39;章鱼哥&#39;), (4,&#39;蟹老板&#39;), (5,&#39;痞老板&#39;), (6,&#39;珊迪&#39;), (7,&#39;小蜗&#39;); /*2、学生成绩表*/ create table achievement( ID int primary key auto_increment, Mark int ); /*给学生成绩表插入数据*/ insert into achievement(ID, Mark) values (1,91), (2,97), (3,88), (4,87), (5,84), (6,80), (7,81); /*查询两张表的数据*/ select * from student; select * from achievement; 输出结果： student（学生表）">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-03-04T08:21:10+08:00">
    <meta property="article:modified_time" content="2023-03-04T08:21:10+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">只知道删除单张表的数据？不知道删除多张表的数据？</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="color:#511b78;"><strong>一些废话</strong></span></p> 
<p>可能在某某一天，你在删除表的数据的时候，不想一张表一张表的去删除，想把两个表的数据同时删除；然后你就会去搜索，然后你就很有很有很有很有可能会看到 me 的这篇优质（呸！！！）文章了~</p> 
<p><img alt="" height="240" src="https://images2.imgbox.com/84/b8/JhVTUr2g_o.jpg" width="240">嗯，没错，是这么个道理......</p> 
<p><img alt="" height="240" src="https://images2.imgbox.com/9e/f2/fPocO4Sq_o.jpg" width="240"></p> 
<p><img alt="" height="240" src="https://images2.imgbox.com/f6/d4/o3uCvHxz_o.gif" width="240"></p> 
<pre></pre> 
<p><strong>本文章赞助商：DataGrip（不是广告哇！！！</strong>Σ( ° △ °|||)︴<strong>）。</strong></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="main-toc-toc" style="margin-left:0px;"><a href="#main-toc" rel="nofollow">一、删除多表数据</a></p> 
<p id="%E4%BA%8C%E3%80%81%E5%88%A0%E9%99%A4%E5%A4%9A%E8%A1%A8%E6%95%B0%E6%8D%AE%EF%BC%88%E4%B8%A4%E5%BC%A0%E8%A1%A8%E6%9C%89%E5%A4%96%E9%94%AE%E5%85%B3%E7%B3%BB%EF%BC%89-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E5%88%A0%E9%99%A4%E5%A4%9A%E8%A1%A8%E6%95%B0%E6%8D%AE%EF%BC%88%E4%B8%A4%E5%BC%A0%E8%A1%A8%E6%9C%89%E5%A4%96%E9%94%AE%E5%85%B3%E7%B3%BB%EF%BC%89" rel="nofollow">二、删除多表数据（两张表有外键关系）</a></p> 
<p id="2.1%E3%80%81%E8%AE%BE%E7%BD%AE%E5%A4%96%E9%94%AE-toc" style="margin-left:40px;"><a href="#2.1%E3%80%81%E8%AE%BE%E7%BD%AE%E5%A4%96%E9%94%AE" rel="nofollow">2.1、设置外键</a></p> 
<p id="%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9ASQL%20%E8%AF%AD%E5%8F%A5%C2%A0-toc" style="margin-left:80px;"><a href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9ASQL%20%E8%AF%AD%E5%8F%A5%C2%A0" rel="nofollow">方法一：SQL 语句 </a></p> 
<p id="%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2-toc" style="margin-left:80px;"><a href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2" rel="nofollow">方法二：图形化界面</a></p> 
<p id="2.2%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-toc" style="margin-left:40px;"><a href="#2.2%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95" rel="nofollow">2.2、解决方法</a></p> 
<p id="%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%88%E7%AE%80%E5%8D%95%E7%89%88%EF%BC%89%EF%BC%9A%E5%85%B3%E9%97%AD%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F-toc" style="margin-left:80px;"><a href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%88%E7%AE%80%E5%8D%95%E7%89%88%EF%BC%89%EF%BC%9A%E5%85%B3%E9%97%AD%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F" rel="nofollow">方法一（简单版）：关闭外键约束</a></p> 
<p id="-toc" style="margin-left:80px;"></p> 
<p id="%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%88%E9%BA%BB%E7%83%A6%E7%89%88%EF%BC%89%EF%BC%9A%E4%BF%AE%E6%94%B9%E5%88%A0%E9%99%A4%2F%E6%9B%B4%E6%96%B0%E8%A1%8C%E4%B8%BA-toc" style="margin-left:80px;"><a href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%88%E9%BA%BB%E7%83%A6%E7%89%88%EF%BC%89%EF%BC%9A%E4%BF%AE%E6%94%B9%E5%88%A0%E9%99%A4%2F%E6%9B%B4%E6%96%B0%E8%A1%8C%E4%B8%BA" rel="nofollow">方法二（麻烦版）：修改删除/更新行为</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="main-toc"><span style="color:#511b78;"><strong>一、删除多表数据</strong></span></h2> 
<p><strong>我这里有两张表，分别是学生表（student）和学生成绩表（achievement）。</strong></p> 
<pre><code>/*1、学生表*/
create table student(
    ID int,
    Name varchar(20)
);

/*给学生表插入数据*/
insert into student(ID, Name)
values (1,'海绵宝宝'),
       (2,'派大星'),
       (3,'章鱼哥'),
       (4,'蟹老板'),
       (5,'痞老板'),
       (6,'珊迪'),
       (7,'小蜗');



/*2、学生成绩表*/
create table achievement(
    ID int primary key auto_increment,
    Mark int
);

/*给学生成绩表插入数据*/
insert into achievement(ID, Mark)
values (1,91),
       (2,97),
       (3,88),
       (4,87),
       (5,84),
       (6,80),
       (7,81);</code></pre> 
<pre><code>/*查询两张表的数据*/
select * from student;
select * from achievement;</code></pre> 
<p><strong>输出结果： </strong></p> 
<p>student（学生表）</p> 
<p><img alt="" height="241" src="https://images2.imgbox.com/64/ae/1qykHRHa_o.png" width="270"></p> 
<p>achievement（学生成绩表）</p> 
<p><img alt="" height="237" src="https://images2.imgbox.com/0c/be/zKBeb2lH_o.png" width="269"></p> 
<p></p> 
<p></p> 
<p><span style="color:#be191c;"><strong>然后，我有个需求：要删除两个表中关于“小蜗”的记录。</strong></span></p> 
<p>如果你没有学过多张表的数据删除的话，你就会分别从两张表中去删除：</p> 
<pre><code>delete from student where Name = '小蜗';

delete from achievement where ID = 7;</code></pre> 
<p></p> 
<p>当你学了多张表的数据删除的话，你就可以把两个表的数据根据条件连接起来进行删除：</p> 
<p><span style="color:#6eaad7;">语法：delete 表1,表2 from 表1,表2 where 条件；</span></p> 
<pre><code>delete Student, Achievement from Student, Achievement where Student.ID = Achievement.ID and Student.Name = '小蜗';</code></pre> 
<p></p> 
<p><strong>要注意的点：</strong></p> 
<p>1.多张表删除数据，from 前面和 from 后面要接删除的表名（要删除几张表 from 前后就写几张表的表名，表名前后个数要保持一致）；</p> 
<p>如下：</p> 
<p>delete <span style="color:#be191c;">Student</span>, <span style="color:#be191c;">Achievement</span> from <span style="color:#be191c;">Student, Achievement</span> where Student.ID = Achievement.ID and Student.Name = '小蜗';</p> 
<p></p> 
<p>2.多张表删除数据，不能给表取别名，只能用表名，如果有 where 连接条件也只能用表名来进行连接。</p> 
<p></p> 
<p></p> 
<p>/*查询两张表的数据*/</p> 
<p>select * from student;<br> select * from achievement;</p> 
<p></p> 
<p><strong>删除成功！！！</strong></p> 
<p></p> 
<p><strong>输出结果： </strong></p> 
<p>student（学生表）</p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/54/f7/VPAX4ioE_o.png" width="266"></p> 
<p>achievement（学生成绩表）</p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/d9/f8/RvEal8xO_o.png" width="316"></p> 
<p></p> 
<p></p> 
<p><strong>“小蜗” -1。喵~</strong></p> 
<p><img alt="" class="left" src="https://images2.imgbox.com/b5/ea/PT6fIK5f_o.gif"></p> 
<p></p> 
<p><strong>小蜗是只猫！！！震惊我 100 年！！！</strong>😱😱😱</p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<h2 id="%E4%BA%8C%E3%80%81%E5%88%A0%E9%99%A4%E5%A4%9A%E8%A1%A8%E6%95%B0%E6%8D%AE%EF%BC%88%E4%B8%A4%E5%BC%A0%E8%A1%A8%E6%9C%89%E5%A4%96%E9%94%AE%E5%85%B3%E7%B3%BB%EF%BC%89"><span style="color:#511b78;"><strong>二、删除多表数据（两张表有外键关系）</strong></span></h2> 
<p><strong>打个预防针：这里面会涉及到外键知识，只想看两张表有外键关系的删除多表数据，直接看 2.2、解决方法 就可以了。</strong></p> 
<p><br>  </p> 
<h3 id="2.1%E3%80%81%E8%AE%BE%E7%BD%AE%E5%A4%96%E9%94%AE"><strong>2.1、设置外键</strong></h3> 
<h4 id="%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9ASQL%20%E8%AF%AD%E5%8F%A5%C2%A0"><strong>方法一：SQL 语句 </strong></h4> 
<p><span style="color:#6eaad7;">语法：alter table 子表 add constraint 外键的名称 foreign key(子表中要建立成外键的字段名) references 父表(父表中外键要关联的字段名);</span></p> 
<p></p> 
<p><strong>子表：</strong>建立外键的表；</p> 
<p><strong>外键的名称：</strong>给你要的外键取个名字；</p> 
<p><strong>父表：</strong>外键所关联的表；</p> 
<p></p> 
<p><strong>因为要演示两张表有外键关系的删除，所以我把 <span style="color:#be191c;">student（学生表）</span>的 <span style="color:#be191c;">ID</span> 字段设置为 <span style="color:#be191c;">外键字段</span>，关联 <span style="color:#be191c;">achievement（学生成绩表）</span>的 <span style="color:#be191c;">主键 ID</span> 字段；</strong></p> 
<pre><code>alter table student add constraint fk_student_ID foreign key(ID) references achievement(ID);</code></pre> 
<p><span style="color:#be191c;">如图：</span></p> 
<p><img alt="" height="166" src="https://images2.imgbox.com/3f/7e/6QqbUXXR_o.png" width="415"><br>  </p> 
<p><span style="color:#be191c;"><strong>注意，科普一下：</strong></span><strong>外键不一定要是另一个表的主键（primary key：主键约束），也可以是另一个表的唯一值（unique：唯一约束）。</strong></p> 
<p>因为外键和另一张表所关联的字段，值是不能重复（而主键约束是一行数据的唯一标识，非空且唯一；唯一约束也能保证该字段的所有数据都是唯一、不重复的）；</p> 
<p></p> 
<p><strong>并且，建立外键最重要的两点是：</strong></p> 
<p><strong>☝️、双方字段类型要保持一致，字段类型长度可以不一致。</strong></p> 
<p><span style="color:#be191c;">演示：</span></p> 
<p>我把 student（学生表）要建立成外键的字段 ID 改成 tinyint 小整形类型，外键所关联的achievement（学生成绩表）的字段主键 ID 还是 int 类型。</p> 
<p>/*学生表*/<br> create table student(<br>     <span style="color:#be191c;">ID tinyint</span>,<br>     Name varchar(20)<br> );</p> 
<p>/*学生成绩表*/<br> create table achievement(<br>     <span style="color:#be191c;">ID int</span> primary key auto_increment,<br>     Mark int<br> );</p> 
<p id="main-toc"></p> 
<p>插入外键：</p> 
<pre><code class="hljs">alter table student add constraint fk_student_ID foreign key(ID) references achievement(ID);</code></pre> 
<p></p> 
<p>会看到，他报错了！！！报的是外键约束不正确的错误！！！</p> 
<p><span style="color:#be191c;">[HY000][1005] Can't create table `test2`.`student` (errno: 150 "Foreign key constraint is incorrectly formed")</span></p> 
<p><img alt="" height="163" src="https://images2.imgbox.com/b9/97/ADz6t417_o.png" width="1027"></p> 
<p></p> 
<p><strong>✌️、双方数据要保持一致，具体演示点击下面链接：</strong></p> 
<p><a href="https://blog.csdn.net/weixin_62332711/article/details/129267590?spm=1001.2014.3001.5502" title="[23000][1452] Cannot add or update a child row: a foreign key constraint fails (`test2`.`#sql-1238_5_^O^——的博客-CSDN博客 ">[23000][1452] Cannot add or update a child row: a foreign key constraint fails (`test2`.`#sql-1238_5_^O^——的博客-CSDN博客</a></p> 
<p><br>  </p> 
<h4 id="%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2"><strong>方法二：图形化界面</strong></h4> 
<p>1、点击要设置成为外键的表（子表），右键 <span style="color:#be191c;"><strong>Modify Table...</strong></span>；</p> 
<p> <img alt="" height="181" src="https://images2.imgbox.com/73/7f/v4LufM6e_o.png" width="618"></p> 
<p></p> 
<p>2、选择 <span style="color:#be191c;"><strong>①Foreign Keys</strong></span>，点击 <span style="color:#be191c;"><strong>②“+”</strong></span> 号图标；</p> 
<p><img alt="" height="522" src="https://images2.imgbox.com/e9/33/UVpLWPhW_o.png" width="732"></p> 
<p></p> 
<p>3、</p> 
<p><span style="color:#be191c;"><strong>①<u>N</u>ame：</strong></span>给外键取个名称；</p> 
<p><span style="color:#be191c;"><strong>②<u>T</u>raget table：</strong></span>父表名称；</p> 
<p><strong><span style="color:#be191c;">③<u>U</u>pdate rule</span> 和 <span style="color:#be191c;">④<u>D</u>elete rule：</span></strong>外键的更新和删除行为；</p> 
<p><img alt="" height="589" src="https://images2.imgbox.com/5e/f6/QJHabLKN_o.png" width="732"></p> 
<p>3.1.</p> 
<p>然后在 <strong><u>C</u>olumns：</strong>下方，点击 <span style="color:#be191c;"><strong>①</strong>“<strong>+</strong>” </span>号图标添加外键相关联的两个字段名（点击 <span style="color:#be191c;"><strong>②</strong>“<strong>-</strong>”</span> 号图标删除），<span style="color:#be191c;"><strong>③<u>F</u>orm：</strong></span>子表的外键字段名；<span style="color:#be191c;"><strong>④<u>T</u>o：</strong></span>父表中子表外键所关联的字段名；最后，点击 <span style="color:#be191c;"><strong>④Execute</strong></span> 就创建完成啦。</p> 
<p><img alt="" height="551" src="https://images2.imgbox.com/33/5d/05kh3StJ_o.png" width="685"></p> 
<p></p> 
<p><strong>还有要补充的一点是：如果你在创建外键后，外键起不到任何效果的话，可以参考该文章：</strong><a href="https://blog.csdn.net/weixin_62332711/article/details/129261493?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22129261493%22%2C%22source%22%3A%22weixin_62332711%22%7D" title="MySQL 数据库创建不了外键约束_^O^——的博客-CSDN博客">MySQL 数据库创建不了外键约束_^O^——的博客-CSDN博客</a></p> 
<p></p> 
<p></p> 
<p><strong><span style="background-color:#fefcd8;">通过这两种方法的其中一种方法建立好外键关系后。</span></strong></p> 
<p><strong>当我从子表 student（学生表）</strong><strong>中去删除两张表数据的时候，可以删除成功：</strong></p> 
<p>delete Student, Achievement from Student, Achievement where Student.ID = Achievement.ID and Student.ID = 7;</p> 
<p><br><span style="color:#be191c;">如下：在两张表中 ID 为 7 的数据都被删除了。</span></p> 
<p>子表 （student：学生表）</p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/da/39/eerE3HiF_o.png" width="266"></p> 
<p> 父表（achievement：学生成绩表）</p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/56/04/Mbbc7YA3_o.png" width="316"></p> 
<p></p> 
<p></p> 
<p><strong>可当我从父表 achievement（学生成绩表）</strong><strong>中去删除两张表数据的时候，就不可以删除成功勒：</strong></p> 
<p>delete Student, Achievement from Student, Achievement where Student.ID = Achievement.ID and Achievement.ID = 6;</p> 
<p><img alt="" height="433" src="https://images2.imgbox.com/5c/46/p5qlqWZP_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<p><strong><span style="background-color:#fefcd8;">那是因为，在添加了外键之后，再删除/更新父表的数据时会产生约束行为，也就是删除/更新行为。</span></strong></p> 
<p><span style="color:#6eaad7;">语法：</span></p> 
<p>在外键约束的基础语法的基础上 + <span style="color:#6eaad7;">on update 删除/更新行为的语法 on delete 删除/更新行为的语法;</span></p> 
<p></p> 
<p><strong>删除/更新行为有以下 5 种语法，简单介绍一下</strong>😎<strong>：</strong></p> 
<p><strong>①no action（创建了外键约束默认的删除/更新行为）：不允许删除/更新父表的数据；</strong></p> 
<p><strong>②restrict：跟 no action 效果一样；</strong></p> 
<p><strong>③cascode：允许删除/更新父表的数据；</strong></p> 
<p><strong>④set null：允许删除/更新父表的数据，但会把外键字段的值变成 null（前提是该外键的字段是允许为 null 的，不能设置成 not null）；</strong></p> 
<p><span style="color:#be191c;">演示：删除父表 ID 为 7 的值。</span></p> 
<p>提示：如果要修改外键默认的删除/更新行为（no action），最好先把之前的外键删除，再添加删除/更新行为（不然会出现外键重复）。</p> 
<p><span style="color:#6eaad7;">语法：alter table 子表 drop foreign key 外键名称;</span></p> 
<p><span style="color:#be191c;">演示：</span></p> 
<p>alter table student drop foreign key fk_student_ID;</p> 
<p></p> 
<p>1、删除原先的外键；</p> 
<p>alter table student drop foreign key fk_student_ID;</p> 
<p>2、把默认的 no action 删除/更新行为改成 set null；</p> 
<p>alter table student add constraint fk_student_ID foreign key(ID) references achievement(ID) <span style="color:#6eaad7;">on update set null on delete set null</span>;</p> 
<p>原先表数据：</p> 
<p>父表（achievement：学生成绩表）</p> 
<p><img alt="" height="241" src="https://images2.imgbox.com/76/b1/GfBedwzf_o.png" width="270"></p> 
<p>子表 （student：学生表）</p> 
<p><img alt="" height="237" src="https://images2.imgbox.com/83/c3/hylVKDpr_o.png" width="269"></p> 
<p></p> 
<p>3、删除父表 ID 为 7 的值；</p> 
<p>delete from achievement where ID = 7;</p> 
<p></p> 
<p>删除后的表数据：</p> 
<p>父表（achievement：学生成绩表）</p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/c8/13/dOHF98vH_o.png" width="270"></p> 
<p>子表 （student：学生表）</p> 
<p><img alt="" height="240" src="https://images2.imgbox.com/fb/cc/sMIVJMo0_o.png" width="271"></p> 
<p>可以看到因为父表 ID 为 7 的删除了值，所以子表 （student：学生表）中对应的 ID 为 7 的外键值也变成 null 了。</p> 
<p id="main-toc"></p> 
<p><strong>⑤set default：允许删除/更新父表的数据，但会把外键字段的值变成 default 默认的值；</strong></p> 
<p><strong>（但是，InnoDB 引擎是不支持的；而 MySQL 数据库只有 InnoDB 引擎才允许使用外键，所以 set default 对 MySQL 数据库不起作用</strong><strong>）；</strong></p> 
<p><span style="color:#be191c;">演示：</span></p> 
<p>1、在图形化界面把 <strong><u>U</u>pdate rule</strong> 和 <strong><u>D</u>elete rule</strong> 外键的更新和删除行为改为 set default 会报错；</p> 
<p><img alt="" height="621" src="https://images2.imgbox.com/68/19/0aA70qAS_o.png" width="732"></p> 
<p>2、使用 SQL 语句进行修改删除/更新行为也报错了； </p> 
<p><img alt="" height="151" src="https://images2.imgbox.com/7d/d6/OeWCDOJp_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<p></p> 
<h3 id="2.2%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95">2.2、解决方法</h3> 
<h4 id="%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%88%E7%AE%80%E5%8D%95%E7%89%88%EF%BC%89%EF%BC%9A%E5%85%B3%E9%97%AD%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F">方法一（简单版）：关闭外键约束</h4> 
<p>删除前表的数据：</p> 
<p>子表（student：学生表）</p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/a2/ae/RJksAbXD_o.png" width="266"></p> 
<p>父表（achievement：学生成绩表）</p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/9f/96/tNqsDEHu_o.png" width="316"></p> 
<p></p> 
<p>1、关闭数据库的外键约束；<br> set foreign_key_checks = 0;</p> 
<p>2、再删除多张表的数据；</p> 
<p>delete Student, Achievement from Student, Achievement where Student.ID = Achievement.ID and Achievement.ID = 6;</p> 
<p>3、删除完之后开启数据库的外键约束；<br> set foreign_key_checks = 1;</p> 
<p></p> 
<p>删除后表的数据：</p> 
<p>子表（student：学生表）</p> 
<p><img alt="" height="182" src="https://images2.imgbox.com/cb/16/yp7l2JQH_o.png" width="269"></p> 
<p>父表（achievement：学生成绩表）</p> 
<p><img alt="" height="182" src="https://images2.imgbox.com/3f/c1/VhdISAcX_o.png" width="267"></p> 
<h4></h4> 
<p id="%E2%80%9C%E7%8F%8A%E8%BF%AA%E2%80%9D%20-1%E3%80%82"><strong>“珊迪” -1。</strong></p> 
<p> <img alt="" height="240" src="https://images2.imgbox.com/b0/b4/HnL9RieM_o.gif" width="240"></p> 
<p><img alt="" height="240" src="https://images2.imgbox.com/48/44/fzfUMtAx_o.jpg" width="240"></p> 
<p></p> 
<p></p> 
<h4 id="%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%88%E9%BA%BB%E7%83%A6%E7%89%88%EF%BC%89%EF%BC%9A%E4%BF%AE%E6%94%B9%E5%88%A0%E9%99%A4%2F%E6%9B%B4%E6%96%B0%E8%A1%8C%E4%B8%BA">方法二（麻烦版）：修改删除/更新行为</h4> 
<p><strong>第一种：图形化界面</strong></p> 
<p>1、选择建立了外键的表（student：学生表），右键 <span style="color:#be191c;"><strong>Modify Table...</strong></span>；</p> 
<p><img alt="" height="492" src="https://images2.imgbox.com/b2/04/a7QNBLvy_o.png" width="577"></p> 
<p></p> 
<p>2、点击 <span style="color:#be191c;"><strong>①Foreign Keys</strong></span>，点击 <span style="color:#be191c;"><strong>②之前插入的外键约束</strong></span>；</p> 
<p><img alt="" height="555" src="https://images2.imgbox.com/45/55/nKtoNw98_o.png" width="732"></p> 
<p></p> 
<p>3、把 <span style="color:#be191c;"><strong>①Update rule：</strong></span>和<strong> <span style="color:#be191c;">②Delete rule：</span></strong>的选项全都改成 <span style="color:#be191c;"><strong>cascode</strong></span>（允许删除/更新父表的数据），然后点击 <span style="color:#be191c;"><strong>③Execute</strong></span>（如果不可以修改就删除之前的外键，再重新新建外键，修改 <strong>①Update rule：和 ②Delete rule：</strong>的选项）；</p> 
<p><img alt="" height="588" src="https://images2.imgbox.com/17/34/o4YKpSSy_o.png" width="732"></p> 
<p></p> 
<p>4、删除两张表中 ID 为 5 的数据。</p> 
<p>delete Student, Achievement from Student, Achievement where Student.ID = Achievement.ID and Achievement.ID = 5;</p> 
<p></p> 
<p>删除前表的数据：</p> 
<p>子表（student：学生表）</p> 
<p><img alt="" height="182" src="https://images2.imgbox.com/03/3e/U23fA9Mg_o.png" width="269"></p> 
<p>父表（achievement：学生成绩表）</p> 
<p><img alt="" height="182" src="https://images2.imgbox.com/00/00/Sd4zfLtl_o.png" width="267"></p> 
<p></p> 
<p>删除后表的数据：</p> 
<p>子表（student：学生表）</p> 
<p><img alt="" height="154" src="https://images2.imgbox.com/90/e5/VYmG4UIT_o.png" width="271"></p> 
<p>父表（achievement：学生成绩表）</p> 
<p><img alt="" height="151" src="https://images2.imgbox.com/7c/1d/simdZkEZ_o.png" width="268"></p> 
<p></p> 
<p><strong>“痞老板” -1。</strong></p> 
<p><img alt="" height="239" src="https://images2.imgbox.com/0f/3d/Ak7gPvow_o.jpg" width="240"></p> 
<p></p> 
<p></p> 
<p><strong>第二种：图形化界面+SQL语句（说了和没说一样）</strong></p> 
<p>1、选择建立了外键的表（student：学生表），右键 <span style="color:#be191c;"><strong>Modify Table...</strong></span>；</p> 
<p><img alt="" height="492" src="https://images2.imgbox.com/ba/35/suSL92YL_o.png" width="577"></p> 
<p></p> 
<p>2、点击 <span style="color:#be191c;"><strong>①Foreign Keys</strong></span>，点击 <span style="color:#be191c;"><strong>②之前插入的外键约束</strong></span>，点击 <span style="color:#be191c;"><strong>③“-”</strong></span> 号删除该外键；</p> 
<p><img alt="" height="519" src="https://images2.imgbox.com/23/61/ff2pxLQr_o.png" width="685"></p> 
<p></p> 
<p>3、使用 SQL 语句把默认的 no action 删除/更新行为改成 cascode；</p> 
<p>alter table student add constraint fk_student_ID foreign key(ID) references achievement(ID) on update cascade on delete cascade;</p> 
<p></p> 
<p>4、删除两张表中 ID 为 4 的数据。</p> 
<p>delete Student, Achievement from Student, Achievement where Student.ID = Achievement.ID and Achievement.ID = 4;</p> 
<p></p> 
<p>删除前表的数据：</p> 
<p>子表（student：学生表）</p> 
<p><img alt="" height="154" src="https://images2.imgbox.com/69/7a/CD7lWTni_o.png" width="271"></p> 
<p>父表（achievement：学生成绩表）</p> 
<p><img alt="" height="151" src="https://images2.imgbox.com/c2/50/HfO94i6T_o.png" width="268"></p> 
<p></p> 
<p>删除后表的数据：</p> 
<p>子表（student：学生表）</p> 
<p><img alt="" height="123" src="https://images2.imgbox.com/af/5a/u1jN3E2C_o.png" width="271"></p> 
<p> 父表（achievement：学生成绩表）</p> 
<h4 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="124" src="https://images2.imgbox.com/00/2e/DCqB7bVq_o.png" width="270"></h4> 
<p></p> 
<p><strong>“蟹老板” -1。</strong><strong>我喜欢钱💰~</strong></p> 
<p><img alt="" height="495" src="https://images2.imgbox.com/bf/8c/7hRxXuK6_o.png" width="769"></p> 
<p></p> 
<p></p> 
<p><strong>好了，删到最后，就只剩下了邻居三人组了，拜拜啦~</strong></p> 
<p><img alt="" height="123" src="https://images2.imgbox.com/b1/ce/MEl1tKpy_o.png" width="271"></p> 
<p><img alt="" height="662" src="https://images2.imgbox.com/ec/42/flzdrfmN_o.png" width="1059"></p> 
<p><img alt="" height="240" src="https://images2.imgbox.com/1f/7c/ozwwMjj9_o.jpg" width="240">  </p> 
<p><img alt="" height="190" src="https://images2.imgbox.com/af/28/TTIoZB5F_o.gif" width="190">完。。。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/62a7174cbbd792ac368ff74a2e066c62/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[23000][1452] Cannot add or update a child row: a foreign key constraint fails (`test2`.`#sql-1238_5</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ae79cb97037f2bb65013950d3550439a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">阿姆斯特朗数也就是俗称的水仙花数，是指一个三位数，其各位数字的立方和等于该数本身。例如：153=1^3&#43;5^3&#43;3^3，所以 153 就是一个水仙花数。求出所有的水仙花数。</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>