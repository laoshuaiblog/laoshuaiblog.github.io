<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ORACLE 11G R2 PSU 补丁升级过程-SinoDB - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/3dc7c19558b05e9b8f6bd06c6ff5e23d/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="ORACLE 11G R2 PSU 补丁升级过程-SinoDB">
  <meta property="og:description" content="1. psu 概述
Oracle PSU的全名是Patch Set Update，是Oracle对于发行的官方补丁包，包含了bug的修复。Oracle选取被用户下载数量多，且被验证过具有较低风险的补丁放入到每个季度的PSU中。在每个PSU中不但包含Bug的修复而且还包含了最新的CPU。PSU通常随CPU一起发布。
在新部署环境建议打上最新的补丁包
2. 升级环境描述
本次升级基本环境如下：
数据库版本
系统版本
升级psu版本
patch文件名
oracle 11.2.0.4
redhat 7.4
11.2.0.4.190416 p29255947
2016年1月份推出对PSU、SPU、Bundle Patch新的命名规则。 新的命名规则为（以11.2.0.4为例）：11.2.0.4.YYMMDD ，YYMMDD为主要patch （PSU、SPU、Bundle）发布的具体日期年份后两位、两位的月份以及两位的日期。如：11.2.0.4.190416表示这11.2.0.4的PSU 是在19年4月16日推出的patch。
3. 升级详细步骤
此升级oracle psu详细步骤如下：
[root@zfbadb1]mkdir /patch
[root@zfbadb1]mv p6880880_112000_Linux-x86-64.zip p29255947_112040_Linux-x86-64.zip /patch/
[root@zfbadb1]cd /u01/app/11.2/grid/
[root@zfbadb1]mv OPatch OPatch_bak
[root@zfbadb1]unzip /patch/p6880880_112000_Linux-x86-64.zip -d ./
[root@zfbadb1]chmod -R 777 OPatch
[root@zfbadb1]chown -R grid:oinstall OPatch
ll OPatch*
OPatch:
total 176
drwxr-x--- 6 grid oinstall 4096 Jun 13 17:54 auto
drwxr-x--- 2 grid oinstall 4096 Jun 13 17:54 config">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-11T09:26:26+08:00">
    <meta property="article:modified_time" content="2024-03-11T09:26:26+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ORACLE 11G R2 PSU 补丁升级过程-SinoDB</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0;text-align:justify;"><span style="color:#121212;"><span style="background-color:#ffffff;">1. psu 概述</span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#121212;"><span style="background-color:#ffffff;">Oracle PSU的全名是Patch Set Update，是Oracle对于发行的官方补丁包，包含了bug的修复。Oracle选取被用户下载数量多，且被验证过具有较低风险的补丁放入到每个季度的PSU中。在每个PSU中不但包含Bug的修复而且还包含了最新的CPU。PSU通常随CPU一起发布。</span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#121212;"><span style="background-color:#ffffff;">在新部署环境建议打上最新的补丁包</span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#121212;"><span style="background-color:#ffffff;">2. 升级环境描述</span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#121212;"><span style="background-color:#ffffff;">本次升级基本环境如下：</span></span></p> 
<table border="1" cellspacing="0"><tbody><tr><td style="background-color:#ffffff;border-color:#eeeeee;vertical-align:middle;"> <p style="margin-left:0;">数据库版本</p> </td><td style="background-color:#ffffff;border-color:#eeeeee;vertical-align:middle;"> <p style="margin-left:0;">系统版本</p> </td><td style="background-color:#ffffff;border-color:#eeeeee;vertical-align:middle;"> <p style="margin-left:0;">升级psu版本</p> </td><td style="background-color:#ffffff;border-color:#eeeeee;vertical-align:middle;"> <p style="margin-left:0;">patch文件名</p> </td></tr><tr><td style="background-color:#ffffff;border-color:#eeeeee;vertical-align:middle;"> <p style="margin-left:0;">oracle 11.2.0.4</p> </td><td style="background-color:#ffffff;border-color:#eeeeee;vertical-align:middle;"> <p style="margin-left:0;">redhat 7.4</p> </td><td style="background-color:#ffffff;border-color:#eeeeee;vertical-align:middle;"> <p style="margin-left:0;"><strong>11.2.0.4.190416 </strong></p> </td><td style="background-color:#ffffff;border-color:#eeeeee;vertical-align:middle;"> <p style="margin-left:0;">p29255947</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"><span style="color:#121212;"><span style="background-color:#ffffff;">2016年1月份推出对PSU、SPU、Bundle Patch新的命名规则。 新的命名规则为（以11.2.0.4为例）：11.2.0.4.YYMMDD ，YYMMDD为主要patch （PSU、SPU、Bundle）发布的具体日期年份后两位、两位的月份以及两位的日期。如：11.2.0.4.190416表示这11.2.0.4的PSU 是在19年4月16日推出的patch。</span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#121212;"><span style="background-color:#ffffff;">3. 升级详细步骤</span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#121212;"><span style="background-color:#ffffff;">此升级oracle psu详细步骤如下：</span></span></p> 
<table border="1" cellspacing="0"><tbody><tr><td style="background-color:#ffffff;border-color:#eeeeee;vertical-align:middle;"> <p style="margin-left:0;">[root@zfbadb1]mkdir /patch</p> <p style="margin-left:0;">[root@zfbadb1]mv p6880880_112000_Linux-x86-64.zip p29255947_112040_Linux-x86-64.zip /patch/</p> <p style="margin-left:0;">[root@zfbadb1]cd /u01/app/11.2/grid/</p> <p style="margin-left:0;">[root@zfbadb1]mv OPatch OPatch_bak</p> <p style="margin-left:0;">[root@zfbadb1]unzip /patch/p6880880_112000_Linux-x86-64.zip -d ./</p> <p style="margin-left:0;">[root@zfbadb1]chmod -R 777 OPatch</p> <p style="margin-left:0;">[root@zfbadb1]chown -R grid:oinstall OPatch</p> <p style="margin-left:0;">ll OPatch*</p> <p style="margin-left:0;">OPatch:</p> <p style="margin-left:0;">total 176</p> <p style="margin-left:0;">drwxr-x--- 6 grid oinstall  4096 Jun 13 17:54 auto</p> <p style="margin-left:0;">drwxr-x--- 2 grid oinstall  4096 Jun 13 17:54 config</p> <p style="margin-left:0;">drwxr-x--- 3 grid oinstall  4096 Jun 13 17:54 crs</p> <p style="margin-left:0;">drwxr-x--- 2 grid oinstall  4096 Jun 13 17:54 docs</p> <p style="margin-left:0;">-rwxr-x--- 1 grid oinstall 23550 Jun 13 17:54 emdpatch.pl</p> <p style="margin-left:0;">drwxr-x--- 2 grid oinstall  4096 Jun 13 17:54 jlib</p> <p style="margin-left:0;">drwxr-x--- 6 grid oinstall  4096 Jun 13 17:54 jre</p> <p style="margin-left:0;">drwxr-x--- 9 grid oinstall  4096 Jun 13 17:54 modules</p> <p style="margin-left:0;">drwxr-x--- 5 grid oinstall  4096 Jun 13 17:54 ocm</p> <p style="margin-left:0;">-rwxr-x--- 1 grid oinstall 48493 Jun 13 17:54 opatch</p> <p style="margin-left:0;">-rwxr-x--- 1 grid oinstall 16326 Jun 13 17:54 opatch.bat</p> <p style="margin-left:0;">-rwxr-x--- 1 grid oinstall  4290 Jun 13 17:54 opatch_env.sh</p> <p style="margin-left:0;">-rw-r----- 1 grid oinstall  2551 Jun 13 17:54 opatch.pl</p> <p style="margin-left:0;">drwxr-x--- 4 grid oinstall  4096 Jun 13 17:54 opatchprereqs</p> <p style="margin-left:0;">-rwxr-x--- 1 grid oinstall  3159 Jun 13 17:54 operr</p> <p style="margin-left:0;">-rwxr-x--- 1 grid oinstall  4218 Jun 13 17:54 operr.bat</p> <p style="margin-left:0;">-rw-r----- 1 grid oinstall  3177 Jun 13 17:54 operr_readme.txt</p> <p style="margin-left:0;">drwxr-x--- 3 grid oinstall  4096 Jun 13 17:54 oplan</p> <p style="margin-left:0;">drwxr-x--- 3 grid oinstall  4096 Jun 13 17:54 oracle_common</p> <p style="margin-left:0;">drwxr-x--- 3 grid oinstall  4096 Jun 13 17:54 plugins</p> <p style="margin-left:0;">-rw-r----- 1 grid oinstall  2915 Jun 13 17:54 README.txt</p> <p style="margin-left:0;">drwxr-x--- 2 grid oinstall  4096 Jun 13 17:54 scripts</p> <p style="margin-left:0;">-rw-r----- 1 grid oinstall    27 Jun 13 17:54 version.txt</p> <p style="margin-left:0;">OPatch_bak:</p> <p style="margin-left:0;">total 132</p> <p style="margin-left:0;">drwxr-xr-x 3 grid oinstall  4096 Jun 13 10:04 crs</p> <p style="margin-left:0;">drwxr-xr-x 2 grid oinstall  4096 Jun 13 10:04 docs</p> <p style="margin-left:0;">-rw-r----- 1 grid oinstall 23695 Aug  2  2010 emdpatch.pl</p> <p style="margin-left:0;">drwxr-xr-x 3 grid oinstall  4096 Jun 13 10:04 jlib</p> <p style="margin-left:0;">drwxr-xr-x 5 grid oinstall  4096 Jun 13 10:04 ocm</p> <p style="margin-left:0;">-rwx--x--- 1 grid oinstall 31493 May 28  2013 opatch</p> <p style="margin-left:0;">-rwx--x--- 1 grid oinstall 19867 May 28  2013 opatch.bat</p> <p style="margin-left:0;">-rwx--x--- 1 grid oinstall 10056 Mar 31  2011 opatchdiag</p> <p style="margin-left:0;">-rwx--x--- 1 grid oinstall  9352 Mar 31  2011 opatchdiag.bat</p> <p style="margin-left:0;">-rw-r----- 1 grid oinstall    49 Jun 13 10:04 opatch.ini</p> <p style="margin-left:0;">-rw-r----- 1 grid oinstall  2576 May  6  2009 opatch.pl</p> <p style="margin-left:0;">drwxr-xr-x 4 grid oinstall  4096 Jun 13 10:04 opatchprereqs</p> <p style="margin-left:0;">drwxr-xr-x 3 grid oinstall  4096 Jun 13 10:04 oplan</p> <p style="margin-left:0;">[root@zfbadb1]# su - oracle</p> <p style="margin-left:0;">Last login: Thu Jun 13 16:15:23 CST 2019 on pts/1</p> <p style="margin-left:0;">[root@zfbadb1]$ echo $ORACLE_HOME</p> <p style="margin-left:0;">/u01/app/oracle/product/11.2</p> <p style="margin-left:0;">[root@zfbadb1]$ cd $ORACLE_HOME</p> <p style="margin-left:0;">[root@zfbadb1]$ mv OPatch OPatch_bak</p> <p style="margin-left:0;">[root@zfbadb1]$ unzip /patch/p6880880_112000_Linux-x86-64.zip -d ./</p> <p style="margin-left:0;">[root@zfbadb1]$ exit</p> <p style="margin-left:0;">logout</p> <p style="margin-left:0;">[root@zfbadb1 grid]#</p> <p style="margin-left:0;">[root@zfbadb1 grid]#</p> <p style="margin-left:0;">[root@zfbadb1 grid]]#</p> <p style="margin-left:0;">[root@zfbadb1 grid]# ll -d OPatch*</p> <p style="margin-left:0;">drwxr-xr-x 15 grid oinstall 4096 Jun 13 17:54 OPatch</p> <p style="margin-left:0;">drwxr-xr-x  8 grid oinstall 4096 Jun 13 10:04 OPatch_20190613</p> <p style="margin-left:0;">[root@dntodu001 grid]# su - grid</p> <p style="margin-left:0;">Last login: Thu Jun 13 18:00:09 CST 2019</p> <p style="margin-left:0;">[root@zfbadb1 grid]$ $ORACLE_HOME/OPatch/opatch version</p> <p style="margin-left:0;">OPatch Version: 11.2.0.3.21</p> <p style="margin-left:0;">OPatch succeeded.</p> <p style="margin-left:0;">[root@zfbadb1 grid]$</p> <p style="margin-left:0;">[root@zfbadb1 grid] cd /patch/</p> <p style="margin-left:0;">[root@zfbadb1 grid] unzip p29255947_112040_Linux-x86-64.zip</p> <p style="margin-left:0;">[root@zfbadb1] chmod -R 777 /patch/29255947</p> <p style="margin-left:0;"></p> <p style="margin-left:0;"><strong>正式打</strong><strong>psu</strong><strong>前需要，生成环境文件，需要在</strong><strong>grid</strong><strong>用户下生成。</strong><strong>oracle</strong><strong>用户的环境文件在</strong><strong>oracle</strong><strong>用户下生成：</strong><strong>/u01/app/oracle/product/11.2.0.4/OPatch/ocm/bin/</strong><strong>下</strong></p> <p style="margin-left:0;"></p> <p style="margin-left:0;">[root@zfbadb1] chown grid:oinstall -R /patch/</p> <p style="margin-left:0;">[grid@zfbadb1]$ cd /u01/app/11.2/grid/OPatch/ocm/bin/</p> <p style="margin-left:0;">[grid@zfbadb1]$ ./emocmrsp</p> <p style="margin-left:0;">OCM Installation Response Generator 10.3.7.0.0 - Production</p> <p style="margin-left:0;">Copyright (c) 2005, 2012, Oracle and/or its affiliates.  All rights reserved.</p> <p style="margin-left:0;">Provide your email address to be informed of security issues, install and</p> <p style="margin-left:0;">initiate Oracle Configuration Manager. Easier for you if you use your My</p> <p style="margin-left:0;">Oracle Support Email address/User Name.</p> <p style="margin-left:0;">Visit http://www.oracle.com/support/policies.html for details.</p> <p style="margin-left:0;">Email address/User Name:</p> <p style="margin-left:0;">You have not provided an email address for notification of security issues.</p> <p style="margin-left:0;">Do you wish to remain uninformed of security issues ([Y]es, [N]o) [N]:  y</p> <p style="margin-left:0;">The OCM configuration response file (ocm.rsp) was successfully created.</p> <p style="margin-left:0;">[grid@zfbadb1 bin]$</p> <p style="margin-left:0;">[grid@zfbadb1 bin]$ exit</p> <p style="margin-left:0;">logout</p> <p style="margin-left:0;">[root@zfbadb1 grid]#</p> <p style="margin-left:0;">打psu前面需要先确认psu文件权限属主属组要修改为grid:oinstall 。打Oracle psu时，修改为oracle:oinstall</p> <p style="margin-left:0;">[root@dntodu001 grid]# /u01/app/11.2/grid/OPatch/opatch auto /patch/29255947/ -oh /u01/app/11.2/grid/ -ocmrf /u01/app/11.2/grid/OPatch/ocm/bin/ocm.rsp</p> <p style="margin-left:0;">Executing /u01/app/11.2/grid/perl/bin/perl /u01/app/11.2/grid/OPatch/crs/patch11203.pl -patchdir /u01/soft -patchn 29255947 -oh /u01/app/11.2/grid/ -ocmrf /u01/app/11.2/grid/OPatch/ocm/bin/ocm.rsp -paramfile /u01/app/11.2/grid/crs/install/crsconfig_params</p> <p style="margin-left:0;">This is the main log file: /u01/app/11.2/grid/cfgtoollogs/opatchauto2021-01-29_18-20-20.log</p> <p style="margin-left:0;">This file will show your detected configuration and all the steps that opatchauto attempted to do on your system:</p> <p style="margin-left:0;">/u01/app/11.2/grid/cfgtoollogs/opatchauto2021-01-29_18-20-20.report.log</p> <p style="margin-left:0;">2019-06-13 18:20:20: Starting Clusterware Patch Setup</p> <p style="margin-left:0;">Using configuration parameter file: /u01/app/11.2/grid/crs/install/crsconfig_params</p> <p style="margin-left:0;">Stopping CRS...</p> <p style="margin-left:0;">Stopped CRS successfully</p> <p style="margin-left:0;">patch /u01/soft/29255947/29141201  apply successful for home  /u01/app/11.2/grid</p> <p style="margin-left:0;">patch /u01/soft/29255947/29141056  apply successful for home  /u01/app/11.2/grid</p> <p style="margin-left:0;">patch /u01/soft/29255947/28729245  apply successful for home  /u01/app/11.2/grid</p> <p style="margin-left:0;">Starting CRS...</p> <p style="margin-left:0;">Installing Trace File Analyzer</p> <p style="margin-left:0;">CRS-4123: Oracle High Availability Services has been started.</p> <p style="margin-left:0;">opatch auto succeeded.</p> <p style="margin-left:0;">[root@zfbadb1 grid]#</p> <p style="margin-left:0;">[root@zagldb1 ~]# chown oracle:oinstall -R /patch/</p> <p style="margin-left:0;">[root@zagldb1 ~]$ cd /u01/app/oracle/product/11.2/OPatch/ocm/bin/</p> <p style="margin-left:0;">[oracle@zagldb1 bin]$ ./emocmrsp</p> <p style="margin-left:0;">OCM Installation Response Generator 10.3.7.0.0 - Production</p> <p style="margin-left:0;">Copyright (c) 2005, 2012, Oracle and/or its affiliates.  All rights reserved.</p> <p style="margin-left:0;">Provide your email address to be informed of security issues, install and</p> <p style="margin-left:0;">initiate Oracle Configuration Manager. Easier for you if you use your My</p> <p style="margin-left:0;">Oracle Support Email address/User Name.</p> <p style="margin-left:0;">Visit http://www.oracle.com/support/policies.html for details.</p> <p style="margin-left:0;">Email address/User Name:</p> <p style="margin-left:0;">You have not provided an email address for notification of security issues.</p> <p style="margin-left:0;">Do you wish to remain uninformed of security issues ([Y]es, [N]o) [N]:  y</p> <p style="margin-left:0;">The OCM configuration response file (ocm.rsp) was successfully created.</p> <p style="margin-left:0;">[oracle@zagldb1 bin]$</p> <p style="margin-left:0;">[root@zagldb1 11.2]# /u01/app/oracle/product/11.2/OPatch/opatch auto /patch/29255947/ -oh /u01/app/oracle/product/11.2/ -ocmrf /u01/app/oracle/product/11.2/OPatch/ocm/bin/ocm.rsp</p> <p style="margin-left:0;">Executing /u01/app/11.2/grid/perl/bin/perl /u01/app/oracle/product/11.2/OPatch/crs/patch11203.pl -patchdir /u01/soft -patchn 29255947 -oh /u01/app/oracle/product/11.2/ -ocmrf /u01/app/oracle/product/11.2/OPatch/ocm/bin/ocm.rsp -paramfile /u01/app/11.2/grid/crs/install/crsconfig_params</p> <p style="margin-left:0;">This is the main log file: /u01/app/oracle/product/11.2/cfgtoollogs/opatchauto2021-01-29_18-35-16.log</p> <p style="margin-left:0;">This file will show your detected configuration and all the steps that opatchauto attempted to do on your system:</p> <p style="margin-left:0;">/u01/app/oracle/product/11.2/cfgtoollogs/opatchauto2021-01-29_18-35-16.log</p> <p style="margin-left:0;">2019-06-13 18:35:16: Starting Clusterware Patch Setup</p> <p style="margin-left:0;">Using configuration parameter file: /u01/app/11.2/grid/crs/install/crsconfig_params</p> <p style="margin-left:0;">Stopping RAC /u01/app/oracle/product/11.2 ...</p> <p style="margin-left:0;">Stopped RAC /u01/app/oracle/product/11.2 successfully</p> <p style="margin-left:0;">patch /u01/soft/29255947/29141201/custom/server/29141201  apply successful for home  /u01/app/oracle/product/11.2</p> <p style="margin-left:0;">patch /u01/soft/29255947/29141056  apply successful for home  /u01/app/oracle/product/11.2</p> <p style="margin-left:0;">Starting RAC /u01/app/oracle/product/11.2 ...</p> <p style="margin-left:0;">Started RAC /u01/app/oracle/product/11.2 successfully</p> <p style="margin-left:0;">opatch auto succeeded.</p> <p style="margin-left:0;">[root@zagldb1 11.2]#</p> </td></tr></tbody></table>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/730472aba34539dc5a332376cf882ba4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">华为云平台部署虚拟机-SinoDB</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/55247f1d177fe5878ba7c5e40e917215/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">打字通小游戏制作教程：用HTML5和JavaScript提升打字速度</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>