<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>kafka从部署到Java springboot整合 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/72dc658524ef430c5f677c0a49127ba4/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="kafka从部署到Java springboot整合">
  <meta property="og:description" content="一、部署zookeeper服务（单机） 温馨提示：部署zookeeper前请务必自己搭建并配置好java环境
服务器环境：centos7
zookeeper版本：zookeeper-3.4.6
zookeeper安装包：zookeeper-3.4.6.tar.gz
1、zookeeper下载 cd /home/root wget https://archive.apache.org/dist/zookeeper/zookeeper-3.4.6/zookeeper-3.4.6.tar.gz 2、解压、配置和启动zookeeper服务 # 解压 cd /home/root tar -xf zookeeper-3.4.6.tar.gz mv zookeeper-3.4.6 zookeeper # 进入conf目录修改zookeeper配置参数 cd /home/root/zookeeper/conf # 修改zoo_sample.cfg名为zoo.cfg # 因为zookeeper启动脚本zkServer.sh启动时会执行zkEnv.sh脚本，zkEnv.sh中会去找conf目录下的zoo.cfg文件作为配置文件加载 mv zoo_sample.cfg zoo.cfg # 修改dataDir值为/home/root/zookeeper/zookeeper/data # 添加dataLogDir=/home/root/zookeeper/zookeeper/logs vim zoo.cfg # 配置zookeeper环境变量 vim /etc/profile # 添加配置 export ZK_HOME=/home/root/zookeeper/zookeeper export PATH=.:$ZK_HOME/bin:$PATH # 环境变量生效 source /etc/profile # 启动zookeeper服务 zkServer.sh start # 查看zk状态 zkServer.sh status 3、查看zookeeper服务状态 二、部署kafka服务（单机） kafka版本：kafka_2.12-2.3.1
kafka安装包：kafka_2.12-2.3.1.tgz
1、kafka下载 cd /home/root wget https://mirrors.tuna.tsinghua.edu.cn/apache/kafka/2.3.1/kafka_2.12-2.3.1.tgz 2、解压、配置和启动kafka服务 cd /home/root/kafka/config # 修改server.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-07-08T18:41:19+08:00">
    <meta property="article:modified_time" content="2020-07-08T18:41:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">kafka从部署到Java springboot整合</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="zookeeper_0"></a>一、部署zookeeper服务（单机）</h5> 
<p>温馨提示：<font color="green" size="3"><em>部署zookeeper前请务必自己搭建并配置好java环境</em></font></p> 
<blockquote> 
 <p>服务器环境：centos7<br> zookeeper版本：zookeeper-3.4.6<br> zookeeper安装包：zookeeper-3.4.6.tar.gz</p> 
</blockquote> 
<h6><a id="1zookeeper_5"></a>1、zookeeper下载</h6> 
<pre><code class="prism language-shell"><span class="token function">cd</span> /home/root
<span class="token function">wget</span> https://archive.apache.org/dist/zookeeper/zookeeper-3.4.6/zookeeper-3.4.6.tar.gz
</code></pre> 
<h6><a id="2zookeeper_10"></a>2、解压、配置和启动zookeeper服务</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 解压</span>
<span class="token function">cd</span> /home/root
<span class="token function">tar</span> -xf zookeeper-3.4.6.tar.gz
<span class="token function">mv</span> zookeeper-3.4.6 zookeeper
<span class="token comment"># 进入conf目录修改zookeeper配置参数</span>
<span class="token function">cd</span> /home/root/zookeeper/conf
<span class="token comment"># 修改zoo_sample.cfg名为zoo.cfg</span>
<span class="token comment"># 因为zookeeper启动脚本zkServer.sh启动时会执行zkEnv.sh脚本，zkEnv.sh中会去找conf目录下的zoo.cfg文件作为配置文件加载</span>
<span class="token function">mv</span> zoo_sample.cfg zoo.cfg
<span class="token comment"># 修改dataDir值为/home/root/zookeeper/zookeeper/data</span>
<span class="token comment"># 添加dataLogDir=/home/root/zookeeper/zookeeper/logs</span>
vim zoo.cfg
<span class="token comment"># 配置zookeeper环境变量</span>
vim /etc/profile
<span class="token comment"># 添加配置</span>
<span class="token function">export</span> ZK_HOME<span class="token operator">=</span>/home/root/zookeeper/zookeeper
<span class="token function">export</span> PATH<span class="token operator">=</span>.:<span class="token variable">$ZK_HOME</span>/bin:<span class="token variable">$PATH</span>
<span class="token comment"># 环境变量生效</span>
<span class="token function">source</span> /etc/profile
<span class="token comment"># 启动zookeeper服务</span>
zkServer.sh start
<span class="token comment"># 查看zk状态</span>
zkServer.sh status
</code></pre> 
<h6><a id="3zookeeper_36"></a>3、查看zookeeper服务状态</h6> 
<p><img src="https://images2.imgbox.com/b1/86/FetmpD9t_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="kafka_38"></a>二、部署kafka服务（单机）</h5> 
<blockquote> 
 <p>kafka版本：kafka_2.12-2.3.1<br> kafka安装包：kafka_2.12-2.3.1.tgz</p> 
</blockquote> 
<h6><a id="1kafka_41"></a>1、kafka下载</h6> 
<pre><code class="prism language-shell"><span class="token function">cd</span> /home/root
<span class="token function">wget</span> https://mirrors.tuna.tsinghua.edu.cn/apache/kafka/2.3.1/kafka_2.12-2.3.1.tgz
</code></pre> 
<h6><a id="2kafka_46"></a>2、解压、配置和启动kafka服务</h6> 
<pre><code class="prism language-shell"><span class="token function">cd</span> /home/root/kafka/config
<span class="token comment"># 修改server.properties</span>
<span class="token comment"># 修改advertised.listeners值为服务器ip,否则java项目启动会报错</span>
log.dirs<span class="token operator">=</span>/home/root/kafka/logs
advertised.listeners<span class="token operator">=</span>PLAINTEXT://服务器ip:9092
<span class="token comment"># 启动kafka后台运行</span>
<span class="token function">cd</span> /home/root/kafka
<span class="token function">nohup</span> ./bin/kafka-server-start.sh config/server.properties <span class="token operator">&amp;</span>
</code></pre> 
<h6><a id="3kafka_topic_57"></a>3、创建kafka topic</h6> 
<p><font color="green">创建topic，为我们下面java项目服务</font></p> 
<pre><code class="prism language-shell"><span class="token comment"># 创建一个topic为hello</span>
<span class="token comment"># replication-factor : 副本数</span>
<span class="token comment"># partitions : 分区数</span>
<span class="token comment"># topic ：主题名称</span>
<span class="token function">cd</span> /home/root/kafka
./bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic hello
</code></pre> 
<p><code>至此，kafka服务部署完成，接下来我们开始在java中使用kafka</code></p> 
<h5><a id="springboot_68"></a>三、搭建springboot项目</h5> 
<h6><a id="1maven_69"></a>1、maven依赖导入</h6> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mvnrepository<span class="token punctuation">.</span>com<span class="token operator">/</span>artifact<span class="token operator">/</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token operator">/</span>spring<span class="token operator">-</span>kafka <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token generics function"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>kafka<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.5</span><span class="token number">.2</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<h6><a id="2_78"></a>2、配置</h6> 
<pre><code class="prism language-yaml">server.port=8989
<span class="token comment">###########【Kafka集群】###########</span>
spring.kafka.bootstrap<span class="token punctuation">-</span>servers=192.168.10.8<span class="token punctuation">:</span><span class="token number">9092</span>

<span class="token comment">###########【初始化生产者配置】###########</span>
<span class="token comment"># 重试次数</span>
spring.kafka.producer.retries=0
<span class="token comment"># 应答级别:多少个分区副本备份完成时向生产者发送ack确认(可选0、1、all/-1)</span>
spring.kafka.producer.acks=1
<span class="token comment"># 批量大小</span>
spring.kafka.producer.batch<span class="token punctuation">-</span>size=16384
<span class="token comment"># 提交延时</span>
spring.kafka.producer.properties.linger.ms=0
<span class="token comment"># 当生产端积累的消息达到batch-size或接收到消息linger.ms后,生产者就会将消息提交给kafka</span>
<span class="token comment"># linger.ms为0表示每接收到一条消息就提交给kafka,这时候batch-size其实就没用了</span>

<span class="token comment"># 生产端缓冲区大小</span>
spring.kafka.producer.buffer<span class="token punctuation">-</span>memory=33554432
<span class="token comment"># Kafka提供的序列化和反序列化类</span>
spring.kafka.producer.key<span class="token punctuation">-</span>serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value<span class="token punctuation">-</span>serializer=org.apache.kafka.common.serialization.StringSerializer
​
<span class="token comment">###########【初始化消费者配置】###########</span>
<span class="token comment"># 默认的消费组ID</span>
spring.kafka.consumer.properties.group.id=defaultConsumerGroup
<span class="token comment"># 是否自动提交offset</span>
spring.kafka.consumer.enable<span class="token punctuation">-</span>auto<span class="token punctuation">-</span>commit=true
<span class="token comment"># 提交offset延时(接收到消息后多久提交offset)</span>
spring.kafka.consumer.auto.commit.interval.ms=0
<span class="token comment"># 当kafka中没有初始offset或offset超出范围时将自动重置offset</span>
<span class="token comment"># earliest:重置为分区中最小的offset;</span>
<span class="token comment"># latest:重置为分区中最新的offset(消费分区中新产生的数据);</span>
<span class="token comment"># none:只要有一个分区不存在已提交的offset,就抛出异常;</span>
spring.kafka.consumer.auto<span class="token punctuation">-</span>offset<span class="token punctuation">-</span>reset=latest
<span class="token comment"># 消费会话超时时间(超过这个时间consumer没有发送心跳,就会触发rebalance操作)</span>
spring.kafka.consumer.properties.session.timeout.ms=120000
<span class="token comment"># 消费请求超时时间</span>
spring.kafka.consumer.properties.request.timeout.ms=180000
<span class="token comment"># Kafka提供的序列化和反序列化类</span>
spring.kafka.consumer.key<span class="token punctuation">-</span>deserializer=org.apache.kafka.common.serialization.StringDeserializer
spring.kafka.consumer.value<span class="token punctuation">-</span>deserializer=org.apache.kafka.common.serialization.StringDeserializer
<span class="token comment"># 消费端监听的topic不存在时，关掉项目启动报错</span>
spring.kafka.listener.missing<span class="token punctuation">-</span>topics<span class="token punctuation">-</span>fatal=false
</code></pre> 
<p><code>准备工作完成。</code><br> <code>接下来我们采用Controller模拟传入消息触发kafka生产者生产消息，用@KafkaListener注解开启kafka消费者消费（监听消息）</code></p> 
<p><font color="green">以下消息输出采用日志打印，请在项目中加入maven依赖</font></p> 
<pre><code class="prism language-java"><span class="token generics function"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>projectlombok<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>lombok<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics function"><span class="token punctuation">&lt;</span>optional<span class="token punctuation">&gt;</span></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>optional<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<h6><a id="3KafkaController_135"></a>3、创建KafkaController模拟消息创建者</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">;</span>

<span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>core<span class="token punctuation">.</span>KafkaTemplate<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token comment">/**
 * @Description : 模拟消息进入，创建kafka消息（生产者）
 * @Author : xu_teng_chao@163.com
 * @CreateTime : 2020/7/7 12:39 下午
 */</span>
<span class="token annotation punctuation">@Slf4j</span> 
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> KafkaTemplate<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> kafkaTemplate<span class="token punctuation">;</span>

	<span class="token comment">// 异步发送消息（无回调）</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/sendMsg"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMessage1</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"msg"</span><span class="token punctuation">)</span> String normalMessage<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        String topic <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span> <span class="token comment">// kafka主题</span>
        kafkaTemplate<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> <span class="token string">"你好"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="4kafkaConsumerkafka_163"></a>4、创建kafkaConsumer监听kafka消息</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">;</span>

<span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span>ConsumerRecord<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>KafkaListener<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Component<span class="token punctuation">;</span>

<span class="token comment">/**
 * @Description : kafka消费者
 * @Author : xu_teng_chao@163.com
 * @CreateTime : 2020/7/7 12:40 下午
 */</span>
<span class="token annotation punctuation">@Slf4j</span> 
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaConsumer</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">// 消费监听,topics写入我们创建的topic</span>
    <span class="token annotation punctuation">@KafkaListener</span><span class="token punctuation">(</span>topics <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"hello"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">listen1</span><span class="token punctuation">(</span>ConsumerRecord<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span> record<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        String msg <span class="token operator">=</span> record<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// 消息内容</span>
        Integer partition <span class="token operator">=</span> record<span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 分区</span>
        Long timestamp <span class="token operator">=</span> record<span class="token punctuation">.</span><span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 时间戳</span>
        Long offset <span class="token operator">=</span> record<span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			 <span class="token comment">// offset（偏移）</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"kafka consumer message:{}; partition:{}; offset:{}; timestamp:{}"</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> partition<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="5_192"></a>5、启动项目测试</h6> 
<p><code>①、使用curl发起请求：</code></p> 
<pre><code class="prism language-shell"><span class="token function">curl</span> -XPOST http://localhost:8989/sendMsg -d <span class="token string">'msg=你好'</span>
</code></pre> 
<p><code>②、使用postman发起请求：</code><br> <img src="https://images2.imgbox.com/e5/7a/VRXk6UFr_o.png" alt="在这里插入图片描述"><br> <font color="green">监听到的结果：</font></p> 
<pre><code class="prism language-java"><span class="token number">2020</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">18</span><span class="token operator">:</span><span class="token number">31</span><span class="token operator">:</span><span class="token number">42.411</span>  INFO <span class="token number">6085</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>ntainer#<span class="token number">0</span><span class="token operator">-</span><span class="token number">0</span><span class="token operator">-</span>C<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">.</span>KafkaConsumer      <span class="token operator">:</span> kafka consumer message<span class="token operator">:</span>你好<span class="token punctuation">;</span> partition<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">;</span> offset<span class="token operator">:</span><span class="token number">385</span><span class="token punctuation">;</span> timestamp<span class="token operator">:</span><span class="token number">1594204302340</span>
</code></pre> 
<h5><a id="kafkaTemplate_203"></a>四、kafkaTemplate异步回调</h5> 
<blockquote> 
 <p><font color="green">默认情况下 KafkaTemplate 发送消息是采取异步方式，上面演示的也是异步发送消息的一种。<br> 接下来我们演示异步回调发送消息。异步回调的好处：可以在发送消息后得知消息是否发送成功，便于方便根据成功与否及时补偿。</font></p> 
</blockquote> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">;</span>

<span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>core<span class="token punctuation">.</span>KafkaTemplate<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token comment">/**
 * @Description : 模拟消息进入，创建kafka消息（生产者）
 * @Author : xu_teng_chao@163.com
 * @CreateTime : 2020/7/7 12:39 下午
 */</span>
<span class="token annotation punctuation">@Slf4j</span> 
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> KafkaTemplate<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> kafkaTemplate<span class="token punctuation">;</span>

	<span class="token comment">// 异步发送消息（回调）</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/sendMsg2"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMessage2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"msg"</span><span class="token punctuation">)</span> String normalMessage<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        String topic <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
        kafkaTemplate<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> normalMessage<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addCallback</span><span class="token punctuation">(</span>success <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
            String topicStr <span class="token operator">=</span> success<span class="token punctuation">.</span><span class="token function">getRecordMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">topic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> partition <span class="token operator">=</span> success<span class="token punctuation">.</span><span class="token function">getRecordMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span> offset <span class="token operator">=</span> success<span class="token punctuation">.</span><span class="token function">getRecordMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"send msg success!; topic = {}, partition = {}, offset = {}"</span><span class="token punctuation">,</span> topicStr<span class="token punctuation">,</span> partition<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> failed <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"send msg failed! errMsg : {}"</span><span class="token punctuation">,</span> failed<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*
    // 异步发送消息（无回调）
    @PostMapping("/sendMsg")
    public void sendMessage1(@RequestParam(value = "msg") String normalMessage) {
        String topic = "hello"; // kafka主题
        kafkaTemplate.send(topic, "你好");
    }
    */</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="kafkaTemplate_249"></a>五、kafkaTemplate同步发消息（无时间限制）</h5> 
<blockquote> 
 <p><font color="green">在kafkaTemplate.send()方法之后发送消息之后调用get()方法即同步发送消息。<br> get 方法返回的即为结果，如果发送失败则抛出异常。</font></p> 
</blockquote> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">;</span>

<span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>core<span class="token punctuation">.</span>KafkaTemplate<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token comment">/**
 * @Description : 模拟消息进入，创建kafka消息（生产者）
 * @Author : xu_teng_chao@163.com
 * @CreateTime : 2020/7/7 12:39 下午
 */</span>
<span class="token annotation punctuation">@Slf4j</span> 
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> KafkaTemplate<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> kafkaTemplate<span class="token punctuation">;</span>

	<span class="token comment">// 同步发送消息</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/sendMsg3"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMessage3</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"msg"</span><span class="token punctuation">)</span> String normalMessage<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        String topic <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            SendResult<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> kafkaTemplate<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> normalMessage<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String topic1 <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getRecordMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">topic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 消息发送到的topic</span>
            <span class="token keyword">int</span> partition <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getRecordMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 消息发送到的分区</span>
            <span class="token keyword">long</span> offset <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getRecordMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 消息在分区内的offset</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"send msg done. topic = {}, partition = {}, offset = {}"</span><span class="token punctuation">,</span> topic1<span class="token punctuation">,</span> partition<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

	<span class="token comment">/*
	// 异步发送消息（回调）
    @PostMapping("/sendMsg2")
    public void sendMessage2(@RequestParam(value = "msg") String normalMessage) {
        String topic = "hello";
        kafkaTemplate.send(topic, normalMessage).addCallback(success -&gt; {
            String topicStr = success.getRecordMetadata().topic();
            int partition = success.getRecordMetadata().partition();
            long offset = success.getRecordMetadata().offset();
            log.info("send msg success!; topic = {}, partition = {}, offset = {}", topicStr, partition, offset);
        }, failed -&gt; {
            log.error("send msg failed! errMsg : {}", failed.getMessage());
        });
    }
    */</span>

    <span class="token comment">/*
    // 异步发送消息（无回调）
    @PostMapping("/sendMsg")
    public void sendMessage1(@RequestParam(value = "msg") String normalMessage) {
        String topic = "hello"; // kafka主题
        kafkaTemplate.send(topic, "你好");
    }
    */</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="kafkaTemplate_314"></a>六、kafkaTemplate发送同步消息（时间限制）</h5> 
<blockquote> 
 <p><font color="green">调用get()方法的重载方法get(long timeout, TimeUnit unit)进行发送消息时间限制。</font><br> <font color="red">需要注意，这里时间限制是对整个结果的耗时（time）限制的：<br> 发送消息 -&gt; 消费者消费完成 -&gt; 返回消费结果。<br> 计时是从生产者产生消息开始计算。</font><br> <font color="green">如果设置的timeout小于time，则会捕获到消息发送失败异常，但是消费者依然对该消息进行了消费。可以理解为：生产者不管消费者有没有成功进行消费，只要时间到还没有收到响应，就立即抛出超时异常。</font></p> 
</blockquote> 
<p><code>我们设置时间限制（timeout）为1毫秒（故意演示失败效果），get(1, TimeUnit.MILLISECONDS)</code></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">;</span>

<span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>core<span class="token punctuation">.</span>KafkaTemplate<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token comment">/**
 * @Description : 模拟消息进入，创建kafka消息（生产者）
 * @Author : xu_teng_chao@163.com
 * @CreateTime : 2020/7/7 12:39 下午
 */</span>
<span class="token annotation punctuation">@Slf4j</span> 
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> KafkaTemplate<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> kafkaTemplate<span class="token punctuation">;</span>
	
	<span class="token comment">// 同步发送消息（超时限制设置）</span>
    <span class="token comment">// 调用get()的重载方法get(long timeout, TimeUnit unit)</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/sendMsg4"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMessage4</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"msg"</span><span class="token punctuation">)</span> String normalMessage<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        String topic <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            SendResult<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> kafkaTemplate<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> normalMessage<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
            String topic1 <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getRecordMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">topic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 消息发送到的topic</span>
            <span class="token keyword">int</span> partition <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getRecordMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 消息发送到的分区</span>
            <span class="token keyword">long</span> offset <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getRecordMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 消息在分区内的offset</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"send msg done. topic = {}, partition = {}, offset = {}"</span><span class="token punctuation">,</span> topic1<span class="token punctuation">,</span> partition<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TimeoutException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

	<span class="token comment">/*
	// 同步发送消息
    @PostMapping("/sendMsg3")
    public void sendMessage3(@RequestParam(value = "msg") String normalMessage) {
        String topic = "hello";
        try {
            SendResult&lt;String, Object&gt; result = kafkaTemplate.send(topic, normalMessage).get();
            String topic1 = result.getRecordMetadata().topic();     // 消息发送到的topic
            int partition = result.getRecordMetadata().partition(); // 消息发送到的分区
            long offset = result.getRecordMetadata().offset();      // 消息在分区内的offset
            log.info("send msg done. topic = {}, partition = {}, offset = {}", topic1, partition, offset);
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (ExecutionException e) {
            e.printStackTrace();
        }
    }
    */</span>

	<span class="token comment">/*
	// 异步发送消息（回调）
    @PostMapping("/sendMsg2")
    public void sendMessage2(@RequestParam(value = "msg") String normalMessage) {
        String topic = "hello";
        kafkaTemplate.send(topic, normalMessage).addCallback(success -&gt; {
            String topicStr = success.getRecordMetadata().topic();
            int partition = success.getRecordMetadata().partition();
            long offset = success.getRecordMetadata().offset();
            log.info("send msg success!; topic = {}, partition = {}, offset = {}", topicStr, partition, offset);
        }, failed -&gt; {
            log.error("send msg failed! errMsg : {}", failed.getMessage());
        });
    }
    */</span>

    <span class="token comment">/*
    // 异步发送消息（无回调）
    @PostMapping("/sendMsg")
    public void sendMessage1(@RequestParam(value = "msg") String normalMessage) {
        String topic = "hello"; // kafka主题
        kafkaTemplate.send(topic, "你好");
    }
    */</span>
</code></pre> 
<p><code>开始测试，发送post请求：</code></p> 
<pre><code class="prism language-shell"><span class="token function">curl</span> -XPOST http://localhost:8989/sendMsg4 -d <span class="token string">'msg=测试同步发送消息的时间限制1ms'</span>
</code></pre> 
<blockquote> 
 <p><font color="redorange">显示结果为:<br> 程序抛出了java.util.concurrent.TimeoutException异常，但是消费者consumer正常消费了消息</font></p> 
</blockquote> 
<pre><code class="prism language-java">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>TimeoutException
	at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>FutureTask<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>FutureTask<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">205</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>SettableListenableFuture<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>SettableListenableFuture<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">134</span><span class="token punctuation">)</span>
	at com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">.</span>KafkaController<span class="token punctuation">.</span><span class="token function">sendMessage4</span><span class="token punctuation">(</span>KafkaController<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">79</span><span class="token punctuation">)</span>
	at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>NativeMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke0</span><span class="token punctuation">(</span>Native Method<span class="token punctuation">)</span>
	at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>NativeMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>NativeMethodAccessorImpl<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">62</span><span class="token punctuation">)</span>
	at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>DelegatingMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>DelegatingMethodAccessorImpl<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">43</span><span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>Method<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">498</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>method<span class="token punctuation">.</span>support<span class="token punctuation">.</span>InvocableHandlerMethod<span class="token punctuation">.</span><span class="token function">doInvoke</span><span class="token punctuation">(</span>InvocableHandlerMethod<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">190</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>method<span class="token punctuation">.</span>support<span class="token punctuation">.</span>InvocableHandlerMethod<span class="token punctuation">.</span><span class="token function">invokeForRequest</span><span class="token punctuation">(</span>InvocableHandlerMethod<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">138</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>method<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ServletInvocableHandlerMethod<span class="token punctuation">.</span><span class="token function">invokeAndHandle</span><span class="token punctuation">(</span>ServletInvocableHandlerMethod<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">105</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>method<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>RequestMappingHandlerAdapter<span class="token punctuation">.</span><span class="token function">invokeHandlerMethod</span><span class="token punctuation">(</span>RequestMappingHandlerAdapter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">879</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>method<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>RequestMappingHandlerAdapter<span class="token punctuation">.</span><span class="token function">handleInternal</span><span class="token punctuation">(</span>RequestMappingHandlerAdapter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">793</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>method<span class="token punctuation">.</span>AbstractHandlerMethodAdapter<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>AbstractHandlerMethodAdapter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">87</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>DispatcherServlet<span class="token punctuation">.</span><span class="token function">doDispatch</span><span class="token punctuation">(</span>DispatcherServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1040</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>DispatcherServlet<span class="token punctuation">.</span><span class="token function">doService</span><span class="token punctuation">(</span>DispatcherServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">943</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>FrameworkServlet<span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span>FrameworkServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1006</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>FrameworkServlet<span class="token punctuation">.</span><span class="token function">doPost</span><span class="token punctuation">(</span>FrameworkServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">909</span><span class="token punctuation">)</span>
	at javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServlet<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span>HttpServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">660</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>FrameworkServlet<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span>FrameworkServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">883</span><span class="token punctuation">)</span>
	at javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServlet<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span>HttpServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">741</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">internalDoFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">231</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>server<span class="token punctuation">.</span>WsFilter<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>WsFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">53</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">internalDoFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">193</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>RequestContextFilter<span class="token punctuation">.</span><span class="token function">doFilterInternal</span><span class="token punctuation">(</span>RequestContextFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>OncePerRequestFilter<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>OncePerRequestFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">119</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">internalDoFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">193</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>FormContentFilter<span class="token punctuation">.</span><span class="token function">doFilterInternal</span><span class="token punctuation">(</span>FormContentFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">93</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>OncePerRequestFilter<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>OncePerRequestFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">119</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">internalDoFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">193</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>CharacterEncodingFilter<span class="token punctuation">.</span><span class="token function">doFilterInternal</span><span class="token punctuation">(</span>CharacterEncodingFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">201</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>OncePerRequestFilter<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>OncePerRequestFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">119</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">internalDoFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">193</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>StandardWrapperValve<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>StandardWrapperValve<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">202</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>StandardContextValve<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>StandardContextValve<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">96</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>authenticator<span class="token punctuation">.</span>AuthenticatorBase<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>AuthenticatorBase<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">541</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>StandardHostValve<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>StandardHostValve<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">139</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>valves<span class="token punctuation">.</span>ErrorReportValve<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>ErrorReportValve<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">92</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>StandardEngineValve<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>StandardEngineValve<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">74</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>connector<span class="token punctuation">.</span>CoyoteAdapter<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span>CoyoteAdapter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">343</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>coyote<span class="token punctuation">.</span>http11<span class="token punctuation">.</span>Http11Processor<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span>Http11Processor<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">373</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>coyote<span class="token punctuation">.</span>AbstractProcessorLight<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>AbstractProcessorLight<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">65</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>coyote<span class="token punctuation">.</span>AbstractProtocol$ConnectionHandler<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>AbstractProtocol<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">868</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>net<span class="token punctuation">.</span>NioEndpoint$SocketProcessor<span class="token punctuation">.</span><span class="token function">doRun</span><span class="token punctuation">(</span>NioEndpoint<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1590</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>net<span class="token punctuation">.</span>SocketProcessorBase<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>SocketProcessorBase<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">49</span><span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>ThreadPoolExecutor<span class="token punctuation">.</span><span class="token function">runWorker</span><span class="token punctuation">(</span>ThreadPoolExecutor<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1149</span><span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>ThreadPoolExecutor$Worker<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>ThreadPoolExecutor<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">624</span><span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>threads<span class="token punctuation">.</span>TaskThread$WrappingRunnable<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>TaskThread<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">61</span><span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">748</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token number">2020</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">09</span><span class="token operator">:</span><span class="token number">12.963</span>  INFO <span class="token number">8665</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>ntainer#<span class="token number">0</span><span class="token operator">-</span><span class="token number">0</span><span class="token operator">-</span>C<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">.</span>KafkaConsumer      <span class="token operator">:</span> kafka consumer message<span class="token operator">:</span>测试同步发送消息的时间限制<span class="token number">1</span>ms<span class="token punctuation">;</span> partition<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">;</span> offset<span class="token operator">:</span><span class="token number">387</span><span class="token punctuation">;</span> timestamp<span class="token operator">:</span><span class="token number">1594264152891</span>
</code></pre> 
<h5><a id="kafka_470"></a>七、开启kafka事务</h5> 
<blockquote> 
 <p>Kafka和数据库一样可以支持事务，在程序发生异常或者出现特定逻辑的时候可以进行回滚，确保消息监听器不会接收到一些错误的或者不需要的消息。<br> <font color="red">开启kafka事务有两种方法，一种是在方法上使用@Transactional注解，另一种是使用本地事务kafkaTemplate.executeInTransaction</font></p> 
</blockquote> 
<h6><a id="1executeInTransaction_474"></a>1、调用executeInTransaction方法开启事务</h6> 
<blockquote> 
 <p><font color="red">开启kafka事务需要添加修改配置文件:<br> 1、重试次数的值设置大于0<br> 2、把应答级别设置为all<br> 3、增加kafka事务配置</font></p> 
</blockquote> 
<pre><code class="prism language-yaml"><span class="token comment"># 重试次数</span>
spring.kafka.producer.retries=1
<span class="token comment"># 应答级别:多少个分区副本备份完成时向生产者发送ack确认(可选0、1、all/-1)</span>
spring.kafka.producer.acks=all
<span class="token comment"># 开启kafka事务</span>
spring.kafka.producer.transaction<span class="token punctuation">-</span>id<span class="token punctuation">-</span>prefix=kafka<span class="token punctuation">-</span>transacation
</code></pre> 
<p><code>编写事务测试Controller</code></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">;</span>

<span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>core<span class="token punctuation">.</span>KafkaTemplate<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token comment">/**
 * @Description : 模拟消息进入，创建kafka消息（生产者）
 * @Author : xu_teng_chao@163.com
 * @CreateTime : 2020/7/7 12:39 下午
 */</span>
<span class="token annotation punctuation">@Slf4j</span> 
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> KafkaTemplate<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> kafkaTemplate<span class="token punctuation">;</span>

	<span class="token comment">// 事务发送消息</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/trans"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMessageByTrans</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"msg"</span><span class="token punctuation">)</span> String normalMessage<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        String topic <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
        kafkaTemplate<span class="token punctuation">.</span><span class="token function">executeInTransaction</span><span class="token punctuation">(</span>operations <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
            operations<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> normalMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"模拟异常"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>	

	<span class="token comment">/*
	// 同步发送消息（超时限制设置）
    // 调用get()的重载方法get(long timeout, TimeUnit unit)
    @PostMapping("/sendMsg4")
    public void sendMessage4(@RequestParam(value = "msg") String normalMessage) {
        String topic = "hello";
        try {
            SendResult&lt;String, Object&gt; result = kafkaTemplate.send(topic, normalMessage).get(1, TimeUnit.MILLISECONDS);
            String topic1 = result.getRecordMetadata().topic();     // 消息发送到的topic
            int partition = result.getRecordMetadata().partition(); // 消息发送到的分区
            long offset = result.getRecordMetadata().offset();      // 消息在分区内的offset
            log.info("send msg done. topic = {}, partition = {}, offset = {}", topic1, partition, offset);
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (ExecutionException e) {
            e.printStackTrace();
        } catch (TimeoutException e) {
            e.printStackTrace();
        }
    }
    */</span>

	<span class="token comment">/*
	// 同步发送消息
    @PostMapping("/sendMsg3")
    public void sendMessage3(@RequestParam(value = "msg") String normalMessage) {
        String topic = "hello";
        try {
            SendResult&lt;String, Object&gt; result = kafkaTemplate.send(topic, normalMessage).get();
            String topic1 = result.getRecordMetadata().topic();     // 消息发送到的topic
            int partition = result.getRecordMetadata().partition(); // 消息发送到的分区
            long offset = result.getRecordMetadata().offset();      // 消息在分区内的offset
            log.info("send msg done. topic = {}, partition = {}, offset = {}", topic1, partition, offset);
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (ExecutionException e) {
            e.printStackTrace();
        }
    }
    */</span>

	<span class="token comment">/*
	// 异步发送消息（回调）
    @PostMapping("/sendMsg2")
    public void sendMessage2(@RequestParam(value = "msg") String normalMessage) {
        String topic = "hello";
        kafkaTemplate.send(topic, normalMessage).addCallback(success -&gt; {
            String topicStr = success.getRecordMetadata().topic();
            int partition = success.getRecordMetadata().partition();
            long offset = success.getRecordMetadata().offset();
            log.info("send msg success!; topic = {}, partition = {}, offset = {}", topicStr, partition, offset);
        }, failed -&gt; {
            log.error("send msg failed! errMsg : {}", failed.getMessage());
        });
    }
    */</span>

    <span class="token comment">/*
    // 异步发送消息（无回调）
    @PostMapping("/sendMsg")
    public void sendMessage1(@RequestParam(value = "msg") String normalMessage) {
        String topic = "hello"; // kafka主题
        kafkaTemplate.send(topic, "你好");
    }
    */</span>
</code></pre> 
<p><font color="green">发送请求：</font></p> 
<pre><code class="prism language-shell"><span class="token function">curl</span> -XPOST http://localhost:8989/trans -d <span class="token string">'msg=测试事务'</span>
</code></pre> 
<p><font color="red">测试结果为：</font></p> 
<pre><code class="prism language-java"><span class="token number">2020</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">56</span><span class="token operator">:</span><span class="token number">53.249</span> ERROR <span class="token number">9149</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>a<span class="token operator">-</span>transacation0<span class="token punctuation">]</span> o<span class="token punctuation">.</span>s<span class="token punctuation">.</span>k<span class="token punctuation">.</span>support<span class="token punctuation">.</span>LoggingProducerListener    <span class="token operator">:</span> Exception thrown when sending a message with key<span class="token operator">=</span><span class="token string">'null'</span> and payload<span class="token operator">=</span><span class="token string">'测试事务'</span> to topic hello<span class="token operator">:</span>

org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>common<span class="token punctuation">.</span>KafkaException<span class="token operator">:</span> Failing batch since transaction was aborted
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span>internals<span class="token punctuation">.</span>Sender<span class="token punctuation">.</span><span class="token function">maybeSendAndPollTransactionalRequest</span><span class="token punctuation">(</span>Sender<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">422</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>kafka<span class="token operator">-</span>clients<span class="token operator">-</span><span class="token number">2.5</span><span class="token number">.0</span><span class="token punctuation">.</span>jar<span class="token operator">:</span>na<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span>internals<span class="token punctuation">.</span>Sender<span class="token punctuation">.</span><span class="token function">runOnce</span><span class="token punctuation">(</span>Sender<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">312</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>kafka<span class="token operator">-</span>clients<span class="token operator">-</span><span class="token number">2.5</span><span class="token number">.0</span><span class="token punctuation">.</span>jar<span class="token operator">:</span>na<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span>internals<span class="token punctuation">.</span>Sender<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>Sender<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">239</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>kafka<span class="token operator">-</span>clients<span class="token operator">-</span><span class="token number">2.5</span><span class="token number">.0</span><span class="token punctuation">.</span>jar<span class="token operator">:</span>na<span class="token punctuation">]</span>
	at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">748</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>na<span class="token operator">:</span><span class="token number">1.8</span><span class="token number">.0</span>_221<span class="token punctuation">]</span>

<span class="token number">2020</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">56</span><span class="token operator">:</span><span class="token number">53.294</span> ERROR <span class="token number">9149</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>nio<span class="token operator">-</span><span class="token number">8989</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> o<span class="token punctuation">.</span>a<span class="token punctuation">.</span>c<span class="token punctuation">.</span>c<span class="token punctuation">.</span>C<span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token operator">/</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>dispatcherServlet<span class="token punctuation">]</span>    <span class="token operator">:</span> Servlet<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> servlet <span class="token punctuation">[</span>dispatcherServlet<span class="token punctuation">]</span> in context with path <span class="token punctuation">[</span><span class="token punctuation">]</span> threw exception <span class="token punctuation">[</span>Request processing failed<span class="token punctuation">;</span> nested exception is java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>RuntimeException<span class="token operator">:</span> 模拟异常<span class="token punctuation">]</span> with root cause

java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>RuntimeException<span class="token operator">:</span> 模拟异常
	at com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">.</span>KafkaController<span class="token punctuation">.</span>lambda$sendMessageByTrans$<span class="token function">2</span><span class="token punctuation">(</span>KafkaController<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">101</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>classes<span class="token operator">/</span><span class="token operator">:</span>na<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>core<span class="token punctuation">.</span>KafkaTemplate<span class="token punctuation">.</span><span class="token function">executeInTransaction</span><span class="token punctuation">(</span>KafkaTemplate<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">463</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>kafka<span class="token operator">-</span><span class="token number">2.5</span><span class="token number">.2</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">2.5</span><span class="token number">.2</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>kafkademo<span class="token punctuation">.</span>KafkaController<span class="token punctuation">.</span><span class="token function">sendMessageByTrans</span><span class="token punctuation">(</span>KafkaController<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">99</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>classes<span class="token operator">/</span><span class="token operator">:</span>na<span class="token punctuation">]</span>
	at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>NativeMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke0</span><span class="token punctuation">(</span>Native Method<span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>na<span class="token operator">:</span><span class="token number">1.8</span><span class="token number">.0</span>_221<span class="token punctuation">]</span>
	at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>NativeMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>NativeMethodAccessorImpl<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">62</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>na<span class="token operator">:</span><span class="token number">1.8</span><span class="token number">.0</span>_221<span class="token punctuation">]</span>
	at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>DelegatingMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>DelegatingMethodAccessorImpl<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">43</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>na<span class="token operator">:</span><span class="token number">1.8</span><span class="token number">.0</span>_221<span class="token punctuation">]</span>
	at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>Method<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">498</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>na<span class="token operator">:</span><span class="token number">1.8</span><span class="token number">.0</span>_221<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>method<span class="token punctuation">.</span>support<span class="token punctuation">.</span>InvocableHandlerMethod<span class="token punctuation">.</span><span class="token function">doInvoke</span><span class="token punctuation">(</span>InvocableHandlerMethod<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">190</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>web<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>method<span class="token punctuation">.</span>support<span class="token punctuation">.</span>InvocableHandlerMethod<span class="token punctuation">.</span><span class="token function">invokeForRequest</span><span class="token punctuation">(</span>InvocableHandlerMethod<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">138</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>web<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>method<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ServletInvocableHandlerMethod<span class="token punctuation">.</span><span class="token function">invokeAndHandle</span><span class="token punctuation">(</span>ServletInvocableHandlerMethod<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">105</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>webmvc<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>method<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>RequestMappingHandlerAdapter<span class="token punctuation">.</span><span class="token function">invokeHandlerMethod</span><span class="token punctuation">(</span>RequestMappingHandlerAdapter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">879</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>webmvc<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>method<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>RequestMappingHandlerAdapter<span class="token punctuation">.</span><span class="token function">handleInternal</span><span class="token punctuation">(</span>RequestMappingHandlerAdapter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">793</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>webmvc<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>method<span class="token punctuation">.</span>AbstractHandlerMethodAdapter<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>AbstractHandlerMethodAdapter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">87</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>webmvc<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>DispatcherServlet<span class="token punctuation">.</span><span class="token function">doDispatch</span><span class="token punctuation">(</span>DispatcherServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1040</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>webmvc<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>DispatcherServlet<span class="token punctuation">.</span><span class="token function">doService</span><span class="token punctuation">(</span>DispatcherServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">943</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>webmvc<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>FrameworkServlet<span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span>FrameworkServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1006</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>webmvc<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>FrameworkServlet<span class="token punctuation">.</span><span class="token function">doPost</span><span class="token punctuation">(</span>FrameworkServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">909</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>webmvc<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServlet<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span>HttpServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">660</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>FrameworkServlet<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span>FrameworkServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">883</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>webmvc<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServlet<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span>HttpServlet<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">741</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">internalDoFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">231</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>server<span class="token punctuation">.</span>WsFilter<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>WsFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">53</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>websocket<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">internalDoFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">193</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>RequestContextFilter<span class="token punctuation">.</span><span class="token function">doFilterInternal</span><span class="token punctuation">(</span>RequestContextFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>web<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>OncePerRequestFilter<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>OncePerRequestFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">119</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>web<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">internalDoFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">193</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>FormContentFilter<span class="token punctuation">.</span><span class="token function">doFilterInternal</span><span class="token punctuation">(</span>FormContentFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">93</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>web<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>OncePerRequestFilter<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>OncePerRequestFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">119</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>web<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">internalDoFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">193</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>CharacterEncodingFilter<span class="token punctuation">.</span><span class="token function">doFilterInternal</span><span class="token punctuation">(</span>CharacterEncodingFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">201</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>web<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>OncePerRequestFilter<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>OncePerRequestFilter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">119</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>spring<span class="token operator">-</span>web<span class="token operator">-</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">5.2</span><span class="token number">.7</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">internalDoFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">193</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ApplicationFilterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>ApplicationFilterChain<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>StandardWrapperValve<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>StandardWrapperValve<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">202</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>StandardContextValve<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>StandardContextValve<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">96</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>authenticator<span class="token punctuation">.</span>AuthenticatorBase<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>AuthenticatorBase<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">541</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>StandardHostValve<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>StandardHostValve<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">139</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>valves<span class="token punctuation">.</span>ErrorReportValve<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>ErrorReportValve<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">92</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>core<span class="token punctuation">.</span>StandardEngineValve<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>StandardEngineValve<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">74</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>connector<span class="token punctuation">.</span>CoyoteAdapter<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span>CoyoteAdapter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">343</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>coyote<span class="token punctuation">.</span>http11<span class="token punctuation">.</span>Http11Processor<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span>Http11Processor<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">373</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>coyote<span class="token punctuation">.</span>AbstractProcessorLight<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>AbstractProcessorLight<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">65</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>coyote<span class="token punctuation">.</span>AbstractProtocol$ConnectionHandler<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>AbstractProtocol<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">868</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>net<span class="token punctuation">.</span>NioEndpoint$SocketProcessor<span class="token punctuation">.</span><span class="token function">doRun</span><span class="token punctuation">(</span>NioEndpoint<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1590</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>net<span class="token punctuation">.</span>SocketProcessorBase<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>SocketProcessorBase<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">49</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>ThreadPoolExecutor<span class="token punctuation">.</span><span class="token function">runWorker</span><span class="token punctuation">(</span>ThreadPoolExecutor<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1149</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>na<span class="token operator">:</span><span class="token number">1.8</span><span class="token number">.0</span>_221<span class="token punctuation">]</span>
	at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>ThreadPoolExecutor$Worker<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>ThreadPoolExecutor<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">624</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>na<span class="token operator">:</span><span class="token number">1.8</span><span class="token number">.0</span>_221<span class="token punctuation">]</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>threads<span class="token punctuation">.</span>TaskThread$WrappingRunnable<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>TaskThread<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">61</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>tomcat<span class="token operator">-</span>embed<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">.</span>jar<span class="token operator">:</span><span class="token number">9.0</span><span class="token number">.36</span><span class="token punctuation">]</span>
	at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">748</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>na<span class="token operator">:</span><span class="token number">1.8</span><span class="token number">.0</span>_221<span class="token punctuation">]</span>
</code></pre> 
<p><code>可以看到已经触发了事务回滚，该消息消费者也没有进行消费。</code></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/38154a775c7036267a190227ea7a709d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">一文深入理解搞懂Java中的魔法类-Unsafe</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5e634d0805bc27cc7eee5ca7d1eec535/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图解|什么是缺页错误Page Fault</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>