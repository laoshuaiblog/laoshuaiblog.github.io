<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>R语言绘制散点密度图ggdentity - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/6de146e80165974669f6a1b6e49f2782/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="R语言绘制散点密度图ggdentity">
  <meta property="og:description" content="使用R语言绘制二维密度图 下图是一张常见的二维核密度散点图，能够清晰直观的反映出数据之间的分布趋势，颜色越红的位置数据越集中分布。今天分享的笔记是在R语言中绘制该图的两种常见方法，提供过程代码。 论文中常见的这种展示两组数据之间分布趋势的图，其实也是一种散点图，只是用不同颜色来映射了点的密度大小，通常是渐变色来展示数据的变化规律。 方法一：ggpointdensity 这个包结合了散点图和密度图的特点，是 ggplot2 的一个扩展，使用户能够创建点密度图，其中点的颜色和大小可以表示数据点在特定区域的局部密度，从而直观地揭示出数据的集中趋势。
安装与使用方法 install.packages(&#34;ggpointdensity&#34;)
library(ggpointdensity)
library(viridis) # 使用viridis提供的翠绿色标度：scale_fill_viridis()
安装完成后开始绘图，首先生成测试数据
df &amp;lt;- data.frame(&#34;x&#34; = rnorm(10000), &#34;y&#34; = rnorm(10000))
&amp;gt; head(df)
x y
1 0.2505781 0.05379511
2 -0.2779240 0.75343075
3 -1.7247357 0.24985048
4 -2.0067049 -0.44410484
5 -1.2918083 -0.05027016
6 0.3658382 -0.46777918
如果你有实际数据，也可以按照这种方式进行整理，比如在excel中整理好，分成两列，分别代表横轴和纵轴，然后导入R语言中进行绘图。
ggplot(df)&#43;
geom_pointdensity(aes(x=x,y=y))
绘图的核心函数geom_pointdensity生成散点密度图，如果直接运行，结果图如下：
看起来配色不太好看，换成青翠渐变色：
ggplot(df)&#43;
geom_pointdensity(aes(x=x,y=y))&#43;
scale_color_viridis() &#43;
theme_bw()
添加scale_color_viridis函数修改配色： 方法二：ggdensity 这个包也是属于ggplot2扩展包，用于绘制密度图，效果和刚才差不多，优点是提供geom_hdr函数，功能比较多。
安装与使用方法 install.packages(&#34;ggdensity&#34;)
if (!requireNamespace(&#34;remotes&#34;)) install.packages(&#34;remotes&#34;)
remotes::install_github(&#34;jamesotto852/ggdensity&#34;)
还是使用刚刚创建的假数据来展示：
p &amp;lt;- ggplot(df, aes(x, y)) &#43; coord_equal()">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-12T11:13:30+08:00">
    <meta property="article:modified_time" content="2024-03-12T11:13:30+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">R语言绘制散点密度图ggdentity</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <section id="nice" style="font-size: 16px; color: black; padding: 0 10px; line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; word-break: break-word; word-wrap: break-word; text-align: left; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;"> 
 <h2 style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.4em; color: #16a085; margin: 0.4em auto; text-align: center; border-bottom: 5px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">使用R语言绘制二维密度图</span><span class="suffix"></span></h2> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">下图是一张常见的二维核密度散点图，能够清晰直观的反映出数据之间的分布趋势，颜色越红的位置数据越集中分布。今天分享的笔记是在R语言中绘制该图的两种常见方法，提供过程代码。 <img src="https://images2.imgbox.com/5b/eb/z57CWJS5_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; margin-top: 10px; margin-bottom: 10px; border-radius: 5px;"></p> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">论文中常见的这种展示两组数据之间分布趋势的图，其实也是一种散点图，只是用不同颜色来映射了点的密度大小，通常是渐变色来展示数据的变化规律。 <img src="https://images2.imgbox.com/39/1d/mSPpR4jz_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; margin-top: 10px; margin-bottom: 10px; border-radius: 5px;"></p> 
 <h3 style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: #009688; padding-left: 12px; margin: 1em auto; font-size: 1.2em; border-left: 7px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">方法一：ggpointdensity</span><span class="suffix"></span></h3> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">这个包结合了散点图和密度图的特点，是 ggplot2 的一个扩展，使用户能够创建点密度图，其中点的颜色和大小可以表示数据点在特定区域的局部密度，从而直观地揭示出数据的集中趋势。</p> 
 <h4 style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; margin: 0.9em auto; padding-left: 21px; font-size: 1.1em; border-left: 10px solid #451261;"><span class="prefix" style="display: none;"></span><span class="content">安装与使用方法</span><span class="suffix" style="display: none;"></span></h4> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;">install.packages(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"ggpointdensity"</span>)<br>library(ggpointdensity)<br>library(viridis) <span class="hljs-comment" style="color: #007400; line-height: 26px;"># 使用viridis提供的翠绿色标度：scale_fill_viridis()</span><br></code></pre> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">安装完成后开始绘图，首先生成测试数据</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;">df &lt;- data.frame(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"x"</span> = rnorm(10000), <span class="hljs-string" style="color: #c41a16; line-height: 26px;">"y"</span> = rnorm(10000))<br>&gt; head(df)<br>           x           y<br>1  0.2505781  0.05379511<br>2 -0.2779240  0.75343075<br>3 -1.7247357  0.24985048<br>4 -2.0067049 -0.44410484<br>5 -1.2918083 -0.05027016<br>6  0.3658382 -0.46777918<br></code></pre> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">如果你有实际数据，也可以按照这种方式进行整理，比如在excel中整理好，分成两列，分别代表横轴和纵轴，然后导入R语言中进行绘图。</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;">ggplot(df)+<br>    geom_pointdensity(aes(x=x,y=y))<br></code></pre> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">绘图的核心函数geom_pointdensity生成散点密度图，如果直接运行，结果图如下：</p> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/10/78/gO54e6eA_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; margin-top: 10px; margin-bottom: 10px; border-radius: 5px;"> 
 </figure> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">看起来配色不太好看，换成青翠渐变色：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;">ggplot(df)+<br>    geom_pointdensity(aes(x=x,y=y))+<br>    scale_color_viridis() +<br>    theme_bw()<br></code></pre> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">添加scale_color_viridis函数修改配色： <img src="https://images2.imgbox.com/f5/fe/uo6BrHS2_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; margin-top: 10px; margin-bottom: 10px; border-radius: 5px;"></p> 
 <h3 style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: #009688; padding-left: 12px; margin: 1em auto; font-size: 1.2em; border-left: 7px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">方法二：ggdensity</span><span class="suffix"></span></h3> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">这个包也是属于ggplot2扩展包，用于绘制密度图，效果和刚才差不多，优点是提供geom_hdr函数，功能比较多。</p> 
 <h4 style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; margin: 0.9em auto; padding-left: 21px; font-size: 1.1em; border-left: 10px solid #451261;"><span class="prefix" style="display: none;"></span><span class="content">安装与使用方法</span><span class="suffix" style="display: none;"></span></h4> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;">install.packages(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"ggdensity"</span>)<br><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">if</span> (!requireNamespace(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"remotes"</span>)) install.packages(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"remotes"</span>)<br>remotes::install_github(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"jamesotto852/ggdensity"</span>)<br></code></pre> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">还是使用刚刚创建的假数据来展示：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;">p &lt;- ggplot(df, aes(x, y)) + coord_equal()<br>p1 &lt;- p + geom_density_2d_filled()+<br>    theme_bw()<br>p1<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/22/47/8KmsolCv_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; margin-top: 10px; margin-bottom: 10px; border-radius: 5px;"> 
 </figure> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">这样获得了一张基础布局的密度图，展示的是等高线，geom_density_2d_filled是ggplot2自带的二维填充绘图函数。</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;">p1&lt;-p + geom_hdr()<br></code></pre> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">如果是使用geom_hdr函数的话，作图效果如下所示：</p> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/e5/7f/xeRPJQvk_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; margin-top: 10px; margin-bottom: 10px; border-radius: 5px;"> 
 </figure> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">我问还可以修改边缘线，比如让曲线变成圆形布局或者其他布局，也可以按照小方块进行渲染，类似于GPU显卡计算图像，通过统计每个小方块儿里面点的数量来进行颜色映射。</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;">p2&lt;-p + geom_hdr(method = <span class="hljs-string" style="color: #c41a16; line-height: 26px;">"mvnorm"</span>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/8f/71/NNoDIR52_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; margin-top: 10px; margin-bottom: 10px; border-radius: 5px;"> 
 </figure> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;">p4&lt;-p + geom_hdr(method = <span class="hljs-string" style="color: #c41a16; line-height: 26px;">"histogram"</span>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/00/3d/1ObiYOTt_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; margin-top: 10px; margin-bottom: 10px; border-radius: 5px;"> 
 </figure> 
 <hr style="height: 1px; margin-top: 10px; margin-bottom: 10px; border: none; border-top: 1px solid black; margin: 30px 0;"> 
 <p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;">以上就是今天分享的密度图小技巧，感谢您的阅读，如果感觉有所帮助，欢迎点赞转发，下期教程分享R语言中绘制动态交互式热图的方法。</p> 
 <h5 style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; margin: 1em auto; font-size: 1.1em; padding-left: 10px; border-left: 5px solid #d29200;"><span class="prefix" style="display: none;"></span><span class="content">参考资料</span><span class="suffix" style="display: none;"></span></h5> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;">https://blog.csdn.net/weixin_40575651/article/details/107038516<br>https://rpkgs.datanovia.com/ggpubr/reference/ggdensity.html<br>https://github.com/jamesotto852/ggdensity<br>https://cloud.tencent.com/developer/article/2297184<br></code></pre> 
</section> 
<p>本文由<a href="https://mdnice.com/?platform=4" rel="nofollow"> mdnice </a>多平台发布</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c81f1c6e06d64ca46de5c0a932d082d1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【虚拟换衣&#43;论文&#43;代码】2403.OOTDiffusion：高分辨率(1024x768)可控的虚拟试穿（已开源，暂不能训练）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/507c69972282c4380fd80176d7369104/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux安全攻防大揭秘：攻击类型与防护策略详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>