<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>学习Java读取excel表格笔记 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/c4cf701d7f6747640358eb682bc5b9d5/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="学习Java读取excel表格笔记">
  <meta property="og:description" content="学习博客 https://www.cnblogs.com/winner-0715/p/6690094.html 记录下来方便复习 jar包 链接：https://pan.baidu.com/s/1mIJgRQeXNAVwMBFsOVvNCQ 密码：3nap
package excel_list;
import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFDateUtil;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.poifs.filesystem.POIFSFileSystem;
import java.io.BufferedInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.List;
public class ExcelOperate {
public static void main(String[] args) throws Exception {
File file = new File(&#34;C:\\Users\\Administrator\\Desktop\\Members.xls&#34;);
String[][] result = getData(file, 1);
int rowLength = result.length;
for (int i = 0; i &amp;lt; rowLength; i&#43;&#43;) {">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2018-03-26T14:48:01+08:00">
    <meta property="article:modified_time" content="2018-03-26T14:48:01+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">学习Java读取excel表格笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>学习博客 https://www.cnblogs.com/winner-0715/p/6690094.html   记录下来方便复习 </p> 
<p>jar包 <span style="background-color:rgb(255,255,255);">链接：https://pan.baidu.com/s/1mIJgRQeXNAVwMBFsOVvNCQ 密码：3nap</span></p> 
<p>package excel_list;<br><br><br>import org.apache.poi.hssf.usermodel.HSSFCell;<br>import org.apache.poi.hssf.usermodel.HSSFDateUtil;<br>import org.apache.poi.hssf.usermodel.HSSFRow;<br>import org.apache.poi.hssf.usermodel.HSSFSheet;<br>import org.apache.poi.hssf.usermodel.HSSFWorkbook;<br>import org.apache.poi.poifs.filesystem.POIFSFileSystem;<br><br><br>import java.io.BufferedInputStream;<br>import java.io.File;<br>import java.io.FileInputStream;<br>import java.io.FileNotFoundException;<br>import java.io.IOException;<br>import java.text.DecimalFormat;<br>import java.text.SimpleDateFormat;<br>import java.util.ArrayList;<br>import java.util.Arrays;<br>import java.util.Date;<br>import java.util.List;<br><br><br><br><br>public class ExcelOperate {<!-- --><br><br><br>    public static void main(String[] args) throws Exception {<!-- --><br>        File file = new File("C:\\Users\\Administrator\\Desktop\\Members.xls");<br>        String[][] result = getData(file, 1);<br>        int rowLength = result.length;<br>        for (int i = 0; i &lt; rowLength; i++) {<!-- --><br>//            System.out.println(result[i]);<br>            for (int j = 0; j &lt; result[i].length; j++) {<!-- --><br>                System.out.print(result[i][j] + "\t\t");<br>            }<br>            System.out.println();<br>        }<br>    }<br><br><br>    /**<br>     * 读取Excel的内容，第一维数组存储的是一行中格列的值，二维数组存储的是多少个行<br>     *<br>     * @param file       读取数据的源Excel<br>     * @param ignoreRows 读取数据忽略的行数，比喻行头不需要读入 忽略的行数为1<br>     * @return 读出的Excel中数据的内容<br>     * @throws FileNotFoundException<br>     * @throws IOException<br>     */<br>    public static String[][] getData(File file, int ignoreRows)<br>            throws FileNotFoundException, IOException {<!-- --><br>        List&lt;String[]&gt; result = new ArrayList&lt;String[]&gt;();<br>        int rowSize = 0;<br>        BufferedInputStream in = new BufferedInputStream(new FileInputStream(<br>                file));<br>        // 打开HSSFWorkbook<br>        POIFSFileSystem fs = new POIFSFileSystem(in);<br>        HSSFWorkbook wb = new HSSFWorkbook(fs);<br>        HSSFCell cell = null;<br>        for (int sheetIndex = 0; sheetIndex &lt; wb.getNumberOfSheets(); sheetIndex++) {<!-- --><br>            HSSFSheet st = wb.getSheetAt(sheetIndex);<br>            // 第一行为标题，不取<br>            for (int rowIndex = ignoreRows; rowIndex &lt;= st.getLastRowNum(); rowIndex++) {<!-- --><br>                HSSFRow row = st.getRow(rowIndex);<br>                if (row == null) {<!-- --><br>                    continue;<br>                }<br>                int tempRowSize = row.getLastCellNum() + 1;<br>                if (tempRowSize &gt; rowSize) {<!-- --><br>                    rowSize = tempRowSize;<br>                }<br>                String[] values = new String[rowSize];<br>                Arrays.fill(values, "");<br>                boolean hasValue = false;<br>                for (short columnIndex = 0; columnIndex &lt;= row.getLastCellNum(); columnIndex++) {<!-- --><br>                    String value = "";<br>                    cell = row.getCell(columnIndex);<br>                    if (cell != null) {<!-- --><br>                        // 注意：一定要设成这个，否则可能会出现乱码,后面版本默认设置<br>                        //cell.setEncoding(HSSFCell.ENCODING_UTF_16);<br>                        switch (cell.getCellType()) {<!-- --><br>                            case HSSFCell.CELL_TYPE_STRING:<br>                                value = cell.getStringCellValue();<br>                                break;<br>                            case HSSFCell.CELL_TYPE_NUMERIC:<br>                                if (HSSFDateUtil.isCellDateFormatted(cell)) {<!-- --><br>                                    Date date = cell.getDateCellValue();<br>                                    if (date != null) {<!-- --><br>                                        value = new SimpleDateFormat("yyyy-MM-dd")<br>                                                .format(date);<br>                                    } else {<!-- --><br>                                        value = "";<br>                                    }<br>                                } else {<!-- --><br>                                    value = new DecimalFormat("0").format(cell<br><br><br>                                            .getNumericCellValue());<br>                                }<br>                                break;<br>                            case HSSFCell.CELL_TYPE_FORMULA:<br>                                // 导入时如果为公式生成的数据则无值<br>                                if (!cell.getStringCellValue().equals("")) {<!-- --><br>                                    value = cell.getStringCellValue();<br>                                } else {<!-- --><br>                                    value = cell.getNumericCellValue() + "";<br>                                }<br>                                break;<br>                            case HSSFCell.CELL_TYPE_BLANK:<br>                                break;<br>                            case HSSFCell.CELL_TYPE_ERROR:<br>                                value = "";<br>                                break;<br>                            case HSSFCell.CELL_TYPE_BOOLEAN:<br>                                value = (cell.getBooleanCellValue() == true ? "Y"<br><br><br>                                        : "N");<br>                                break;<br>                            default:<br>                                value = "";<br>                        }<br>                    }<br>                    if (columnIndex == 0 &amp;&amp; value.trim().equals("")) {<!-- --><br>                        break;<br>                    }<br>                    values[columnIndex] = rightTrim(value);<br>                    hasValue = true;<br>                }<br>                if (hasValue) {<!-- --><br>                    result.add(values);<br>                }<br>            }<br>        }<br>        in.close();<br>        String[][] returnArray = new String[result.size()][rowSize];<br>        for (int i = 0; i &lt; returnArray.length; i++) {<!-- --><br>            returnArray[i] = (String[]) result.get(i);<br>        }<br>        return returnArray;<br>    }<br><br><br><br><br>    /**<br>     * 去掉字符串右边的空格<br>     *<br>     * @param str 要处理的字符串<br>     * @return 处理后的字符串<br>     */<br><br><br>    public static String rightTrim(String str) {<!-- --><br>        if (str == null) {<!-- --><br>            return "";<br>        }<br>        int length = str.length();<br>        for (int i = length - 1; i &gt;= 0; i--) {<!-- --><br>            if (str.charAt(i) != 0x20) {<!-- --><br>                break;<br>            }<br>            length--;<br>        }<br>        return str.substring(0, length);<br>    }<br>}<br></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e06159a26c4c03616f8dc770e2a5dcd3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">去除HTML文件标签</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/52339d621ecd816cdf5edaaee7a2f9d5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何主动唤起文件选择框</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>