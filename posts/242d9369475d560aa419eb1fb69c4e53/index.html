<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Java中使用Redis（即学即用） - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/242d9369475d560aa419eb1fb69c4e53/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="Java中使用Redis（即学即用）">
  <meta property="og:description" content="一、为什么需要用Redis？ Redis（Remote Dictionary Server），一个基于内存的高性能key-value 数据库。针对关系型数据库性能瓶颈来设计的，处理关系型数据库不擅长做的业务场景。Redis 多用于项目的高速缓存，可以让项目性能更好。
补充：Redis的应用场景 1、缓存
当我们需要查询数据时，先去查询Redis的缓存，有就直接返回，没有再去关系型数据库查询，返回结果，最后把结果数据缓存到Redis（为下一次的查询）。（Redis是以key-value的形式缓存数据的，一般较多使用string类型，关于key，设计上要保证唯一，一种做法的类的全限定名&#43;id，关于value，如果要存储对象，会直接把对象转成json格式，进行缓存。要查询时，查出来json格式的数据，再转成java对象返回。）
一般缓存都是对于不常变动的数据，如账号密码，一些（QQ、微信）等。
2、实时统计点赞总数
一些短视频，推文，博客等的点赞，热度高的时候，可能瞬时爆发非常多的请求，如果都是直接操作关系型数据库，就会对数据库造成很大压力，甚至崩溃。
这时，我们会使用Redis，先把每一次的点赞先存到Redis，每点一次就&#43;1（因为Redis是直接操作内存的，无惧这点点击量），然后隔一段时间（服务器压力小点时）定时把数据存储到关系型数据中（数据落地）。
3、朋友圈点赞
这区别于上面的统计点赞数，因为统计点赞数，只是计算数量，在代码中也只是调用“incr key ”把值递增1，而朋友圈点赞，还需要知道谁给谁点了赞。
4、热门推荐 在网站或者App的首页的 推荐的热门内容 ，可以使用 list 形式存入R edis 中。这种，不管是哪个用户或者游客，不管多少人去点击，都是去Redis中查，不用直接查关系型数据库。（不管谁进入这个网站，看到的首页都是一样的） 5、抽奖
6、好友推荐
二、安装Redis 1、下面提供其中一个版本的Redis：
链接：https://pan.baidu.com/s/1Z3QRpdMzUyPh8ODZJDgGEA 提取码：j8vl 2、初学时，直接全部next安装即可
3、安装完成后，进入Redis的安装目录
双击打开redis-cli.exe，出现以下端口号6379，表明安装成功：
注：当我们输入太多的命令后，可以使用命令“clear”清除掉，使用窗口更干净
三、管理Redis 1、管理密码（初学时不建议搞）
（1）设置密码 config set requirepass 123
设置密码后，这时就需要登录认证了，不然就会报错（下图）
（2）登录 auth 123 （登录后就可以继续操作了）
（3）获取密码 config get requirepass
（4）取消密码 config set requirepass &#39;&#39;
2、管理key exists key -&amp;gt; 判断某个key是否存在 expire key second -&amp;gt; 设置key的过期时间 persist key -&amp;gt; 取消key的过期时间 select index -&amp;gt; 切换数据库索引,范围是0 ~ 15共16个分区 move key index -&amp;gt; 把某个key-value移动到其他索引中 rename oldKey newKey -&amp;gt; 把oldKey重命名为newKey info -&amp;gt; 查看当前服务器信息 flushdb -&amp;gt; 清空当前库中的数据 flushall -&amp;gt; 清空所有库中的数据 四、Redis如何操作数据 Redis支持多种数据类型：string，hash，list，set，zset。">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-11-01T11:31:36+08:00">
    <meta property="article:modified_time" content="2020-11-01T11:31:36+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Java中使用Redis（即学即用）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>一、为什么需要用Redis？</h4> 
<p>Redis<em>（Remote Dictionary Server）</em>，一个基于内存的高性能key-value 数据库。<span style="color:#333333;">针对关系型数据库性能瓶颈来设计的，处理关系型数据库不擅长做的业务场景。Redis 多用于项目的高速缓存，可以让项目性能更好。</span></p> 
<p> </p> 
<h4><span style="color:#333333;">补充：Redis的应用场景</span></h4> 
<p><strong><span style="color:#333333;">1、缓存</span></strong></p> 
<p><span style="color:#333333;">当我们需要查询数据时，先去查询Redis的缓存，有就直接返回，没有再去关系型数据库查询，返回结果，最后把结果数据缓存到Redis（为下一次的查询）。（Redis是以key-value的形式缓存数据的，一般较多使用string类型，关于key，设计上要保证唯一，一种做法的类的全限定名+id，关于value，如果要存储对象，会直接把对象转成json格式，进行缓存。要查询时，查出来json格式的数据，再转成java对象返回。）</span></p> 
<p><span style="color:#333333;">一般缓存都是对于不常变动的数据，如账号密码，一些</span><span style="color:#333333;">（QQ、微信）等。</span></p> 
<p><img alt="" height="316" src="https://images2.imgbox.com/32/85/NhZJ7W1A_o.png" width="366"></p> 
<p><strong>2、实时统计点赞总数</strong></p> 
<p>一些短视频，推文，博客等的点赞，热度高的时候，可能瞬时爆发非常多的请求，如果都是直接操作关系型数据库，就会对数据库造成很大压力，甚至崩溃。</p> 
<p>这时，我们会使用Redis，先把每一次的点赞先存到Redis，每点一次就+1（因为Redis是直接操作内存的，无惧这点点击量），然后隔一段时间（服务器压力小点时）定时把数据存储到关系型数据中（数据落地）。</p> 
<p><img alt="" height="267" src="https://images2.imgbox.com/e5/7e/N8rPhOfc_o.png" width="1200"></p> 
<p> </p> 
<p><strong>3、朋友圈点赞</strong></p> 
<p>这区别于上面的统计点赞数，因为统计点赞数，只是计算数量，在代码中也只是调用“incr key  ”把值递增1，而朋友圈点赞，还需要知道谁给谁点了赞。</p> 
<p><img alt="" height="507" src="https://images2.imgbox.com/2a/3e/DeeIWiVx_o.png" width="415"></p> 
<p>4、<span style="color:#333333;"><strong>热门推荐 </strong></span></p> 
<div> 
 <span style="color:#333333;">在网站或者App的首页的</span> 
 <span style="color:#333333;">推荐的热门内容</span> 
 <span style="color:#333333;">，可以使用</span> 
 <span style="color:#333333;">list</span> 
 <span style="color:#333333;">形式存入R</span> 
 <span style="color:#333333;">edis</span> 
 <span style="color:#333333;">中。这种，不管是哪个用户或者游客，不管多少人去点击，都是去Redis中查，不用直接查关系型数据库。（不管谁进入这个网站，看到的首页都是一样的）</span> 
</div> 
<div>
    
</div> 
<p><img alt="" height="488" src="https://images2.imgbox.com/d6/2e/OADIur9F_o.png" width="684"></p> 
<p>5、抽奖</p> 
<p> </p> 
<p>6、好友推荐</p> 
<p> </p> 
<p> </p> 
<h4><span style="color:#333333;">二、安装Redis</span></h4> 
<p> </p> 
<p><strong><span style="color:#333333;">1、下面提供其中一个版本的Redis：</span></strong></p> 
<p><span style="color:#333333;">链接：https://pan.baidu.com/s/1Z3QRpdMzUyPh8ODZJDgGEA <br> 提取码：j8vl </span><br>  </p> 
<p><strong><span style="color:#333333;">2、初学时，直接全部next安装即可</span></strong></p> 
<p><strong>3、安装完成后，进入Redis的安装目录</strong></p> 
<p><img alt="" height="434" src="https://images2.imgbox.com/62/ab/R8m65lzE_o.png" width="659"></p> 
<p><strong>双击打开redis-cli.exe，出现以下端口号6379，表明安装成功：</strong></p> 
<p> <img alt="" height="146" src="https://images2.imgbox.com/ad/22/qoPzv5nq_o.png" width="270"></p> 
<p><strong> 注：当我们输入太多的命令后，可以使用命令“clear”清除掉，使用窗口更干净</strong></p> 
<p><img alt="" height="86" src="https://images2.imgbox.com/cb/c4/L3SRnqVB_o.png" width="296"></p> 
<h4>三、管理Redis</h4> 
<p><strong>1、管理密码（初学时不建议搞）</strong></p> 
<p><strong>（1）设置密码   config set requirepass 123</strong></p> 
<p><img alt="" height="77" src="https://images2.imgbox.com/5c/81/hwamOyBC_o.png" width="422"></p> 
<p><strong>设置密码后，这时就需要登录认证了，不然就会报错（下图）</strong></p> 
<p><img alt="" height="40" src="https://images2.imgbox.com/dd/d5/AQjUtoiS_o.png" width="398"></p> 
<p> <img alt="" height="43" src="https://images2.imgbox.com/40/2b/ncpygoMw_o.png" width="392"></p> 
<p><strong>（2）登录  auth 123 （登录后就可以继续操作了）</strong></p> 
<p><img alt="" height="39" src="https://images2.imgbox.com/4e/00/VkWmXh6C_o.png" width="262"></p> 
<p><strong>（3）获取密码  config get requirepass</strong></p> 
<p> <img alt="" height="61" src="https://images2.imgbox.com/34/4f/ORsU0qJl_o.png" width="390"></p> 
<p><strong> （4）取消密码  config set requirepass ''</strong></p> 
<p><img alt="" height="40" src="https://images2.imgbox.com/b5/5c/E26S8sqZ_o.png" width="413"></p> 
<p><strong>2、管理key </strong></p> 
<div> 
 <pre><code>exists key -&gt; 判断某个key是否存在
expire key second -&gt; 设置key的过期时间
persist key -&gt; 取消key的过期时间
select index -&gt; 切换数据库索引,范围是0 ~ 15共16个分区
move key index -&gt; 把某个key-value移动到其他索引中
rename oldKey newKey -&gt; 把oldKey重命名为newKey
info -&gt; 查看当前服务器信息
flushdb -&gt; 清空当前库中的数据
flushall -&gt; 清空所有库中的数据</code></pre> 
 <h4>四、Redis如何操作数据</h4> 
 <p><strong>Redis支持多种数据类型：string，hash，list，set，zset。</strong></p> 
 <p><strong>1、string类型</strong></p> 
 <div> 
  <strong><span style="color:#333333;">（1）普通的字符串类型，表示一个简单值，</span>结构上：</strong> 
 </div> 
 <div>
     
 </div> 
 <div> 
  <table align="left" border="1" cellpadding="1" cellspacing="1" style="width:175px;"><tbody><tr><td style="width:82px;"><strong>key</strong></td><td style="width:90px;"><strong>value</strong></td></tr><tr><td style="width:82px;">name</td><td style="width:90px;">Cindy</td></tr></tbody></table> 
  <p> </p> 
  <p> </p> 
  <p> </p> 
  <p><strong>（2）操作string类型的常用命令：</strong></p> 
 </div> 
 <div>
     
 </div> 
 <pre><code>set key value -&gt; 存入键值对 
get key -&gt; 根据键取出值 
getset key value -&gt; 返回旧值后存入新值 
incr key -&gt; 把值递增1 
decr key -&gt; 把值递减1 
incrby key num -&gt; 偏移值 
append key 'value' -&gt; 原值后拼接新内容 
setnx key value -&gt; 存入键值对,键存在时不存入 
setex key timeout value -&gt; 存入键值对,timeout表示失效时间,单位s 
setrange key index value -&gt; 修改键对应的值,index表示开始的索引位置 
mset k1 v1 k2 v2 ... -&gt; 批量存入键值对 
mget k1 k2 ... -&gt; 批量取出键值 
del key -&gt; 根据键删除键值对</code></pre> 
 <p><strong>2、hash类型/hash对象</strong></p> 
 <p><strong>（1）hash类型实际上就是map类型，它的内部可以有多个键值对，可以用于存储对象。</strong></p> 
 <table align="left" border="1" cellpadding="1" cellspacing="1" style="width:257px;"><tbody><tr><td style="width:96px;"><strong>key</strong></td><td colspan="2" rowspan="1" style="width:159px;"> <p><strong>value</strong></p> </td></tr><tr><td colspan="1" rowspan="3" style="width:96px;">student</td><td style="width:72px;">hkey</td><td style="width:87px;">hvalue</td></tr><tr><td style="width:72px;">name</td><td style="width:87px;">Cindy</td></tr><tr><td style="width:72px;">age</td><td style="width:87px;">18</td></tr></tbody></table> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p><strong>（2）操作hash类型的常用命令：</strong></p> 
 <div> 
  <pre><code>hset key hashkey hashvalue -&gt; 存入一个hash对象
hget key hashkey -&gt; 根据hash对象键取去值
hincrby key hashkey 递增值 -&gt; 递增hashkey对应的值
hexists key hashkey -&gt; 判断hash对象是含有某个键
hlen key -&gt; 获取hash对象键的数量
hkeys key -&gt; 获取hash对象的所有键
hvals key -&gt; 获取hash对象的所有值
hgetall key -&gt; 获取hash对象的所有数据
hdel key hashkey -&gt; 根据hashkey删除hash对象键值对
同样有hsetnx,其作用跟用法和setnx一样</code></pre> 
  <p><strong>3、list类型</strong></p> 
  <div> 
   <strong><span style="color:#333333;">（1）list类型能直接操作首尾元素（队列）</span></strong> 
  </div> 
  <div>
      
  </div> 
  <div> 
   <table align="left" border="1" cellpadding="1" cellspacing="1" style="width:298px;"><tbody><tr><td><strong>    key</strong></td><td colspan="3" rowspan="1" style="width:204px;"><strong>               value</strong></td></tr><tr><td>game</td><td style="width:71px;">LOL</td><td style="width:63px;">CF</td><td style="width:72px;">GOK</td></tr></tbody></table> 
   <p> </p> 
   <p> </p> 
  </div> 
  <div>
      
  </div> 
  <div> 
   <strong>（2）操作<span style="color:#333333;">list</span>类型的常用命令：</strong> 
  </div> 
  <div> 
   <pre><code>rpush key value -&gt; 往列表右边添加数据
lpush key value -&gt; 往列表左边添加数据
lpop key -&gt; 弹出列表最左边的数据
rpop key -&gt; 弹出列表最右边的数据
lrange key start end -&gt; 范围显示列表数据,全显示则设置0 -1
linsert key before/after refVal newVal -&gt; 参考值之前/后插入数据
lset key index value -&gt; 根据索引修改数据
lrem key count value -&gt; 在列表中按照个数删除数据
ltrim key start end -&gt; 范围截取列表
lindex key index -&gt; 根据索引取列表中数据
llen key -&gt; 获取列表长度</code></pre> 
   <p><strong>4、set类型</strong></p> 
   <p>底层是哈希表，存入的元素，无序不可重复，可以通过命令来取到交、并、差集。</p> 
   <p><strong>操作set类型的常用命令：</strong></p> 
   <div> 
    <pre><code>sadd key value -&gt; 往set集合中添加元素
smembers key -&gt; 列出set集合中的元素
srem key value -&gt; 删除set集合中的元素
spop key count -&gt; 随机弹出集合中的元素
sdiff key1 key2 -&gt; 返回key1中特有元素
sdiffstore var key1 key2 -&gt; 返回key1中特有元素存入另一个set集合
sinter key1 key2 -&gt; 返回两个set集合的交集
sinterstore var key1 key2 -&gt; 返回两个set集合的交集存入另一个set集合
sunion key1 key2 -&gt; 返回两个set集合的并集
sunionstore var key1 key2 -&gt; 返回两个set集合的并集存入另一个set集合
smove key1 key2 value -&gt; 把key1中的某元素移入key2中
scard key -&gt; 返回set集合中元素个数
sismember key value -&gt; 判断集合是否包含某个值
srandmember key count -&gt; 随机获取set集合中元素</code></pre> 
    <p><strong>5、zset类型</strong></p> 
    <p><strong>操作zset类型的常用命令：</strong></p> 
    <div> 
     <pre><code>zadd key num name -&gt; 存入数值和名称
zrange key start end -&gt; 按照数值升序输出名称
zrangebyscore key min max [withscores] -&gt; 按照数值范围升序输出名称
zrevrange key start end -&gt; 按照数值降序输出名称
zrevrangebyscore key max min [withscores] -&gt; 按照数值范围降序输出名称
zrem key name -&gt; 删除名称和数值
zincrby key num name -&gt; 偏移名称对应的数值
zrank key name -&gt; 升序返回排名
zrevrank key name -&gt; 降序返回排名
zremrangebyscore key max min [withscores] -&gt; 根据分数范围删除元素
zremrangebyrank key start end -&gt; 根据排名删除元素
zcard key -&gt; 返回元素个数
zcount key min max -&gt; 按照分数范围统计个数</code></pre> 
     <h4>五、Java中如何操作Redis</h4> 
     <p>在Java中操作Redis的手段还是很多的，但是下面只介绍常用的两种。</p> 
     <p><strong>1、<span style="color:#333333;">Jedis </span></strong></p> 
     <p>（1）跟MySQL的使用类似，Java是不认识Redis的，所以要加入驱动包。依赖：</p> 
     <pre><code>&lt;!-- redis的驱动包:jedis --&gt; 
&lt;dependency&gt; 
    &lt;groupId&gt;redis.clients&lt;/groupId&gt; 
    &lt;artifactId&gt;jedis&lt;/artifactId&gt; 
&lt;/dependency&gt;</code></pre> 
     <p>（2）然后就可以按特定的步骤，操作Redis。（跟MySQL的“贾琏欲执事”类型）</p> 
     <p>步骤：</p> 
     <p>①创建Jedis连接池</p> 
     <p>②从连接池中获取Jedis对象</p> 
     <p>③操作（和Redis命令名字很像，根据方法名调用即可）</p> 
     <p><img alt="" height="211" src="https://images2.imgbox.com/78/b8/yjTmBHkC_o.png" width="518"></p> 
     <p>④释放资源</p> 
     <p><img alt="" height="367" src="https://images2.imgbox.com/77/0a/2tfrhifi_o.png" width="688"></p> 
     <p><strong>演示代码：</strong></p> 
     <p>链接：https://pan.baidu.com/s/1o7UvxzbToOnnmfAotvaHaw <br> 提取码：s5w7 <br>  </p> 
     <p> </p> 
     <p><strong>2、<span style="color:#333333;">Spring Data Redis </span></strong></p> 
     <p><span style="color:#333333;">（1）Spring Data Redis是Spring Data提供的一种对于Redis的解决方案。</span></p> 
     <p><span style="color:#333333;">【注】Spring Data是Spring全家桶的的一支，基本上常用的数据存储方案，它都支持，其中也包括Redis。</span></p> 
     <p><img alt="" height="504" src="https://images2.imgbox.com/b8/8d/Rn5vOKxh_o.png" width="779"></p> 
     <p><span style="color:#333333;">（2）它是通过引入对应的依赖，然后注入里面的StringRedisTemplate来使用的，StringRedisTemplate继承了RedisTemplate。</span></p> 
     <p><span style="color:#333333;">在使用StringRedisTemplate时，需要先获取到对应的操作对象，</span><span style="color:#333333;">opsForValue()操作string，</span><span style="color:#333333;">opsForZSet() 操作zset，opsForHash() 操作Hash，opsForList() 操作List，opsForSet() 操作Set，然后再用操作对象去调用对应的方法。</span></p> 
     <p><img alt="" height="258" src="https://images2.imgbox.com/e3/f8/Aqn9Kwe1_o.png" width="767"></p> 
     <p><strong>演示代码：</strong></p> 
     <p>链接：https://pan.baidu.com/s/1QcFW78j-vzYcLx3YuRkQsg <br> 提取码：57z4 <br>  </p> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/279f0ab82526d7270bb8f6d3a36a1f6b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android Studio下载、安装、配置SDK</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2394c3e65e81223ec02cbef5378e5274/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Twitter雪花算法SnowFlake介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>