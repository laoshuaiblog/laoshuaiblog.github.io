<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Storm学习教程 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/81b759c9cb83934a85c8048d70d0e5bc/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="Storm学习教程">
  <meta property="og:description" content="在这个教程中, 你将学到如何创建一个Storm topologies以及怎样把它部署到storm集群上。本教程中，Java将作为主要使用的语言，但在一小部分示例中将会使用Python来阐述storm处理多语言的能力。
预备工作 本教程使用的例子来自于 storm-starter 项目. 我们建议你拷贝该项目并跟随这个例子来进行学习。 请阅读 Setting up a development environment 和 Creating a new Storm project 创建好相应的基础环境。
Storm集群的组件 Storm集群在表面上与Hadoop集群相似。在Hadoop上运行&#34;MapReduce jobs&#34;，而在Storm上运行的是&#34;topologies&#34;。 &#34;Jobs&#34; and &#34;topologies&#34; 它们本身非常的不同 -- 一个关键的不同的是MapReduce job最终会完成并结束，而topology的消息处理将无限期进行下去（除非你kill它）。
在storm集群中，有两类节点。Master节点运行守护进程称为&#34;Nimbus&#34;，它有点像 Hadoop 的 &#34;JobTracker&#34;。Nimbus负责集群的代码分发，任务分配，故障监控。
每个工作节点运行的守护进程称为&#34;Supervisor&#34;。Supervisor 负责监听分配到它自己机器的作业，根据需要启动和停止相应的工作进程，当然这些工作进程也是Nimbus分派给它的。每个工作进程执行topology的一个子集；一个运行的topology是由分布在多个机器的多个工作进程组成的。
Nimbus 与 Supervisors 所有的协调工作是由 Zookeeper 集群完成的. 此外，Nimbus 守护进程 和 Supervisor 守护进程 是无状态的，快速失败的机制。 所有的状态保存在Zookeeper上或者本地磁盘中。这就是说，你用kill -9杀掉Nimbus 或者Supervisors，它们重新启动后就像什么都没有发生一样，这样的设计让storm集群拥有令人难以置信的稳定性。
Topologies 在Storm上进行实时计算，你需要创建名为 &#34;topologies&#34; 的这么个东西。一个topology是一个计算的图，每个在topology中的节点（以下部分也称作“组件”）包含了处理逻辑，以及多个节点间数据传送的联系和方式。运行一个topology很直接简单的。第一，你把你的java code和它所有的依赖打成一个单独的jar包。然后，你用如下的命令去运行就可以了。
storm jar all-my-code.jar org.apache.storm.MyTopology arg1 arg2 这个例子中运行的类是 org.apache.storm.MyTopology 且带着两个参数 arg1 和 arg2. 这个类的主要功能是定义topology，并被提交到Nimbus中。命令 storm jar 就是用来加载这个topology jar的。">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2017-01-09T11:54:23+08:00">
    <meta property="article:modified_time" content="2017-01-09T11:54:23+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Storm学习教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 在这个教程中, 你将学到如何创建一个<span style="line-height:24px">Storm topologies以及怎样把它部署到storm集群上。本教程中，<a target="_blank" href="http://lib.csdn.net/base/javase" rel="nofollow noopener noreferrer" class="replace_word" title="Java SE知识库" style="text-decoration:none; color:rgb(223,52,52); font-weight:bold">Java</a>将作为主要使用的语言，但在一小部分示例中将会使用<a target="_blank" href="http://lib.csdn.net/base/python" rel="nofollow noopener noreferrer" class="replace_word" title="Python知识库" style="text-decoration:none; color:rgb(223,52,52); font-weight:bold">Python</a>来阐述storm处理多语言的能力。</span></p> 
<h3 id="preliminaries" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t0" style="color:rgb(12,137,207)"></a>预备工作</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 本教程使用的例子来自于 <a target="_blank" href="http://github.com/apache/storm/blob/v1.0.1/examples/storm-starter" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent" rel="noopener noreferrer">storm-starter</a> 项目. 我们建议你拷贝该项目并跟随这个例子来进行学习。 请阅读 <a target="_blank" href="http://storm.apache.org/releases/current/Setting-up-development-environment.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Setting up a development environment</a> 和 <a target="_blank" href="http://storm.apache.org/releases/current/Creating-a-new-Storm-project.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Creating a new Storm project</a> 创建好相应的基础环境。</p> 
<h3 id="components-of-a-storm-cluster" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t1" style="color:rgb(12,137,207)"></a>Storm集群的组件</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> Storm集群在表面上与<a target="_blank" href="http://lib.csdn.net/base/hadoop" rel="nofollow noopener noreferrer" class="replace_word" title="Hadoop知识库" style="text-decoration:none; color:rgb(223,52,52); font-weight:bold">Hadoop</a>集群相似。在Hadoop上运行<span style="line-height:24px">"MapReduce jobs"，而在Storm上运行的是</span><span style="line-height:24px">"topologies"。 "Jobs" and "topologies" 它们本身非常的不同 -- 一个关键的不同的是<span style="line-height:24px">MapReduce job最终会完成并结束，而<span style="line-height:24px">topology的消息处理将无限期进行下去（除非你kill它）。</span></span></span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 在storm集群中，有两类节点。Master节点运行守护进程称为<span style="line-height:24px">"Nimbus"，它有点像 Hadoop 的 <span style="line-height:24px">"JobTracker"。Nimbus负责集群的代码分发，任务分配，故障监控。</span></span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 每个工作节点运行的守护进程称为<span style="line-height:24px">"Supervisor"。S<span style="line-height:24px">upervisor 负责监听分配到它自己机器的作业，根据需要启动和停止相应的工作进程，当然这些工作进程也是Nimbus分派给它的。每个工作进程执行topology的一个子集；一个运行的topology是由分布在多个机器的多个工作进程组成的。</span></span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <span style="line-height:24px"><br> </span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <img src="https://images2.imgbox.com/54/ec/Xb1mQuq8_o.png" alt="Storm cluster" style="border:0px; max-width:602px; max-height:100%; height:auto; vertical-align:middle"></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> Nimbus 与 <span style="line-height:24px">Supervisors 所有的协调工作是由 </span><a target="_blank" href="http://zookeeper.apache.org/" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Zookeeper</a> 集群完成的. 此外，Nimbus 守护进程 和 <span style="line-height:24px">Supervisor 守护进程 是无状态的，快速失败的机制。</span> 所有的状态保存在Zookeeper上或者本地磁盘中。这就是说，你用kill -9杀掉Nimbus 或者<span style="line-height:24px">Supervisors，它们重新启动后就像什么都没有发生一样，这样的设计让storm集群拥有令人难以置信的稳定性。</span></p> 
<h3 id="topologies" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t2" style="color:rgb(12,137,207)"></a>Topologies</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 在Storm上进行实时计算，你需要创建名为 <span style="line-height:24px">"topologies" 的这么个东西。一个<span style="line-height:24px">topology是一个计算的图，每个在topology中的节点（以下部分也称作“组件”）包含了处理逻辑，以及多个节点间数据传送的联系和方式。运行一个topology很直接简单的。第一，你把你的java code和它所有的依赖打成一个单独的jar包。然后，你用如下的命令去运行就可以了。</span></span></p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'>storm jar all-my-code.jar org.apache.storm.MyTopology arg1 arg2
</code></pre> 
</div> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 这个例子中运行的类是 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>org.apache.storm.MyTopology</code> 且带着两个参数 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>arg1</code> 和 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>arg2</code>. 这个类的主要功能是定义topology，并被提交到Nimbus中。命令 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>storm jar</code> 就是用来加载这个topology jar的。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 因为topology的定义方式就是Thrift的结构，Nimbus也是一个Thrift服务，所以你可以用任何语言去创建topologies并提交。以上的例子是最简单的方式去使用基于JVM的语言（比如java）创建的topology。请阅读 <a target="_blank" href="http://storm.apache.org/releases/current/Running-topologies-on-a-production-cluster.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Running topologies on a production cluster</a> 来获得更多的信息关于topology的启动和停止。</p> 
<h3 id="streams" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t3" style="color:rgb(12,137,207)"></a>流</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> Storm里的核心抽象就是 "流"。流 是一个无界的 元组序列。Storm提供原始地、分布式地、可靠地方式 把一个流转变成一个新的流。举例来说，</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 你可以把一个 tweet 流 转换成一个 趋势主题 的流。 </p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> Storm中提供 流转换 的最主要的原生方式是 <span style="line-height:24px">"spouts" and "bolts"。<span style="line-height:24px">Spouts 和 bolts 有相应的接口，你需要用你的应用的特定逻辑实现接口即可。</span></span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <span style="line-height:24px">Spout是 流 的源头。举例来说，一个spout也许会从</span> <a target="_blank" href="http://github.com/nathanmarz/storm-kestrel" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent" rel="noopener noreferrer">Kestrel</a> 队列中读取数据并以流的方式发射出来，亦或者一个spout也许会连接Twitter的API,</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 并发出一个关于tweets的流。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 一个bolt可以消费任意数量的输入流，并做一些处理，也可以由此发出一个新的流。复杂流的转换，像从一个tweet流中计算出一个关于趋势话题的流，它要求多个步骤，因此也需要多个bolt。Bolts 能做任何事情，运行方法，过滤元组，做流的聚合，流的连接，写入<a target="_blank" href="http://lib.csdn.net/base/mysql" rel="nofollow noopener noreferrer" class="replace_word" title="MySQL知识库" style="text-decoration:none; color:rgb(223,52,52); font-weight:bold">数据库</a>等。 </p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> Spouts 和 bolts 组成的网络 打包到 "topology" 中，它是顶级的抽象，是你需要提交到storm集群执行的东西。一个topology是一个由spout和bolt组成的 做流转换 的图，其中图中的每个节点都可以是一个spout或者一个bolt。图中的边表明了bolt订阅了哪些流，亦或是当一个spout或者bolt发射元组到流中，它发出的元组数据到订阅这个流的所有bolt中去。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <img src="https://images2.imgbox.com/cd/0f/63SnPrCZ_o.png" alt="A Storm topology" style="border:0px; max-width:602px; max-height:100%; height:auto; vertical-align:middle"></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> topology中节点之间的联系表明了元组数据是怎样去传送的。举例来说，Spout A 和 Bolt B 相连（A 到 B），Spout A 和 Bolt C 相连(A 到 C)，Bolt B 和 Bolt C相连(B 到 C)。每当Spout A发出元组数据时，它会同时发给Bolt B 和 Bolt C。再者，所有Bolt B的输出元组，也会发给Bolt C。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 在topology中的每个节点都是并行运行的。因此在你的topology中，你可以为每个节点指定并行运行的数量，然后storm集群将会产生相应数量的线程来执行。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 一个topology无限运行，直到你杀掉它才会停止。Storm将自动地重新分配失败过的任务。此外，Storm保证不会有数据丢失，即便是机器挂掉，消息被丢弃。</p> 
<h3 id="data-model" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t4" style="color:rgb(12,137,207)"></a>数据模型</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> Storm用元组作为它的数据模型。一个元组是一个命名的，有值的，一般由过个字段组成的序列，序列中的每个字段可以是任何类型的对象。在沙箱之外，Storm提供所有的原始类型，字符串，byte数组作为元组的字段值。如果想用一个其他类型的对象，你需要实现<a target="_blank" href="http://storm.apache.org/releases/current/Serialization.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">a serializer</a> 接口。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 每个topology节点必须声明输出元组的字段。举例来说，这个bolt声明它将输出带有<span style="line-height:24px">"double" and "triple"两个字段的元组：</span></p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-java" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'><span class="kd" style="font-weight:bold">public</span> <span class="kd" style="font-weight:bold">class</span> <span class="nc" style="color:rgb(68,85,136); font-weight:bold">DoubleAndTripleBolt</span> <span class="kd" style="font-weight:bold">extends</span> <span class="n">BaseRichBolt</span> <span class="o" style="font-weight:bold">{<!-- --></span>
    <span class="kd" style="font-weight:bold">private</span> <span class="n">OutputCollectorBase</span> <span class="n">_collector</span><span class="o" style="font-weight:bold">;</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">prepare</span><span class="o" style="font-weight:bold">(</span><span class="n">Map</span> <span class="n">conf</span><span class="o" style="font-weight:bold">,</span> <span class="n">TopologyContext</span> <span class="n">context</span><span class="o" style="font-weight:bold">,</span> <span class="n">OutputCollectorBase</span> <span class="n">collector</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="n">_collector</span> <span class="o" style="font-weight:bold">=</span> <span class="n">collector</span><span class="o" style="font-weight:bold">;</span>
    <span class="o" style="font-weight:bold">}</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">execute</span><span class="o" style="font-weight:bold">(</span><span class="n">Tuple</span> <span class="n">input</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="kt" style="color:rgb(68,85,136); font-weight:bold">int</span> <span class="n">val</span> <span class="o" style="font-weight:bold">=</span> <span class="n">input</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">getInteger</span><span class="o" style="font-weight:bold">(</span><span class="mi" style="color:rgb(0,153,153)">0</span><span class="o" style="font-weight:bold">);</span>        
        <span class="n">_collector</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">emit</span><span class="o" style="font-weight:bold">(</span><span class="n">input</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">Values</span><span class="o" style="font-weight:bold">(</span><span class="n">val</span><span class="o" style="font-weight:bold">*</span><span class="mi" style="color:rgb(0,153,153)">2</span><span class="o" style="font-weight:bold">,</span> <span class="n">val</span><span class="o" style="font-weight:bold">*</span><span class="mi" style="color:rgb(0,153,153)">3</span><span class="o" style="font-weight:bold">));</span>
        <span class="n">_collector</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">ack</span><span class="o" style="font-weight:bold">(</span><span class="n">input</span><span class="o" style="font-weight:bold">);</span>
    <span class="o" style="font-weight:bold">}</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">declareOutputFields</span><span class="o" style="font-weight:bold">(</span><span class="n">OutputFieldsDeclarer</span> <span class="n">declarer</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="n">declarer</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">declare</span><span class="o" style="font-weight:bold">(</span><span class="k" style="font-weight:bold">new</span> <span class="n">Fields</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"double"</span><span class="o" style="font-weight:bold">,</span> <span class="s" style="color:rgb(221,17,68)">"triple"</span><span class="o" style="font-weight:bold">));</span>
    <span class="o" style="font-weight:bold">}</span>    
<span class="o" style="font-weight:bold">}</span>
</code></pre> 
</div> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px">  <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>declareOutputFields</code> 方法声明了该bolt的输出的字段 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>["double", "triple"]</code> .这个bolt的剩余部分将在接下来进行说明。</p> 
<h3 id="a-simple-topology" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t5" style="color:rgb(12,137,207)"></a>一个简单<span style="line-height:1.1">topology</span></h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 让我们去看一个简单的 topology，去探索更多的概念，去看一下它的代码到底长什么样。让我们看一下 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ExclamationTopology</code> 的定义，来自storm-starter的项目:</p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-java" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'><span class="n">TopologyBuilder</span> <span class="n">builder</span> <span class="o" style="font-weight:bold">=</span> <span class="k" style="font-weight:bold">new</span> <span class="n">TopologyBuilder</span><span class="o" style="font-weight:bold">();</span>        
<span class="n">builder</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">setSpout</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"words"</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">TestWordSpout</span><span class="o" style="font-weight:bold">(),</span> <span class="mi" style="color:rgb(0,153,153)">10</span><span class="o" style="font-weight:bold">);</span>        
<span class="n">builder</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">setBolt</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"exclaim1"</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">ExclamationBolt</span><span class="o" style="font-weight:bold">(),</span> <span class="mi" style="color:rgb(0,153,153)">3</span><span class="o" style="font-weight:bold">)</span>
        <span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">shuffleGrouping</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"words"</span><span class="o" style="font-weight:bold">);</span>
<span class="n">builder</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">setBolt</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"exclaim2"</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">ExclamationBolt</span><span class="o" style="font-weight:bold">(),</span> <span class="mi" style="color:rgb(0,153,153)">2</span><span class="o" style="font-weight:bold">)</span>
        <span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">shuffleGrouping</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"exclaim1"</span><span class="o" style="font-weight:bold">);</span>
</code></pre> 
</div> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 这个topology包含了一个spout和两个bolt，这个spout发出words，然后每个bolt都在自己的读入字符串上加上<span style="line-height:24px">"!!!"。</span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 这些节点被安排成一条线：spout发给第一个bolt，第一个bolt发给第二个bolt。如果spout发出的元组数据是<span style="line-height:24px">["bob"] 和 ["john"]，通过第二个</span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> bolt后，将发出<span style="line-height:24px">["bob!!!!!!"] 和 ["john!!!!!!"]。</span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 代码中用 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>setSpout</code> 和 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>setBolt</code> 方法定义了节点。这些方法的输入是 一个用户指定的id，包含处理逻辑的对象，你希望该节点并行计算的数量。在这个例子中，这个 spout 的id是 "words" ，两个bolt的id分别为 "exclaim1" 和 "exclaim2"。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 包含处理逻辑的spout对象实现了 <a target="_blank" href="http://storm.apache.org/releases/current/javadocs/org/apache/storm/topology/IRichSpout.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">IRichSpout</a> 接口，bolt对象实现了 <a target="_blank" href="http://storm.apache.org/releases/current/javadocs/org/apache/storm/topology/IRichBolt.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">IRichBolt</a> 接口。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 最后一个参数，是你希望该节点并行计算的数量是多少，这是可选的。它表明了会有多少线程会通过storm集群来执行这个组件（spout或bolt）。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 如果你忽略它，Storm集群会分配单线程给该节点。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>setBolt</code> 返回一个 <a target="_blank" href="http://storm.apache.org/releases/current/javadocs/org/apache/storm/topology/InputDeclarer.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">InputDeclarer</a> 对象,它用来定义bolt的输入。在这里，bolt "<span style="line-height:24px">exclaim1</span>" 声明了它希望通过shuffle分组的方式读取 spout "words"中的所有元组。同理，Bolt "<span style="line-height:24px">exclaim2</span>" 声明了它希望通过shuffle分组的方式读取 bolt "<span style="line-height:24px">exclaim1</span>" 所发出的元组数据。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> "shuffle 分组" 指元组数据 将会 随机分布地 从输入任务 到bolt任务中。在多个组件（spout或bolt）之间，这里有很多数据分组的方式。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 这在接下来的章节中会说明。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 如果你希望bolt "<span style="line-height:24px">exclaim2</span>" 从 spout "words" 和 bolt "<span style="line-height:24px">exclaim1</span>" 读取所有的元组数据，你需要像下面这样定义：</p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-java" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'><span class="n">builder</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">setBolt</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"exclaim2"</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">ExclamationBolt</span><span class="o" style="font-weight:bold">(),</span> <span class="mi" style="color:rgb(0,153,153)">5</span><span class="o" style="font-weight:bold">)</span>
            <span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">shuffleGrouping</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"words"</span><span class="o" style="font-weight:bold">)</span>
            <span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">shuffleGrouping</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"exclaim1"</span><span class="o" style="font-weight:bold">);</span>
</code></pre> 
</div> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 如你所见，输入的定义可以是链式的，bolt可以指定多个源。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 让我们深入了解一下spout和bolt在topology中的实现。Spout负责发送新的数据到topology中。 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>TestWordSpout</code> 在topology中每隔 100ms 发送了一个随机的单词，单词来自列表["nathan", "mike", "jackson", "golda", "bertels"]。<span style="line-height:24px">在 TestWordSpout 中的</span> <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>nextTuple()</code> 的实现细节如下:</p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-java" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'><span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="nf" style="color:rgb(153,0,0); font-weight:bold">nextTuple</span><span class="p">(</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
    <span class="n">Utils</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">sleep</span><span class="o" style="font-weight:bold">(</span><span class="mi" style="color:rgb(0,153,153)">100</span><span class="o" style="font-weight:bold">);</span>
    <span class="kd" style="font-weight:bold">final</span> <span class="n">String</span><span class="o" style="font-weight:bold">[]</span> <span class="n">words</span> <span class="o" style="font-weight:bold">=</span> <span class="k" style="font-weight:bold">new</span> <span class="n">String</span><span class="o" style="font-weight:bold">[]</span> <span class="o" style="font-weight:bold">{<!-- --></span><span class="s" style="color:rgb(221,17,68)">"nathan"</span><span class="o" style="font-weight:bold">,</span> <span class="s" style="color:rgb(221,17,68)">"mike"</span><span class="o" style="font-weight:bold">,</span> <span class="s" style="color:rgb(221,17,68)">"jackson"</span><span class="o" style="font-weight:bold">,</span> <span class="s" style="color:rgb(221,17,68)">"golda"</span><span class="o" style="font-weight:bold">,</span> <span class="s" style="color:rgb(221,17,68)">"bertels"</span><span class="o" style="font-weight:bold">};</span>
    <span class="kd" style="font-weight:bold">final</span> <span class="n">Random</span> <span class="n">rand</span> <span class="o" style="font-weight:bold">=</span> <span class="k" style="font-weight:bold">new</span> <span class="n">Random</span><span class="o" style="font-weight:bold">();</span>
    <span class="kd" style="font-weight:bold">final</span> <span class="n">String</span> <span class="n">word</span> <span class="o" style="font-weight:bold">=</span> <span class="n">words</span><span class="o" style="font-weight:bold">[</span><span class="n">rand</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">nextInt</span><span class="o" style="font-weight:bold">(</span><span class="n">words</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">length</span><span class="o" style="font-weight:bold">)];</span>
    <span class="n">_collector</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">emit</span><span class="o" style="font-weight:bold">(</span><span class="k" style="font-weight:bold">new</span> <span class="n">Values</span><span class="o" style="font-weight:bold">(</span><span class="n">word</span><span class="o" style="font-weight:bold">));</span>
<span class="o" style="font-weight:bold">}</span>
</code></pre> 
</div> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 如你所见，这个实现非常简单明了。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ExclamationBolt</code> 给输入的字符串追加上 "!!!" 。 让我们看一下 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ExclamationBolt</code> 的完整实现吧：</p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-java" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'><span class="kd" style="font-weight:bold">public</span> <span class="kd" style="font-weight:bold">static</span> <span class="kd" style="font-weight:bold">class</span> <span class="nc" style="color:rgb(68,85,136); font-weight:bold">ExclamationBolt</span> <span class="kd" style="font-weight:bold">implements</span> <span class="n">IRichBolt</span> <span class="o" style="font-weight:bold">{<!-- --></span>
    <span class="n">OutputCollector</span> <span class="n">_collector</span><span class="o" style="font-weight:bold">;</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">prepare</span><span class="o" style="font-weight:bold">(</span><span class="n">Map</span> <span class="n">conf</span><span class="o" style="font-weight:bold">,</span> <span class="n">TopologyContext</span> <span class="n">context</span><span class="o" style="font-weight:bold">,</span> <span class="n">OutputCollector</span> <span class="n">collector</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="n">_collector</span> <span class="o" style="font-weight:bold">=</span> <span class="n">collector</span><span class="o" style="font-weight:bold">;</span>
    <span class="o" style="font-weight:bold">}</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">execute</span><span class="o" style="font-weight:bold">(</span><span class="n">Tuple</span> <span class="n">tuple</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="n">_collector</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">emit</span><span class="o" style="font-weight:bold">(</span><span class="n">tuple</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">Values</span><span class="o" style="font-weight:bold">(</span><span class="n">tuple</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">getString</span><span class="o" style="font-weight:bold">(</span><span class="mi" style="color:rgb(0,153,153)">0</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">+</span> <span class="s" style="color:rgb(221,17,68)">"!!!"</span><span class="o" style="font-weight:bold">));</span>
        <span class="n">_collector</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">ack</span><span class="o" style="font-weight:bold">(</span><span class="n">tuple</span><span class="o" style="font-weight:bold">);</span>
    <span class="o" style="font-weight:bold">}</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">cleanup</span><span class="o" style="font-weight:bold">()</span> <span class="o" style="font-weight:bold">{<!-- --></span>
    <span class="o" style="font-weight:bold">}</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">declareOutputFields</span><span class="o" style="font-weight:bold">(</span><span class="n">OutputFieldsDeclarer</span> <span class="n">declarer</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="n">declarer</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">declare</span><span class="o" style="font-weight:bold">(</span><span class="k" style="font-weight:bold">new</span> <span class="n">Fields</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"word"</span><span class="o" style="font-weight:bold">));</span>
    <span class="o" style="font-weight:bold">}</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="n">Map</span><span class="o" style="font-weight:bold">&lt;</span><span class="n">String</span><span class="o" style="font-weight:bold">,</span> <span class="n">Object</span><span class="o" style="font-weight:bold">&gt;</span> <span class="n">getComponentConfiguration</span><span class="o" style="font-weight:bold">()</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="k" style="font-weight:bold">return</span> <span class="kc" style="font-weight:bold">null</span><span class="o" style="font-weight:bold">;</span>
    <span class="o" style="font-weight:bold">}</span>
<span class="o" style="font-weight:bold">}</span>
</code></pre> 
</div> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>prepare</code><span style="line-height:24px"> 方法提供了一个 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>OutputCollector</code><span style="line-height:24px"> 对象，它用来发出元组数据给下游节点。元组数据可以在任意时间从bolt发出 -- 可以在 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>prepare</code><span style="line-height:24px">,</span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>execute</code><span style="line-height:24px">, 或者 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>cleanup</code><span style="line-height:24px"> 方法,或者 在另一个线程，异步地发送。 这里的 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>prepare</code><span style="line-height:24px"> 实现很简单，初始化并保存了 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>OutputCollector</code><span style="line-height:24px"> 的引用，该引用将在接下来的</span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>execute</code><span style="line-height:24px"> 方法中使用。</span><br> </p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <span style="line-height:24px"><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>execute</code><span style="line-height:24px"> 方法从该bolt的输入中接收一个元组数据， </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ExclamationBolt</code><span style="line-height:24px"> 对象提取元组中的第一个字段，并追加字符串 "!!!" 。如果你实现的bolt订阅了多个输入源，你可以用 </span><a target="_blank" href="http://storm.apache.org/javadoc/apidocs/org/apache/storm/tuple/Tuple.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); line-height:24px; background-color:transparent">Tuple</a><span style="line-height:24px"> 中的 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>Tuple#getSourceComponent </code><span style="line-height:24px">方法来获取你当前读取的这个元组数据来自于哪个源。</span></span></p> 
<p style='margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px; line-height:24px'> <span style="line-height:24px"><span style="line-height:24px"><span style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:24px">在 </span><code style='color:rgb(199,37,78); font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; line-height:24px; padding:2px 4px; background-color:rgb(249,242,244)'>execute</code><span style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:24px"> 方法中，还有一点东西需要说明。 即输入的元组作为第一个参数 </span><span style="line-height:24px; font-size:12.6px; background-color:rgb(249,242,244)"><span style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; color:rgb(199,37,78)'>发出</span></span><span style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:24px"> ，然后在最后一行中发出确认消息。这是Storm保证可靠性的API的一部分，它保证数据不会丢失，这在之后的教程会说明。</span></span></span></p> 
<p style='margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px; line-height:24px'> <span style="line-height:24px"><span style="line-height:24px"><span style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:24px"><span style="line-height:24px">当一个Bolt将要停止、关闭时，它需要关闭当前打开的资源，此时 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>cleanup</code><span style="line-height:24px"> 方法可以被调用。 需要注意的是，这并不保证这个方法在storm集群中一定会被调用：举例来说，如果机器上的任务爆发，这就不会调用这个方法。</span></span></span></span><span style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> </span><code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>cleanup</code><span style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 方法打算用于，当你在</span><span style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> </span><a target="_blank" href="http://storm.apache.org/releases/current/Local-mode.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); font-family:Lato,sans-serif; font-size:14px; background-color:transparent">local mode</a><span style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 上运行你的topology(模拟storm集群的仿真模式), 你能够启动和停止很多topology且不会遭受任何资源泄露的问题。</span></p> 
<p style='margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px; line-height:24px'> <span style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>declareOutputFields</code><span style="line-height:24px"> 方法声明 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ExclamationBolt</code><span style="line-height:24px"> 发出一个名称为 <span style="line-height:24px">"word" 的带一个字段的元组。</span></span></span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>getComponentConfiguration</code> 方法允许你从很多方面配置这个组件怎样去运行。更多高级的话题，深入的解释，请参见 <a target="_blank" href="http://storm.apache.org/releases/current/Configuration.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Configuration</a>.</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <span style="line-height:24px">通常像 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>cleanup</code><span style="line-height:24px"> 和 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>getComponentConfiguration</code><span style="line-height:24px"> 方法，在bolt中并不是必须去实现的。你可以用一个更为简洁的方式，通过使用一个提供默认实现的基本类去定义bolt，这也许更为合适一些。 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ExclamationBolt</code><span style="line-height:24px"> 可以通过继承 </span><code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>BaseRichBolt</code><span style="line-height:24px">,这会更简单一点，就像这样:</span></p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-java" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'><span class="kd" style="font-weight:bold">public</span> <span class="kd" style="font-weight:bold">static</span> <span class="kd" style="font-weight:bold">class</span> <span class="nc" style="color:rgb(68,85,136); font-weight:bold">ExclamationBolt</span> <span class="kd" style="font-weight:bold">extends</span> <span class="n">BaseRichBolt</span> <span class="o" style="font-weight:bold">{<!-- --></span>
    <span class="n">OutputCollector</span> <span class="n">_collector</span><span class="o" style="font-weight:bold">;</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">prepare</span><span class="o" style="font-weight:bold">(</span><span class="n">Map</span> <span class="n">conf</span><span class="o" style="font-weight:bold">,</span> <span class="n">TopologyContext</span> <span class="n">context</span><span class="o" style="font-weight:bold">,</span> <span class="n">OutputCollector</span> <span class="n">collector</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="n">_collector</span> <span class="o" style="font-weight:bold">=</span> <span class="n">collector</span><span class="o" style="font-weight:bold">;</span>
    <span class="o" style="font-weight:bold">}</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">execute</span><span class="o" style="font-weight:bold">(</span><span class="n">Tuple</span> <span class="n">tuple</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="n">_collector</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">emit</span><span class="o" style="font-weight:bold">(</span><span class="n">tuple</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">Values</span><span class="o" style="font-weight:bold">(</span><span class="n">tuple</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">getString</span><span class="o" style="font-weight:bold">(</span><span class="mi" style="color:rgb(0,153,153)">0</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">+</span> <span class="s" style="color:rgb(221,17,68)">"!!!"</span><span class="o" style="font-weight:bold">));</span>
        <span class="n">_collector</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">ack</span><span class="o" style="font-weight:bold">(</span><span class="n">tuple</span><span class="o" style="font-weight:bold">);</span>
    <span class="o" style="font-weight:bold">}</span>

    <span class="nd">@Override</span>
    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">declareOutputFields</span><span class="o" style="font-weight:bold">(</span><span class="n">OutputFieldsDeclarer</span> <span class="n">declarer</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="n">declarer</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">declare</span><span class="o" style="font-weight:bold">(</span><span class="k" style="font-weight:bold">new</span> <span class="n">Fields</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"word"</span><span class="o" style="font-weight:bold">));</span>
    <span class="o" style="font-weight:bold">}</span>    
<span class="o" style="font-weight:bold">}</span>
</code></pre> 
</div> 
<h3 id="running-exclamationtopology-in-local-mode" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t6" style="color:rgb(12,137,207)"></a>在<span style="line-height:1.1">local mode上运行</span>ExclamationTopology</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 让我们来看一下如何在本地模式上运行 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ExclamationTopology</code> ，看到它工作起来。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> Storm有两种操作模式：本地模式和分布式模式。在本地模式中，Storm通过线程模拟工作节点并在一个进程中完成执行。本地模式在用于开发和<a target="_blank" href="http://lib.csdn.net/base/softwaretest" rel="nofollow noopener noreferrer" class="replace_word" title="软件测试知识库" style="text-decoration:none; color:rgb(223,52,52); font-weight:bold">测试</a>topology时是很有用处的。当你在本地模式中运行 <span style="line-height:24px">storm-starter 项目中的 topology 时，你就能看到每个组件发送了什么信息。你可以获取更多关于在本地模式上运行topology的信息，请参见</span> <a target="_blank" href="http://storm.apache.org/releases/current/Local-mode.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Local mode</a>。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 在分布式模式中，Storm操作的是机器集群。当你提交一个topology给master，你也需要提交运行这个topology所必须的代码。Master将会关注于分发你的代码并分配worker去运行你的topology。如果worker挂掉，master将会重新分配这些代码、topology到其他地方。你可以获取更多关于在分布式模式上运行topology的信息，请参见 <a target="_blank" href="http://storm.apache.org/releases/current/Running-topologies-on-a-production-cluster.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Running topologies on a production cluster</a>。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 这是在本地模式上运行 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ExclamationTopology</code> 的代码:</p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-java" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'><span class="n">Config</span> <span class="n">conf</span> <span class="o" style="font-weight:bold">=</span> <span class="k" style="font-weight:bold">new</span> <span class="n">Config</span><span class="o" style="font-weight:bold">();</span>
<span class="n">conf</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">setDebug</span><span class="o" style="font-weight:bold">(</span><span class="kc" style="font-weight:bold">true</span><span class="o" style="font-weight:bold">);</span>
<span class="n">conf</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">setNumWorkers</span><span class="o" style="font-weight:bold">(</span><span class="mi" style="color:rgb(0,153,153)">2</span><span class="o" style="font-weight:bold">);</span>

<span class="n">LocalCluster</span> <span class="n">cluster</span> <span class="o" style="font-weight:bold">=</span> <span class="k" style="font-weight:bold">new</span> <span class="n">LocalCluster</span><span class="o" style="font-weight:bold">();</span>
<span class="n">cluster</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">submitTopology</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"test"</span><span class="o" style="font-weight:bold">,</span> <span class="n">conf</span><span class="o" style="font-weight:bold">,</span> <span class="n">builder</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">createTopology</span><span class="o" style="font-weight:bold">());</span>
<span class="n">Utils</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">sleep</span><span class="o" style="font-weight:bold">(</span><span class="mi" style="color:rgb(0,153,153)">10000</span><span class="o" style="font-weight:bold">);</span>
<span class="n">cluster</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">killTopology</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"test"</span><span class="o" style="font-weight:bold">);</span>
<span class="n">cluster</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">shutdown</span><span class="o" style="font-weight:bold">();</span>
</code></pre> 
</div> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 首先，代码中定义了单进程的伪集群，通过创建 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>LocalCluster</code> 对象实现。提交topology到虚拟集群，和提交topology到真正的分布式集群是相同的。提交topology使用<code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>LocalCluster</code> 的 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>submitTopology</code> 方法。它需要的参数为 topology的名字，topology的配置，topology本身。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> topology的名称是为了标识topology，以便你之后可以停掉它。一个topology将无限期运行，直到你停掉它。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> topology的配置可以从多个方面调整topology运行时的形态。这里给出了两个最为常见的配置：</p> 
<ol style="margin-top:0px; margin-bottom:10px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"><li><span style="font-weight:700">TOPOLOGY_WORKERS</span> (用 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>setNumWorkers</code>方法来设置) 表明你希望在storm集群中分配多少进程来执行你的topology。每个在topology中的组件（spout 或 bolt）将会被分配多个线程去执行。线程数的设置是通过组件的 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>setBolt</code> 和 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>setSpout</code> 方法。这些线程存在于worker进程中。 每个worker进程包含了处理一些组件的一些线程，例如，你横跨集群指定了300个线程处理所有的组件，且指定了50个worker进程。也就是说，每个工作进程将执行6个线程， 其中的每一个可能又属于不同的组件。调整topology的性能需要通过调整每个组件的并行线程数 和 工作进程中运行的线程数量。</li><li><span style="font-weight:700">TOPOLOGY_DEBUG</span> (用 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>setDebug</code>方法来设置), 当设为true的时候,它将告诉Storm打印组件发出的每条信息。这在本地模式测试topology的时候很有用处。但是当你的topology在集群中运行的时候，或许你应该关掉它。</li></ol> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 这里有很多其他的topology的配置，更多细节请参见 <a target="_blank" href="http://storm.apache.org/releases/current/javadocs/org/apache/storm/Config.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">the Javadoc for Config</a>.</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 学习如何建立自己的开发环境，以便你能用本地模式运行你的topology（比如在eclipse里），请参见 <a target="_blank" href="http://storm.apache.org/releases/current/Creating-a-new-Storm-project.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Creating a new Storm project</a>.</p> 
<h3 id="stream-groupings" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t7" style="color:rgb(12,137,207)"></a>流的分组方式</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 流的分组方式告诉一个topology，两个组件是通过怎样的方式传递元组数据。记住，spout 和 bolt 是并行执行在集群上的多个任务中的。如果你想知道一个topology是如何在任务层执行的，它也许就是这样的：</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <img src="https://images2.imgbox.com/37/47/puoot1y4_o.png" alt="Tasks in a topology" style="border:0px; max-width:602px; max-height:100%; height:auto; vertical-align:middle"></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 从上图可知，bolt A 有4个task，bolt B有3个task。当bolt A的1个task 发出一个元组给 bolt B,那么bolt A的这个task应该发给bolt B的哪个task呢？</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 流的分组方式通过告诉storm在两个任务集（上图的 bolt A 的任务集 合 bolt B的任务集）发送元组信息的方式 回答了这个问题。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 在我们深入研究不同的流的分组策略前，我们先看一下另一个来自 <a target="_blank" href="http://github.com/apache/storm/blob/1.0.1/examples/storm-starter" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent" rel="noopener noreferrer">storm-starter</a> 项目的例子。 <a target="_blank" href="http://github.com/apache/storm/blob/v1.0.1/examples/storm-starter/src/jvm/storm/starter/WordCountTopology.java" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent" rel="noopener noreferrer">WordCountTopology</a> 从spout读取一句话，并分流给 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>WordCountBolt</code> ，并统计句子中每个词儿出现的次数:</p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-java" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'><span class="n">TopologyBuilder</span> <span class="n">builder</span> <span class="o" style="font-weight:bold">=</span> <span class="k" style="font-weight:bold">new</span> <span class="n">TopologyBuilder</span><span class="o" style="font-weight:bold">();</span>

<span class="n">builder</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">setSpout</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"sentences"</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">RandomSentenceSpout</span><span class="o" style="font-weight:bold">(),</span> <span class="mi" style="color:rgb(0,153,153)">5</span><span class="o" style="font-weight:bold">);</span>        
<span class="n">builder</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">setBolt</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"split"</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">SplitSentence</span><span class="o" style="font-weight:bold">(),</span> <span class="mi" style="color:rgb(0,153,153)">8</span><span class="o" style="font-weight:bold">)</span>
        <span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">shuffleGrouping</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"sentences"</span><span class="o" style="font-weight:bold">);</span>
<span class="n">builder</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">setBolt</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"count"</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">WordCount</span><span class="o" style="font-weight:bold">(),</span> <span class="mi" style="color:rgb(0,153,153)">12</span><span class="o" style="font-weight:bold">)</span>
        <span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">fieldsGrouping</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"split"</span><span class="o" style="font-weight:bold">,</span> <span class="k" style="font-weight:bold">new</span> <span class="n">Fields</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"word"</span><span class="o" style="font-weight:bold">));</span>
</code></pre> 
</div> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>SplitSentence</code> 发出的元组来自于它接收到的每个句子的每个单词，<code style='line-height:24px; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>WordCount</code><span style="line-height:24px"> 在内存中保留一个map统计单词的次数。每当<span style='color:rgb(199,37,78); font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; line-height:24px; background-color:rgb(249,242,244)'>WordCount</span></span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 收到一个单词，它将更新map的状态并发出最新的单词统计。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 这里有几种不同的流的分组方式。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 最简单的分组方式称作 <span style="line-height:24px">"shuffle grouping" ，这种方式是将元组数据发送给随机的任务。<span style="line-height:24px">shuffle grouping 用于 </span></span><code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>WordCountTopology</code> 中，<code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>RandomSentenceSpout</code> 发送元组数据给 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>SplitSentence</code> bolt 的部分。它很有效地把元组数组 均匀分给所有的<span style="line-height:24px"> </span><code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); line-height:24px; background-color:rgb(249,242,244)'>SplitSentence</code><span style="line-height:24px"> bolt 的任务。</span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 一个更有趣的分组方式叫做 <span style="line-height:24px">"fields grouping"。在本例中，字段分组用于</span> <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>SplitSentence</code> bolt 和 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>WordCount</code> bolt 之间。它对 <span style='color:rgb(199,37,78); font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; line-height:24px; background-color:rgb(249,242,244)'>WordCount </span>的功能至关重要，它保证了相同的单词只会去相同的任务中。否则,会有多个任务接收到相同的单词，它们各自发出的单词统计也是不正确的，因为它们获得的都是不全的信息。 fields grouping 让你可以通过字段来进行数据流的分组，这样就导致了相同的字段值会进入到相同的任务中去。 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>WordCount</code> 订阅了 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>SplitSentence</code> 的输出流，并且是通过<span style="line-height:24px">fields grouping的方式，本例针对</span> <span style="line-height:24px">"word" 字段进行分组</span>, 使相同的单词进入了相同的任务，bolt 就可以给出正确的结果了。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <span style="line-height:24px">Fields groupings 是 流的连接 和 聚合 的基础实现，它也有其他很多的例子。</span><br> </p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 在底层, fields groupings 使用 mod hashing <a target="_blank" href="http://lib.csdn.net/base/datastructure" rel="nofollow noopener noreferrer" class="replace_word" title="算法与数据结构知识库" style="text-decoration:none; color:rgb(223,52,52); font-weight:bold">算法</a>来实现的。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 这里还有一些其他的分组方式，更多信息请参见 <a target="_blank" href="http://storm.apache.org/releases/current/Concepts.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Concepts</a>.</p> 
<h3 id="defining-bolts-in-other-languages" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t8" style="color:rgb(12,137,207)"></a>用其他语言定义Bolts</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> Bolts 可以用任何语言定义。用其他语言写的 Bolts ，是以子进程的方式运行,storm与子进程通信的方式是 通过输入输出 JSON 数据来实现的。通信协议只需要1个100行的适配器代码的库， Storm附带了 <span style="line-height:24px">Ruby, Python, and Fancy 的适配器的库。</span></p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 这是 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>SplitSentence</code> bolt 的定义，来自于 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>WordCountTopology</code>:</p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-java" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'><span class="kd" style="font-weight:bold">public</span> <span class="kd" style="font-weight:bold">static</span> <span class="kd" style="font-weight:bold">class</span> <span class="nc" style="color:rgb(68,85,136); font-weight:bold">SplitSentence</span> <span class="kd" style="font-weight:bold">extends</span> <span class="n">ShellBolt</span> <span class="kd" style="font-weight:bold">implements</span> <span class="n">IRichBolt</span> <span class="o" style="font-weight:bold">{<!-- --></span>
    <span class="kd" style="font-weight:bold">public</span> <span class="n">SplitSentence</span><span class="o" style="font-weight:bold">()</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="kd" style="font-weight:bold">super</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"python"</span><span class="o" style="font-weight:bold">,</span> <span class="s" style="color:rgb(221,17,68)">"splitsentence.py"</span><span class="o" style="font-weight:bold">);</span>
    <span class="o" style="font-weight:bold">}</span>

    <span class="kd" style="font-weight:bold">public</span> <span class="kt" style="color:rgb(68,85,136); font-weight:bold">void</span> <span class="n">declareOutputFields</span><span class="o" style="font-weight:bold">(</span><span class="n">OutputFieldsDeclarer</span> <span class="n">declarer</span><span class="o" style="font-weight:bold">)</span> <span class="o" style="font-weight:bold">{<!-- --></span>
        <span class="n">declarer</span><span class="o" style="font-weight:bold">.</span><span class="na" style="color:rgb(0,128,128)">declare</span><span class="o" style="font-weight:bold">(</span><span class="k" style="font-weight:bold">new</span> <span class="n">Fields</span><span class="o" style="font-weight:bold">(</span><span class="s" style="color:rgb(221,17,68)">"word"</span><span class="o" style="font-weight:bold">));</span>
    <span class="o" style="font-weight:bold">}</span>
<span class="o" style="font-weight:bold">}</span>
</code></pre> 
</div> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>SplitSentence</code> 覆盖 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>ShellBolt</code> 并声明用  <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>python</code> ，运行文件为 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>splitsentence.py</code>. 这是 <code style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:12.6px; padding:2px 4px; color:rgb(199,37,78); background-color:rgb(249,242,244)'>splitsentence.py</code>的实现：</p> 
<div class="highlight" style="color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px; line-height:20px"> 
 <pre style='white-space:pre-wrap; word-wrap:break-word; overflow:auto; font-family:Menlo,Monaco,Consolas,"Courier New",monospace; font-size:13px; padding:9.5px; margin-top:0px; margin-bottom:10px; line-height:1.42857; word-break:break-all; border:1px solid rgb(204,204,204); background-color:rgb(245,245,245)'><code class="language-python" style='font-family:Menlo,Monaco,Consolas,"Courier New",monospace; padding:0px; color:inherit; background-color:transparent'><span class="kn">import</span> <span class="nn" style="color:rgb(85,85,85)">storm</span>

<span class="k" style="font-weight:bold">class</span> <span class="nc" style="color:rgb(68,85,136); font-weight:bold">SplitSentenceBolt</span><span class="p">(</span><span class="n">storm</span><span class="o" style="font-weight:bold">.</span><span class="n">BasicBolt</span><span class="p">):</span>
    <span class="k" style="font-weight:bold">def</span> <span class="nf" style="color:rgb(153,0,0); font-weight:bold">process</span><span class="p">(</span><span class="bp" style="color:rgb(153,153,153)">self</span><span class="p">,</span> <span class="n">tup</span><span class="p">):</span>
        <span class="n">words</span> <span class="o" style="font-weight:bold">=</span> <span class="n">tup</span><span class="o" style="font-weight:bold">.</span><span class="n">values</span><span class="p">[</span><span class="mi" style="color:rgb(0,153,153)">0</span><span class="p">]</span><span class="o" style="font-weight:bold">.</span><span class="n">split</span><span class="p">(</span><span class="s" style="color:rgb(221,17,68)">" "</span><span class="p">)</span>
        <span class="k" style="font-weight:bold">for</span> <span class="n">word</span> <span class="ow" style="font-weight:bold">in</span> <span class="n">words</span><span class="p">:</span>
          <span class="n">storm</span><span class="o" style="font-weight:bold">.</span><span class="n">emit</span><span class="p">([</span><span class="n">word</span><span class="p">])</span>

<span class="n">SplitSentenceBolt</span><span class="p">()</span><span class="o" style="font-weight:bold">.</span><span class="n">run</span><span class="p">()</span>
</code></pre> 
</div> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 更多关于用其他语言编写 spout 和 bolt 的信息，创建topology的信息 (以及完全避免 JVM 的方式), 请参见 <a target="_blank" href="http://storm.apache.org/releases/current/Using-non-JVM-languages-with-Storm.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Using non-JVM languages with Storm</a>.</p> 
<h3 id="guaranteeing-message-processing" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t9" style="color:rgb(12,137,207)"></a>保证消息的处理</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 本教程前面部分,我们跳过了一些方面如元组是怎么发出的，这些方面涉及了Storm的可靠性的API：Storm是如何保证每条来自于spout的消息会被完全完整地被处理。 参见 <a target="_blank" href="http://storm.apache.org/releases/current/Guaranteeing-message-processing.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">Guaranteeing message processing</a> 信息看它是如何工作的，以及作为用户的你，如何使用storm的可靠性能的这一优点。</p> 
<h3 id="transactional-topologies" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t10" style="color:rgb(12,137,207)"></a>事务型的topologies</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> Storm 保证每条信息至少被处理一次. 一个大众化的问题被提出： "你怎么在storm顶层上进行计数操作?计数值会不会超量？" Storm 有一个特性称作事务型topologies，在绝大部分的计算场景中，它的实现可以让消息只传递一次。获取更多事务型的topologies的信息： <a target="_blank" href="http://storm.apache.org/releases/current/Transactional-topologies.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">here</a>.</p> 
<h3 id="distributed-rpc" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t11" style="color:rgb(12,137,207)"></a>分布式 RPC</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 本教程介绍了storm顶层的核心流的处理过程。storm原生部分 是有很多的事情可以去做的，其中最有意思的应用就是storm的分布式RPC,它具有很强的并行计算的性能。获取更多的关于分布式RPC的信息： <a target="_blank" href="http://storm.apache.org/releases/current/Distributed-RPC.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(51,122,183); background-color:transparent">here</a>.</p> 
<h3 id="conclusion" style="margin:20px 0px 10px; padding:0px; font-family:Oswald,sans-serif; font-weight:400; line-height:1.1; color:rgb(51,51,51); font-size:30px"> <a target="_blank" name="t12" style="color:rgb(12,137,207)"></a>结论</h3> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 这个教程给出了一个关于storm开发，测试，部署的概览，剩余的文档将深入storm的每个方面。</p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> <br> </p> 
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; line-height:24px; color:rgb(51,51,51); font-family:Lato,sans-serif; font-size:14px"> 原文地址：http://blog.csdn.net/hrn1216/article/details/51538962</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c715a2a2cb4440149dab467da470c9eb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">debug看源码小技巧：当有多个子类时，调用的是哪个子类的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/45f3315db69c1cb91e029c5fcbb4bd73/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">安卓实现查看通话记录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>