<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>List集合转树形结构 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/592aedc50ef10fc68f15a7fb4922609e/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="List集合转树形结构">
  <meta property="og:description" content="在开发中，我们通常需要将从数据库中查询的集合数据转换成类似文件系统一样的树形集合，比如：省市单位，部门机构，书籍分类等 TreeNode对象 @Data @AllArgsConstructor @NoArgsConstructor public class TreeNode { /** * 节点内码 */ private Long id; /** * 节点名称 */ private String label; /** * 父节点内码 */ private Long pid; /** * 子节点集合 */ private List&amp;lt;TreeNode&amp;gt; children; } 转换工具类 方式一：foreach遍历
对所传递的treeList进行遍历，然后判断该节点的父id与传递的id是否相同，相同则递归设置其孩子节点，并将该节点的放入children集合中，用于统一返回父节点相同的所有TreeNode对象。
方式二：stream流
基于ﬁlter()实现数据过滤
该方法会接收一个返回boolean的函数作为参数，终返回一个包括所有符合条件元素的流。
基于map()对元素进行转换
它接收一个函数作为方法参数，这个函数会被应用到集合中每一个 元素上，并终将其映射为一个新的元素。
对集合中的元素进行过滤，通过filter将父id相同的所有节点过滤出来，然后在map中递归设置其孩子节点，并返回。
public class List2TreeList { //方式一: 使用foreach转换 public static List&amp;lt;TreeNode&amp;gt; buildTreeUseList(List&amp;lt;TreeNode&amp;gt; treeList,long id){ //收集传递的集合中父id相同的TreeNode List&amp;lt;TreeNode&amp;gt; children = new ArrayList&amp;lt;&amp;gt;(); for (TreeNode treeNode : treeList) { //判断该节点的父id，是否与传入的父id相同，相同则递归设置其孩子节点，并将该节点放入children集合中 if(treeNode.">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-07-31T22:40:29+08:00">
    <meta property="article:modified_time" content="2023-07-31T22:40:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">List集合转树形结构</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>在开发中，我们通常需要将从数据库中查询的集合数据转换成类似文件系统一样的树形集合，比如：省市单位，部门机构，书籍分类等</h4> 
<h3><strong>TreeNode对象</strong></h3> 
<pre><code class="language-java">@Data
@AllArgsConstructor
@NoArgsConstructor
public class TreeNode {
    /**
     * 节点内码
     */
    private Long id;
    /**
     * 节点名称
     */
    private String label;
    /**
     * 父节点内码
     */
    private Long pid;
    /**
     * 子节点集合
     */
    private List&lt;TreeNode&gt; children;
}</code></pre> 
<h3><strong>转换工具类</strong></h3> 
<p><strong>方式一：foreach遍历</strong></p> 
<p><strong>对所传递的treeList进行遍历，然后判断该节点的父id与传递的id是否相同，相同则递归设置其孩子节点，并将该节点的放入children集合中，用于统一返回父节点相同的所有TreeNode对象。</strong></p> 
<p><strong>方式二：stream流</strong></p> 
<p><strong>基于ﬁlter()实现数据过滤</strong></p> 
<p>该方法会接收一个返回boolean的函数作为参数，终返回一个包括所有符合条件元素的流。</p> 
<p><strong>基于map()对元素进行转换</strong></p> 
<p>它接收一个函数作为方法参数，这个函数会被应用到集合中每一个 元素上，并终将其映射为一个新的元素。</p> 
<p><strong>对集合中的元素进行过滤，通过filter将父id相同的所有节点过滤出来，然后在map中递归设置其孩子节点，并返回。</strong></p> 
<pre><code class="language-java">public class List2TreeList {

    //方式一:  使用foreach转换
    public static List&lt;TreeNode&gt; buildTreeUseList(List&lt;TreeNode&gt; treeList,long id){
        //收集传递的集合中父id相同的TreeNode
        List&lt;TreeNode&gt; children = new ArrayList&lt;&gt;();
        for (TreeNode treeNode : treeList) {
            //判断该节点的父id，是否与传入的父id相同，相同则递归设置其孩子节点，并将该节点放入children集合中
            if(treeNode.getPid() == id){
                //递归设置其孩子节点
                treeNode.setChildren(buildTreeUseList(treeList, treeNode.getId()));
                //放入children集合
                children.add(treeNode);
            }
        }
        return children;
    }

    //方式二:  使用stream流转换
    public static List&lt;TreeNode&gt; buildTreeUseStream(List&lt;TreeNode&gt; treeList,long id){
        List&lt;TreeNode&gt; list = treeList.stream()
                //过滤父节点与传递的id相同的TreeNode对象
                .filter( treeNode -&gt; treeNode.getPid().longValue() == id )
                .map( treeNode -&gt; {
                    //递归设置孩子节点
                    treeNode.setChildren(buildTreeUseStream(treeList,treeNode.getId()));
                    return treeNode;
                })
                .collect(Collectors.toList());
        return list;
    }
}</code></pre> 
<h3><strong>功能测试</strong></h3> 
<p><strong>传入集合数据及最高节点的父id进行转换</strong></p> 
<pre><code class="language-java">@RestController
public class TestController {

    @GetMapping("/treeList")
    public List&lt;TreeNode&gt; convert2Tree(){
        List&lt;TreeNode&gt; list = new ArrayList&lt;&gt;();
        list.add(new TreeNode(370000l,"山东省",0l,null));
        list.add(new TreeNode(370100l,"济南市",370000l,null));
        list.add(new TreeNode(370200l,"青岛市",370000l,null));
        list.add(new TreeNode(370300l,"淄博市",370000l,null));
        list.add(new TreeNode(371300l,"临沂市",370000l,null));
        list.add(new TreeNode(370102l,"历下区",370100l,null));
        list.add(new TreeNode(370103l,"市中区",370100l,null));
        list.add(new TreeNode(370202l,"市南区",370200l,null));
        //使用list转换
        List&lt;TreeNode&gt; treeList = List2TreeList.buildTreeUseList(list, 0l);
        System.out.println(treeList);
        return treeList;
    }
}</code></pre> 
<h3><strong>TreeList结果格式</strong></h3> 
<p><strong>转换后的集合数据格式</strong></p> 
<pre><code class="language-java">[
    {
        "id": 370000,
        "label": "山东省",
        "pid": 0,
        "children": [
            {
                "id": 370100,
                "label": "济南市",
                "pid": 370000,
                "children": [
                    {
                        "id": 370102,
                        "label": "历下区",
                        "pid": 370100,
                        "children": []
                    },
                    {
                        "id": 370103,
                        "label": "市中区",
                        "pid": 370100,
                        "children": []
                    }
                ]
            },
            {
                "id": 370200,
                "label": "青岛市",
                "pid": 370000,
                "children": [
                    {
                        "id": 370202,
                        "label": "市南区",
                        "pid": 370200,
                        "children": []
                    }
                ]
            },
            {
                "id": 370300,
                "label": "淄博市",
                "pid": 370000,
                "children": []
            },
            {
                "id": 371300,
                "label": "临沂市",
                "pid": 370000,
                "children": []
            }
        ]
    }
]</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/49c27e124e0042034c8e18844393f9ba/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Linux】中如何安装nginx</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8fb07f1ec70da2734198fd20da0a5ca7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【物联网】详解STM32的GPIO八种输入输出模式，GPIO各种输入输出的区别、初始化的步骤详解，看这文章就行了（超详细）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>