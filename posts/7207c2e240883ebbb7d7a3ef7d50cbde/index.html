<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>离线环境下仅使用vscode remote ssh方式远程连接服务器操作指南 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/7207c2e240883ebbb7d7a3ef7d50cbde/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="离线环境下仅使用vscode remote ssh方式远程连接服务器操作指南">
  <meta property="og:description" content="文章目录 1.vscode配置2.安装步骤3.简单的使用方法说明4.vscode免密登录服务器配置5.vscode使用普通用户登录远程ubuntu服务器配置5.参考 1.vscode配置 由于vscode的跨平台的特点：vscode既可以安装在windows，也可以安装在Linux，也可以安装在macOS。下面的操作全都是在Linux（CentOS）上进行的remote ssh插件需要在客户端以及服务端都需要安装，如果是是连外网状态，配置好网络后，可以直接使用。如果是离线状态，则需要自己下载vscode的客户端插件和服务端插件，然后放置在Linux的合适位置。vscode的代码编辑器需要安装的插件是：
2.安装步骤 第一步：首先在Linux上安装vscode客户端代码编辑器
在vscode官网上下载：链接，
下载完毕后，使用rpm -ivh code-1.51.1-1605051791.el7.x86_64.rpm进行安装，安装过程中依赖的包，需要配置公司内部的镜像yum源进行下载，我在安装过程中依赖一个libXScrnSaver-1.2.2-6.1.el7.x86_64.rpm这个包，但是公司镜像源没有，我就从Centos下载的官方二进制包，链接
图中的链接放到浏览器中就可以下载：安装：rpm -ivh libXScrnSaver-1.2.2-6.1.el7.x86_64.rpm
到此位置vscode应该安装完毕
第二步：给vscode编辑器安装Remote-SSH插件：ms-vscode-remote.remote-ssh-0.56.0.vsix
（1）首先需要安装Remote-SSH插件在vscode客户端代码编辑器上，需要从Visual Studio | Marketplace中去搜索下载，
下载链接，如果是C/C&#43;&#43;的开发，最好再下载一个ms-vscode.cpptools-0.29.0.vsx插件工具，以及MS-CEINTL.vscode-language-pack-zh-hans-1.51.2.vsx简体中文翻译插件工具
（2）将ms-vscode.cpptools-0.29.0.vsx工具在windows本地进行解压，然后压缩成ms-vscode.cpptools-0.29.0.zip文件上传至服务器的/root/.vscode/extensions这个目录下
接着新建目录，eg：mkdir ms-vscode-remote.remote-ssh-0.56.0，解压ms-vscode.cpptools-0.29.0.zip，将其中的extensions下的内容拷贝到ms-vscode-remote.remote-ssh-0.56.0目录中去，最后重启vscode客户端即可，此时vscode中应该可以看到安装好的remote ssh插件。
其他插件的安装方式类似，如果有错误请看vscode客户端界面的错误
第三步：vscode服务端的配置
（1）在客户端使用remote ssh方式连接服务器，以此来获取commit id
该config文件的内容，大致如下，都是可配的，其他选项自己配置尝试
Host 100.19.14.217 HostName 100.19.14.217 port 22 User root 免密登录参考：VsCode Remote SSh开启免密登录 输入：ssh root@192.168.122.155或者ssh -p 22 root@192.168.122.155
192.168.122.155为服务器的ip，root为服务器的用户
在vscode中打开：查看-&amp;gt;输出，打开下面的remote-ssh，这里是vscode客户端的输出信息，commit id以及报错以及使用的日志在这里会输出，从这里我们可以获取commit id。
将commit id放到这个链接中：https://update.code.visualstudio.com/commit:commit id/server-linux-x64/stable
（2）eg：https://update.code.visualstudio.com/commit:6ab598523be7a800d7f3eb4d92d7ab9a66669390/server-linux-x64/stable
（3）清空/root/.vscode-server/bin/6ab598523be7a800d7f3eb4d92d7ab9a66669390下目录的内容
（4）将下载下来的vscode-server-linux-x64.tar.gz文件放到/root/.vscode-server/bin/6ab598523be7a800d7f3eb4d92d7ab9a66669390中下面（6ab598523be7a800d7f3eb4d92d7ab9a66669390这个id应该与vscode客户端看到的commit id应该是对应的）
（5）在这个目录下解压vscode-server-linux-x64.tar.gz，tar -xvzf vscode-server-linux-x64.tar.gz --strip-components 1
（6）所有工作做完，重启vscode客户端，右键下方，然后进行connect，会提示有2种方式，这2种方式随意
注意：连接过程中注意报错输出日志，如果报错了要按照日志进行百度等方式处理，这里列一下我做的配置改变，如果能直接使用，则不需要修改
因为remote ssh使用的是ssh，所以更改基本上都是/etc/ssh/sshd_config文件 AllowTcpForwarding yes打开 PermitRootLogin yes打开 上面这么做的一个好处是，只要一台服务器配置成功，其他服务器都不用配置了，都是可以直接用。">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-06-20T10:27:14+08:00">
    <meta property="article:modified_time" content="2022-06-20T10:27:14+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">离线环境下仅使用vscode remote ssh方式远程连接服务器操作指南</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#1vscode_1" rel="nofollow">1.vscode配置</a></li><li><a href="#2_9" rel="nofollow">2.安装步骤</a></li><li><a href="#3_63" rel="nofollow">3.简单的使用方法说明</a></li><li><a href="#4vscode_72" rel="nofollow">4.vscode免密登录服务器配置</a></li><li><a href="#5vscodeubuntu_91" rel="nofollow">5.vscode使用普通用户登录远程ubuntu服务器配置</a></li><li><a href="#5_141" rel="nofollow">5.参考</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="1vscode_1"></a>1.vscode配置</h3> 
<ul><li>由于vscode的跨平台的特点：vscode既可以安装在windows，也可以安装在Linux，也可以安装在macOS。<font color="#F00">下面的操作全都是在Linux（CentOS）上进行的</font></li><li><strong>remote ssh插件需要在客户端以及服务端都需要安装，如果是是连外网状态，配置好网络后，可以直接使用。</strong></li><li><strong>如果是离线状态，则需要自己下载vscode的客户端插件和服务端插件，然后放置在Linux的合适位置。</strong></li><li>vscode的代码编辑器需要安装的插件是：<br> <img src="https://images2.imgbox.com/fb/ce/3psHtMco_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="2_9"></a>2.安装步骤</h3> 
<ul><li> <p>第一步：首先在Linux上安装vscode客户端代码编辑器<br> 在vscode官网上下载：<a href="https://code.visualstudio.com/Download" rel="nofollow">链接</a>，<br> <img src="https://images2.imgbox.com/29/88/OUF7Uv8R_o.png" alt="在这里插入图片描述"><br> 下载完毕后，使用rpm -ivh code-1.51.1-1605051791.el7.x86_64.rpm进行安装，安装过程中依赖的包，需要配置公司内部的镜像yum源进行下载，我在安装过程中依赖一个libXScrnSaver-1.2.2-6.1.el7.x86_64.rpm这个包，但是公司镜像源没有，我就从Centos下载的官方二进制包，<a href="https://centos.pkgs.org/7/centos-x86_64/libunwind-1.2-2.el7.x86_64.rpm.html" rel="nofollow">链接</a><br> 图中的链接放到浏览器中就可以下载：安装：rpm -ivh libXScrnSaver-1.2.2-6.1.el7.x86_64.rpm<br> <img src="https://images2.imgbox.com/e4/ed/6adfCCoR_o.png" alt="在这里插入图片描述"><br> 到此位置vscode应该安装完毕</p> </li><li> <p>第二步：给vscode编辑器安装Remote-SSH插件：ms-vscode-remote.remote-ssh-0.56.0.vsix<br> （1）首先需要安装Remote-SSH插件在vscode客户端代码编辑器上，需要从<a href="https://marketplace.visualstudio.com/search?target=VSCode&amp;category=All%20categories&amp;sortBy=Installs" rel="nofollow">Visual Studio | Marketplace</a>中去搜索下载，<br> <img src="https://images2.imgbox.com/05/7f/CQuYKHMZ_o.png" alt="在这里插入图片描述"><br> <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-ssh" rel="nofollow">下载链接</a>，如果是C/C++的开发，最好再下载一个ms-vscode.cpptools-0.29.0.vsx插件工具，以及MS-CEINTL.vscode-language-pack-zh-hans-1.51.2.vsx简体中文翻译插件工具<br> （2）将ms-vscode.cpptools-0.29.0.vsx工具在windows本地进行解压，然后压缩成ms-vscode.cpptools-0.29.0.zip文件上传至服务器的/root/.vscode/extensions这个目录下<br> 接着新建目录，eg：mkdir ms-vscode-remote.remote-ssh-0.56.0，解压ms-vscode.cpptools-0.29.0.zip，将其中的extensions下的内容拷贝到ms-vscode-remote.remote-ssh-0.56.0目录中去，最后重启vscode客户端即可，此时vscode中应该可以看到安装好的remote ssh插件。<br> 其他插件的安装方式类似，如果有错误请看vscode客户端界面的错误<br> <img src="https://images2.imgbox.com/1c/ed/IBhN2iKA_o.png" alt="在这里插入图片描述"></p> </li><li> <p>第三步：vscode服务端的配置<br> （1）在客户端使用remote ssh方式连接服务器，以此来获取commit id<br> <img src="https://images2.imgbox.com/a5/10/wFXPFQdl_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e6/98/41zT7iQO_o.png" alt="在这里插入图片描述"><br> 该config文件的内容，大致如下，都是可配的，其他选项自己配置尝试</p> </li></ul> 
<pre><code class="prism language-c">Host <span class="token number">100.19</span><span class="token number">.14</span><span class="token number">.217</span>
   HostName <span class="token number">100.19</span><span class="token number">.14</span><span class="token number">.217</span>
   port <span class="token number">22</span>
   User root
</code></pre> 
<ul><li>免密登录参考：<a href="https://www.huiyingwu.com/4839/" rel="nofollow">VsCode Remote SSh开启免密登录</a></li></ul> 
<p>输入：ssh root@192.168.122.155或者ssh -p 22 root@192.168.122.155<br> 192.168.122.155为服务器的ip，root为服务器的用户<br> 在vscode中打开：查看-&gt;输出，打开下面的remote-ssh，这里是vscode客户端的输出信息，commit id以及报错以及使用的日志在这里会输出，从这里我们可以获取commit id。<br> <img src="https://images2.imgbox.com/a5/ad/DMLegWoa_o.png" alt="在这里插入图片描述"></p> 
<p>将commit id放到这个链接中：https://update.code.visualstudio.com/commit:<strong>commit id</strong>/server-linux-x64/stable<br> （2）eg：https://update.code.visualstudio.com/commit:6ab598523be7a800d7f3eb4d92d7ab9a66669390/server-linux-x64/stable<br> （3）清空/root/.vscode-server/bin/6ab598523be7a800d7f3eb4d92d7ab9a66669390下目录的内容<br> （4）将下载下来的vscode-server-linux-x64.tar.gz文件放到/root/.vscode-server/bin/6ab598523be7a800d7f3eb4d92d7ab9a66669390中下面（<font color="#F00"><strong>6ab598523be7a800d7f3eb4d92d7ab9a66669390这个id应该与vscode客户端看到的commit id应该是对应的</strong>）</font><br> （5）在这个目录下解压vscode-server-linux-x64.tar.gz，tar -xvzf vscode-server-linux-x64.tar.gz --strip-components 1<br> （6）所有工作做完，重启vscode客户端，右键下方，然后进行connect，会提示有2种方式，这2种方式随意<br> <img src="https://images2.imgbox.com/96/a2/BUc22DNF_o.png" alt="在这里插入图片描述"></p> 
<ul><li>注意：连接过程中注意报错输出日志，如果报错了要按照日志进行百度等方式处理，这里列一下我做的配置改变，如果能直接使用，则不需要修改<br> 因为remote ssh使用的是ssh，所以更改基本上都是/etc/ssh/sshd_config文件</li></ul> 
<pre><code class="prism language-cpp">AllowTcpForwarding yes打开
PermitRootLogin yes打开
</code></pre> 
<p>上面这么做的一个好处是，只要一台服务器配置成功，其他服务器都不用配置了，都是可以直接用。</p> 
<h3><a id="3_63"></a>3.简单的使用方法说明</h3> 
<ul><li> <p>配置完成后，在vscode中点击文件-&gt;打开文件夹来进行目录选择，只能通过绝对路径的方式修改目录<br> <img src="https://images2.imgbox.com/e9/a4/6wzVGZZc_o.png" alt="在这里插入图片描述"></p> </li><li> <p>配置完成后，还可以有一个终端，用来操作服务器<br> <img src="https://images2.imgbox.com/18/4b/joFP7Brr_o.png" alt="在这里插入图片描述"></p> </li><li> <p>只要配置完，就可以使用该vscode客户端连接其他服务器了，该服务端的配置会被自动分发到别的服务器中</p> </li></ul> 
<h3><a id="4vscode_72"></a>4.vscode免密登录服务器配置</h3> 
<p>Client：Win<br> Server：ubuntu</p> 
<pre><code class="prism language-bash">vscode的remote ssh的配置文件<span class="token punctuation">(</span>C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>wangji<span class="token punctuation">\</span>.ssh<span class="token punctuation">\</span>config<span class="token punctuation">)</span>如下：
Host <span class="token number">192.168</span>.229.12
  HostName <span class="token number">192.168</span>.229.12
  User root
  IdentityFile <span class="token string">"C:\Users\wangji\.ssh\id_rsa"</span>
  ServerAliveInterval <span class="token number">60</span>

由Win的git的cmd得到私有-公有密钥对

在git命令行使用ssh-keygen命令，得到C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>script.wang<span class="token punctuation">\</span>.ssh<span class="token punctuation">\</span>id_rsa的公钥id_rsa.pub；
将其拷贝至ubuntu的cat ~/.ssh/authorized_keys（文件没有则新建该文件即可）
</code></pre> 
<h3><a id="5vscodeubuntu_91"></a>5.vscode使用普通用户登录远程ubuntu服务器配置</h3> 
<p>客户端：win10<br> 服务器端：ubuntu</p> 
<ul><li>（1）使用<a href="https://jiwangreal.blog.csdn.net/article/details/125329971?spm=1001.2014.3001.5502" rel="nofollow">Ubuntu系统添加新的普通用户</a>方法添加新一个新用户jiwangreal</li><li>（2）在ubuntu的testuser下创建一个ssh私有密钥对，然后重启sshd服务</li></ul> 
<pre><code class="prism language-bash">ssh-keygen -t rsa -C <span class="token string">"jiwangreal@163.com"</span>
<span class="token function">sudo</span> <span class="token function">service</span> sshd restart
</code></pre> 
<ul><li>（3）将win10的公有密钥的内容写入至ubuntu的authorized_keys</li></ul> 
<pre><code class="prism language-bash">ssh-copy-id wangji@xxx.xxx.xxx.xxx---最好这么使用，因为ssh相关的权限配置问题很蛋疼

ssh-copy-id失效的情况下。使用：
/home/jiwangreal/.ssh/authorized_keys
打开，然后将公有密钥填进去
</code></pre> 
<ul><li>（4）vscode的remote ssh配置如下，或者直接使用点下面的+号也行</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># Read more about SSH config files: https://linux.die.net/man/5/ssh_config</span>
Host jiwangreal
    HostName <span class="token number">192.168</span>.79.135
    User jiwangreal
    <span class="token comment">#IdentityFile "C:\Users\1\.ssh\id_rsa"---可以不需要</span>
    <span class="token comment">#ServerAliveInterval 60</span>

Host root
    HostName <span class="token number">192.168</span>.79.135
    User root
    <span class="token comment">#IdentityFile "C:\Users\1\.ssh\id_rsa"</span>
    <span class="token comment">#ServerAliveInterval 60</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5c/ca/S2pfV0A3_o.png" alt="在这里插入图片描述"></p> 
<ul><li>（5）注意：ubuntu的sshd_config文件<a href="https://download.csdn.net/download/u011436427/85694261">链接</a>，若还是不能免密登录，可以使用链接中的sshd_config文件替换原有的sshd_config文件</li></ul> 
<pre><code class="prism language-bash">记住要先备份哦
<span class="token function">cp</span> -f /etc/ssh/sshd_config /etc/ssh/sshd_config_bak
</code></pre> 
<h3><a id="5_141"></a>5.参考</h3> 
<ul><li><a href="https://download.csdn.net/download/u011436427/11967937">VS code的linux服务器端的离线安装教程</a>，主要进行参考，该方法将vscode客户端安装在了windows10而已，但是我这边完成后，总是不会稳定，所以没采用</li><li>参考的blog：<br> <a href="https://code.visualstudio.com/docs/remote/troubleshooting#_configuring-key-based-authentication" rel="nofollow">官方文档</a>可以直接从vs code获取，<br> <a href="https://blog.csdn.net/ltyyz/article/details/91477994">VSCode 远程开发 remote development SSH 模式 | Windows 版</a><br> <a href="https://blog.csdn.net/YiloPo/article/details/90258797">VS Code Remote 远程开发配置</a>，其中cmd的操作可以完全在vs code的终端上操作<br> <a href="https://blog.csdn.net/Huadong_eddy/article/details/90523926">Windows下使用CMD/Powershell通过SSH协议远程连接Linux服务器</a></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6fa5fc88d4af89f950a4a89e20ad961e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于JavaSwing和Mysql的学生成绩管理信息系统</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1c350c26a28d34cf2dfed89db5205241/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">爬取网站视频命令行工具you-get的安装及使用方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>