<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JdbcTemplate对象 - 老帅的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://laoshuaiblog.github.io/posts/0a805d5bf629a28d4b08d271bf2d57fe/">
  <meta property="og:site_name" content="老帅的博客">
  <meta property="og:title" content="JdbcTemplate对象">
  <meta property="og:description" content="描述
使用 例子 插入
修改
删除
查询
queryForMap()：查询结果，将结果集封装为map集合
queryForList()：查询结果，将结果集封装为list集合
query()：查询结果，将结果集封装为JavaBean对象
queryForObject：查询结果，将结果集封装为对象
描述 JdbcTemplate是Spring框架对JDBC的简单封装，依赖于数据源DataSource
使用 要是用得先导包
调用JdbcTemplate的方法来完成CRUD的操作
update()：执行DML语句。增、删、改语句queryForMap()：查询结果，将结果集封装为map集合queryForList()：查询结果，将结果集封装为list集合query()：查询结果，将结果集封装为JavaBean对象queryForObject：查询结果，将结果集封装为对象 例子 下面我们用一个例子说明，为何封装方便，例子用到：
druid连接池以及Jdbc工具类单元测试 package com.lingaolu; import org.springframework.jdbc.core.JdbcTemplate; /** * @author 林高禄 * @create 2020-06-28-9:43 */ public class TemplateDemo { private JdbcTemplate template = new JdbcTemplate(JdbcUtils.getDataSource()); } 用到的数据库表
学生表 班级表 插入 @Test public void insert() { String sql = &#34;insert into student(name,class_id,ageNum) values(&#39;王帅&#39;,2,22)&#34;; int update = template.update(sql); System.out.println(update); } 运行输出：
1
运行后学生表中的数据多了一条王帅
修改 @Test public void update(){ String sql = &#34;">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-06-28T12:00:53+08:00">
    <meta property="article:modified_time" content="2020-06-28T12:00:53+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="老帅的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">老帅的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JdbcTemplate对象</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><a href="#%E6%8F%8F%E8%BF%B0" rel="nofollow">描述</a></p> 
<p id="%E4%BD%BF%E7%94%A8%C2%A0-toc" style="margin-left:0px;"><a href="#%E4%BD%BF%E7%94%A8%C2%A0" rel="nofollow">使用 </a></p> 
<p id="%E4%BE%8B%E5%AD%90%C2%A0-toc" style="margin-left:0px;"><a href="#%E4%BE%8B%E5%AD%90%C2%A0" rel="nofollow">例子 </a></p> 
<p id="%E6%8F%92%E5%85%A5-toc" style="margin-left:40px;"><a href="#%E6%8F%92%E5%85%A5" rel="nofollow">插入</a></p> 
<p id="%E4%BF%AE%E6%94%B9-toc" style="margin-left:40px;"><a href="#%E4%BF%AE%E6%94%B9" rel="nofollow">修改</a></p> 
<p id="%E5%88%A0%E9%99%A4-toc" style="margin-left:40px;"><a href="#%E5%88%A0%E9%99%A4" rel="nofollow">删除</a></p> 
<p id="%E6%9F%A5%E8%AF%A2-toc" style="margin-left:40px;"><a href="#%E6%9F%A5%E8%AF%A2" rel="nofollow">查询</a></p> 
<p id="queryForMap()%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BAmap%E9%9B%86%E5%90%88-toc" style="margin-left:80px;"><a href="#queryForMap%28%29%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BAmap%E9%9B%86%E5%90%88" rel="nofollow">queryForMap()：查询结果，将结果集封装为map集合</a></p> 
<p id="queryForList()%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BAlist%E9%9B%86%E5%90%88-toc" style="margin-left:80px;"><a href="#queryForList%28%29%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BAlist%E9%9B%86%E5%90%88" rel="nofollow">queryForList()：查询结果，将结果集封装为list集合</a></p> 
<p id="query()%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BAJavaBean%E5%AF%B9%E8%B1%A1-toc" style="margin-left:80px;"><a href="#query%28%29%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BAJavaBean%E5%AF%B9%E8%B1%A1" rel="nofollow">query()：查询结果，将结果集封装为JavaBean对象</a></p> 
<p id="queryForObject%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BA%E5%AF%B9%E8%B1%A1-toc" style="margin-left:80px;"><a href="#queryForObject%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BA%E5%AF%B9%E8%B1%A1" rel="nofollow">queryForObject：查询结果，将结果集封装为对象</a></p> 
<hr id="hr-toc"> 
<p> </p> 
<blockquote> 
 <h2 id="%E6%8F%8F%E8%BF%B0">描述</h2> 
 <p>JdbcTemplate是Spring框架对JDBC的简单封装，依赖于数据源DataSource</p> 
</blockquote> 
<blockquote> 
 <h2 id="%E4%BD%BF%E7%94%A8%C2%A0">使用 </h2> 
</blockquote> 
<blockquote> 
 <p>要是用得先导包</p> 
 <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/fb/b8/QpTqHPvT_o.png"></p> 
 <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/5e/57/hor6XHYT_o.png"></p> 
 <p> </p> 
</blockquote> 
<blockquote> 
 <p>调用JdbcTemplate的方法来完成CRUD的操作</p> 
 <ul><li>update()：执行DML语句。增、删、改语句</li><li>queryForMap()：查询结果，将结果集封装为map集合</li><li>queryForList()：查询结果，将结果集封装为list集合</li><li>query()：查询结果，将结果集封装为JavaBean对象</li><li>queryForObject：查询结果，将结果集封装为对象</li></ul> 
</blockquote> 
<blockquote> 
 <h2 id="%E4%BE%8B%E5%AD%90%C2%A0">例子 </h2> 
</blockquote> 
<blockquote> 
 <p>下面我们用一个例子说明，为何封装方便，例子用到：</p> 
 <ul><li><a href="https://mp.csdn.net/console/editor/html/106972557">druid连接池以及Jdbc工具类</a></li><li><a href="https://mp.csdn.net/console/editor/html/106992391">单元测试</a></li></ul> 
</blockquote> 
<pre><code class="language-java">package com.lingaolu;

import org.springframework.jdbc.core.JdbcTemplate;

/**
 * @author 林高禄
 * @create 2020-06-28-9:43
 */
public class TemplateDemo {

    private JdbcTemplate template = new JdbcTemplate(JdbcUtils.getDataSource());
    
    
}
</code></pre> 
<p> </p> 
<blockquote> 
 <p>用到的数据库表</p> 
 <ul><li>学生表 </li></ul> 
 <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/db/dd/kNoEurTb_o.png"></p> 
 <ul><li>班级表</li></ul> 
 <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/73/5a/etOz8Muy_o.png"></p> 
 <p> </p> 
</blockquote> 
<blockquote> 
 <h3 id="%E6%8F%92%E5%85%A5">插入</h3> 
</blockquote> 
<pre><code class="language-java"> @Test
    public void insert() {
        String sql = "insert into student(name,class_id,ageNum) values('王帅',2,22)";
        int update = template.update(sql);
        System.out.println(update);
    }</code></pre> 
<blockquote> 
 <p>运行输出：</p> 
 <p>1</p> 
</blockquote> 
<blockquote> 
 <p>运行后学生表中的数据多了一条王帅</p> 
 <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/e5/c0/b7hiMYoe_o.png"></p> 
 <p> </p> 
</blockquote> 
<blockquote> 
 <h3 id="%E4%BF%AE%E6%94%B9">修改</h3> 
</blockquote> 
<pre><code class="language-java">    @Test
    public void update(){
        String sql = "update student set name=? where name=?";
        int update = template.update(sql,"王丑","王帅");
        System.out.println(update);
    }</code></pre> 
<blockquote> 
 <p>运行输出：</p> 
 <p>1</p> 
</blockquote> 
<blockquote> 
 <p>运行后表中的数据，王帅变成了王丑</p> 
 <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/d2/59/cGEJBx1A_o.png"></p> 
 <p> </p> 
</blockquote> 
<blockquote> 
 <h3 id="%E5%88%A0%E9%99%A4">删除</h3> 
</blockquote> 
<pre><code class="language-java">  @Test
    public void delete(){
        String sql = "delete from student where name=?";
        int delete = template.update(sql, "王丑");
        System.out.println(delete);
    }</code></pre> 
<blockquote> 
 <p>运行输出：</p> 
 <p>1</p> 
</blockquote> 
<blockquote> 
 <p>运行后表中的数据，王丑删除了</p> 
 <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/35/ff/PqRDMany_o.png"></p> 
 <p> </p> 
</blockquote> 
<blockquote> 
 <h3 id="%E6%9F%A5%E8%AF%A2">查询</h3> 
</blockquote> 
<blockquote> 
 <h4 id="queryForMap()%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BAmap%E9%9B%86%E5%90%88">queryForMap()：查询结果，将结果集封装为map集合</h4> 
</blockquote> 
<pre><code class="language-java">  @Test
    public void queryForMap(){
        String sql = "select * from student";
        Map&lt;String, Object&gt; stringObjectMap = template.queryForMap(sql);
        System.out.println(stringObjectMap);
    }</code></pre> 
<blockquote> 
 <p>运行输出:</p> 
 <p>org.springframework.dao.IncorrectResultSizeDataAccessException: Incorrect result size: expected 1, actual 3</p> 
 <p>......</p> 
 <p>......</p> 
</blockquote> 
<blockquote> 
 <p>因为queryForMap()只能需要一条结果，而我们查出来的是3条，所以报错，所以我们修改一下sql，值查出一条</p> 
</blockquote> 
<pre><code class="language-java"> @Test
    public void queryForMap(){
        String sql = "select * from student limit 0,1";
        Map&lt;String, Object&gt; stringObjectMap = template.queryForMap(sql);
        System.out.println(stringObjectMap);
    }</code></pre> 
<blockquote> 
 <p>运行输出：</p> 
 <p>{id=1, name=林帅, class_id=2, ageNum=23}</p> 
</blockquote> 
<blockquote> 
 <h4 id="queryForList()%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BAlist%E9%9B%86%E5%90%88">queryForList()：查询结果，将结果集封装为list集合</h4> 
</blockquote> 
<pre><code class="language-java">  @Test
    public void queryForList(){
        String sql = "select * from student";
        List&lt;Map&lt;String, Object&gt;&gt; maps = template.queryForList(sql);
        maps.forEach(System.out::println);
    }</code></pre> 
<blockquote> 
 <p>运行输出：</p> 
 <p>{id=1, name=林帅, class_id=2, ageNum=23}<br> {id=2, name=徐帅, class_id=2, ageNum=24}<br> {id=3, name=吴帅, class_id=1, ageNum=27}</p> 
</blockquote> 
<blockquote> 
 <h4 id="query()%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BAJavaBean%E5%AF%B9%E8%B1%A1">query()：查询结果，将结果集封装为JavaBean对象</h4> 
</blockquote> 
<blockquote> 
 <p>我们先把学生表的字段和值修改一下，原来的ageNum改为num_age,并且把“徐帅”的num_age置为null</p> 
</blockquote> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/58/6a/xMufIUCK_o.png"></p> 
<blockquote> 
 <p>再来一个实体类StudentVo</p> 
</blockquote> 
<pre><code class="language-java">package com.lingaolu;

/**
 * @author 林高禄
 * @create 2020-06-28-10:54
 */
public class StudentVo {
    private int id;
    private String name;
    private int ageNum;
    private String classname;

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getAgeNum() {
        return ageNum;
    }

    public void setAgeNum(int ageNum) {
        this.ageNum = ageNum;
    }

    public String getClassname() {
        return classname;
    }

    public void setClassname(String classname) {
        this.classname = classname;
    }

    @Override
    public String toString() {
        return "StudentVo{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", ageNum=" + ageNum +
                ", classname='" + classname + '\'' +
                '}';
    }
}
</code></pre> 
<pre><code class="language-java"> @Test
    public void query() {
        String sql = "select t.*,c.name class_name from student t left join class c on t.class_id = c.id";
        List&lt;StudentVo&gt; query = template.query(sql, new BeanPropertyRowMapper&lt;StudentVo&gt;(StudentVo.class));
        query.forEach(System.out::println);
    }</code></pre> 
<p> </p> 
<blockquote> 
 <p>运行输出：</p> 
 <p>org.springframework.beans.TypeMismatchException: Failed to convert property value of type 'null' to required type 'int' for property 'ageNum'; nested exception is org.springframework.core.convert.ConversionFailedException: Failed to convert from type [null] to type [int] for value 'null'; nested exception is java.lang.IllegalArgumentException: A null value cannot be assigned to a primitive type</p> 
 <p>......</p> 
 <p>......</p> 
</blockquote> 
<blockquote> 
 <p>A null value cannot be assigned to a primitive type,空值不能分配给基元类型，这就是我特意把其中一个num_age置为空的原因，所以我们以后为了防止报错，写实体类的属性要用包装类对象，而不用基本类型</p> 
</blockquote> 
<blockquote> 
 <p>修改后的StudentVo的代码</p> 
</blockquote> 
<pre><code class="language-java">package com.lingaolu;

/**
 * @author 林高禄
 * @create 2020-06-28-10:54
 */
public class StudentVo {
    private Integer id;
    private String name;
    private Integer ageNum;
    private String classname;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Integer getAgeNum() {
        return ageNum;
    }

    public void setAgeNum(Integer ageNum) {
        this.ageNum = ageNum;
    }

    public String getClassname() {
        return classname;
    }

    public void setClassname(String classname) {
        this.classname = classname;
    }

    @Override
    public String toString() {
        return "StudentVo{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", ageNum=" + ageNum +
                ", classname='" + classname + '\'' +
                '}';
    }
}
</code></pre> 
<blockquote> 
 <p>再次运行输出：</p> 
 <p>StudentVo{id=1, name='林帅', ageNum=23, classname='null'}<br> StudentVo{id=2, name='徐帅', ageNum=null, classname='null'}<br> StudentVo{id=3, name='吴帅', ageNum=27, classname='null'}</p> 
</blockquote> 
<blockquote> 
 <p>发现没有，我们的classname全是空的，奇怪，数据库里的age_num能赋值到Student属性里的ageNum，为何sql查出来的class_name不能赋值到Student属性里的classname呢，因为表里属性下划线查出来后能转为驼峰命名，但是classname并不是驼峰命名，className才是驼峰命名，所以这里我们要改一下，第一种改法是把StudentVo类里的classname改为className，第二种改法是sql语句取别名和StudentVo类的对应，这里我们采用第一种，规范一下命名，建议sql的别名最好也要规范一下和属性一致，看着舒服，当然不改也行。</p> 
</blockquote> 
<pre><code class="language-java">package com.lingaolu;

/**
 * @author 林高禄
 * @create 2020-06-28-10:54
 */
public class StudentVo {
    private Integer id;
    private String name;
    private Integer ageNum;
    private String className;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Integer getAgeNum() {
        return ageNum;
    }

    public void setAgeNum(Integer ageNum) {
        this.ageNum = ageNum;
    }

    public String getClassName() {
        return className;
    }

    public void setClassName(String className) {
        this.className = className;
    }

    @Override
    public String toString() {
        return "StudentVo{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", ageNum=" + ageNum +
                ", className='" + className + '\'' +
                '}';
    }
}
</code></pre> 
<blockquote> 
 <p>测试例子还是原来的代码</p> 
</blockquote> 
<pre><code> @Test
    public void query() {
        String sql = "select t.*,c.name class_name from student t left join class c on t.class_id = c.id";
        List&lt;StudentVo&gt; query = template.query(sql, new BeanPropertyRowMapper&lt;StudentVo&gt;(StudentVo.class));
        query.forEach(System.out::println);
    }</code></pre> 
<blockquote> 
 <p> 运行输出：</p> 
 <p>StudentVo{id=1, name='林帅', ageNum=23, className='优秀班'}<br> StudentVo{id=2, name='徐帅', ageNum=null, className='优秀班'}<br> StudentVo{id=3, name='吴帅', ageNum=27, className='尖子班'}</p> 
</blockquote> 
<blockquote> 
 <h4 id="queryForObject%EF%BC%9A%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%B0%86%E7%BB%93%E6%9E%9C%E9%9B%86%E5%B0%81%E8%A3%85%E4%B8%BA%E5%AF%B9%E8%B1%A1">queryForObject：查询结果，将结果集封装为对象</h4> 
</blockquote> 
<pre><code class="language-java">  @Test
    public void queryForObject() {
        String sql = "select count(*) from student";
        Map map = template.queryForObject(sql, Map.class);
        System.out.println(map);

    }</code></pre> 
<blockquote> 
 <p>运行输出：</p> 
 <p>org.springframework.dao.TypeMismatchDataAccessException: Type mismatch affecting row number 0 and column type 'BIGINT': Value [3] is of type [java.lang.Long] and cannot be converted to required type [java.util.Map]</p> 
</blockquote> 
<blockquote> 
 <p>Long不能转为Map,queryForObject方法一般是适用于聚合函数，返回的是Long值，所以我们要把测试代码修改下</p> 
</blockquote> 
<pre><code class="language-java"> @Test
    public void queryForObject() {
        String sql = "select count(*) from student";
        Long aLong = template.queryForObject(sql, Long.class);
        System.out.println(aLong);
    }</code></pre> 
<blockquote> 
 <p>运行输出：</p> 
 <p>3</p> 
</blockquote> 
<blockquote> 
 <p> 因为我们表中也就只有3条数据，所以结果是对的</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bc67aa535fede0cf878c71cd7e7d98e1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Halcon学习---毛刺凸点检测</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/48c0b7ad2e1d69a0b5f15b9eee9d14d5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">类图、时序图、用例图简单介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 老帅的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>